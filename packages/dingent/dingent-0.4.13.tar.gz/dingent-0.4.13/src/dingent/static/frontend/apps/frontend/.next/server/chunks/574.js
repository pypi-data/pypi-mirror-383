"use strict";exports.id=574,exports.ids=[574],exports.modules={89574:(a,b,c)=>{c.d(b,{fromHttp:()=>z});var d=c(75162),e=c(81803),f=c(96742),g=c(79748),h=c.n(g),i=c(2834),j=c(11969),k=c(56919),l=c(91228),m=c(27910),n=c(36921);let o=async a=>"function"==typeof Blob&&a instanceof Blob||a.constructor?.name==="Blob"?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await a.arrayBuffer()):p(a):q(a);async function p(a){var b;let c=await (b=a,new Promise((a,c)=>{let d=new FileReader;d.onloadend=()=>{if(2!==d.readyState)return c(Error("Reader aborted too early"));let b=d.result??"",e=b.indexOf(","),f=e>-1?e+1:b.length;a(b.substring(f))},d.onabort=()=>c(Error("Read aborted")),d.onerror=()=>c(d.error),d.readAsDataURL(b)}));return new Uint8Array((0,n.E)(c))}async function q(a){let b=[],c=a.getReader(),d=!1,e=0;for(;!d;){let{done:a,value:f}=await c.read();f&&(b.push(f),e+=f.length),d=a}let f=new Uint8Array(e),g=0;for(let a of b)f.set(a,g),g+=a.length;return f}var r=c(46420),s=c(70334),t=c(940);let u=a=>"function"==typeof ReadableStream&&(a?.constructor?.name===ReadableStream.name||a instanceof ReadableStream),v="The stream has already been transformed.",w=a=>"function"==typeof Blob&&a instanceof Blob,x="The stream has already been transformed.";async function y(a,b){let c=(a=>{if(!(a instanceof m.Readable))try{var b=a;if(!w(b)&&!u(b)){let a=b?.__proto__?.constructor?.name||b;throw Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${a}`)}let c=!1,d=async()=>{if(c)throw Error(v);return c=!0,await o(b)};return Object.assign(b,{transformToByteArray:d,transformToString:async a=>{let b=await d();if("base64"===a)return(0,r.n)(b);if("hex"===a)return(0,s.n)(b);if(void 0===a||"utf8"===a||"utf-8"===a)return(0,t.P)(b);if("function"==typeof TextDecoder)return new TextDecoder(a).decode(b);throw Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(c)throw Error(v);if(c=!0,w(b)){var a=b;if("function"!=typeof a.stream)throw Error("Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\nIf you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body");return a.stream()}if(u(b))return b;throw Error(`Cannot transform payload to web stream, got ${b}`)}})}catch(c){let b=a?.__proto__?.constructor?.name||a;throw Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${b}`)}let c=!1,d=async()=>{if(c)throw Error(x);return c=!0,await (0,k.k)(a)};return Object.assign(a,{transformToByteArray:d,transformToString:async a=>{let b=await d();return void 0===a||Buffer.isEncoding(a)?(0,l.Q)(b.buffer,b.byteOffset,b.byteLength).toString(a):new TextDecoder(a).decode(b)},transformToWebStream:()=>{if(c)throw Error(x);if(null!==a.readableFlowing)throw Error("The stream has been consumed by other callbacks.");if("function"!=typeof m.Readable.toWeb)throw Error("Readable.toWeb() is not supported. Please ensure a polyfill is available.");return c=!0,m.Readable.toWeb(a)}})})(a.body),d=await c.transformToString();if(200===a.statusCode){let a=JSON.parse(d);if("string"!=typeof a.AccessKeyId||"string"!=typeof a.SecretAccessKey||"string"!=typeof a.Token||"string"!=typeof a.Expiration)throw new f.C("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:b});return{accessKeyId:a.AccessKeyId,secretAccessKey:a.SecretAccessKey,sessionToken:a.Token,expiration:(0,j.EI)(a.Expiration)}}if(a.statusCode>=400&&a.statusCode<500){let c={};try{c=JSON.parse(d)}catch(a){}throw Object.assign(new f.C(`Server responded with status: ${a.statusCode}`,{logger:b}),{Code:c.Code,Message:c.Message})}throw new f.C(`Server responded with status: ${a.statusCode}`,{logger:b})}let z=(a={})=>{let b;a.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let c=a.awsContainerCredentialsRelativeUri??process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI,g=a.awsContainerCredentialsFullUri??process.env.AWS_CONTAINER_CREDENTIALS_FULL_URI,j=a.awsContainerAuthorizationToken??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,k=a.awsContainerAuthorizationTokenFile??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE,l=a.logger?.constructor?.name!=="NoOpLogger"&&a.logger?.warn?a.logger.warn.bind(a.logger):console.warn;if(c&&g&&(l("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),l("awsContainerCredentialsFullUri will take precedence.")),j&&k&&(l("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),l("awsContainerAuthorizationToken will take precedence.")),g)b=g;else if(c)b=`http://169.254.170.2${c}`;else throw new f.C(`No HTTP credential provider host provided.
Set AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`,{logger:a.logger});let m=new URL(b);((a,b)=>{if("https:"!==a.protocol&&"169.254.170.2"!==a.hostname&&"169.254.170.23"!==a.hostname&&"[fd00:ec2::23]"!==a.hostname){if(a.hostname.includes("[")){if("[::1]"===a.hostname||"[0000:0000:0000:0000:0000:0000:0000:0001]"===a.hostname)return}else{if("localhost"===a.hostname)return;let b=a.hostname.split("."),c=a=>{let b=parseInt(a,10);return 0<=b&&b<=255};if("127"===b[0]&&c(b[1])&&c(b[2])&&c(b[3])&&4===b.length)return}throw new f.C(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:b})}})(m,a.logger);let n=new e.$({requestTimeout:a.timeout??1e3,connectionTimeout:a.timeout??1e3});return((a,b,c)=>async()=>{for(let d=0;d<b;++d)try{return await a()}catch(a){await new Promise(a=>setTimeout(a,c))}return await a()})(async()=>{let b=function(a){return new i.K({protocol:a.protocol,hostname:a.hostname,port:Number(a.port),path:a.pathname,query:Array.from(a.searchParams.entries()).reduce((a,[b,c])=>(a[b]=c,a),{}),fragment:a.hash})}(m);j?b.headers.Authorization=j:k&&(b.headers.Authorization=(await h().readFile(k)).toString());try{let a=await n.handle(b);return y(a.response).then(a=>(0,d.g)(a,"CREDENTIALS_HTTP","z"))}catch(b){throw new f.C(String(b),{logger:a.logger})}},a.maxRetries??3,a.timeout??1e3)}}};