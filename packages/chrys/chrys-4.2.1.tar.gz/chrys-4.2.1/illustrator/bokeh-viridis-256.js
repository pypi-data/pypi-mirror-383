var config = {"document":{"height":210,"width":297,"mode":"rgb"},"characterStyles":[{"name":"swatchRectTitle","attributes":{"size":8}}],"swatchRect":{"textPosition":0.125},"colors":[{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-1","rgb":[68,1,84]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-2","rgb":[68,2,85]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-3","rgb":[68,3,87]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-4","rgb":[69,5,88]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-5","rgb":[69,6,90]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-6","rgb":[69,8,91]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-7","rgb":[70,9,92]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-8","rgb":[70,11,94]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-9","rgb":[70,12,95]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-10","rgb":[70,14,97]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-11","rgb":[71,15,98]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-12","rgb":[71,17,99]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-13","rgb":[71,18,101]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-14","rgb":[71,20,102]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-15","rgb":[71,21,103]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-16","rgb":[71,22,105]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-17","rgb":[71,24,106]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-18","rgb":[72,25,107]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-19","rgb":[72,26,108]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-20","rgb":[72,28,110]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-21","rgb":[72,29,111]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-22","rgb":[72,30,112]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-23","rgb":[72,32,113]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-24","rgb":[72,33,114]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-25","rgb":[72,34,115]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-26","rgb":[72,35,116]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-27","rgb":[71,37,117]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-28","rgb":[71,38,118]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-29","rgb":[71,39,119]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-30","rgb":[71,40,120]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-31","rgb":[71,42,121]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-32","rgb":[71,43,122]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-33","rgb":[71,44,123]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-34","rgb":[70,45,124]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-35","rgb":[70,47,124]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-36","rgb":[70,48,125]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-37","rgb":[70,49,126]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-38","rgb":[69,50,127]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-39","rgb":[69,52,127]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-40","rgb":[69,53,128]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-41","rgb":[69,54,129]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-42","rgb":[68,55,129]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-43","rgb":[68,57,130]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-44","rgb":[67,58,131]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-45","rgb":[67,59,131]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-46","rgb":[67,60,132]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-47","rgb":[66,61,132]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-48","rgb":[66,62,133]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-49","rgb":[66,64,133]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-50","rgb":[65,65,134]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-51","rgb":[65,66,134]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-52","rgb":[64,67,135]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-53","rgb":[64,68,135]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-54","rgb":[63,69,135]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-55","rgb":[63,71,136]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-56","rgb":[62,72,136]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-57","rgb":[62,73,137]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-58","rgb":[61,74,137]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-59","rgb":[61,75,137]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-60","rgb":[61,76,137]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-61","rgb":[60,77,138]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-62","rgb":[60,78,138]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-63","rgb":[59,80,138]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-64","rgb":[59,81,138]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-65","rgb":[58,82,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-66","rgb":[58,83,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-67","rgb":[57,84,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-68","rgb":[57,85,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-69","rgb":[56,86,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-70","rgb":[56,87,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-71","rgb":[55,88,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-72","rgb":[55,89,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-73","rgb":[54,90,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-74","rgb":[54,91,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-75","rgb":[53,92,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-76","rgb":[53,93,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-77","rgb":[52,94,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-78","rgb":[52,95,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-79","rgb":[51,96,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-80","rgb":[51,97,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-81","rgb":[50,98,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-82","rgb":[50,99,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-83","rgb":[49,100,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-84","rgb":[49,101,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-85","rgb":[49,102,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-86","rgb":[48,103,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-87","rgb":[48,104,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-88","rgb":[47,105,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-89","rgb":[47,106,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-90","rgb":[46,107,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-91","rgb":[46,108,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-92","rgb":[46,109,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-93","rgb":[45,110,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-94","rgb":[45,111,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-95","rgb":[44,112,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-96","rgb":[44,113,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-97","rgb":[44,114,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-98","rgb":[43,115,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-99","rgb":[43,116,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-100","rgb":[42,117,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-101","rgb":[42,118,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-102","rgb":[42,119,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-103","rgb":[41,120,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-104","rgb":[41,121,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-105","rgb":[40,122,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-106","rgb":[40,122,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-107","rgb":[40,123,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-108","rgb":[39,124,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-109","rgb":[39,125,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-110","rgb":[39,126,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-111","rgb":[38,127,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-112","rgb":[38,128,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-113","rgb":[38,129,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-114","rgb":[37,130,142]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-115","rgb":[37,131,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-116","rgb":[36,132,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-117","rgb":[36,133,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-118","rgb":[36,134,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-119","rgb":[35,135,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-120","rgb":[35,136,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-121","rgb":[35,137,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-122","rgb":[34,137,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-123","rgb":[34,138,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-124","rgb":[34,139,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-125","rgb":[33,140,141]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-126","rgb":[33,141,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-127","rgb":[33,142,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-128","rgb":[32,143,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-129","rgb":[32,144,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-130","rgb":[32,145,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-131","rgb":[31,146,140]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-132","rgb":[31,147,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-133","rgb":[31,148,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-134","rgb":[31,149,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-135","rgb":[31,150,139]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-136","rgb":[30,151,138]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-137","rgb":[30,152,138]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-138","rgb":[30,153,138]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-139","rgb":[30,153,138]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-140","rgb":[30,154,137]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-141","rgb":[30,155,137]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-142","rgb":[30,156,137]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-143","rgb":[30,157,136]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-144","rgb":[30,158,136]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-145","rgb":[30,159,136]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-146","rgb":[30,160,135]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-147","rgb":[31,161,135]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-148","rgb":[31,162,134]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-149","rgb":[31,163,134]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-150","rgb":[32,164,133]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-151","rgb":[32,165,133]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-152","rgb":[33,166,133]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-153","rgb":[33,167,132]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-154","rgb":[34,167,132]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-155","rgb":[35,168,131]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-156","rgb":[35,169,130]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-157","rgb":[36,170,130]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-158","rgb":[37,171,129]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-159","rgb":[38,172,129]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-160","rgb":[39,173,128]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-161","rgb":[40,174,127]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-162","rgb":[41,175,127]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-163","rgb":[42,176,126]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-164","rgb":[43,177,125]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-165","rgb":[44,177,125]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-166","rgb":[46,178,124]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-167","rgb":[47,179,123]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-168","rgb":[48,180,122]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-169","rgb":[50,181,122]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-170","rgb":[51,182,121]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-171","rgb":[53,183,120]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-172","rgb":[54,184,119]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-173","rgb":[56,185,118]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-174","rgb":[57,185,118]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-175","rgb":[59,186,117]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-176","rgb":[61,187,116]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-177","rgb":[62,188,115]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-178","rgb":[64,189,114]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-179","rgb":[66,190,113]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-180","rgb":[68,190,112]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-181","rgb":[69,191,111]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-182","rgb":[71,192,110]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-183","rgb":[73,193,109]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-184","rgb":[75,194,108]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-185","rgb":[77,194,107]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-186","rgb":[79,195,105]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-187","rgb":[81,196,104]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-188","rgb":[83,197,103]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-189","rgb":[85,198,102]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-190","rgb":[87,198,101]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-191","rgb":[89,199,100]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-192","rgb":[91,200,98]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-193","rgb":[94,201,97]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-194","rgb":[96,201,96]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-195","rgb":[98,202,95]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-196","rgb":[100,203,93]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-197","rgb":[103,204,92]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-198","rgb":[105,204,91]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-199","rgb":[107,205,89]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-200","rgb":[109,206,88]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-201","rgb":[112,206,86]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-202","rgb":[114,207,85]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-203","rgb":[116,208,84]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-204","rgb":[119,208,82]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-205","rgb":[121,209,81]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-206","rgb":[124,210,79]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-207","rgb":[126,210,78]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-208","rgb":[129,211,76]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-209","rgb":[131,211,75]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-210","rgb":[134,212,73]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-211","rgb":[136,213,71]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-212","rgb":[139,213,70]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-213","rgb":[141,214,68]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-214","rgb":[144,214,67]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-215","rgb":[146,215,65]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-216","rgb":[149,215,63]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-217","rgb":[151,216,62]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-218","rgb":[154,216,60]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-219","rgb":[157,217,58]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-220","rgb":[159,217,56]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-221","rgb":[162,218,55]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-222","rgb":[165,218,53]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-223","rgb":[167,219,51]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-224","rgb":[170,219,50]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-225","rgb":[173,220,48]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-226","rgb":[175,220,46]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-227","rgb":[178,221,44]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-228","rgb":[181,221,43]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-229","rgb":[183,221,41]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-230","rgb":[186,222,39]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-231","rgb":[189,222,38]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-232","rgb":[191,223,36]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-233","rgb":[194,223,34]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-234","rgb":[197,223,33]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-235","rgb":[199,224,31]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-236","rgb":[202,224,30]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-237","rgb":[205,224,29]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-238","rgb":[207,225,28]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-239","rgb":[210,225,27]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-240","rgb":[212,225,26]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-241","rgb":[215,226,25]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-242","rgb":[218,226,24]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-243","rgb":[220,226,24]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-244","rgb":[223,227,24]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-245","rgb":[225,227,24]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-246","rgb":[228,227,24]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-247","rgb":[231,228,25]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-248","rgb":[233,228,25]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-249","rgb":[236,228,26]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-250","rgb":[238,229,27]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-251","rgb":[241,229,28]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-252","rgb":[243,229,30]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-253","rgb":[246,230,31]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-254","rgb":[248,230,33]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-255","rgb":[250,230,34]},{"group":"bokeh-viridis-256","name":"bokeh-viridis-256-256","rgb":[253,231,36]}]};

// Polyfills methods that aren't available in Illustrator.
polyfill();

// Document configuration.
var docColorSpace = 'cmyk' === config.document.mode ? DocumentColorSpace.CMYK : DocumentColorSpace.RGB;
var docHeight = mmToPt(config.document.height);
var docWidth = mmToPt(config.document.width);

// Swatch rectangle configuration.
var swatchRectWidth = docWidth / getColorGroups(config.colors).length;
var swatchRectHeight = docHeight / getMaxShades(config.colors);

// Creates a document template.
var docPreset = new DocumentPreset;
docPreset.colorMode = docColorSpace;
docPreset.height = docHeight;
docPreset.width = docWidth;
docPreset.units = RulerUnits.Millimeters;

// Creates a new document.
var doc = app.documents.addDocument(docColorSpace, docPreset);

// Creates character styles.
var charStyles = {};
config.characterStyles.forEach(function (style) {
  var styleAttributes = style.attributes;
  var characterStyle = doc.characterStyles.add(style.name);
  var characterAttributes = characterStyle.characterAttributes;

  Object.keys(styleAttributes).forEach(function (attribute) {
    characterAttributes[attribute] = styleAttributes[attribute];
  });

  charStyles[style.name] = characterStyle;
});

// Removes default swatches and swatch groups created by Illustrator.
removeAllSwatchGroups();
removeAllSwatches();

// Creates and adds swatch groups and swatches.
build(config.colors, config.document.mode);

/**
 * Creates and adds swatch groups and swatches.
 *
 * @param   {Array} colors
 * @param   {String} mode
 */
function build(colors, mode) {
  var colorGroups = getColorGroups(colors);

  colorGroups.forEach(function (colorGroup, colorGroupIndex) {
    // Creates and adds swatch group.
    var swatchGroup = addSwatchGroup(colorGroup);

    // Gets colors that belong to group.
    var groupColors = colors.filter(function (o) {
      return o.group === colorGroup;
    });

    groupColors.forEach(function (groupColor, groupColorIndex) {
      // Creates RGB color.
      var rgb = new RGBColor();
      rgb.red = groupColor.rgb[0];
      rgb.green = groupColor.rgb[1];
      rgb.blue = groupColor.rgb[2];

      var swatchColor = 'cmyk' === mode ? colorToCMYK(rgb) : rgb;

      // Creates and adds swatch to document.
      var swatch = addSwatch(groupColor.name, swatchColor);

      // Adds swatch to swatch group.
      swatchGroup.addSwatch(swatch);

      // Draws rectangle on artboard.
      drawSwatchRect(docHeight - groupColorIndex * swatchRectHeight, colorGroupIndex * swatchRectWidth, swatchRectWidth, swatchRectHeight, groupColor.name, swatchColor);
    });
  });
}

/**
 * Adds swatch group.
 *
 * @param   {String} name
 * @returns {SwatchGroup}
 */
function addSwatchGroup(name) {
  var swatchGroup = doc.swatchGroups.add();
  swatchGroup.name = name;

  return swatchGroup;
}

/**
 * Adds swatch.
 *
 * @param   {String} name
 * @param   {Color} color
 * @returns {Swatch}
 */
function addSwatch(name, color) {
  var swatch = doc.swatches.add();
  swatch.color = color;
  swatch.name = name;

  return swatch;
}

/**
 * Removes all swatches.
 */
function removeAllSwatches() {
  for (var i = 0; i < doc.swatches.length; i++) {
    doc.swatches[i].remove();
  }
}

/**
 * Removes all swatch groups.
 */
function removeAllSwatchGroups() {
  for (var i = 0; i < doc.swatchGroups.length; i++) {
    doc.swatchGroups[i].remove();
  }
}

/**
 * Draws rectangle on artboard.
 *
 * @param   {Number} top
 * @param   {Number} left
 * @param   {Number} width
 * @param   {Number} height
 * @param   {String} name
 * @param   {Color} color
 * @returns {PathItem}
 */
function drawSwatchRect(top, left, width, height, name, color) {
  var layer = doc.layers[0];

  var rect = layer.pathItems.rectangle(top, left, width, height);
  rect.filled = true;
  rect.fillColor = color;
  rect.stroked = false;

  var textBounds = layer.pathItems.rectangle(top - height * config.swatchRect.textPosition, left + width * config.swatchRect.textPosition, width * (1 - config.swatchRect.textPosition * 2), height * (1 - config.swatchRect.textPosition * 2));
  var text = layer.textFrames.areaText(textBounds);
  text.contents = name + '\n' + colorToString(color);

  charStyles['swatchRectTitle'].applyTo(text.textRange);

  return rect;
}

/**
 * Returns an array of unique group names.
 *
 * @param   {Array} colors
 * @returns {Array)
 */
function getColorGroups(colors) {
  var colorGroups = [];

  colors.forEach(function (color) {
    if (colorGroups.indexOf(color.group) < 0) {
      colorGroups.push(color.group);
    }
  });

  return colorGroups;
}

/**
 * Returns maximum number of shades.
 *
 * @param   {Array} colors
 * @returns {Number}
 */
function getMaxShades(colors) {
  var max = 0;
  var colorGroups = getColorGroups(colors);

  colorGroups.forEach(function (colorGroup, colorGroupIndex) {
    // Gets colors that belong to group.
    var groupColors = colors.filter(function (o) {
      return o.group === colorGroup;
    });

    var len = groupColors.length;

    if (len > max) {
      max = len;
    }
  });

  return max;
}

/**
 *
 * @see https://github.com/totorototo/adobe_cc_extension/blob/master/Apps/Panels/src/cep/application/ilst/color.jsx
 * @param   {Color} color
 * @returns {CMYKColor}
 */
function colorToCMYK(color) {
  var cmykColor = new CMYKColor();
  var colors;

  switch (color.typename) {
  case 'CMYKColor':
    cmykColor = color;
    break;

  case 'RGBColor':
    colors = app.convertSampleColor(ImageColorSpace.RGB, [color.red, color.green, color.blue], ImageColorSpace.CMYK, ColorConvertPurpose.dummypurpose);
    cmykColor.cyan = colors[0];
    cmykColor.magenta = colors[1];
    cmykColor.yellow = colors[2];
    cmykColor.black = colors[3];
    break;

  case 'LabColor':
    colors = app.convertSampleColor(ImageColorSpace.LAB, [color.l, color.a, color.b], ImageColorSpace.CMYK, ColorConvertPurpose.dummypurpose);
    cmykColor.cyan = colors[0];
    cmykColor.magenta = colors[1];
    cmykColor.yellow = colors[2];
    cmykColor.black = colors[3];
    break;

  case 'GrayColor':
    colors = app.convertSampleColor(ImageColorSpace.GrayScale, [color.gray], ImageColorSpace.CMYK, ColorConvertPurpose.dummypurpose);
    cmykColor.cyan = colors[0];
    cmykColor.magenta = colors[1];
    cmykColor.yellow = colors[2];
    cmykColor.black = colors[3];
    break;

  case 'SpotColor':
    return colorToCMYK(color.spot.color);
  }

  return cmykColor;
};

/**
 *
 * @param   {Color} color
 * @returns {String}
 */
function colorToString(color) {
  if ('CMYKColor' === color.typename) {
    return [
      Math.round(color.cyan) + '%',
      Math.round(color.magenta) + '%',
      Math.round(color.yellow) + '%',
      Math.round(color.black) + '%'
    ].join(', ');
  }
  else if ('RGBColor' === color.typename) {
    return [
      Math.round(color.red),
      Math.round(color.green),
      Math.round(color.blue)
    ].join(', ');
  }

  return '';
}

/**
 *
 * @param   {Number} mm
 * @returns {Number}
 */
function mmToPt(mm) {
  return mm * 2.834645;
}

/**
 *
 * @param   {Number} pt
 * @returns {Number}
 */
function ptToMm(pt) {
  return pt / 2.834645;
}

/**
 * Polyfills methods that aren't available in Illustrator.
 */
function polyfill() {
  // https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/filter#Polyfill
  if (!Array.prototype.filter) {
    Array.prototype.filter = function (fun /*, thisArg*/ ) {
      'use strict';

      if (this === void 0 || this === null) {
        throw new TypeError();
      }

      var t = Object(this);
      var len = t.length >>> 0;
      if (typeof fun !== 'function') {
        throw new TypeError();
      }

      var res = [];
      var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
      for (var i = 0; i < len; i++) {
        if (i in t) {
          var val = t[i];

          // NOTE: Technically this should Object.defineProperty at
          //       the next index, as push can be affected by
          //       properties on Object.prototype and Array.prototype.
          //       But that method's new, and collisions should be
          //       rare, so use the more-compatible alternative.
          if (fun.call(thisArg, val, i, t)) {
            res.push(val);
          }
        }
      }

      return res;
    };
  }

  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach#Polyfill
  if (!Array.prototype.forEach) {
    Array.prototype.forEach = function (callback /*, thisArg*/ ) {

      var T, k;

      if (this == null) {
        throw new TypeError('this is null or not defined');
      }

      // 1. Let O be the result of calling toObject() passing the
      // |this| value as the argument.
      var O = Object(this);

      // 2. Let lenValue be the result of calling the Get() internal
      // method of O with the argument "length".
      // 3. Let len be toUint32(lenValue).
      var len = O.length >>> 0;

      // 4. If isCallable(callback) is false, throw a TypeError exception.
      // See: http://es5.github.com/#x9.11
      if (typeof callback !== 'function') {
        throw new TypeError(callback + ' is not a function');
      }

      // 5. If thisArg was supplied, let T be thisArg; else let
      // T be undefined.
      if (arguments.length > 1) {
        T = arguments[1];
      }

      // 6. Let k be 0
      k = 0;

      // 7. Repeat, while k < len
      while (k < len) {

        var kValue;

        // a. Let Pk be ToString(k).
        //    This is implicit for LHS operands of the in operator
        // b. Let kPresent be the result of calling the HasProperty
        //    internal method of O with argument Pk.
        //    This step can be combined with c
        // c. If kPresent is true, then
        if (k in O) {

          // i. Let kValue be the result of calling the Get internal
          // method of O with argument Pk.
          kValue = O[k];

          // ii. Call the Call internal method of callback with T as
          // the this value and argument list containing kValue, k, and O.
          callback.call(T, kValue, k, O);
        }
        // d. Increase k by 1.
        k++;
      }
      // 8. return undefined
    };
  }

  // https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Polyfill
  if (!Array.prototype.indexOf) {
    Array.prototype.indexOf = function (searchElement, fromIndex) {
      var k;

      // 1. Let o be the result of calling ToObject passing
      //    the this value as the argument.
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let lenValue be the result of calling the Get
      //    internal method of o with the argument "length".
      // 3. Let len be ToUint32(lenValue).
      var len = o.length >>> 0;

      // 4. If len is 0, return -1.
      if (len === 0) {
        return -1;
      }

      // 5. If argument fromIndex was passed let n be
      //    ToInteger(fromIndex); else let n be 0.
      var n = fromIndex | 0;

      // 6. If n >= len, return -1.
      if (n >= len) {
        return -1;
      }

      // 7. If n >= 0, then Let k be n.
      // 8. Else, n<0, Let k be len - abs(n).
      //    If k is less than 0, then let k be 0.
      k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

      // 9. Repeat, while k < len
      while (k < len) {
        // a. Let Pk be ToString(k).
        //   This is implicit for LHS operands of the in operator
        // b. Let kPresent be the result of calling the
        //    HasProperty internal method of o with argument Pk.
        //   This step can be combined with c
        // c. If kPresent is true, then
        //    i.  Let elementK be the result of calling the Get
        //        internal method of o with the argument ToString(k).
        //   ii.  Let same be the result of applying the
        //        Strict Equality Comparison Algorithm to
        //        searchElement and elementK.
        //  iii.  If same is true, return k.
        if (k in o && o[k] === searchElement) {
          return k;
        }
        k++;
      }

      return -1;
    };
  }

  // https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/keys#Polyfill
  if (!Object.keys) {
    Object.keys = (function () {
      'use strict';
      var hasOwnProperty = Object.prototype.hasOwnProperty,
        hasDontEnumBug = !({
          toString: null
        }).propertyIsEnumerable('toString'),
        dontEnums = [
          'toString',
          'toLocaleString',
          'valueOf',
          'hasOwnProperty',
          'isPrototypeOf',
          'propertyIsEnumerable',
          'constructor'
        ],
        dontEnumsLength = dontEnums.length;

      return function (obj) {
        if (typeof obj !== 'function' && (typeof obj !== 'object' || obj === null)) {
          throw new TypeError('Object.keys called on non-object');
        }

        var result = [],
          prop, i;

        for (prop in obj) {
          if (hasOwnProperty.call(obj, prop)) {
            result.push(prop);
          }
        }

        if (hasDontEnumBug) {
          for (i = 0; i < dontEnumsLength; i++) {
            if (hasOwnProperty.call(obj, dontEnums[i])) {
              result.push(dontEnums[i]);
            }
          }
        }
        return result;
      };
    }());
  }
}
