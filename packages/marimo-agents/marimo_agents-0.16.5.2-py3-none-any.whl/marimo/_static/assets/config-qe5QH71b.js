var be=Object.defineProperty;var _e=(t,e,r)=>e in t?be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var dt=(t,e,r)=>_e(t,typeof e!="symbol"?e+"":e,r);import{s as mt,t as X}from"./chunk-DZLz74EQ.js";import{i as gt,n as yt,o as S,r as ot}from"./react-7g8sREeT.js";import{E as M,F as Q,L as ve,P as J,V as xe,W as Le,Y as ke,b as I,j as W,w as Y,z as A}from"./zod-BEi78Y5d.js";import{n as Ue}from"./jsx-runtime-DvsdsEjx.js";import{n as at,t as Re}from"./_arrayReduce-BnF2698I.js";import{t as Se}from"./merge-BK4jEs5n.js";import{t as Ae}from"./_baseSlice-Uxm09S3C.js";import{t as wt}from"./_hasUnicode-CGNOqZbu.js";import{o as bt,r as it,t as Ee}from"./Deferred-BaXvZ7xh.js";import{t as B}from"./Logger-BYf_jckC.js";import{c as Oe,n as Ie}from"./hotkeys-B6RmRq9l.js";function je(t,e,r){var a=t.length;return r=r===void 0?a:r,!e&&r>=a?t:Ae(t,e,r)}var Te=je;function $e(t){return t.split("")}var He=$e,_t="\\ud800-\\udfff",Ce="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Be="\\ufe0e\\ufe0f",Pe="["+_t+"]",st="["+Ce+"]",lt="\\ud83c[\\udffb-\\udfff]",ze="(?:"+st+"|"+lt+")",vt="[^"+_t+"]",xt="(?:\\ud83c[\\udde6-\\uddff]){2}",Lt="[\\ud800-\\udbff][\\udc00-\\udfff]",Me="\\u200d",kt=ze+"?",Ut="["+Be+"]?",We="(?:"+Me+"(?:"+[vt,xt,Lt].join("|")+")"+Ut+kt+")*",qe=Ut+kt+We,De="(?:"+[vt+st+"?",st,xt,Lt,Pe].join("|")+")",Fe=RegExp(lt+"(?="+lt+")|"+De+qe,"g");function Ne(t){return t.match(Fe)||[]}var Ze=Ne;function Xe(t){return wt(t)?Ze(t):He(t)}var Ve=Xe;function Ge(t){return function(e){e=at(e);var r=wt(e)?Ve(e):void 0,a=r?r[0]:e.charAt(0),o=r?Te(r,1).join(""):e.slice(1);return a[t]()+o}}var Rt=Ge("toUpperCase");function Je(t){return function(e){return t==null?void 0:t[e]}}var Ye=Je({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),Ke=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qe=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function tr(t){return t=at(t),t&&t.replace(Ke,Ye).replace(Qe,"")}var er=tr,rr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function nr(t){return t.match(rr)||[]}var or=nr,ar=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function ir(t){return ar.test(t)}var sr=ir,St="\\ud800-\\udfff",lr="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",At="\\u2700-\\u27bf",Et="a-z\\xdf-\\xf6\\xf8-\\xff",ur="\\xac\\xb1\\xd7\\xf7",fr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",cr="\\u2000-\\u206f",hr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ot="A-Z\\xc0-\\xd6\\xd8-\\xde",pr="\\ufe0e\\ufe0f",It=ur+fr+cr+hr,jt="['\u2019]",Tt="["+It+"]",dr="["+lr+"]",$t="\\d+",mr="["+At+"]",Ht="["+Et+"]",Ct="[^"+St+It+$t+At+Et+Ot+"]",gr="(?:"+dr+"|\\ud83c[\\udffb-\\udfff])",yr="[^"+St+"]",Bt="(?:\\ud83c[\\udde6-\\uddff]){2}",Pt="[\\ud800-\\udbff][\\udc00-\\udfff]",V="["+Ot+"]",wr="\\u200d",zt="(?:"+Ht+"|"+Ct+")",br="(?:"+V+"|"+Ct+")",Mt="(?:"+jt+"(?:d|ll|m|re|s|t|ve))?",Wt="(?:"+jt+"(?:D|LL|M|RE|S|T|VE))?",qt=gr+"?",Dt="["+pr+"]?",_r="(?:"+wr+"(?:"+[yr,Bt,Pt].join("|")+")"+Dt+qt+")*",vr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",xr="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Lr=Dt+qt+_r,kr="(?:"+[mr,Bt,Pt].join("|")+")"+Lr,Ur=RegExp([V+"?"+Ht+"+"+Mt+"(?="+[Tt,V,"$"].join("|")+")",br+"+"+Wt+"(?="+[Tt,V+zt,"$"].join("|")+")",V+"?"+zt+"+"+Mt,V+"+"+Wt,xr,vr,$t,kr].join("|"),"g");function Rr(t){return t.match(Ur)||[]}var Sr=Rr;function Ar(t,e,r){return t=at(t),e=r?void 0:e,e===void 0?sr(t)?Sr(t):or(t):t.match(e)||[]}var Er=Ar,Or=RegExp("['\u2019]","g");function Ir(t){return function(e){return Re(Er(er(e).replace(Or,"")),t,"")}}var Ft=Ir(function(t,e,r){return t+(r?" ":"")+Rt(e)}),jr={"Content-Type":"application/json"},Tr=/\{[^{}]+\}/g,$r=class extends Request{constructor(t,e){for(let r in super(t,e),e)r in this||(this[r]=e[r])}};function Hr(t){let{baseUrl:e="",fetch:r=globalThis.fetch,querySerializer:a,bodySerializer:o,headers:h,...p}={...t};e.endsWith("/")&&(e=e.substring(0,e.length-1)),h=Vt(jr,h);let b=[];async function E(v,y){let{fetch:T=r,headers:F,params:P={},parseAs:C="json",querySerializer:$,bodySerializer:_=o??Br,...L}=y||{},x=typeof a=="function"?a:Xt(a);$&&(x=typeof $=="function"?$:Xt({...typeof a=="object"?a:{},...$}));let g={redirect:"follow",...p,...L,headers:Vt(h,F,P.header)};g.body&&(g.body=_(g.body)),g.body instanceof FormData&&g.headers.delete("Content-Type");let O=new $r(Pr(v,{baseUrl:e,params:P,querySerializer:x}),g),d={baseUrl:e,fetch:T,parseAs:C,querySerializer:x,bodySerializer:_};for(let m of b)if(m&&typeof m=="object"&&typeof m.onRequest=="function"){O.schemaPath=v,O.params=P;let i=await m.onRequest(O,d);if(i){if(!(i instanceof Request))throw Error("Middleware must return new Request() when modifying the request");O=i}}let l=await T(O);for(let m=b.length-1;m>=0;m--){let i=b[m];if(i&&typeof i=="object"&&typeof i.onResponse=="function"){let u=await i.onResponse(l,d);if(u){if(!(u instanceof Response))throw Error("Middleware must return new Response() when modifying the response");l=u}}}if(l.status===204||l.headers.get("Content-Length")==="0")return l.ok?{data:{},response:l}:{error:{},response:l};if(l.ok)return C==="stream"?{data:l.body,response:l}:{data:await l[C](),response:l};let c=await l.text();try{c=JSON.parse(c)}catch{}return{error:c,response:l}}return{async GET(v,y){return E(v,{...y,method:"GET"})},async PUT(v,y){return E(v,{...y,method:"PUT"})},async POST(v,y){return E(v,{...y,method:"POST"})},async DELETE(v,y){return E(v,{...y,method:"DELETE"})},async OPTIONS(v,y){return E(v,{...y,method:"OPTIONS"})},async HEAD(v,y){return E(v,{...y,method:"HEAD"})},async PATCH(v,y){return E(v,{...y,method:"PATCH"})},async TRACE(v,y){return E(v,{...y,method:"TRACE"})},use(...v){for(let y of v)if(y){if(typeof y!="object"||!("onRequest"in y||"onResponse"in y))throw Error("Middleware must be an object with one of `onRequest()` or `onResponse()`");b.push(y)}},eject(...v){for(let y of v){let T=b.indexOf(y);T!==-1&&b.splice(T,1)}}}}function tt(t,e,r){if(e==null)return"";if(typeof e=="object")throw Error("Deeply-nested arrays/objects aren\u2019t supported. Provide your own `querySerializer()` to handle these.");return`${t}=${(r==null?void 0:r.allowReserved)===!0?e:encodeURIComponent(e)}`}function Nt(t,e,r){if(!e||typeof e!="object")return"";let a=[],o={simple:",",label:".",matrix:";"}[r.style]||"&";if(r.style!=="deepObject"&&r.explode===!1){for(let b in e)a.push(b,r.allowReserved===!0?e[b]:encodeURIComponent(e[b]));let p=a.join(",");switch(r.style){case"form":return`${t}=${p}`;case"label":return`.${p}`;case"matrix":return`;${t}=${p}`;default:return p}}for(let p in e){let b=r.style==="deepObject"?`${t}[${p}]`:p;a.push(tt(b,e[p],r))}let h=a.join(o);return r.style==="label"||r.style==="matrix"?`${o}${h}`:h}function Zt(t,e,r){if(!Array.isArray(e))return"";if(r.explode===!1){let h={form:",",spaceDelimited:"%20",pipeDelimited:"|"}[r.style]||",",p=(r.allowReserved===!0?e:e.map(b=>encodeURIComponent(b))).join(h);switch(r.style){case"simple":return p;case"label":return`.${p}`;case"matrix":return`;${t}=${p}`;default:return`${t}=${p}`}}let a={simple:",",label:".",matrix:";"}[r.style]||"&",o=[];for(let h of e)r.style==="simple"||r.style==="label"?o.push(r.allowReserved===!0?h:encodeURIComponent(h)):o.push(tt(t,h,r));return r.style==="label"||r.style==="matrix"?`${a}${o.join(a)}`:o.join(a)}function Xt(t){return function(e){let r=[];if(e&&typeof e=="object")for(let a in e){let o=e[a];if(o!=null){if(Array.isArray(o)){r.push(Zt(a,o,{style:"form",explode:!0,...t==null?void 0:t.array,allowReserved:(t==null?void 0:t.allowReserved)||!1}));continue}if(typeof o=="object"){r.push(Nt(a,o,{style:"deepObject",explode:!0,...t==null?void 0:t.object,allowReserved:(t==null?void 0:t.allowReserved)||!1}));continue}r.push(tt(a,o,t))}}return r.join("&")}}function Cr(t,e){let r=t;for(let a of t.match(Tr)??[]){let o=a.substring(1,a.length-1),h=!1,p="simple";if(o.endsWith("*")&&(h=!0,o=o.substring(0,o.length-1)),o.startsWith(".")?(p="label",o=o.substring(1)):o.startsWith(";")&&(p="matrix",o=o.substring(1)),!e||e[o]===void 0||e[o]===null)continue;let b=e[o];if(Array.isArray(b)){r=r.replace(a,Zt(o,b,{style:p,explode:h}));continue}if(typeof b=="object"){r=r.replace(a,Nt(o,b,{style:p,explode:h}));continue}if(p==="matrix"){r=r.replace(a,`;${tt(o,b)}`);continue}r=r.replace(a,p==="label"?`.${b}`:b)}return r}function Br(t){return JSON.stringify(t)}function Pr(t,e){var o;let r=`${e.baseUrl}${t}`;(o=e.params)!=null&&o.path&&(r=Cr(r,e.params.path));let a=e.querySerializer(e.params.query??{});return a.startsWith("?")&&(a=a.substring(1)),a&&(r+=`?${a}`),r}function Vt(...t){let e=new Headers;for(let r of t){if(!r||typeof r!="object")continue;let a=r instanceof Headers?r.entries():Object.entries(r);for(let[o,h]of a)if(h===null)e.delete(o);else if(Array.isArray(h))for(let p of h)e.append(o,p);else h!==void 0&&e.set(o,h)}return e}function zr(t){return Hr(t)}const ut={startCase:t=>{if(!t)return"";if(typeof t!="string")throw B.error(t),TypeError(`Expected string, got ${typeof t}`);return/[A-Za-z]/.test(t)?Ft(t):t},htmlEscape:t=>t&&t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;").replaceAll(`
`," "),withTrailingSlash(t){return t.endsWith("/")?t:`${t}/`},withoutTrailingSlash(t){return t.endsWith("/")?t.slice(0,-1):t},withoutLeadingSlash(t){return t.startsWith("/")?t.slice(1):t},asString:t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return String(t)}}};function Gt(){return(window==null?void 0:window.__MARIMO_STATIC__)!==void 0}function Mr(){return bt(window.__MARIMO_STATIC__!==void 0,"Not a static notebook"),window.__MARIMO_STATIC__.files}const Wr={githubPage:"https://github.com/marimo-team/marimo",releasesPage:"https://github.com/marimo-team/marimo/releases",issuesPage:"https://github.com/marimo-team/marimo/issues",feedbackForm:"https://marimo.io/feedback",discordLink:"https://marimo.io/discord?ref=notebook",docsPage:"https://docs.marimo.io",youtube:"https://www.youtube.com/@marimo-team"},N={showCode:"show-code",includeCode:"include-code",sessionId:"session_id",kiosk:"kiosk",vscode:"vscode",filePath:"file",accessToken:"access_token",viewAs:"view-as",showChrome:"show-chrome"};function Jt(){return!1}var qr=X((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.add=x,t.fromBig=a,t.split=o;var e=BigInt(2**32-1),r=BigInt(32);function a(i,u=!1){return u?{h:Number(i&e),l:Number(i>>r&e)}:{h:Number(i>>r&e)|0,l:Number(i&e)|0}}function o(i,u=!1){let s=i.length,w=new Uint32Array(s),R=new Uint32Array(s);for(let H=0;H<s;H++){let{h:q,l:G}=a(i[H],u);[w[H],R[H]]=[q,G]}return[w,R]}var h=(i,u)=>BigInt(i>>>0)<<r|BigInt(u>>>0);t.toBig=h;var p=(i,u,s)=>i>>>s;t.shrSH=p;var b=(i,u,s)=>i<<32-s|u>>>s;t.shrSL=b;var E=(i,u,s)=>i>>>s|u<<32-s;t.rotrSH=E;var v=(i,u,s)=>i<<32-s|u>>>s;t.rotrSL=v;var y=(i,u,s)=>i<<64-s|u>>>s-32;t.rotrBH=y;var T=(i,u,s)=>i>>>s-32|u<<64-s;t.rotrBL=T;var F=(i,u)=>u;t.rotr32H=F;var P=(i,u)=>i;t.rotr32L=P;var C=(i,u,s)=>i<<s|u>>>32-s;t.rotlSH=C;var $=(i,u,s)=>u<<s|i>>>32-s;t.rotlSL=$;var _=(i,u,s)=>u<<s-32|i>>>64-s;t.rotlBH=_;var L=(i,u,s)=>i<<s-32|u>>>64-s;t.rotlBL=L;function x(i,u,s,w){let R=(u>>>0)+(w>>>0);return{h:i+s+(R/2**32|0)|0,l:R|0}}var g=(i,u,s)=>(i>>>0)+(u>>>0)+(s>>>0);t.add3L=g;var O=(i,u,s,w)=>u+s+w+(i/2**32|0)|0;t.add3H=O;var d=(i,u,s,w)=>(i>>>0)+(u>>>0)+(s>>>0)+(w>>>0);t.add4L=d;var l=(i,u,s,w,R)=>u+s+w+R+(i/2**32|0)|0;t.add4H=l;var c=(i,u,s,w,R)=>(i>>>0)+(u>>>0)+(s>>>0)+(w>>>0)+(R>>>0);t.add5L=c;var m=(i,u,s,w,R,H)=>u+s+w+R+H+(i/2**32|0)|0;t.add5H=m,t.default={fromBig:a,split:o,toBig:h,shrSH:p,shrSL:b,rotrSH:E,rotrSL:v,rotrBH:y,rotrBL:T,rotr32H:F,rotr32L:P,rotlSH:C,rotlSL:$,rotlBH:_,rotlBL:L,add:x,add3L:g,add3H:O,add4L:d,add4H:l,add5H:m,add5L:c}})),Dr=X((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0})),Fr=X((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.Hash=t.nextTick=t.swap32IfBE=t.byteSwapIfBE=t.swap8IfBE=t.isLE=void 0,t.isBytes=r,t.anumber=a,t.abytes=o,t.ahash=h,t.aexists=p,t.aoutput=b,t.u8=E,t.u32=v,t.clean=y,t.createView=T,t.rotr=F,t.rotl=P,t.byteSwap=C,t.byteSwap32=$,t.bytesToHex=x,t.hexToBytes=d,t.asyncLoop=l,t.utf8ToBytes=c,t.bytesToUtf8=m,t.toBytes=i,t.kdfInputToBytes=u,t.concatBytes=s,t.checkOpts=w,t.createHasher=R,t.createOptHasher=H,t.createXOFer=q,t.randomBytes=G;var e=Dr();function r(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function a(n){if(!Number.isSafeInteger(n)||n<0)throw Error("positive integer expected, got "+n)}function o(n,...f){if(!r(n))throw Error("Uint8Array expected");if(f.length>0&&!f.includes(n.length))throw Error("Uint8Array expected of length "+f+", got length="+n.length)}function h(n){if(typeof n!="function"||typeof n.create!="function")throw Error("Hash should be wrapped by utils.createHasher");a(n.outputLen),a(n.blockLen)}function p(n,f=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(f&&n.finished)throw Error("Hash#digest() has already been called")}function b(n,f){o(n);let k=f.outputLen;if(n.length<k)throw Error("digestInto() expects output buffer of length at least "+k)}function E(n){return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}function v(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function y(...n){for(let f=0;f<n.length;f++)n[f].fill(0)}function T(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function F(n,f){return n<<32-f|n>>>f}function P(n,f){return n<<f|n>>>32-f>>>0}t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function C(n){return n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255}t.swap8IfBE=t.isLE?n=>n:n=>C(n),t.byteSwapIfBE=t.swap8IfBE;function $(n){for(let f=0;f<n.length;f++)n[f]=C(n[f]);return n}t.swap32IfBE=t.isLE?n=>n:$;var _=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",L=Array.from({length:256},(n,f)=>f.toString(16).padStart(2,"0"));function x(n){if(o(n),_)return n.toHex();let f="";for(let k=0;k<n.length;k++)f+=L[n[k]];return f}var g={_0:48,_9:57,A:65,F:70,a:97,f:102};function O(n){if(n>=g._0&&n<=g._9)return n-g._0;if(n>=g.A&&n<=g.F)return n-(g.A-10);if(n>=g.a&&n<=g.f)return n-(g.a-10)}function d(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);if(_)return Uint8Array.fromHex(n);let f=n.length,k=f/2;if(f%2)throw Error("hex string expected, got unpadded hex of length "+f);let U=new Uint8Array(k);for(let j=0,z=0;j<k;j++,z+=2){let ht=O(n.charCodeAt(z)),pt=O(n.charCodeAt(z+1));if(ht===void 0||pt===void 0){let we=n[z]+n[z+1];throw Error('hex string expected, got non-hex character "'+we+'" at index '+z)}U[j]=ht*16+pt}return U}t.nextTick=async()=>{};async function l(n,f,k){let U=Date.now();for(let j=0;j<n;j++){k(j);let z=Date.now()-U;z>=0&&z<f||(await(0,t.nextTick)(),U+=z)}}function c(n){if(typeof n!="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function m(n){return new TextDecoder().decode(n)}function i(n){return typeof n=="string"&&(n=c(n)),o(n),n}function u(n){return typeof n=="string"&&(n=c(n)),o(n),n}function s(...n){let f=0;for(let U=0;U<n.length;U++){let j=n[U];o(j),f+=j.length}let k=new Uint8Array(f);for(let U=0,j=0;U<n.length;U++){let z=n[U];k.set(z,j),j+=z.length}return k}function w(n,f){if(f!==void 0&&{}.toString.call(f)!=="[object Object]")throw Error("options should be object or undefined");return Object.assign(n,f)}t.Hash=class{};function R(n){let f=U=>n().update(i(U)).digest(),k=n();return f.outputLen=k.outputLen,f.blockLen=k.blockLen,f.create=()=>n(),f}function H(n){let f=(U,j)=>n(j).update(i(U)).digest(),k=n({});return f.outputLen=k.outputLen,f.blockLen=k.blockLen,f.create=U=>n(U),f}function q(n){let f=(U,j)=>n(j).update(i(U)).digest(),k=n({});return f.outputLen=k.outputLen,f.blockLen=k.blockLen,f.create=U=>n(U),f}t.wrapConstructor=R,t.wrapConstructorWithOpts=H,t.wrapXOFConstructorWithOpts=q;function G(n=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(n));if(e.crypto&&typeof e.crypto.randomBytes=="function")return Uint8Array.from(e.crypto.randomBytes(n));throw Error("crypto.getRandomValues must be defined")}})),Nr=X((t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.keccakP=L;var e=qr(),r=Fr(),a=BigInt(0),o=BigInt(1),h=BigInt(2),p=BigInt(7),b=BigInt(256),E=BigInt(113),v=[],y=[],T=[];for(let d=0,l=o,c=1,m=0;d<24;d++){[c,m]=[m,(2*c+3*m)%5],v.push(2*(5*m+c)),y.push((d+1)*(d+2)/2%64);let i=a;for(let u=0;u<7;u++)l=(l<<o^(l>>p)*E)%b,l&h&&(i^=o<<(o<<BigInt(u))-o);T.push(i)}var F=(0,e.split)(T,!0),P=F[0],C=F[1],$=(d,l,c)=>c>32?(0,e.rotlBH)(d,l,c):(0,e.rotlSH)(d,l,c),_=(d,l,c)=>c>32?(0,e.rotlBL)(d,l,c):(0,e.rotlSL)(d,l,c);function L(d,l=24){let c=new Uint32Array(10);for(let m=24-l;m<24;m++){for(let s=0;s<10;s++)c[s]=d[s]^d[s+10]^d[s+20]^d[s+30]^d[s+40];for(let s=0;s<10;s+=2){let w=(s+8)%10,R=(s+2)%10,H=c[R],q=c[R+1],G=$(H,q,1)^c[w],n=_(H,q,1)^c[w+1];for(let f=0;f<50;f+=10)d[s+f]^=G,d[s+f+1]^=n}let i=d[2],u=d[3];for(let s=0;s<24;s++){let w=y[s],R=$(i,u,w),H=_(i,u,w),q=v[s];i=d[q],u=d[q+1],d[q]=R,d[q+1]=H}for(let s=0;s<50;s+=10){for(let w=0;w<10;w++)c[w]=d[s+w];for(let w=0;w<10;w++)d[s+w]^=~c[(w+2)%10]&c[(w+4)%10]}d[0]^=P[m],d[1]^=C[m]}(0,r.clean)(c)}var x=class ye extends r.Hash{constructor(l,c,m,i=!1,u=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=l,this.suffix=c,this.outputLen=m,this.enableXOF=i,this.rounds=u,(0,r.anumber)(m),!(0<l&&l<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,r.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,r.swap32IfBE)(this.state32),L(this.state32,this.rounds),(0,r.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(l){(0,r.aexists)(this),l=(0,r.toBytes)(l),(0,r.abytes)(l);let{blockLen:c,state:m}=this,i=l.length;for(let u=0;u<i;){let s=Math.min(c-this.pos,i-u);for(let w=0;w<s;w++)m[this.pos++]^=l[u++];this.pos===c&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:l,suffix:c,pos:m,blockLen:i}=this;l[m]^=c,c&128&&m===i-1&&this.keccak(),l[i-1]^=128,this.keccak()}writeInto(l){(0,r.aexists)(this,!1),(0,r.abytes)(l),this.finish();let c=this.state,{blockLen:m}=this;for(let i=0,u=l.length;i<u;){this.posOut>=m&&this.keccak();let s=Math.min(m-this.posOut,u-i);l.set(c.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return l}xofInto(l){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(l)}xof(l){return(0,r.anumber)(l),this.xofInto(new Uint8Array(l))}digestInto(l){if((0,r.aoutput)(l,this),this.finished)throw Error("digest() was already called");return this.writeInto(l),this.destroy(),l}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,r.clean)(this.state)}_cloneInto(l){let{blockLen:c,suffix:m,outputLen:i,rounds:u,enableXOF:s}=this;return l||(l=new ye(c,m,i,s,u)),l.state32.set(this.state32),l.pos=this.pos,l.posOut=this.posOut,l.finished=this.finished,l.rounds=u,l.suffix=m,l.outputLen=i,l.enableXOF=s,l.destroyed=this.destroyed,l}};t.Keccak=x;var g=(d,l,c)=>(0,r.createHasher)(()=>new x(l,d,c));t.sha3_224=g(6,144,224/8),t.sha3_256=g(6,136,256/8),t.sha3_384=g(6,104,384/8),t.sha3_512=g(6,72,512/8),t.keccak_224=g(1,144,224/8),t.keccak_256=g(1,136,256/8),t.keccak_384=g(1,104,384/8),t.keccak_512=g(1,72,512/8);var O=(d,l,c)=>(0,r.createXOFer)((m={})=>new x(l,d,m.dkLen===void 0?c:m.dkLen,!0));t.shake128=O(31,168,128/8),t.shake256=O(31,136,256/8)})),Zr=X(((t,e)=>{var{sha3_512:r}=Nr(),a=24,o=32,h=(_=4,L=Math.random)=>{let x="";for(;x.length<_;)x+=Math.floor(L()*36).toString(36);return x};function p(_){let L=0n;for(let x of _.values()){let g=BigInt(x);L=(L<<8n)+g}return L}var b=(_="")=>p(r(_)).toString(36).slice(1),E=Array.from({length:26},(_,L)=>String.fromCharCode(L+97)),v=_=>E[Math.floor(_()*E.length)],y=({globalObj:_=typeof global<"u"?global:typeof window<"u"?window:{},random:L=Math.random}={})=>{let x=Object.keys(_).toString(),g=x.length?x+h(o,L):h(o,L);return b(g).substring(0,o)},T=_=>()=>_++,F=476782367,P=({random:_=Math.random,counter:L=T(Math.floor(_()*F)),length:x=a,fingerprint:g=y({random:_})}={})=>function(){let O=v(_),d=Date.now().toString(36),l=L().toString(36),c=h(x,_),m=`${d+c+l+g}`;return`${O+b(m).substring(1,x)}`},C=P(),$=(_,{minLength:L=2,maxLength:x=o}={})=>{let g=_.length,O=/^[0-9a-z]+$/;try{if(typeof _=="string"&&g>=L&&g<=x&&O.test(_))return!0}finally{}return!1};e.exports.getConstants=()=>({defaultLength:a,bigLength:o}),e.exports.init=P,e.exports.createId=C,e.exports.bufToBigInt=p,e.exports.createCounter=T,e.exports.createFingerprint=y,e.exports.isCuid=$})),Yt=X(((t,e)=>{var{createId:r,init:a,getConstants:o,isCuid:h}=Zr();e.exports.createId=r,e.exports.init=a,e.exports.getConstants=o,e.exports.isCuid=h}));function Kt(t){return new URL(t,document.baseURI)}function Qt(t){let e=new URL(window.location.href);t(e.searchParams),window.history.replaceState({},"",e.toString())}function Xr(t,e){if(typeof window>"u")return!1;let r=new URLSearchParams(window.location.search);return e===void 0?r.has(t):r.get(t)===e}function Vr(){let t=`__new__${te()}`;return Kt(`?file=${t}`).toString()}var Gr=/^(https?:\/\/\S+)$/;function Jr(t){return typeof t=="string"&&Gr.test(t)}var Yr=(0,mt(Yt()).init)({length:6});function te(){return`s_${Yr()}`}function ee(t){return t?/^s_[\da-z]{6}$/.test(t):!1}var Kr=(()=>{let t=new URL(window.location.href).searchParams.get(N.sessionId);return ee(t)?(Qt(e=>{e.has(N.kiosk)||e.delete(N.sessionId)}),B.debug("Connecting to existing session",{sessionId:t}),t):(B.debug("Starting a new session",{sessionId:t}),te())})();function re(){return Kr}function ne(){return typeof document<"u"&&document.querySelector("marimo-wasm")!==null}var Qr=class{constructor(t,e=!1){dt(this,"initialHealthyCheck",new Ee);this.config=t,this.lazy=e;try{new URL(this.config.url)}catch(r){throw Error(`Invalid runtime URL: ${this.config.url}. ${r instanceof Error?r.message:"Unknown error"}`)}this.lazy||this.init()}get httpURL(){return new URL(this.config.url)}get isSameOrigin(){return this.httpURL.origin===window.location.origin}formatHttpURL(t,e,r=!0){t||(t="");let a=this.httpURL,o=new URLSearchParams(window.location.search);if(e)for(let[h,p]of e.entries())a.searchParams.set(h,p);for(let[h,p]of o.entries())r&&!Object.values(N).includes(h)||a.searchParams.set(h,p);return a.pathname=`${a.pathname.replace(/\/$/,"")}/${t.replace(/^\//,"")}`,a.hash="",a}formatWsURL(t,e){let r=this.formatHttpURL(t,e,!1);return tn(r.toString())}getWsURL(t){let e=new URL(this.config.url),r=new URLSearchParams(e.search);return new URLSearchParams(window.location.search).forEach((a,o)=>{r.has(o)||r.set(o,a)}),r.set(N.sessionId,t),this.formatWsURL("/ws",r)}getWsSyncURL(t){let e=new URL(this.config.url),r=new URLSearchParams(e.search);return new URLSearchParams(window.location.search).forEach((a,o)=>{r.has(o)||r.set(o,a)}),r.set(N.sessionId,t),this.formatWsURL("/ws_sync",r)}getTerminalWsURL(){return this.formatWsURL("/terminal/ws")}getLSPURL(t){if(t==="copilot"){let e=this.formatWsURL(`/lsp/${t}`);return e.search="",e}return this.formatWsURL(`/lsp/${t}`)}getAiURL(t){return this.formatHttpURL(`/api/ai/${t}`)}healthURL(){return this.formatHttpURL("/health")}async isHealthy(){if(ne()||Jt())return!0;try{let t=await fetch(this.healthURL().toString());if(t.redirected){let r=t.url.replace(/\/health$/,"");this.config.url=r}let e=t.ok;return e&&this.setDOMBaseUri(this.config.url),e}catch{return!1}}setDOMBaseUri(t){t=t.split("?",1)[0],t.endsWith("/")||(t+="/");let e=document.querySelector("base");e?e.setAttribute("href",t):(e=document.createElement("base"),e.setAttribute("href",t),document.head.append(e))}async init(t){let e=0;for(;!await this.isHealthy();){if(e>=25){B.error("Failed to connect after 25 retries"),this.initialHealthyCheck.reject(Error("Failed to connect after 25 retries"));return}if(!(t!=null&&t.disableRetryDelay)){let r=Math.min(100*1.2**e,2e3);await new Promise(a=>setTimeout(a,r))}e++}this.initialHealthyCheck.resolve()}async waitForHealthy(){return this.initialHealthyCheck.promise}headers(){let t={"Marimo-Session-Id":re(),"Marimo-Server-Token":this.config.serverToken??"","x-runtime-url":this.httpURL.toString()};return this.config.authToken&&(t.Authorization=`Bearer ${this.config.authToken}`),t}};function tn(t){if(!t.startsWith("http")){B.warn(`URL must start with http: ${t}`);let e=new URL(t);return e.protocol="ws",e}return new URL(t.replace(/^http/,"ws"))}function en(){let t=new URL(document.baseURI);return t.search="",t.hash="",t.toString()}const oe={url:en()},ae=S(oe);var ie=S(t=>{let e=t(ae),r=Gt();return new Qr(e,r)});function rn(){return ot(ie)}function et(){return it.get(ie)}function nn(t){if(t.startsWith("http"))return new URL(t);let e=et().httpURL.toString();return e.startsWith("blob:")&&(e=e.replace("blob:","")),new URL(t,e)}function se(){let t=et().httpURL;return t.search="",t.hash="",t.toString()}const rt={post(t,e,r={}){let a=`${ut.withTrailingSlash(r.baseUrl??se())}api${t}`;return fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...rt.headers(),...r.headers},body:JSON.stringify(e),signal:r.signal}).then(async o=>{var p;let h=(p=o.headers.get("Content-Type"))==null?void 0:p.startsWith("application/json");if(!o.ok){let b=h?await o.json():await o.text();throw Error(o.statusText,{cause:b})}return h?o.json():o.text()}).catch(o=>{throw B.error(`Error requesting ${a}`,o),o})},get(t,e={}){let r=`${ut.withTrailingSlash(e.baseUrl??se())}api${t}`;return fetch(r,{method:"GET",headers:{...rt.headers(),...e.headers}}).then(a=>{var o;if(!a.ok)throw Error(a.statusText);return(o=a.headers.get("Content-Type"))!=null&&o.startsWith("application/json")?a.json():null}).catch(a=>{throw B.error(`Error requesting ${r}`,a),a})},headers(){return et().headers()},handleResponse:t=>t.error?Promise.reject(t.error):Promise.resolve(t.data),handleResponseReturnNull:t=>t.error?Promise.reject(t.error):Promise.resolve(null)};function on(t){let e=zr({baseUrl:t.httpURL.toString()});return e.use({onRequest:r=>{let a=t.headers();for(let[o,h]of Object.entries(a))r.headers.set(o,h);return r}}),e}const le=["pip","uv","rye","poetry","pixi"];var ue=["normal","compact","medium","full","columns"],fe=["auto","native","polars","lazy-polars","pandas"];const an="openai/gpt-4o";var ce=["html","markdown","ipynb"],Z=Q({api_key:A().optional(),base_url:A().optional()}).loose(),sn=Q({chat_model:A().nullish(),edit_model:A().nullish(),autocomplete_model:A().nullish(),displayed_models:Y(A()).default([]),custom_models:Y(A()).default([])});const ft=W({completion:Q({activate_on_typing:M().prefault(!0),copilot:xe([M(),I(["github","codeium","custom"])]).prefault(!1).transform(t=>t===!0?"github":t),codeium_api_key:A().nullish()}).prefault({}),save:W({autosave:I(["off","after_delay"]).prefault("after_delay"),autosave_delay:J().nonnegative().transform(t=>Math.max(t,1e3)).prefault(1e3),format_on_save:M().prefault(!1)}).prefault({}),formatting:W({line_length:J().nonnegative().prefault(79).transform(t=>Math.min(t,1e3))}).prefault({}),keymap:W({preset:I(["default","vim"]).prefault("default"),overrides:ve(A(),A()).prefault({}),destructive_delete:M().prefault(!0)}).prefault({}),runtime:W({auto_instantiate:M().prefault(!0),on_cell_change:I(["lazy","autorun"]).prefault("autorun"),auto_reload:I(["off","lazy","autorun"]).prefault("off"),watcher_on_save:I(["lazy","autorun"]).prefault("lazy"),default_sql_output:I(fe).prefault("auto"),default_auto_download:Y(I(ce)).prefault([])}).prefault({}),display:W({theme:I(["light","dark","system"]).prefault("light"),code_editor_font_size:J().nonnegative().prefault(14),cell_output:I(["above","below"]).prefault("above"),dataframes:I(["rich","plain"]).prefault("rich"),default_table_page_size:J().prefault(10),default_table_max_columns:J().prefault(50),default_width:I(ue).prefault("medium").transform(t=>t==="normal"?"compact":t),locale:A().nullable().optional(),reference_highlighting:M().prefault(!1)}).prefault({}),package_management:W({manager:I(le).prefault("pip")}).prefault({}),ai:W({rules:A().prefault(""),mode:I(["manual","ask"]).prefault("manual"),inline_tooltip:M().prefault(!1),open_ai:Z.optional(),anthropic:Z.optional(),google:Z.optional(),ollama:Z.optional(),openrouter:Z.optional(),open_ai_compatible:Z.optional(),azure:Z.optional(),bedrock:W({region_name:A().optional(),profile_name:A().optional(),aws_access_key_id:A().optional(),aws_secret_access_key:A().optional()}).optional(),models:sn.prefault({displayed_models:[],custom_models:[]})}).prefault({}),experimental:W({markdown:M().optional(),rtc:M().optional()}).prefault(()=>({})),server:W({disable_home_page:M().optional(),disable_terminal:M().optional()}).prefault(()=>({})),sharing:W({html:M().optional(),wasm:M().optional()}).optional(),mcp:W({presets:Y(I(["marimo","context7"])).optional()}).optional().prefault({})}).partial().prefault(()=>({completion:{},save:{},formatting:{},keymap:{},runtime:{},display:{},experimental:{},server:{},ai:{},package_management:{},mcp:{}})),he=A(),ln=I(fe).prefault("auto"),ct=Q({width:I(ue).prefault("medium").transform(t=>t==="normal"?"compact":t),app_title:he.nullish(),css_file:A().nullish(),html_head_file:A().nullish(),auto_download:Y(I(ce)).prefault([]),sql_output:ln}).prefault(()=>({width:"medium",auto_download:[],sql_output:"auto"}));function pe(t){try{return ct.parse(t)}catch(e){return B.error(`Marimo got an unexpected value in the configuration file: ${e}`),ct.parse({})}}function un(t){try{let e=ft.parse(t);for(let[r,a]of Object.entries(e.experimental??{}))a===!0&&B.log(`\u{1F9EA} Experimental feature "${r}" is enabled.`);return e}catch(e){return e instanceof Le?B.error(`Marimo got an unexpected value in the configuration file: ${ke(e)}`):B.error(`Marimo got an unexpected value in the configuration file: ${e}`),de()}}function fn(t){try{let e=t;return bt(typeof e=="object","internal-error: marimo-config-overrides is not an object"),Object.keys(e).length>0&&B.log("\u{1F527} Project configuration overrides:",e),e}catch(e){return B.error(`Marimo got an unexpected configuration overrides: ${e}`),{}}}function de(){return ft.parse({completion:{},save:{},formatting:{},keymap:{},runtime:{},display:{},experimental:{},server:{},ai:{},package_management:{},mcp:{}})}var cn=mt(Ue());const nt=S(de()),me=S({}),D=S(t=>{let e=t(me),r=t(nt);return Se({},r,e)}),hn=S(t=>t(D).runtime.auto_instantiate),pn=S(t=>t(D).keymap.overrides??{}),dn=S(Oe()),mn=S(t=>{let e=t(pn),r=t(dn);return new Ie(e,{platform:r})}),gn=S(t=>t(D).save),yn=S(t=>t(D).ai),wn=S(async()=>{try{let t=await rt.get("/kernel/server_config");return{disable_home_page:(t==null?void 0:t.disable_home_page)??!1,disable_terminal:(t==null?void 0:t.disable_terminal)??!1,disable_package_installation:(t==null?void 0:t.disable_package_installation)??!1,disabled_panels:(t==null?void 0:t.disabled_panels)??[],browser:"default",follow_symlink:!1}}catch(t){return B.warn("Failed to fetch server config:",t),{disable_home_page:!1,disable_terminal:!1,disable_package_installation:!1,disabled_panels:[],browser:"default",follow_symlink:!1}}}),bn=S(t=>t(D).completion),_n=S(t=>t(D).keymap.preset);function vn(){return yt(nt)}function xn(){let t=(0,cn.c)(3),e=ot(D),r=gt(nt),a;return t[0]!==e||t[1]!==r?(a=[e,r],t[0]=e,t[1]=r,t[2]=a):a=t[2],a}function Ln(){return it.get(D)}function kn(){return ot(wn)}const Un=S(t=>ge(t(D)));S(t=>t(D).display.code_editor_font_size);const Rn=S(t=>t(D).display.locale);function ge(t){var e,r,a,o,h,p;return!!((r=(e=t.ai)==null?void 0:e.models)!=null&&r.chat_model)||!!((o=(a=t.ai)==null?void 0:a.models)!=null&&o.edit_model)||!!((p=(h=t.ai)==null?void 0:h.models)!=null&&p.autocomplete_model)}const K=S(pe({}));function Sn(){return yt(K)}function An(){return gt(K)}function En(){return it.get(K)}const On=S(t=>t(K).width);export{Rt as $,rt as A,Xr as B,he as C,pe as D,ft as E,ae as F,Yt as G,Vr as H,rn as I,N as J,Jt as K,ne as L,oe as M,nn as N,fn as O,et as P,Ft as Q,re as R,ct as S,le as T,Qt as U,Jr as V,Kt as W,Gt as X,Mr as Y,ut as Z,xn as _,hn as a,vn as b,me as c,mn as d,ge as f,Sn as g,D as h,On as i,on as j,un as k,En as l,Rn as m,Un as n,gn as o,_n as p,Wr as q,K as r,bn as s,yn as t,Ln as u,kn as v,an as w,nt as x,An as y,ee as z};
