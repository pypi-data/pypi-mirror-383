const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./esm-Bf1yW8h_.js","./precisionRound-Cje8lX3w.js","./defaultLocale-TeaKXDgq.js","./linear-B6iGsbsp.js","./timer-BQp7kwGJ.js","./chunk-DZLz74EQ.js","./init-o6-p_brG.js","./src-HDGn0xeG.js","./time-DeNr8Rf0.js","./defaultLocale-BR1BPE-P.js","./range-zj4gCPVR.js","./vega-loader.browser.module-Bhk0bKod.js","./treemap-CupNXDhc.js","./path-DinqECSb.js","./colors-ByNWjp1O.js","./ordinal-WQ-aX1ha.js","./arc-C21mLlLg.js","./math-CJPGrKXj.js","./array-RG72wiOX.js","./step-CU2Y1mmF.js","./line-C7-cGBTD.js","./fast-deep-equal-DYEF_O4u.js","./esm-B5nQEEh4.js","./prop-types-Cxxd3-eB.js","./react-BcIddLXZ.js","./tslib.es6-DAgqUqkS.js"])))=>i.map(i=>d[i]);
import{s as E}from"./chunk-DZLz74EQ.js";import{i as Q,o as Z,r as D}from"./react-7g8sREeT.js";import{t as ee}from"./react-BcIddLXZ.js";import{W as H,j as te,__tla as re}from"./cells-Cu8VFzqb.js";import"./react-dom-D6bRRS5R.js";import"./zod-BEi78Y5d.js";import{n as ie,t as se}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-CPNtPV0k.js";import"./_baseIsEqual-Colb33IN.js";import"./_arrayReduce-BnF2698I.js";import"./toNumber-D8Yr4jg3.js";import"./toInteger-HqbAY1oN.js";import"./isArrayLikeObject-VZQcF0wU.js";import"./_getTag-DAtegGfi.js";import"./merge-BK4jEs5n.js";import"./_baseSlice-Uxm09S3C.js";import"./config-qe5QH71b.js";import"./_hasUnicode-CGNOqZbu.js";import"./_baseProperty-DbWSe5Dg.js";import"./now-r4Qe1IPI.js";import"./debounce-DI2W_mLY.js";import"./Deferred-BaXvZ7xh.js";import"./Logger-BYf_jckC.js";import"./hotkeys-B6RmRq9l.js";import"./dist-MGl6rJvQ.js";import{t as le}from"./cn-BXZDj0q7.js";import"./dist-CjbXXQXG.js";import"./useEventListener-C9Ldphl0.js";import"./events-DeIoPUd7.js";import"./button-CtXpvmEK.js";import"./dist--Nd6X-oZ.js";import"./dist-BEN0CeKa.js";import"./once-CcEB5YYF.js";import"./documentation-CMlrFSRf.js";import"./createReducer-BYK7466H.js";import"./key-Bbtykojp.js";import{t as ae}from"./preload-helper-VwE_myu3.js";import"./dist-DhHwnpP4.js";import"./dist-DbZtNFqr.js";import"./dist-h7riDns7.js";import"./dist-2yVzxPX_.js";import"./dist-D3mqw5EG.js";import"./dist-DucN38iS.js";import"./stex-yqX35Zwf.js";import"./uuid-BGl6uOso.js";import"./use-toast-DkqvBA-s.js";import"./main-Bhvb2Udf.js";import"./marked.esm-5H8spd6k.js";import"./connection-EQhJerFr.js";import"./dist-Bv1qgN6C.js";import{r as oe}from"./useTheme-Dr_rjc9V.js";import{t as ne}from"./createLucideIcon-D2ExLlYe.js";import{t as me}from"./activity-DzHOnfji.js";import{i as pe,n as ce,r as O}from"./CellStatus-C5ey1pLa.js";import"./type-I5fspO4n.js";import"./check-DdKonHHo.js";import{_ as de}from"./select-BdzgTzLI.js";import{t as ue}from"./chevron-right-CVxEz2FM.js";import{t as he}from"./circle-play-BYYeRvQk.js";import"./toDate-C2WSQeY2.js";import{t as xe}from"./circle-x-CmH9EBUz.js";import"./ellipsis-BtL09jyh.js";import"./refresh-cw-BFu7py5Y.js";import"./input-DYl9pNu1.js";import"./workflow-B9umNRPA.js";import"./useNonce-BUl5Llhg.js";import"./badge-nqYSoYtT.js";import"./namespace-2k7Gzn5q.js";import{t as q}from"./tooltip-Cm87HNT4.js";import"./useLifecycle-j98D-0aE.js";import"./menu-items-DPQQViy7.js";import"./fullscreen-BhmcNC-V.js";import"./tslib.es6-DAgqUqkS.js";import"./en-US-_jwQtbkE.js";import"./alert-dialog-DIUeqg2n.js";import"./dialog-C4GYD4Bo.js";import"./useNumberFormatter-CUi4J2hW.js";import"./useDateFormatter-BrD1D_DL.js";import"./useEvent-B3kxZodb.js";import"./useDebounce-gJnKHNBL.js";import"./ImperativeModal-C6f_jDAq.js";import"./vega-loader.browser.module-Bhk0bKod.js";import"./precisionRound-Cje8lX3w.js";import"./linear-B6iGsbsp.js";import{n as fe}from"./src-HDGn0xeG.js";import"./ordinal-WQ-aX1ha.js";import"./time-DeNr8Rf0.js";import"./range-zj4gCPVR.js";import"./defaultLocale-TeaKXDgq.js";import"./defaultLocale-BR1BPE-P.js";import"./filename-Dae00hVY.js";import{t as ge}from"./cell-link-D_wBCMcx.js";import{t as ve}from"./bundle.esm-BV5PVDFy.js";import{t as je}from"./empty-state-DqtHvbL-.js";import"./timer-BQp7kwGJ.js";import"./multi-icon-CPZEFzy5.js";import{t as ye}from"./clear-button-CIlTH3jW.js";import{n as Ie,t as Se}from"./runs-BDDrOdWx.js";import"./path-DinqECSb.js";import"./math-CJPGrKXj.js";import"./arc-C21mLlLg.js";import"./array-RG72wiOX.js";import"./step-CU2Y1mmF.js";import"./line-C7-cGBTD.js";import"./init-o6-p_brG.js";import"./colors-ByNWjp1O.js";import"./treemap-CupNXDhc.js";let F,w,be=Promise.all([(()=>{try{return re}catch{}})()]).then(async()=>{var V=ne("circle-ellipsis",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]),T=E(ie()),_=E(ee());const M="hoveredCellId",$="cellHover";var U="cellNum",P="cell",R="startTimestamp",C="endTimestamp",L="status";function A(t,e,r,o){let s="hoursminutessecondsmilliseconds";return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",background:o==="dark"?"black":void 0,mark:{type:"bar",cornerRadius:2},params:[{name:M,bind:{element:`#${e}`}},{name:$,select:{type:"point",on:"mouseover",fields:[P],clear:"mouseout"}}],height:{step:r==="sideBySide"?26:21},encoding:{y:{field:U,scale:{paddingInner:.2},sort:{field:"sortPriority"},title:"cell",axis:r==="sideBySide"?null:void 0},x:{field:R,type:"temporal",axis:{orient:"top",title:null}},x2:{field:C,type:"temporal"},tooltip:[{field:R,type:"temporal",timeUnit:s,title:"Start"},{field:C,type:"temporal",timeUnit:s,title:"End"}],size:{value:{expr:`${M} == toString(datum.${P}) ? 19.5 : 18`}},color:{field:L,scale:{domain:["success","error"],range:["#37BE5F","red"]},legend:null}},data:{values:t},transform:[{calculate:`datum.${L} === 'queued' ? 9999999999999 : datum.${R}`,as:"sortPriority"}],config:{view:{stroke:"transparent"}}}}var i=E(se()),z=Z(new Map);F=()=>{let t=(0,T.c)(28),{runIds:e,runMap:r}=D(Se),o=D(z),{clearRuns:s}=Ie(),{theme:a}=oe(),[l,u]=(0,_.useState)("above"),n;t[0]===l?n=t[1]:(n=()=>{u(l==="above"?"sideBySide":"above")},t[0]=l,t[1]=n);let x=n;if(e.length===0){let h;return t[2]===Symbol.for("react.memo_cache_sentinel")?(h=(0,i.jsx)(je,{title:"No traces",description:(0,i.jsx)("span",{children:"Cells that have ran will appear here."}),icon:(0,i.jsx)(me,{})}),t[2]=h):h=t[2],h}let d;t[3]===Symbol.for("react.memo_cache_sentinel")?(d=(0,i.jsx)("label",{htmlFor:"chartPosition",className:"text-xs",children:"Inline chart"}),t[3]=d):d=t[3];let p=l==="sideBySide",f;t[4]!==p||t[5]!==x?(f=(0,i.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[d,(0,i.jsx)("input",{type:"checkbox",name:"chartPosition","data-testid":"chartPosition",onClick:x,defaultChecked:p,className:"h-3 cursor-pointer"})]}),t[4]=p,t[5]=x,t[6]=f):f=t[6];let c;t[7]===s?c=t[8]:(c=(0,i.jsx)(ye,{dataTestId:"clear-traces-button",onClick:s}),t[7]=s,t[8]=c);let j;t[9]!==f||t[10]!==c?(j=(0,i.jsxs)("div",{className:"flex flex-row justify-end gap-3",children:[f,c]}),t[9]=f,t[10]=c,t[11]=j):j=t[11];let g;if(t[12]!==l||t[13]!==o||t[14]!==e||t[15]!==r||t[16]!==a){let h;t[18]!==l||t[19]!==o||t[20]!==r||t[21]!==a?(h=(I,m)=>{let S=r.get(I);if(S)return(0,i.jsx)(Y,{run:S,isExpanded:o.get(S.runId),isMostRecentRun:m===0,chartPosition:l,theme:a},S.runId)},t[18]=l,t[19]=o,t[20]=r,t[21]=a,t[22]=h):h=t[22],g=e.map(h),t[12]=l,t[13]=o,t[14]=e,t[15]=r,t[16]=a,t[17]=g}else g=t[17];let v;t[23]===g?v=t[24]:(v=(0,i.jsx)("div",{className:"flex flex-col gap-3",children:g}),t[23]=g,t[24]=v);let y;return t[25]!==j||t[26]!==v?(y=(0,i.jsxs)("div",{className:"py-1 px-2 overflow-y-scroll",children:[j,v]}),t[25]=j,t[26]=v,t[27]=y):y=t[27],y};var W=_.lazy(()=>ae(()=>import("./esm-Bf1yW8h_.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]),import.meta.url).then(t=>({default:t.Vega}))),B=t=>{let e=(0,T.c)(10),{ref:r,width:o}=ve(),s=o===void 0?300:o,a=t.theme==="dark"?"dark":void 0,l=s-50,u;e[0]!==t.height||e[1]!==t.signalListeners||e[2]!==t.vegaSpec||e[3]!==a||e[4]!==l?(u=(0,i.jsx)(_.Suspense,{children:(0,i.jsx)(W,{spec:t.vegaSpec,theme:a,width:l,height:t.height,signalListeners:t.signalListeners,actions:!1})}),e[0]=t.height,e[1]=t.signalListeners,e[2]=t.vegaSpec,e[3]=a,e[4]=l,e[5]=u):u=e[5];let n;return e[6]!==t.className||e[7]!==r||e[8]!==u?(n=(0,i.jsx)("div",{className:t.className,ref:r,children:u}),e[6]=t.className,e[7]=r,e[8]=u,e[9]=n):n=e[9],n},Y=({run:t,isMostRecentRun:e,chartPosition:r,isExpanded:o,theme:s})=>{let a=Q(z);o??(o=e);let l=()=>{a(x=>{let d=new Map(x);return d.set(t.runId,!o),d})},u=(0,i.jsx)(o?de:ue,{height:16,className:"inline"}),n=(0,i.jsxs)("span",{className:"text-sm cursor-pointer",onClick:l,children:["Run - ",H(t.runStartTime),u]});return o?(0,i.jsx)(G,{run:t,chartPosition:r,theme:s,title:n},t.runId):(0,i.jsx)("div",{className:"flex flex-col",children:(0,i.jsx)("pre",{className:"font-mono font-semibold",children:n})},t.runId)},G=t=>{let e=(0,T.c)(32),{run:r,chartPosition:o,theme:s,title:a}=t,[l,u]=(0,_.useState)(),n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={[$]:(I,m)=>{var b;let S=(b=m.cell)==null?void 0:b[0];u(S??null)}},e[0]=n):n=e[0];let x=n,d=te(),p,f;if(e[1]!==d||e[2]!==o||e[3]!==r.cellRuns||e[4]!==r.runId||e[5]!==s){let I=[...r.cellRuns.values()].map(m=>{let S=m.elapsedTime??0;return{cell:m.cellId,cellNum:d.inOrderIds.indexOf(m.cellId),startTimestamp:w(m.startTime),endTimestamp:w(m.startTime+S),elapsedTime:O(S*1e3),status:m.status}});p=`hiddenInputElement-${r.runId}`,f=fe(A(I,p,o,s)),e[1]=d,e[2]=o,e[3]=r.cellRuns,e[4]=r.runId,e[5]=s,e[6]=p,e[7]=f}else p=e[6],f=e[7];let c=f.spec,j;e[8]!==p||e[9]!==l||e[10]!==r?(j=(0,i.jsx)(J,{run:r,hoveredCellId:l,hiddenInputElementId:p}),e[8]=p,e[9]=l,e[10]=r,e[11]=j):j=e[11];let g=j;if(o==="above"){let I;e[12]!==s||e[13]!==c?(I=(0,i.jsx)(B,{vegaSpec:c,height:120,signalListeners:x,theme:s}),e[12]=s,e[13]=c,e[14]=I):I=e[14];let m;e[15]!==I||e[16]!==a||e[17]!==g?(m=(0,i.jsxs)("pre",{className:"font-mono font-semibold",children:[a,I,g]}),e[15]=I,e[16]=a,e[17]=g,e[18]=m):m=e[18];let S;return e[19]!==r.runId||e[20]!==m?(S=(0,i.jsx)("div",{className:"flex flex-col",children:m},r.runId),e[19]=r.runId,e[20]=m,e[21]=S):S=e[21],S}let v;e[22]!==a||e[23]!==g?(v=(0,i.jsxs)("pre",{className:"font-mono font-semibold",children:[a,g]}),e[22]=a,e[23]=g,e[24]=v):v=e[24];let y;e[25]!==s||e[26]!==c?(y=(0,i.jsx)(B,{className:"-mt-0.5 flex-1",vegaSpec:c,height:100,signalListeners:x,theme:s}),e[25]=s,e[26]=c,e[27]=y):y=e[27];let h;return e[28]!==r.runId||e[29]!==v||e[30]!==y?(h=(0,i.jsxs)("div",{className:"flex flex-row",children:[v,y]},r.runId),e[28]=r.runId,e[29]=v,e[30]=y,e[31]=h):h=e[31],h},J=t=>{let e=(0,T.c)(12),{run:r,hoveredCellId:o,hiddenInputElementId:s}=t,a=(0,_.useRef)(null),l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=c=>{a.current&&(a.current.value=String(c),a.current.dispatchEvent(new Event("input",{bubbles:!0})))},e[0]=l):l=e[0];let u=l,n=o||"",x;e[1]!==s||e[2]!==n?(x=(0,i.jsx)("input",{type:"text",id:s,defaultValue:n,hidden:!0,ref:a}),e[1]=s,e[2]=n,e[3]=x):x=e[3];let d;e[4]===r.cellRuns?d=e[5]:(d=[...r.cellRuns.values()],e[4]=r.cellRuns,e[5]=d);let p;e[6]!==o||e[7]!==d?(p=d.map(c=>(0,i.jsx)(X,{cellRun:c,hovered:c.cellId===o,dispatchHoverEvent:u},c.cellId)),e[6]=o,e[7]=d,e[8]=p):p=e[8];let f;return e[9]!==x||e[10]!==p?(f=(0,i.jsxs)("div",{className:"text-xs mt-0.5 ml-3 flex flex-col gap-0.5",children:[x,p]}),e[9]=x,e[10]=p,e[11]=f):f=e[11],f},K={success:(0,i.jsx)(pe,{color:"green",size:14}),running:(0,i.jsx)(he,{color:"var(--blue-10)",size:14}),error:(0,i.jsx)(xe,{color:"red",size:14}),queued:(0,i.jsx)(V,{color:"grey",size:14})},X=t=>{let e=(0,T.c)(39),{cellRun:r,hovered:o,dispatchHoverEvent:s}=t,a;e[0]===r.elapsedTime?a=e[1]:(a=r.elapsedTime?O(r.elapsedTime*1e3):"-",e[0]=r.elapsedTime,e[1]=a);let l=a,u;e[2]!==r.elapsedTime||e[3]!==l?(u=r.elapsedTime?(0,i.jsxs)("span",{children:["This cell took ",(0,i.jsx)(ce,{elapsedTime:l})," to run"]}):(0,i.jsx)("span",{children:"This cell has not been run"}),e[2]=r.elapsedTime,e[3]=l,e[4]=u):u=e[4];let n=u,x;e[5]!==r.cellId||e[6]!==s?(x=()=>{s(r.cellId)},e[5]=r.cellId,e[6]=s,e[7]=x):x=e[7];let d=x,p;e[8]===s?p=e[9]:(p=()=>{s(null)},e[8]=s,e[9]=p);let f=p,c=o&&"bg-(--gray-3) opacity-100",j;e[10]===c?j=e[11]:(j=le("flex flex-row gap-2 py-1 px-1 opacity-70 hover:bg-(--gray-3) hover:opacity-100",c),e[10]=c,e[11]=j);let g;e[12]===r.startTime?g=e[13]:(g=H(r.startTime),e[12]=r.startTime,e[13]=g);let v;e[14]===g?v=e[15]:(v=(0,i.jsxs)("span",{className:"text-(--gray-10) dark:text-(--gray-11)",children:["[",g,"]"]}),e[14]=g,e[15]=v);let y;e[16]===r.cellId?y=e[17]:(y=(0,i.jsxs)("span",{className:"text-(--gray-10) w-16",children:["(",(0,i.jsx)(ge,{cellId:r.cellId}),")"]}),e[16]=r.cellId,e[17]=y);let h;e[18]===r.code?h=e[19]:(h=(0,i.jsx)("span",{className:"w-40 truncate -ml-1",children:r.code}),e[18]=r.code,e[19]=h);let I;e[20]===l?I=e[21]:(I=(0,i.jsx)("span",{className:"text-(--gray-10) dark:text-(--gray-11)",children:l}),e[20]=l,e[21]=I);let m;e[22]!==n||e[23]!==I?(m=(0,i.jsx)(q,{content:n,children:I}),e[22]=n,e[23]=I,e[24]=m):m=e[24];let S=K[r.status],b;e[25]!==r.status||e[26]!==S?(b=(0,i.jsx)(q,{content:r.status,children:S}),e[25]=r.status,e[26]=S,e[27]=b):b=e[27];let N;e[28]!==m||e[29]!==b?(N=(0,i.jsxs)("div",{className:"flex flex-row gap-1 w-16 justify-end -ml-2",children:[m,b]}),e[28]=m,e[29]=b,e[30]=N):N=e[30];let k;return e[31]!==d||e[32]!==f||e[33]!==h||e[34]!==N||e[35]!==j||e[36]!==v||e[37]!==y?(k=(0,i.jsxs)("div",{className:j,onMouseEnter:d,onMouseLeave:f,children:[v,y,h,N]}),e[31]=d,e[32]=f,e[33]=h,e[34]=N,e[35]=j,e[36]=v,e[37]=y,e[38]=k):k=e[38],k};w=function(t){try{let e=new Date(t*1e3),r=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0"),u=String(e.getSeconds()).padStart(2,"0"),n=String(e.getMilliseconds()).padStart(3,"0");return`${r}-${o}-${s} ${a}:${l}:${u}.${n}`}catch{return""}}});export{F as Tracing,be as __tla,w as formatChartTime};
