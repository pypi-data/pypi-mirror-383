import{p as k,r as m,e as v,j as e,M as I,g as z,P as x,B as o,i as D,a as b}from"./main-gLMaKCvr.js";import{b as w,d as A,c as M}from"./index-D2XNTdXQ.js";import{F as P}from"./Table-CWRWFg95.js";const J=({visible:c,onClose:l,params:d,callback:p})=>{if(!c)return null;const{modal:i,openModal:y,closeModal:u}=k(),{component_id:r,component_type:h,namespace:$,namespace_name:B,name:j,...F}=d,[_,C]=m.useState([]),{messageApi:a}=v(),s=async()=>{const t=await b.get(`/get-depend-component/${r}`);C(t.data)},g=async t=>{try{const n=await A(t);a.success("删除成功!"),s()}catch(n){console.log(n),a.error(`删除失败!${n.response.data.detail}`)}},f=async t=>{try{const n=await M(t);a.success("删除成功!"),l(),p&&p()}catch(n){console.log(n),a.error(`删除失败!${n.response.data.detail}`)}};return m.useEffect(()=>{s()},[r]),e.jsxs("div",{children:[e.jsxs(I,{width:"70%",title:`组件(${h},${j})`,open:c,onCancel:l,footer:(t,{OkBtn:n,CancelBtn:O})=>e.jsxs(e.Fragment,{children:[e.jsx(x,{title:"确定要删除组件吗？",onConfirm:()=>{f(r)},children:e.jsx(o,{size:"small",color:"danger",variant:"solid",children:"删除组件"})}),e.jsx(o,{size:"small",color:"cyan",variant:"solid",onClick:s,children:"刷新"}),e.jsx(o,{size:"small",color:"cyan",variant:"solid",onClick:l,children:"关闭"})]}),children:[e.jsx("div",{children:e.jsx(P,{size:"small",bordered:!0,pagination:!1,columns:[{title:"组件名称",dataIndex:"component_name",key:"component_name"},{title:"组件类型",dataIndex:"component_type",key:"component_type"},{title:"关系类型",dataIndex:"relation_type",key:"relation_type"},{title:"组件ID",dataIndex:"component_id",key:"component_id"},{title:"关系ID",dataIndex:"relation_id",key:"relation_id"},{title:"操作",key:"action",render:(t,n)=>e.jsxs(z,{gap:"small",children:[e.jsx(x,{title:"确定要移除关系吗？",onConfirm:()=>{g(n.relation_id)},children:e.jsx(o,{size:"small",color:"danger",variant:"solid",children:"移除关系"})}),e.jsx(o,{size:"small",color:"cyan",variant:"solid",onClick:()=>{y("modalA",{data:n,structure:{component_type:n.component_type}})},children:"更新组件"})]})}],dataSource:_})}),e.jsx(D,{ghost:!0,items:[{key:"1",label:"更多",children:e.jsx("pre",{children:JSON.stringify(d,null,2)})}]})]}),e.jsx(w,{callback:s,visible:i.key=="modalA"&&i.visible,onClose:u,params:i.params})]})};export{J as D};
