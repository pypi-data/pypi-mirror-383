const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./graph-view-CqXblzgF.js","./main-gLMaKCvr.js","./main-DLoYsyAm.css","./index-Jdu54dr5.js","./index-ZwmWfN3I.js","./Dropdown-CSp8FTqG.js","./index-B-_sZvQI.js","./study-page-BLC-2qgz.js","./usePagination-DK-N3QaW.js","./Table-CWRWFg95.js","./addEventListener-BwXlid1p.js","./index-BrNLqRge.js","./NodeIndexOutlined-ClGfWszx.js","./index-DDpcHwmR.js"])))=>i.map(i=>d[i]);
import{r as s,ad as B,bh as Ee,aj as Pe,ac as Y,O as J,ak as ye,ag as Te,ax as Ne,a$ as He,_ as le,ae as W,aw as ge,Z as ze,$ as ke,a0 as Ae,a2 as Ve,a1 as z,b4 as Le,aC as Be,b9 as Ke,a5 as Ue,a6 as We,F as $,q as be,j as n,I as q,S as K,e as qe,a as k,M as fe,i as Ge,d as Xe,t as ve,o as N,B as L,P as ee,aL as Je}from"./main-gLMaKCvr.js";import{a as Ye,S as Ze,D as Qe}from"./study-page-BLC-2qgz.js";import{T as xe,S as oe}from"./Table-CWRWFg95.js";import{S as et}from"./index-B-_sZvQI.js";import{T as de}from"./index-BrNLqRge.js";import{T as tt}from"./index-ZwmWfN3I.js";import{D as te}from"./index-DDpcHwmR.js";var ce=function(e,i){if(!e)return null;var a={left:e.offsetLeft,right:e.parentElement.clientWidth-e.clientWidth-e.offsetLeft,width:e.clientWidth,top:e.offsetTop,bottom:e.parentElement.clientHeight-e.clientHeight-e.offsetTop,height:e.clientHeight};return i?{left:0,right:0,width:0,top:a.top,bottom:a.bottom,height:a.height}:{left:a.left,right:a.right,width:a.width,top:0,bottom:0,height:0}},E=function(e){return e!==void 0?"".concat(e,"px"):void 0};function nt(t){var e=t.prefixCls,i=t.containerRef,a=t.value,r=t.getValueIndex,d=t.motionName,c=t.onMotionStart,u=t.onMotionEnd,h=t.direction,m=t.vertical,l=m===void 0?!1:m,o=s.useRef(null),_=s.useState(a),x=B(_,2),p=x[0],O=x[1],F=function(H){var P,V=r(H),T=(P=i.current)===null||P===void 0?void 0:P.querySelectorAll(".".concat(e,"-item"))[V];return(T==null?void 0:T.offsetParent)&&T},D=s.useState(null),y=B(D,2),f=y[0],g=y[1],j=s.useState(null),w=B(j,2),v=w[0],R=w[1];Ee(function(){if(p!==a){var S=F(p),H=F(a),P=ce(S,l),V=ce(H,l);O(a),g(P),R(V),S&&H?c():u()}},[a]);var I=s.useMemo(function(){if(l){var S;return E((S=f==null?void 0:f.top)!==null&&S!==void 0?S:0)}return E(h==="rtl"?-(f==null?void 0:f.right):f==null?void 0:f.left)},[l,h,f]),b=s.useMemo(function(){if(l){var S;return E((S=v==null?void 0:v.top)!==null&&S!==void 0?S:0)}return E(h==="rtl"?-(v==null?void 0:v.right):v==null?void 0:v.left)},[l,h,v]),G=function(){return l?{transform:"translateY(var(--thumb-start-top))",height:"var(--thumb-start-height)"}:{transform:"translateX(var(--thumb-start-left))",width:"var(--thumb-start-width)"}},A=function(){return l?{transform:"translateY(var(--thumb-active-top))",height:"var(--thumb-active-height)"}:{transform:"translateX(var(--thumb-active-left))",width:"var(--thumb-active-width)"}},X=function(){g(null),R(null),u()};return!f||!v?null:s.createElement(Pe,{visible:!0,motionName:d,motionAppear:!0,onAppearStart:G,onAppearActive:A,onVisibleChanged:X},function(S,H){var P=S.className,V=S.style,T=Y(Y({},V),{},{"--thumb-start-left":I,"--thumb-start-width":E(f==null?void 0:f.width),"--thumb-active-left":b,"--thumb-active-width":E(v==null?void 0:v.width),"--thumb-start-top":I,"--thumb-start-height":E(f==null?void 0:f.height),"--thumb-active-top":b,"--thumb-active-height":E(v==null?void 0:v.height)}),Z={ref:ye(o,H),style:T,className:J("".concat(e,"-thumb"),P)};return s.createElement("div",Z)})}var at=["prefixCls","direction","vertical","options","disabled","defaultValue","value","name","onChange","className","motionName"];function it(t){if(typeof t.title<"u")return t.title;if(ge(t.label)!=="object"){var e;return(e=t.label)===null||e===void 0?void 0:e.toString()}}function st(t){return t.map(function(e){if(ge(e)==="object"&&e!==null){var i=it(e);return Y(Y({},e),{},{title:i})}return{label:e==null?void 0:e.toString(),title:e==null?void 0:e.toString(),value:e}})}var rt=function(e){var i=e.prefixCls,a=e.className,r=e.disabled,d=e.checked,c=e.label,u=e.title,h=e.value,m=e.name,l=e.onChange,o=e.onFocus,_=e.onBlur,x=e.onKeyDown,p=e.onKeyUp,O=e.onMouseDown,F=function(y){r||l(y,h)};return s.createElement("label",{className:J(a,W({},"".concat(i,"-item-disabled"),r)),onMouseDown:O},s.createElement("input",{name:m,className:"".concat(i,"-item-input"),type:"radio",disabled:r,checked:d,onChange:F,onFocus:o,onBlur:_,onKeyDown:x,onKeyUp:p}),s.createElement("div",{className:"".concat(i,"-item-label"),title:u,"aria-selected":d},c))},lt=s.forwardRef(function(t,e){var i,a,r=t.prefixCls,d=r===void 0?"rc-segmented":r,c=t.direction,u=t.vertical,h=t.options,m=h===void 0?[]:h,l=t.disabled,o=t.defaultValue,_=t.value,x=t.name,p=t.onChange,O=t.className,F=O===void 0?"":O,D=t.motionName,y=D===void 0?"thumb-motion":D,f=Te(t,at),g=s.useRef(null),j=s.useMemo(function(){return ye(g,e)},[g,e]),w=s.useMemo(function(){return st(m)},[m]),v=Ne((i=w[0])===null||i===void 0?void 0:i.value,{value:_,defaultValue:o}),R=B(v,2),I=R[0],b=R[1],G=s.useState(!1),A=B(G,2),X=A[0],S=A[1],H=function(M,U){b(U),p==null||p(U)},P=He(f,["children"]),V=s.useState(!1),T=B(V,2),Z=T[0],ne=T[1],we=s.useState(!1),ae=B(we,2),Ie=ae[0],ie=ae[1],Ce=function(){ie(!0)},$e=function(){ie(!1)},De=function(){ne(!1)},Re=function(M){M.key==="Tab"&&ne(!0)},se=function(M){var U=w.findIndex(function(Fe){return Fe.value===I}),re=w.length,Oe=(U+M+re)%re,Q=w[Oe];Q&&(b(Q.value),p==null||p(Q.value))},Me=function(M){switch(M.key){case"ArrowLeft":case"ArrowUp":se(-1);break;case"ArrowRight":case"ArrowDown":se(1);break}};return s.createElement("div",le({role:"radiogroup","aria-label":"segmented control",tabIndex:l?void 0:0},P,{className:J(d,(a={},W(a,"".concat(d,"-rtl"),c==="rtl"),W(a,"".concat(d,"-disabled"),l),W(a,"".concat(d,"-vertical"),u),a),F),ref:j}),s.createElement("div",{className:"".concat(d,"-group")},s.createElement(nt,{vertical:u,prefixCls:d,value:I,containerRef:g,motionName:"".concat(d,"-").concat(y),direction:c,getValueIndex:function(M){return w.findIndex(function(U){return U.value===M})},onMotionStart:function(){S(!0)},onMotionEnd:function(){S(!1)}}),w.map(function(C){var M;return s.createElement(rt,le({},C,{name:x,key:C.value,prefixCls:d,className:J(C.className,"".concat(d,"-item"),(M={},W(M,"".concat(d,"-item-selected"),C.value===I&&!X),W(M,"".concat(d,"-item-focused"),Ie&&Z&&C.value===I),M)),checked:C.value===I,onChange:H,onFocus:Ce,onBlur:$e,onKeyDown:Me,onKeyUp:Re,onMouseDown:De,disabled:!!l||!!C.disabled}))})))}),ot=lt;function ue(t,e){return{[`${t}, ${t}:hover, ${t}:focus`]:{color:e.colorTextDisabled,cursor:"not-allowed"}}}function he(t){return{backgroundColor:t.itemSelectedBg,boxShadow:t.boxShadowTertiary}}const dt=Object.assign({overflow:"hidden"},Be),ct=t=>{const{componentCls:e}=t,i=t.calc(t.controlHeight).sub(t.calc(t.trackPadding).mul(2)).equal(),a=t.calc(t.controlHeightLG).sub(t.calc(t.trackPadding).mul(2)).equal(),r=t.calc(t.controlHeightSM).sub(t.calc(t.trackPadding).mul(2)).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ae(t)),{display:"inline-block",padding:t.trackPadding,color:t.itemColor,background:t.trackBg,borderRadius:t.borderRadius,transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`}),Ve(t)),{[`${e}-group`]:{position:"relative",display:"flex",alignItems:"stretch",justifyItems:"flex-start",flexDirection:"row",width:"100%"},[`&${e}-rtl`]:{direction:"rtl"},[`&${e}-vertical`]:{[`${e}-group`]:{flexDirection:"column"},[`${e}-thumb`]:{width:"100%",height:0,padding:`0 ${z(t.paddingXXS)}`}},[`&${e}-block`]:{display:"flex"},[`&${e}-block ${e}-item`]:{flex:1,minWidth:0},[`${e}-item`]:{position:"relative",textAlign:"center",cursor:"pointer",transition:`color ${t.motionDurationMid} ${t.motionEaseInOut}`,borderRadius:t.borderRadiusSM,transform:"translateZ(0)","&-selected":Object.assign(Object.assign({},he(t)),{color:t.itemSelectedColor}),"&-focused":Object.assign({},Le(t)),"&::after":{content:'""',position:"absolute",zIndex:-1,width:"100%",height:"100%",top:0,insetInlineStart:0,borderRadius:"inherit",opacity:0,transition:`opacity ${t.motionDurationMid}`,pointerEvents:"none"},[`&:hover:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemHoverBg}},[`&:active:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemActiveBg}},"&-label":Object.assign({minHeight:i,lineHeight:z(i),padding:`0 ${z(t.segmentedPaddingHorizontal)}`},dt),"&-icon + *":{marginInlineStart:t.calc(t.marginSM).div(2).equal()},"&-input":{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:0,opacity:0,pointerEvents:"none"}},[`${e}-thumb`]:Object.assign(Object.assign({},he(t)),{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:"100%",padding:`${z(t.paddingXXS)} 0`,borderRadius:t.borderRadiusSM,transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, height ${t.motionDurationSlow} ${t.motionEaseInOut}`,[`& ~ ${e}-item:not(${e}-item-selected):not(${e}-item-disabled)::after`]:{backgroundColor:"transparent"}}),[`&${e}-lg`]:{borderRadius:t.borderRadiusLG,[`${e}-item-label`]:{minHeight:a,lineHeight:z(a),padding:`0 ${z(t.segmentedPaddingHorizontal)}`,fontSize:t.fontSizeLG},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadius}},[`&${e}-sm`]:{borderRadius:t.borderRadiusSM,[`${e}-item-label`]:{minHeight:r,lineHeight:z(r),padding:`0 ${z(t.segmentedPaddingHorizontalSM)}`},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadiusXS}}}),ue(`&-disabled ${e}-item`,t)),ue(`${e}-item-disabled`,t)),{[`${e}-thumb-motion-appear-active`]:{transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, width ${t.motionDurationSlow} ${t.motionEaseInOut}`,willChange:"transform, width"},[`&${e}-shape-round`]:{borderRadius:9999,[`${e}-item, ${e}-thumb`]:{borderRadius:9999}}})}},ut=t=>{const{colorTextLabel:e,colorText:i,colorFillSecondary:a,colorBgElevated:r,colorFill:d,lineWidthBold:c,colorBgLayout:u}=t;return{trackPadding:c,trackBg:u,itemColor:e,itemHoverColor:i,itemHoverBg:a,itemSelectedBg:r,itemActiveBg:d,itemSelectedColor:i}},ht=ze("Segmented",t=>{const{lineWidth:e,calc:i}=t,a=ke(t,{segmentedPaddingHorizontal:i(t.controlPaddingHorizontal).sub(e).equal(),segmentedPaddingHorizontalSM:i(t.controlPaddingHorizontalSM).sub(e).equal()});return[ct(a)]},ut);var me=function(t,e){var i={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(i[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(t);r<a.length;r++)e.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(t,a[r])&&(i[a[r]]=t[a[r]]);return i};function mt(t){return typeof t=="object"&&!!(t!=null&&t.icon)}const yt=s.forwardRef((t,e)=>{const i=Ke(),{prefixCls:a,className:r,rootClassName:d,block:c,options:u=[],size:h="middle",style:m,vertical:l,shape:o="default",name:_=i}=t,x=me(t,["prefixCls","className","rootClassName","block","options","size","style","vertical","shape","name"]),{getPrefixCls:p,direction:O,className:F,style:D}=Ue("segmented"),y=p("segmented",a),[f,g,j]=ht(y),w=We(h),v=s.useMemo(()=>u.map(b=>{if(mt(b)){const{icon:G,label:A}=b,X=me(b,["icon","label"]);return Object.assign(Object.assign({},X),{label:s.createElement(s.Fragment,null,s.createElement("span",{className:`${y}-item-icon`},G),A&&s.createElement("span",null,A))})}return b}),[u,y]),R=J(r,d,F,{[`${y}-block`]:c,[`${y}-sm`]:w==="small",[`${y}-lg`]:w==="large",[`${y}-vertical`]:l,[`${y}-shape-${o}`]:o==="round"},g,j),I=Object.assign(Object.assign({},D),m);return f(s.createElement(ot,Object.assign({},x,{name:_,className:R,style:I,options:v,ref:e,prefixCls:y,direction:O,vertical:l})))}),gt=yt,{Option:Nt}=K,bt=({})=>{const[t,e]=s.useState("study"),[i,a]=s.useState("disease"),r=$.useFormInstance(),[d,c]=s.useState([]),[u,h]=s.useState([]),{modals:m,openModals:l,closeModals:o}=be(["entityDrawer","studyDrawer"]),[_,x]=s.useState();return n.jsxs(n.Fragment,{children:[n.jsx($.Item,{label:"Study",name:"study_id",children:n.jsx(q,{placeholder:"which study or reference provides evidence",style:{cursor:"pointer"},onClick:()=>l("studyDrawer",{name:"study_id"})})}),n.jsx($.Item,{label:"Subject",name:"subject_id",children:n.jsx(q,{placeholder:"who does something",style:{cursor:"pointer"},onClick:()=>l("entityDrawer",{name:"subject_id"})})}),n.jsx($.Item,{label:"Object",name:"object_id",children:n.jsx(q,{placeholder:"who receives the effect",style:{cursor:"pointer"},onClick:()=>l("entityDrawer",{name:"object_id"})})}),n.jsx($.Item,{label:"Predicate",name:"predicate",children:n.jsx(K,{allowClear:!0,options:[{value:"CORRELATED_WITH",label:"CORRELATED_WITH"},{value:"PRODUCES",label:"PRODUCES"},{value:"MODULATES",label:"MODULATES"},{value:"ACTIVATES",label:"ACTIVATES"},{value:"INHIBITS",label:"INHIBITS"}]})}),n.jsx($.Item,{label:"effect",name:"effect",children:n.jsx(K,{allowClear:!0,options:[{value:"Up",label:"Up"},{value:"Down",label:"Down"}]})}),n.jsx($.Item,{label:"Observed",name:"observed_id",children:n.jsx(q,{placeholder:"where the phenomenon is observed (e.g., patient group, tissue, condition)",style:{cursor:"pointer"},onClick:()=>l("entityDrawer",{name:"observed_id"})})}),n.jsx(vt,{form:r,setRecord:x,visible:m.entityDrawer.visible,params:m.entityDrawer.params,onClose:()=>o("entityDrawer")}),n.jsx(ft,{form:r,setRecord:x,visible:m.studyDrawer.visible,params:m.studyDrawer.params,onClose:()=>o("studyDrawer")})]})},ft=({visible:t,setRecord:e,form:i,params:a,onClose:r,callback:d})=>n.jsx(n.Fragment,{children:n.jsx(te,{open:t,onClose:r,width:"80%",children:t&&n.jsx(Ye,{rowSelection:{onChange:(c,u)=>{i.setFieldValue(a.name,u[0].entity_id),r()},type:"radio"}})})}),vt=({visible:t,setRecord:e,form:i,params:a,onClose:r,callback:d})=>n.jsx(n.Fragment,{children:n.jsx(te,{open:t,onClose:r,width:"80%",children:t&&n.jsx(Se,{disableWidth:!0,rowSelection:{onChange:(c,u)=>{i.setFieldValue(a.name,u[0].entity_id),r()},type:"radio"}})})}),xt=()=>n.jsxs(n.Fragment,{children:[n.jsx($.Item,{label:"entity_name_zh",name:"entity_name_zh",children:n.jsx(q,{})}),n.jsx($.Item,{label:"entity_type",name:"entity_type",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(K,{allowClear:!0,options:[{value:"Microbe",label:"Microbe"},{value:"Disease",label:"Disease"},{value:"Pathway",label:"Pathway"},{value:"Pathway",label:"Pathway"},{value:"Compound",label:"compound"},{value:"evidence",label:"Evidence"}]})}),n.jsx($.Item,{name:"tags",label:"tags",children:n.jsx(K,{mode:"tags",style:{width:"100%"}})}),n.jsx($.Item,{name:"short_name",label:"short_name",children:n.jsx(K,{mode:"tags",style:{width:"100%"}})})]}),_e=({visible:t,params:e,onClose:i,record:a,callback:r,children:d,entityType:c="mesh"})=>{const[u]=$.useForm(),{messageApi:h}=qe(),[m,l]=s.useState(!1);s.useEffect(()=>{t&&(e!=null&&e.entityId)?o():u.resetFields()},[t]);const o=async()=>{l(!0);const x=await k.get(`/entity/get/${c}/${e.entityId}`);u.setFieldsValue(x.data),l(!1)},_=async()=>{const x=await u.validateFields();l(!0);try{e!=null&&e.entityId?await k.put(`/entity/update/${e.entityType}/${e.entityId}`,x):await k.post(`/entity/add/${e.entityType}`,x)}catch{l(!1),h.error("error!")}l(!1),i(),r&&r(),h.success("操作成功!")};return n.jsx(fe,{loading:m,title:e!=null&&e.entityId?"update entity":"create entity",onOk:_,width:"50%",open:t,onClose:i,onCancel:i,children:n.jsxs($,{form:u,children:[d,n.jsx(Ge,{ghost:!0,items:[{key:"1",label:"more",children:n.jsx(n.Fragment,{children:n.jsx($.Item,{noStyle:!0,shouldUpdate:!0,children:()=>n.jsx(Xe,{children:n.jsx("pre",{children:JSON.stringify(u.getFieldsValue(),null,2)})})})})}]})]})})},_t={mesh:xt},pt=({type:t,record:e})=>{const i=_t[t]||(()=>n.jsxs("div",{children:["no ",t," component!"]}));return n.jsx(i,{record:e})},jt=({...t})=>{const{params:e,record:i}=t,[a,r]=s.useState([]);return s.useEffect(()=>{if(r([]),e!=null&&e.category&&Array.isArray(e==null?void 0:e.category)){const d=e==null?void 0:e.category.map(c=>({label:c,value:c}));r(d)}},[e]),n.jsx(n.Fragment,{children:n.jsxs(_e,{...t,children:[!(e!=null&&e.entityId)&&n.jsx($.Item,{label:"category",name:"category",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(K,{options:a})}),n.jsx($.Item,{label:"is_research",name:"is_research",children:n.jsx(Ze,{})}),n.jsx($.Item,{label:"entity_name",name:"entity_name",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(q,{})}),n.jsx(pt,{type:e==null?void 0:e.entityType,record:i})]})})},Ht=({...t})=>n.jsx(n.Fragment,{children:n.jsx(_e,{...t,entityType:"association",children:n.jsx(bt,{})})}),pe=(t,e,i)=>t.map(a=>a.key===e?{...a,children:i}:a.children?{...a,children:pe(a.children,e,i)}:a),St=s.forwardRef(({entityType:t,params:e},i)=>{const[a,r]=s.useState(),[d,c]=s.useState(new Set),[u,h]=s.useState(),[m,l]=s.useState("default"),o=async(y,f,g,j="")=>{const w=await k.post(`/entity/page/${t}`,{page_number:f,page_size:g,parent_id:String(y),keyword:j,...e}),{items:v,total:R}=w.data;if(t=="taxonomy"){const I=v.map(b=>({title:n.jsx(n.Fragment,{children:n.jsxs(N,{title:`${b.entity_name}(${b.rank})(${b.tax_id})`,children:[b.entity_name," (",b.rank,")"]})}),key:b.tax_id,isLeaf:!b.has_children}));return h(I),{children:I,total:R}}else if(t=="mesh"){const I=v.map(b=>({title:n.jsx(n.Fragment,{children:n.jsxs(N,{title:`${b.entity_name}`,children:[b.entity_name,"(",b.entity_id,")"]})}),key:b.tree_number,isLeaf:!b.has_children}));return h(I),{children:I,total:R}}else{const I=v.map(b=>({title:n.jsx(n.Fragment,{children:n.jsx(N,{title:`${b.entity_name}`,children:b.entity_name})}),key:b.entity_id,isLeaf:!b.has_children}));return h(I),{children:I,total:R}}},_=async()=>{const{children:y}=await o(m,1,-1);r(y)};s.useImperativeHandle(i,()=>({reload:_})),s.useEffect(()=>{_()},[t,JSON.stringify(e)]);const x=async({key:y,children:f})=>{if(f)return;c(j=>new Set(j).add(y));const{children:g}=await o(y,1,-1);r(j=>pe(j,y,[...g])),c(j=>{const w=new Set(j);return w.delete(y),w})},p=s.useRef(null),[O,F]=s.useState(null),D=()=>{if(p.current){const y=p.current.getBoundingClientRect().top;F(window.innerHeight-y)}};return s.useEffect(()=>(D(),window.addEventListener("resize",D),()=>{window.removeEventListener("resize",D)}),[]),n.jsx("div",{ref:p,children:a?n.jsx(n.Fragment,{children:n.jsx(xe,{height:O,loadData:x,treeData:a,showLine:!0,titleRender:y=>d.has(Number(y.key))?n.jsx(et,{size:"small"}):y.title})}):n.jsx(ve,{active:!0})})}),wt=t=>{let e=[];switch(t){case"organisms":e=[...e,{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id",render:(i,a)=>n.jsx("a",{href:`https://meshb.nlm.nih.gov/record/ui?ui=${i}`,target:"_blank",children:i})},{title:"entity_name",dataIndex:"entity_name",key:"entity_name",render:(i,a)=>n.jsx(n.Fragment,{children:a!=null&&a.entity_name_en?n.jsx(N,{title:a==null?void 0:a.entity_name_en,children:i}):n.jsx(n.Fragment,{children:i})})},{title:"taxonomy_name",dataIndex:"taxonomy_name",key:"taxonomy_name"},{title:"rank",dataIndex:"rank",key:"rank"},{title:"tax_id",dataIndex:"tax_id",key:"tax_id"},{title:"entity_type",dataIndex:"entity_type",key:"entity_type"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"}];break;case"mesh":e=[...e,{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id",render:(i,a)=>n.jsx("a",{href:`https://meshb.nlm.nih.gov/record/ui?ui=${i}`,target:"_blank",children:i})},{title:"entity_name",dataIndex:"entity_name",key:"entity_name",render:(i,a)=>n.jsx(n.Fragment,{children:a!=null&&a.entity_name_en?n.jsx(N,{title:a==null?void 0:a.entity_name_en,children:i}):n.jsx(n.Fragment,{children:i})})},{title:"short_name",dataIndex:"short_name",key:"short_name",render:(i,a)=>n.jsx(n.Fragment,{children:i&&Array.isArray(i)&&i.map((r,d)=>n.jsx(de,{children:r},d))})},{title:"entity_type",dataIndex:"entity_type",key:"entity_type"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"},{title:"is_research",dataIndex:"is_research",key:"is_research",render:(i,a)=>i?"research":"non-research"},{title:"tags",dataIndex:"tags",key:"tags",render:(i,a)=>n.jsx(n.Fragment,{children:i&&Array.isArray(i)&&i.map((r,d)=>n.jsx(de,{children:r},d))})}];break;case"association":e=[{title:"entity_id",dataIndex:"entity_id",key:"entity_id"},{title:"subject_name",dataIndex:"subject_name",key:"subject_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(N,{title:a==null?void 0:a.subject_id,children:i})})},{title:"predicate",dataIndex:"predicate",key:"predicate"},{title:"object_name",dataIndex:"object_name",key:"object_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(N,{title:a==null?void 0:a.object_id,children:i})})},{title:"effect",dataIndex:"effect",key:"effect"},{title:"study_name",dataIndex:"study_name",key:"study_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(N,{title:a==null?void 0:a.study_id,children:i})})},{title:"observed_name",dataIndex:"observed_name",key:"observed_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(N,{title:a==null?void 0:a.observed_id,children:i})})},{title:"created_at",dataIndex:"created_at",key:"created_at"}];break;default:e=[{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id"},{title:"entity_name",dataIndex:"entity_name",key:"entity_name"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"},{title:"is_research",dataIndex:"is_research",key:"is_research",render:(i,a)=>i?"research":"non-research"}]}return e},It=(t,e,i,a)=>{let r=[];switch(t){case"association":r=[{title:"操作",key:"action",fixed:"right",width:200,render:(d,c)=>n.jsx(oe,{size:"middle",children:e&&n.jsxs(n.Fragment,{children:[n.jsx(L,{size:"small",color:"cyan",variant:"solid",onClick:()=>{console.log("update:",c),e("optModal",{entityType:t,entityId:c.entity_id})},children:"update"}),n.jsx(ee,{title:"Confirm deletion?",onConfirm:async()=>{var u,h,m,l;try{await k.delete(`/entity-relation/delete-association/${c.entity_id}`),a.success("Delete successfully!"),i()}catch(o){console.log((h=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:h.detail),a.error((l=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:l.detail)}},children:n.jsx(L,{size:"small",danger:!0,variant:"solid",children:"delete"})})]})})}];break;case"mesh":r=[{title:"操作",key:"action",fixed:"right",width:200,render:(d,c)=>n.jsx(oe,{size:"middle",children:e&&n.jsxs(n.Fragment,{children:[n.jsx(L,{size:"small",color:"cyan",variant:"solid",onClick:()=>{e("entityDetailsModal",{entityType:t,entityId:c.entity_id})},children:"details"}),n.jsx(L,{size:"small",color:"cyan",variant:"solid",onClick:()=>{console.log("update:",c),e("optModal",{entityType:t,entityId:c.entity_id})},children:"update"}),c.is_exist_graph?n.jsxs(n.Fragment,{children:[n.jsx(L,{size:"small",color:"cyan",variant:"solid",onClick:()=>{e("graphView",{entityType:t,entityId:c.entity_id,entityName:c.entity_name})},children:"network"}),n.jsx(ee,{title:"确认删除节点?",onConfirm:async()=>{var u,h,m,l;try{await k.delete(`/entity/delete-node/${t}/${c.entity_id}`),a.success("删除成功!"),i()}catch(o){console.log((h=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:h.detail),a.error((l=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:l.detail)}},children:n.jsx(L,{size:"small",danger:!0,variant:"solid",children:"delete"})})]}):n.jsx(ee,{title:"Confirm deletion?",onConfirm:async()=>{var u,h,m,l;try{await k.delete(`/entity/delete/${t}/${c.entity_id}`),a.success("Delete successfully!"),i()}catch(o){console.log((h=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:h.detail),a.error((l=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:l.detail)}},children:n.jsx(L,{size:"small",danger:!0,variant:"solid",children:"delete"})})]})})}];break}return r},Ct=s.lazy(()=>Je(()=>import("./graph-view-CqXblzgF.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),je=s.forwardRef(({openModals:t,rowSelection:e,disableWidth:i=!1,tabKey:a,params:r,hiddenSwitch:d=!0},c)=>{const[u,h]=s.useState("mesh"),[m,l]=s.useState(r||{category:["F03","C10","F01"]}),[o,_]=s.useState(a||"mental_disorders"),x=s.useRef(null),[p,O]=s.useState("table"),F=()=>{var g;(g=x.current)==null||g.reload()},D=g=>{var j;x.current&&((j=x.current)==null||j.setPageNumber(g))},y=[{key:"mental_disorders",label:"Mental Disorders"},{key:"organisms",label:"Microbe"},{key:"mesh-KEGG",label:"KEGG"},{key:"chemicals_and_drugs",label:"Chemicals and Drugs"}],f=g=>{if(g.startsWith("mesh")){const j=g.split("-")[1];l({category:[j]}),h("mesh")}else g=="organisms"?(h("organisms"),l({category:["B02","B03","B04"],registry_join:"taxonomy"})):g=="mental_disorders"?(l({category:["F03","C10","F01"]}),h("mesh")):g=="chemicals_and_drugs"?(l({category:["D01","D02","D03","D04","D05","D06","D08","D09","D10","D12","D13","D20","D23","D25","D26","D27"]}),h("mesh")):g=="evidence"&&(l({category:["evidence"],registry_join:"study"}),h("mesh"))};return s.useImperativeHandle(c,()=>({reload:F})),n.jsxs("div",{style:i?{}:{maxWidth:"1500px",margin:"1rem auto"},children:[n.jsx("div",{style:{marginBottom:"1rem"},children:" "}),!r&&n.jsx(tt,{size:"small",activeKey:o,onChange:g=>{f(g),_(g),D(1)},tabBarExtraContent:n.jsx(n.Fragment,{children:n.jsx(gt,{size:"small",value:p,onChange:g=>O(g),options:[{label:"table",value:"table"},{label:"tree",value:"tree"}]})}),items:y}),p=="table"&&n.jsx(n.Fragment,{children:n.jsx(Qe,{columns:({openModal:g,reload:j,messageApi:w})=>{const v=wt(u),R=It("mesh",g,j,w);return[...v,...R]},hiddenSwitch:d,rowSelection:e,ref:x,openModal:t,params:m,api:"/entity/page/mesh"})}),p=="tree"&&n.jsx(n.Fragment,{children:n.jsx(St,{ref:x,entityType:"mesh",params:m})})]})}),Se=({...t})=>{const{modals:e,openModals:i,closeModals:a}=be(["entityPage","optModal","graphView","entityDrawer","entityDetailsModal"]),r=s.useRef(null),d=()=>{var c;(c=r.current)==null||c.reload()};return n.jsxs(n.Fragment,{children:[n.jsx(je,{...t,ref:r,openModals:i}),n.jsx(jt,{openModals:i,callback:d,visible:e.optModal.visible,params:e.optModal.params,onClose:()=>a("optModal")}),n.jsx($t,{callback:d,visible:e.graphView.visible,params:e.graphView.params,onClose:()=>a("graphView")}),n.jsx(Dt,{openModals:i,callback:d,visible:e.entityDetailsModal.visible,params:e.entityDetailsModal.params,onClose:()=>a("entityDetailsModal")})]})},$t=({visible:t,params:e,onClose:i,callback:a})=>n.jsx(fe,{title:e==null?void 0:e.entityName,width:"60%",footer:null,open:t,onClose:i,onCancel:i,children:n.jsx(s.Suspense,{fallback:n.jsx(ve,{active:!0}),children:n.jsx(Ct,{entity_id:e==null?void 0:e.entityId})})}),Dt=({visible:t,params:e,onClose:i})=>{const[a,r]=s.useState(!1),[d,c]=s.useState(),[u,h]=s.useState(),m=o=>o.map(_=>({title:_.entity_name,key:_.entity_id,children:_.children?m(_.children):[]})),l=async()=>{r(!0);const o=await k.get(`/entity/get/${e.entityType}/${e.entityId}`),_=m(o.data.parents);h(_),r(!1)};return s.useEffect(()=>{e!=null&&e.entityId&&l()},[e==null?void 0:e.entityId]),n.jsx(te,{open:t,onClose:i,width:"40%",loading:a,children:u&&n.jsx(n.Fragment,{children:n.jsx(xe,{treeData:u,defaultExpandAll:!0,showLine:!0,selectable:!0})})})},zt=Object.freeze(Object.defineProperty({__proto__:null,EntityView:je,default:Se},Symbol.toStringTag,{value:"Module"}));export{Ht as A,Se as E,It as a,wt as g,zt as i};
