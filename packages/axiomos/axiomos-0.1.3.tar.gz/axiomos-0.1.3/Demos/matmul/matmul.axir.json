{
  "version": "0.1",
  "types": {
    "scalars": { "M": { "value": 2 }, "N": { "value": 2 }, "K": { "value": 2 } },
    "buffers": { "hA": {"dtype":"f32"}, "hB":{"dtype":"f32"}, "hC":{"dtype":"f32"},
                 "dA":{"dtype":"f32"}, "dB":{"dtype":"f32"}, "dC":{"dtype":"f32"} }
  },
  "ops": [
    {"op":"DeviceMalloc","dst":"&dA","bytes":"M*K*4"},
    {"op":"DeviceMalloc","dst":"&dB","bytes":"K*N*4"},
    {"op":"DeviceMalloc","dst":"&dC","bytes":"M*N*4"},

    {"op":"Memcpy","dst":"&dA","src":"&hA","bytes":"M*K*4","kind":"H2D"},
    {"op":"Memcpy","dst":"&dB","src":"&hB","bytes":"K*N*4","kind":"H2D"},

    {"op":"KernelLaunch","kernel":"matmul","grid":["1","1","1"],"block":["1","1","1"],
     "args":["dA","dB","dC","M","N","K"]},

    {"op":"Memcpy","dst":"&hC","src":"&dC","bytes":"M*N*4","kind":"D2H"}
  ]
}
