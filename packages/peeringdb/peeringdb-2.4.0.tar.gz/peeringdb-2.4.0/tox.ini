[gh-actions]
python =
    3.9: py39,mypy
    3.10: py310
    3.11: py311
    3.12: py312
    3.13: py313

[pytest]
norecursedirs = .facsimile .tox data gen

[tox]
envlist =
    py39-django{32,42}
    py{310,311,312,313}-django{42,52}
    mypy
isolated_build = True

[testenv]
setenv =
    PYTHONDONTWRITEBYTECODE=1
    PYTHONWARNINGS=once
deps =
    django32: Django>=3.2,<3.3
    django42: Django>=4.2,<4.3
    django50: Django>=5.0,<5.1
    django51: Django>=5.1,<5.2
    django52: Django>=5.2,<5.3
runner = uv-venv-lock-runner
extras =
commands =
    pytest -vv --cov="{toxinidir}/src" --cov-report=term-missing --cov-report=xml tests/

[testenv:mypy]
deps =
    mypy>=0.950
    types-requests
    types-PyYAML
    # Core dependencies needed for mypy checking
    django>=4.2
    django_peeringdb>=3.1.0
    confu>=1
    munge[toml,tomlkit,yaml]>=1.2.0
    twentyc.rpc>=1
    pyyaml>=6.0.1
    httpx>=0.24.1
extras =
commands =
    mypy src/
