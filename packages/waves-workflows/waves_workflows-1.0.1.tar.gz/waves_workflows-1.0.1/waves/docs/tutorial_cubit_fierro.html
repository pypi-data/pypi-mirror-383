
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial: Cubit+Fierro &#8212; WAVES 1.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=cb027bf8" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=cb027bf8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=423d4ce3"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=e639491b"></script>
    <script src="_static/custom.js?v=070b234d"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial_cubit_fierro';</script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial: Escape Sequences" href="tutorial_escape_sequences.html" />
    <link rel="prev" title="Tutorial: Cubit+Sierra" href="tutorial_cubit_sierra.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Oct 10, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/waves_logo_brandmark_smaller.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/waves_logo_brandmark_smaller.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">1.0.1</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Computational Practices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="computational_practices_introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_version_control.html">Version Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_build_system.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_compute_environment.html">Compute Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_regression_testing.html">Regression Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_archival.html">Data Archival</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abstract.html">Why WAVES?</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_quickstart.html">Quickstart</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="waves_quickstart.html">Quickstart: Abaqus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_gmsh_calculix.html">Quickstart: Gmsh+CalculiX</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_introduction.html">Tutorial Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_core.html">Core Lessons</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_00_scons.html">Tutorial 00: SConstruct</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_01_geometry.html">Tutorial 01: Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_02_partition_mesh.html">Tutorial 02: Partition and Mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_03_solverprep.html">Tutorial 03: SolverPrep</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_04_simulation.html">Tutorial 04: Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_05_parameter_substitution.html">Tutorial 05: Parameter Substitution</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_06_include_files.html">Tutorial 06: Include Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_cartesian_product.html">Tutorial 07: Cartesian Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_08_data_extraction.html">Tutorial 08: Data Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_09_post_processing.html">Tutorial 09: Post-Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_10_unit_testing.html">Tutorial 10: Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_11_regression_testing.html">Tutorial 11: Regression Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_12_archival.html">Tutorial 12: Data Archival</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tutorial_supplemental.html">Supplemental Lessons</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scons_quickstart.html">SCons Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="scons_multiactiontask.html">SCons Multi-Action Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_argparse_types.html">Tutorial: Input Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cubit_abaqus.html">Tutorial: Cubit+Abaqus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cubit_sierra.html">Tutorial: Cubit+Sierra</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tutorial: Cubit+Fierro</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_escape_sequences.html">Tutorial: Escape Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_latin_hypercube.html">Tutorial 07: Latin Hypercube</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_sobol_sequence.html">Tutorial 07: Sobol Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_one_at_a_time.html">Tutorial 07: One-at-a-Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_mesh_convergence.html">Tutorial: Mesh Convergence</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_part_image.html">Tutorial: Part Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_sensitivity_study.html">Tutorial: Sensitivity Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_abaqus_cae.html">Tutorial: Abaqus CAE</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_wip.html">Work-in-progress Lessons</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_writing_builders.html">Tutorial: Writing Builders</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_remote_execution.html">Tutorial: Simulation via SSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_sbatch.html">Tutorial: Simulation via SLURM</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_extend_study.html">Automatically Extending a Parameter Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_task_reuse.html">Tutorial: Task Definition Reuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_setuptools_scm.html">Tutorial: setuptools_scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_quinoa.html">Tutorial: Quinoa</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">ModSim Templates</a></li>

<li class="toctree-l1"><a class="reference internal" href="api.html">External API</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-Line Utilities</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Help and Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="license.html">LICENSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal_api.html">Internal API</a></li>
<li class="toctree-l1"><a class="reference internal" href="devops.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_philosophy.html">Release Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tutorial_api.html">WAVES-TUTORIAL API</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_cli.html">WAVES-TUTORIAL CLI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="tutorial_supplemental.html" class="nav-link">Supplemental Lessons</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Tutorial:...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lanl-aea/waves" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lanl-aea/waves/blob/main/docs/tutorial_cubit_fierro.rst?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/tutorial_cubit_fierro.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial: Cubit+Fierro</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment">Environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-structure">Directory Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconscript">SConscript</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cubit-journal-files">Cubit Journal Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-script">Python Script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fierro-input-file-s">Fierro Input File(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconstruct">SConstruct</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-targets">Build Targets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output Files</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tutorial-cubit-fierro">
<span id="id1"></span><h1>Tutorial: Cubit+Fierro<a class="headerlink" href="#tutorial-cubit-fierro" title="Link to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on your Cubit installation and operating system, it may not be
possible to import Cubit into arbitrary Python 3 environments. Instead, it
may be necessary to execute Cubit Python scripts using the Python
interpreter bundled with Cubit. An alternate Cubit tutorial using
<a class="reference internal" href="api.html#waves.scons_extensions.add_cubit_python" title="waves.scons_extensions.add_cubit_python"><code class="xref py py-meth docutils literal notranslate"><span class="pre">waves.scons_extensions.add_cubit_python()</span></code></a> is provided as
<code class="docutils literal notranslate"><span class="pre">tutorial_cubit_alternate</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwd
/home/roppenheimer/waves-tutorials
$ waves fetch --destination tutorial_cubit_alternate tutorials/tutorial_cubit_alternate
</pre></div>
</div>
</div>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://cubit.sandia.gov/public/documentation.html">Cubit</a>: Python Interface <span id="id2">[<a class="reference internal" href="zreferences.html#id21" title="National Technology and Engineering Solutions of Sandia, LLC. Cubit. 2022. Albuquerque, New Mexico, USA. URL: https://cubit.sandia.gov/ (visited on 2022-08-05).">62</a>]</span></p></li>
<li><p><a class="reference external" href="https://cubit.sandia.gov/public/documentation.html">Cubit</a>: Importing Cubit into Python <span id="id3">[<a class="reference internal" href="zreferences.html#id21" title="National Technology and Engineering Solutions of Sandia, LLC. Cubit. 2022. Albuquerque, New Mexico, USA. URL: https://cubit.sandia.gov/ (visited on 2022-08-05).">62</a>]</span></p></li>
<li><p><a class="reference external" href="https://lanl.github.io/Fierro/index.html">Fierro</a> documentation <span id="id4">[<a class="reference internal" href="zreferences.html#id24" title="Los Alamos National Laboratory. Fierro. 2020. URL: https://github.com/lanl/fierro (visited on 2024-04-02).">65</a>, <a class="reference internal" href="zreferences.html#id23" title="Los Alamos National Laboratory. Fierro. 2020. URL: https://lanl.github.io/Fierro/index.html (visited on 2024-04-02).">66</a>]</span></p></li>
<li><p><a class="reference external" href="https://github.com/nschloe/meshio">meshio</a> <span id="id5">[<a class="reference internal" href="zreferences.html#id80" title="Nico Schlömer. meshio: Tools for mesh files. URL: https://github.com/nschloe/meshio, doi:10.5281/zenodo.1173115.">40</a>]</span></p></li>
<li><p><a class="reference external" href="https://vtk.org/">vtk</a> <span id="id6">[<a class="reference internal" href="zreferences.html#id81" title="Will Schroeder, Ken Martin, and Bill Lorensen. The Visualization Toolkit (4th ed.). Kitware, 2006. ISBN 978-1-930934-19-1.">67</a>]</span></p></li>
<li><p><a class="reference external" href="https://www.mpi-forum.org/">MPI</a> <span id="id7">[<a class="reference internal" href="zreferences.html#id82" title="MPI Forum. MPI forum. 2024. URL: https://www.mpi-forum.org/ (visited on 2024-12-05).">68</a>]</span></p></li>
</ul>
</section>
<section id="environment">
<h2>Environment<a class="headerlink" href="#environment" title="Link to this heading">#</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The Fierro tutorial requires a different compute environment than the other tutorials. The following commands create
a dedicated environment for the use of this tutorial. You can also use your existing tutorial environment
environment if you add the <a class="reference external" href="https://anaconda.org/fierromechanics">FierroMechanics</a> channel and install the <code class="docutils literal notranslate"><span class="pre">fierro-fe-cpu</span></code> and <code class="docutils literal notranslate"><span class="pre">meshio</span></code> packages.</p>
</div>
<p><a class="reference external" href="https://scons.org/">SCons</a>, <a class="reference external" href="https://lanl-aea.github.io/waves/index.html">WAVES</a>, and <a class="reference external" href="https://lanl.github.io/Fierro/index.html">Fierro</a> can be installed in a <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a> environment with the <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a> package manager. See the
<a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.html">Conda installation</a> and <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">Conda environment management</a> documentation for more details about using <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a>.</p>
<ol class="arabic">
<li><p>Create the Fierro tutorials environment if it doesn’t exist</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda create --name waves-fierro-env --channel fierromechanics --channel conda-forge waves &#39;scons&gt;=4.6&#39; fierro-fe-cpu meshio
</pre></div>
</div>
</li>
<li><p>Activate the environment</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda activate waves-fierro-env
</pre></div>
</div>
</li>
</ol>
</section>
<section id="directory-structure">
<h2>Directory Structure<a class="headerlink" href="#directory-structure" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="3">
<li><p>Create and change to a new project root directory to house the tutorial files if you have not already done so. For example</p></li>
</ol>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="OS" data-sync-id="bash" for="sd-tab-item-0">
Linux/MacOS</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>~/waves-tutorials
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/waves-tutorials
$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="OS" data-sync-id="powershell" for="sd-tab-item-1">
Windows</label><div class="sd-tab-content docutils">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">New-Item</span> <span class="nv">$HOME</span><span class="p">\</span><span class="n">waves-tutorials</span> <span class="n">-ItemType</span> <span class="s2">&quot;Directory&quot;</span>
<span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">Set-Location</span> <span class="nv">$HOME</span><span class="p">\</span><span class="n">waves-tutorials</span>
<span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">Get-Location</span>

<span class="n">Path</span>
<span class="p">----</span>
<span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">roppenheimer</span><span class="p">\</span><span class="n">waves-tutorials</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="4">
<li><p>Create a new <code class="docutils literal notranslate"><span class="pre">tutorial_cubit</span></code> directory with the <code class="docutils literal notranslate"><span class="pre">waves</span> <span class="pre">fetch</span></code> command below</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
$<span class="w"> </span>waves<span class="w"> </span>fetch<span class="w"> </span>--destination<span class="w"> </span>tutorial_cubit<span class="w"> </span>tutorials/tutorial_cubit
$<span class="w"> </span>ls<span class="w"> </span>tutorial_cubit
modsim_package/<span class="w"> </span>abaqus.scons<span class="w"> </span>cubit.scons<span class="w"> </span>SConstruct<span class="w"> </span>sierra.scons<span class="w"> </span>fierro.scons
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Make the new <code class="docutils literal notranslate"><span class="pre">tutorial_cubit</span></code> directory the current working directory</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>tutorial_cubit
$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials/tutorial_cubit
$<span class="w"> </span>ls
modsim_package/<span class="w"> </span>abaqus.scons<span class="w"> </span>cubit.scons<span class="w"> </span>SConstruct<span class="w"> </span>sierra.scons<span class="w"> </span>fierro.scons
</pre></div>
</div>
</section>
<section id="sconscript">
<h2>SConscript<a class="headerlink" href="#sconscript" title="Link to this heading">#</a></h2>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">tutorial_cubit</span></code> directory has four SConscript files: <code class="docutils literal notranslate"><span class="pre">cubit.scons</span></code>, <code class="docutils literal notranslate"><span class="pre">abaqus.scons</span></code>,
<code class="docutils literal notranslate"><span class="pre">sierra.scons</span></code>, and <code class="docutils literal notranslate"><span class="pre">fierro.scons</span></code>.  The <code class="docutils literal notranslate"><span class="pre">cubit.scons</span></code> and <code class="docutils literal notranslate"><span class="pre">fierro.scons</span></code> files are relevant to the current
tutorial. The <code class="docutils literal notranslate"><span class="pre">abaqus.scons</span></code> and <code class="docutils literal notranslate"><span class="pre">sierra.scons</span></code> workflows are described in the complementary
<a class="reference internal" href="tutorial_cubit_abaqus.html#tutorial-cubit-abaqus"><span class="std std-ref">Tutorial: Cubit+Abaqus</span></a> and <a class="reference internal" href="tutorial_cubit_sierra.html#tutorial-cubit-sierra"><span class="std std-ref">Tutorial: Cubit+Sierra</span></a>.</p>
<ol class="arabic simple" start="6">
<li><p>Review the <code class="docutils literal notranslate"><span class="pre">cubit.scons</span></code> and <code class="docutils literal notranslate"><span class="pre">fierro.scons</span></code> tutorials and compare them against the <a class="reference internal" href="tutorial_04_simulation.html#tutorial-simulation"><span class="std std-ref">Tutorial 04: Simulation</span></a> files.</p></li>
</ol>
<p>The structure has changed enough that a diff view is not as useful. Instead the contents of the new SConscript files are
duplicated below.</p>
<div class="admonition-waves-tutorials-tutorial-cubit-cubit-scons admonition">
<p class="admonition-title">waves-tutorials/tutorial_cubit/cubit.scons</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="ch">#! /usr/bin/env python</span>
<span class="linenos">  2</span><span class="sd">&quot;&quot;&quot;Rectangle compression workflow: geometry, partition, mesh.</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="sd">Requires the following ``SConscript(..., exports={})``</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="sd">* ``env`` - The SCons construction environment with the following required keys</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="sd">  * ``unconditional_build`` - Boolean flag to force building of conditionally ignored targets</span>
<span class="linenos">  9</span><span class="sd">  * ``cubit`` - String path for the Cubit executable</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="sd">* ``element_type`` - The Cubit 4 node quadrilateral element type</span>
<span class="linenos"> 12</span><span class="sd">* ``solver`` - The target solver to use when writing a mesh file</span>
<span class="linenos"> 13</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="c1"># Inherit the parent construction environment</span>
<span class="linenos"> 18</span><span class="n">Import</span><span class="p">(</span><span class="s2">&quot;env&quot;</span><span class="p">,</span> <span class="s2">&quot;element_type&quot;</span><span class="p">,</span> <span class="s2">&quot;solver&quot;</span><span class="p">)</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span><span class="c1"># Simulation variables</span>
<span class="linenos"> 21</span><span class="n">build_directory</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">Dir</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">abspath</span><span class="p">)</span>
<span class="linenos"> 22</span><span class="n">workflow_name</span> <span class="o">=</span> <span class="n">build_directory</span><span class="o">.</span><span class="n">name</span>
<span class="linenos"> 23</span>
<span class="linenos"> 24</span><span class="c1"># Collect the target nodes to build a concise alias for all targets</span>
<span class="linenos"> 25</span><span class="n">workflow</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span><span class="c1"># Rectangle 2D</span>
<span class="linenos"> 28</span><span class="c1"># Geometry</span>
<span class="linenos"> 29</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos"> 30</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos"> 31</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle_geometry.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 32</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#/modsim_package/cubit/rectangle_geometry.py&quot;</span><span class="p">],</span>
<span class="linenos"> 33</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos"> 34</span>    <span class="p">)</span>
<span class="linenos"> 35</span><span class="p">)</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="c1"># Partition</span>
<span class="linenos"> 38</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos"> 39</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos"> 40</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle_partition.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 41</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#/modsim_package/cubit/rectangle_partition.py&quot;</span><span class="p">,</span> <span class="s2">&quot;rectangle_geometry.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 42</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos"> 43</span>    <span class="p">)</span>
<span class="linenos"> 44</span><span class="p">)</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span><span class="c1"># Mesh</span>
<span class="linenos"> 47</span><span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abaqus&quot;</span><span class="p">:</span>
<span class="linenos"> 48</span>    <span class="n">mesh_extension</span> <span class="o">=</span> <span class="s2">&quot;inp&quot;</span>
<span class="linenos"> 49</span><span class="k">elif</span> <span class="n">solver</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;sierra&quot;</span><span class="p">,</span> <span class="s2">&quot;adagio&quot;</span><span class="p">]:</span>
<span class="linenos"> 50</span>    <span class="n">mesh_extension</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span>
<span class="linenos"> 51</span><span class="k">else</span><span class="p">:</span>
<span class="linenos"> 52</span>    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown solver &#39;</span><span class="si">{</span><span class="n">solver</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 53</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos"> 54</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos"> 55</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;rectangle_mesh.</span><span class="si">{</span><span class="n">mesh_extension</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;rectangle_mesh.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 56</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#/modsim_package/cubit/rectangle_mesh.py&quot;</span><span class="p">,</span> <span class="s2">&quot;rectangle_partition.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 57</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;--element-type $</span><span class="si">{element_type}</span><span class="s2"> --solver $</span><span class="si">{solver}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="linenos"> 58</span>        <span class="n">element_type</span><span class="o">=</span><span class="n">element_type</span><span class="p">,</span>
<span class="linenos"> 59</span>        <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
<span class="linenos"> 60</span>    <span class="p">)</span>
<span class="linenos"> 61</span><span class="p">)</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span>
<span class="linenos"> 64</span><span class="c1"># Cube 3D</span>
<span class="linenos"> 65</span><span class="c1"># Geometry</span>
<span class="linenos"> 66</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos"> 67</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos"> 68</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cube_geometry.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 69</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#/modsim_package/cubit/cube_geometry.py&quot;</span><span class="p">],</span>
<span class="linenos"> 70</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos"> 71</span>    <span class="p">)</span>
<span class="linenos"> 72</span><span class="p">)</span>
<span class="linenos"> 73</span>
<span class="linenos"> 74</span><span class="c1"># Partition</span>
<span class="linenos"> 75</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos"> 76</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos"> 77</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cube_partition.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 78</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#/modsim_package/cubit/cube_partition.py&quot;</span><span class="p">,</span> <span class="s2">&quot;cube_geometry.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 79</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos"> 80</span>    <span class="p">)</span>
<span class="linenos"> 81</span><span class="p">)</span>
<span class="linenos"> 82</span>
<span class="linenos"> 83</span><span class="c1"># Mesh</span>
<span class="linenos"> 84</span><span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abaqus&quot;</span><span class="p">:</span>
<span class="linenos"> 85</span>    <span class="n">mesh_extension</span> <span class="o">=</span> <span class="s2">&quot;inp&quot;</span>
<span class="linenos"> 86</span><span class="k">elif</span> <span class="n">solver</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;sierra&quot;</span><span class="p">,</span> <span class="s2">&quot;adagio&quot;</span><span class="p">]:</span>
<span class="linenos"> 87</span>    <span class="n">mesh_extension</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span>
<span class="linenos"> 88</span><span class="k">else</span><span class="p">:</span>
<span class="linenos"> 89</span>    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown solver &#39;</span><span class="si">{</span><span class="n">solver</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 90</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos"> 91</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos"> 92</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cube_mesh.</span><span class="si">{</span><span class="n">mesh_extension</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;cube_mesh.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 93</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#/modsim_package/cubit/cube_mesh.py&quot;</span><span class="p">,</span> <span class="s2">&quot;cube_partition.cub&quot;</span><span class="p">],</span>
<span class="linenos"> 94</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;--element-type $</span><span class="si">{element_type}</span><span class="s2"> --solver $</span><span class="si">{solver}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="linenos"> 95</span>        <span class="n">element_type</span><span class="o">=</span><span class="n">element_type</span><span class="p">,</span>
<span class="linenos"> 96</span>        <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
<span class="linenos"> 97</span>    <span class="p">)</span>
<span class="linenos"> 98</span><span class="p">)</span>
<span class="linenos"> 99</span>
<span class="linenos">100</span><span class="c1"># Collector alias based on parent directory name</span>
<span class="linenos">101</span><span class="n">env</span><span class="o">.</span><span class="n">Alias</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">workflow_name</span><span class="si">}</span><span class="s2">_cubit&quot;</span><span class="p">,</span> <span class="n">workflow</span><span class="p">)</span>
<span class="linenos">102</span>
<span class="linenos">103</span><span class="k">if</span> <span class="ow">not</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;unconditional_build&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;CUBIT_PROGRAM&quot;</span><span class="p">]:</span>
<span class="linenos">104</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Program &#39;cubit&#39; was not found in construction environment. Ignoring &#39;</span><span class="si">{</span><span class="n">workflow_name</span><span class="si">}</span><span class="s2">&#39; target(s)&quot;</span><span class="p">)</span>
<span class="linenos">105</span>    <span class="n">Ignore</span><span class="p">([</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">workflow_name</span><span class="p">],</span> <span class="n">workflow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-waves-tutorials-tutorial-cubit-fierro-scons admonition">
<p class="admonition-title">waves-tutorials/tutorial_cubit/fierro.scons</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#! /usr/bin/env python</span>
<span class="linenos"> 2</span><span class="sd">&quot;&quot;&quot;Rectangle compression workflow: Fierro solve.</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="sd">Requires the following ``SConscript(..., exports={})``</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="sd">* ``env`` - The SCons construction environment with the following required keys</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="sd">  * ``unconditional_build`` - Boolean flag to force building of conditionally ignored targets</span>
<span class="linenos"> 9</span><span class="sd">  * ``cubit`` - String path for the Cubit executable</span>
<span class="linenos">10</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1"># Inherit the parent construction environment</span>
<span class="linenos">15</span><span class="n">Import</span><span class="p">(</span><span class="s2">&quot;env&quot;</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="c1"># Simulation variables</span>
<span class="linenos">18</span><span class="n">build_directory</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">Dir</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">abspath</span><span class="p">)</span>
<span class="linenos">19</span><span class="n">workflow_name</span> <span class="o">=</span> <span class="n">build_directory</span><span class="o">.</span><span class="n">name</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="c1"># Collect the target nodes to build a concise alias for all targets</span>
<span class="linenos">22</span><span class="n">workflow</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="n">element_type</span> <span class="o">=</span> <span class="s2">&quot;HEX&quot;</span>
<span class="linenos">25</span><span class="n">solver</span> <span class="o">=</span> <span class="s2">&quot;sierra&quot;</span>
<span class="linenos">26</span><span class="n">SConscript</span><span class="p">(</span><span class="s2">&quot;cubit.scons&quot;</span><span class="p">,</span> <span class="n">exports</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;env&quot;</span><span class="p">:</span> <span class="n">env</span><span class="p">,</span> <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="n">element_type</span><span class="p">,</span> <span class="s2">&quot;solver&quot;</span><span class="p">:</span> <span class="n">solver</span><span class="p">},</span> <span class="n">duplicate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="c1"># Convert mesh file type for Fierro</span>
<span class="linenos">29</span><span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos">30</span>    <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cube_mesh.vtk&quot;</span><span class="p">],</span>
<span class="linenos">31</span>    <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#/modsim_package/fierro/convert_to_vtk2ascii.py&quot;</span><span class="p">,</span> <span class="s2">&quot;cube_mesh.g&quot;</span><span class="p">],</span>
<span class="linenos">32</span>    <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;--input-format=exodus $</span><span class="si">{SOURCES[1].abspath}</span><span class="s2"> $</span><span class="si">{TARGET.abspath}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="linenos">33</span><span class="p">)</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="c1"># SolverPrep</span>
<span class="linenos">36</span><span class="n">fierro_source_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#/modsim_package/fierro/cube_compression.yaml&quot;</span><span class="p">]</span>
<span class="linenos">37</span><span class="n">fierro_source_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">source_file</span><span class="p">)</span> <span class="k">for</span> <span class="n">source_file</span> <span class="ow">in</span> <span class="n">fierro_source_list</span><span class="p">]</span>
<span class="linenos">38</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">CopySubstfile</span><span class="p">(</span><span class="n">fierro_source_list</span><span class="p">))</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="c1"># Fierro Solve</span>
<span class="linenos">41</span><span class="n">solve_source_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">source_file</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">source_file</span> <span class="ow">in</span> <span class="n">fierro_source_list</span><span class="p">]</span>
<span class="linenos">42</span><span class="n">solve_source_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;cube_mesh.vtk&quot;</span><span class="p">)</span>
<span class="linenos">43</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos">44</span>    <span class="n">env</span><span class="o">.</span><span class="n">FierroImplicit</span><span class="p">(</span>
<span class="linenos">45</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cube_compression.stdout&quot;</span><span class="p">,</span> <span class="s2">&quot;TecplotTO0.dat&quot;</span><span class="p">,</span> <span class="s2">&quot;TecplotTO_undeformed0.dat&quot;</span><span class="p">],</span>
<span class="linenos">46</span>        <span class="n">source</span><span class="o">=</span><span class="n">solve_source_list</span><span class="p">,</span>
<span class="linenos">47</span>    <span class="p">)</span>
<span class="linenos">48</span><span class="p">)</span>
<span class="linenos">49</span>
<span class="linenos">50</span><span class="c1"># Collector alias based on parent directory name</span>
<span class="linenos">51</span><span class="n">env</span><span class="o">.</span><span class="n">Alias</span><span class="p">(</span><span class="n">workflow_name</span><span class="p">,</span> <span class="n">workflow</span><span class="p">)</span>
<span class="linenos">52</span>
<span class="linenos">53</span><span class="k">if</span> <span class="ow">not</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;unconditional_build&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;FIERRO_IMPLICIT_PROGRAM&quot;</span><span class="p">]:</span>
<span class="linenos">54</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Program &#39;fierro&#39; was not found in construction environment. Ignoring &#39;</span><span class="si">{</span><span class="n">workflow_name</span><span class="si">}</span><span class="s2">&#39; target(s)&quot;</span><span class="p">)</span>
<span class="linenos">55</span>    <span class="n">Ignore</span><span class="p">([</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">workflow_name</span><span class="p">],</span> <span class="n">workflow</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="cubit-journal-files">
<h2>Cubit Journal Files<a class="headerlink" href="#cubit-journal-files" title="Link to this heading">#</a></h2>
<p>Unlike <a class="reference internal" href="tutorial_cubit_abaqus.html#tutorial-cubit-abaqus"><span class="std std-ref">Tutorial: Cubit+Abaqus</span></a> and <a class="reference internal" href="tutorial_cubit_sierra.html#tutorial-cubit-sierra"><span class="std std-ref">Tutorial: Cubit+Sierra</span></a>, this tutorial creates a 3D cube geometry. The
<a class="reference external" href="https://lanl.github.io/Fierro/index.html">Fierro</a> implicit solver works best with 3D geometries and meshes. The 3D geometry, mesh, and simulation match the
uniaxial compression boundary conditions of the 2D simulation as closely as possible with the <a class="reference external" href="https://lanl.github.io/Fierro/index.html">Fierro</a> boundary
conditions.</p>
<ol class="arabic simple" start="7">
<li><p>Review the following journal files in the <code class="docutils literal notranslate"><span class="pre">waves-tutorials/modsim_package/cubit</span></code> directory.</p></li>
</ol>
<p>The Cubit journal files include a similar CLI to the Abaqus journal files introduced in <a class="reference internal" href="tutorial_02_partition_mesh.html#tutorial-partition-mesh"><span class="std std-ref">Tutorial 02: Partition and Mesh</span></a>
files. Besides the differences in Abaqus and Cubit commands, the major difference between the Abaqus and Cubit journal
files is the opportunity to use Python 3 with Cubit, where Abaqus journal files must use the Abaqus controlled
installation of Python 2. The API and CLI built from the Cubit journal files’ docstrings may be found in the
<a class="reference internal" href="tutorial_api.html#waves-tutorial-api"><span class="std std-ref">WAVES-TUTORIAL API</span></a> for <a class="reference internal" href="tutorial_api.html#cubit-journal-api"><span class="std std-ref">cubit</span></a> and the <a class="reference internal" href="tutorial_cli.html#waves-tutorial-cli"><span class="std std-ref">WAVES-TUTORIAL CLI</span></a> for <a class="reference internal" href="tutorial_cli.html#cubit-journal-cli"><span class="std std-ref">cubit</span></a>,
respectively.</p>
<div class="admonition-waves-tutorials-tutorial-cubit-modsim-package-cubit-cube-geometry-py admonition">
<p class="admonition-title">waves-tutorials/tutorial_cubit/modsim_package/cubit/cube_geometry.py</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="sd">&quot;&quot;&quot;Create a simple cube geometry.&quot;&quot;&quot;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="linenos"> 5</span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">import</span><span class="w"> </span><span class="nn">cubit</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">output_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">11</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a simple cube geometry.</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="sd">    This script creates a simple Cubit model with a single cube part.</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="sd">    :param str output_file: The output file for the Cubit model. Will be stripped of the extension and ``.cub`` will be</span>
<span class="linenos">16</span><span class="sd">        used.</span>
<span class="linenos">17</span><span class="sd">    :param float width: The cube width (X-axis)</span>
<span class="linenos">18</span><span class="sd">    :param float height: The cube height (Y-axis)</span>
<span class="linenos">19</span><span class="sd">    :param float depth: The cube depth (Z-axis)</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="sd">    :returns: writes ``output_file``.cub</span>
<span class="linenos">22</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">23</span>    <span class="n">output_file</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span>
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">init</span><span class="p">([</span><span class="s2">&quot;cubit&quot;</span><span class="p">,</span> <span class="s2">&quot;-noecho&quot;</span><span class="p">,</span> <span class="s2">&quot;-nojournal&quot;</span><span class="p">,</span> <span class="s2">&quot;-nographics&quot;</span><span class="p">,</span> <span class="s2">&quot;-batch&quot;</span><span class="p">])</span>
<span class="linenos">26</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
<span class="linenos">27</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;reset&quot;</span><span class="p">)</span>
<span class="linenos">28</span>
<span class="linenos">29</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;brick x </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> y </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2"> z </span><span class="si">{</span><span class="n">depth</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">30</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;move volume 1 x </span><span class="si">{</span><span class="n">width</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2"> y </span><span class="si">{</span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2"> z </span><span class="si">{</span><span class="n">depth</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2"> include_merged&quot;</span><span class="p">)</span>
<span class="linenos">31</span>
<span class="linenos">32</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;save as &#39;</span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&#39; overwrite&quot;</span><span class="p">)</span>
<span class="linenos">33</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="k">def</span><span class="w"> </span><span class="nf">get_parser</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
<span class="linenos">36</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the command-line interface parser.&quot;&quot;&quot;</span>
<span class="linenos">37</span>    <span class="n">script_name</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="linenos">38</span>    <span class="c1"># Set default parameter values</span>
<span class="linenos">39</span>    <span class="n">default_output_file</span> <span class="o">=</span> <span class="n">script_name</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="linenos">40</span>    <span class="n">default_width</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos">41</span>    <span class="n">default_height</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos">42</span>    <span class="n">default_depth</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos">43</span>
<span class="linenos">44</span>    <span class="n">prog</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;python </span><span class="si">{</span><span class="n">script_name</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
<span class="linenos">45</span>    <span class="n">cli_description</span> <span class="o">=</span> <span class="s2">&quot;Create a simple cube geometry and write an ``output_file``.cub Cubit model file.&quot;</span>
<span class="linenos">46</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">cli_description</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="n">prog</span><span class="p">)</span>
<span class="linenos">47</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">48</span>        <span class="s2">&quot;--output-file&quot;</span><span class="p">,</span>
<span class="linenos">49</span>        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos">50</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_output_file</span><span class="p">,</span>
<span class="linenos">51</span>        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
<span class="linenos">52</span>            <span class="s2">&quot;The output file for the Cubit model. &quot;</span>
<span class="linenos">53</span>            <span class="s2">&quot;Will be stripped of the extension and ``.cub`` will be used, e.g. ``output_file``.cub &quot;</span>
<span class="linenos">54</span>            <span class="s2">&quot;(default: </span><span class="si">%(default)s</span><span class="s2">&quot;</span>
<span class="linenos">55</span>        <span class="p">),</span>
<span class="linenos">56</span>    <span class="p">)</span>
<span class="linenos">57</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">58</span>        <span class="s2">&quot;--width&quot;</span><span class="p">,</span>
<span class="linenos">59</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="linenos">60</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_width</span><span class="p">,</span>
<span class="linenos">61</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The cube width (X-axis)&quot;</span><span class="p">,</span>
<span class="linenos">62</span>    <span class="p">)</span>
<span class="linenos">63</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">64</span>        <span class="s2">&quot;--height&quot;</span><span class="p">,</span>
<span class="linenos">65</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="linenos">66</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_height</span><span class="p">,</span>
<span class="linenos">67</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The cube height (Y-axis)&quot;</span><span class="p">,</span>
<span class="linenos">68</span>    <span class="p">)</span>
<span class="linenos">69</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">70</span>        <span class="s2">&quot;--depth&quot;</span><span class="p">,</span>
<span class="linenos">71</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="linenos">72</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_depth</span><span class="p">,</span>
<span class="linenos">73</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The cube depth (Z-axis)&quot;</span><span class="p">,</span>
<span class="linenos">74</span>    <span class="p">)</span>
<span class="linenos">75</span>    <span class="k">return</span> <span class="n">parser</span>
<span class="linenos">76</span>
<span class="linenos">77</span>
<span class="linenos">78</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">79</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">get_parser</span><span class="p">()</span>
<span class="linenos">80</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">81</span>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
<span class="linenos">82</span>        <span class="n">main</span><span class="p">(</span>
<span class="linenos">83</span>            <span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
<span class="linenos">84</span>            <span class="n">width</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
<span class="linenos">85</span>            <span class="n">height</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
<span class="linenos">86</span>            <span class="n">depth</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span>
<span class="linenos">87</span>        <span class="p">)</span>
<span class="linenos">88</span>    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-waves-tutorials-tutorial-cubit-modsim-package-cubit-cube-partition-py admonition">
<p class="admonition-title">waves-tutorials/tutorial_cubit/modsim_package/cubit/cube_partition.py</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="sd">&quot;&quot;&quot;Partition the simple cube geometry created by ``cube_geometry.py``.&quot;&quot;&quot;</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="linenos">  4</span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="linenos">  5</span><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="linenos">  6</span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="kn">import</span><span class="w"> </span><span class="nn">cubit</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">input_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">output_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 12</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Partition the simple cube geometry created by ``cube_geometry.py``.</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="sd">    This script partitions a simple Cubit model with a single cube part.</span>
<span class="linenos"> 15</span>
<span class="linenos"> 16</span><span class="sd">    **Feature labels:**</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span><span class="sd">    * ``top``: +Y surface</span>
<span class="linenos"> 19</span><span class="sd">    * ``bottom``: -Y surface</span>
<span class="linenos"> 20</span><span class="sd">    * ``left``: -X surface</span>
<span class="linenos"> 21</span><span class="sd">    * ``right``: +X surface</span>
<span class="linenos"> 22</span><span class="sd">    * ``front``: +Z surface</span>
<span class="linenos"> 23</span><span class="sd">    * ``back``: -Z surface</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="sd">    :param str input_file: The Cubit model file created by ``cube_geometry.py``. Will be stripped of the extension</span>
<span class="linenos"> 26</span><span class="sd">        and ``.cub`` will be used.</span>
<span class="linenos"> 27</span><span class="sd">    :param str output_file: The output file for the Cubit model. Will be stripped of the extension and ``.cub`` will be</span>
<span class="linenos"> 28</span><span class="sd">        used.</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span><span class="sd">    :returns: writes ``output_file``.cub</span>
<span class="linenos"> 31</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 32</span>    <span class="n">input_file</span> <span class="o">=</span> <span class="n">input_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span>
<span class="linenos"> 33</span>    <span class="n">output_file</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span>    <span class="c1"># Avoid modifying the contents or timestamp on the input file.</span>
<span class="linenos"> 36</span>    <span class="c1"># Required to get conditional re-builds with a build system such as GNU Make, CMake, or SCons</span>
<span class="linenos"> 37</span>    <span class="k">if</span> <span class="n">input_file</span> <span class="o">!=</span> <span class="n">output_file</span><span class="p">:</span>
<span class="linenos"> 38</span>        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">init</span><span class="p">([</span><span class="s2">&quot;cubit&quot;</span><span class="p">,</span> <span class="s2">&quot;-noecho&quot;</span><span class="p">,</span> <span class="s2">&quot;-nojournal&quot;</span><span class="p">,</span> <span class="s2">&quot;-nographics&quot;</span><span class="p">,</span> <span class="s2">&quot;-batch&quot;</span><span class="p">])</span>
<span class="linenos"> 41</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
<span class="linenos"> 42</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;reset&quot;</span><span class="p">)</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;open &#39;</span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 1 add surface 5&quot;</span><span class="p">)</span>
<span class="linenos"> 47</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 1 name &#39;top&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 48</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 1 add surface 5&quot;</span><span class="p">)</span>
<span class="linenos"> 49</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 1 name &#39;top&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 50</span>
<span class="linenos"> 51</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 2 add surface 3&quot;</span><span class="p">)</span>
<span class="linenos"> 52</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 2 name &#39;bottom&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 53</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 2 add surface 3&quot;</span><span class="p">)</span>
<span class="linenos"> 54</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 2 name &#39;bottom&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 55</span>
<span class="linenos"> 56</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 3 add surface 4&quot;</span><span class="p">)</span>
<span class="linenos"> 57</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 3 name &#39;left&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 58</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 3 add surface 4&quot;</span><span class="p">)</span>
<span class="linenos"> 59</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 3 name &#39;left&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 4 add surface 6&quot;</span><span class="p">)</span>
<span class="linenos"> 62</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 4 name &#39;right&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 63</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 4 add surface 6&quot;</span><span class="p">)</span>
<span class="linenos"> 64</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 4 name &#39;right&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 65</span>
<span class="linenos"> 66</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 5 add surface 1&quot;</span><span class="p">)</span>
<span class="linenos"> 67</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 5 name &#39;front&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 68</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 5 add surface 1&quot;</span><span class="p">)</span>
<span class="linenos"> 69</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 5 name &#39;front&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 70</span>
<span class="linenos"> 71</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 6 add surface 2&quot;</span><span class="p">)</span>
<span class="linenos"> 72</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 6 name &#39;back&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 73</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 6 add surface 2&quot;</span><span class="p">)</span>
<span class="linenos"> 74</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;sideset 6 name &#39;back&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 75</span>
<span class="linenos"> 76</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;save as &#39;</span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&#39; overwrite&quot;</span><span class="p">)</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span>
<span class="linenos"> 79</span><span class="k">def</span><span class="w"> </span><span class="nf">get_parser</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
<span class="linenos"> 80</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the command-line interface parser.&quot;&quot;&quot;</span>
<span class="linenos"> 81</span>    <span class="n">script_name</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="linenos"> 82</span>    <span class="c1"># Set default parameter values</span>
<span class="linenos"> 83</span>    <span class="n">default_input_file</span> <span class="o">=</span> <span class="n">script_name</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_partition&quot;</span><span class="p">,</span> <span class="s2">&quot;_geometry&quot;</span><span class="p">)</span>
<span class="linenos"> 84</span>    <span class="n">default_output_file</span> <span class="o">=</span> <span class="n">script_name</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="linenos"> 85</span>
<span class="linenos"> 86</span>    <span class="n">prog</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;python </span><span class="si">{</span><span class="n">script_name</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
<span class="linenos"> 87</span>    <span class="n">cli_description</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 88</span>        <span class="s2">&quot;Partition the simple cube geometry created by ``cube_geometry.py`` &quot;</span>
<span class="linenos"> 89</span>        <span class="s2">&quot;and write an ``output_file``.cub Cubit model file.&quot;</span>
<span class="linenos"> 90</span>    <span class="p">)</span>
<span class="linenos"> 91</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">cli_description</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="n">prog</span><span class="p">)</span>
<span class="linenos"> 92</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos"> 93</span>        <span class="s2">&quot;--input-file&quot;</span><span class="p">,</span>
<span class="linenos"> 94</span>        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos"> 95</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_input_file</span><span class="p">,</span>
<span class="linenos"> 96</span>        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
<span class="linenos"> 97</span>            <span class="s2">&quot;The Cubit model file created by ``cube_geometry.py``. &quot;</span>
<span class="linenos"> 98</span>            <span class="s2">&quot;Will be stripped of the extension and ``.cub`` will be used, e.g. ``input_file``.cub &quot;</span>
<span class="linenos"> 99</span>            <span class="s2">&quot;(default: </span><span class="si">%(default)s</span><span class="s2">&quot;</span>
<span class="linenos">100</span>        <span class="p">),</span>
<span class="linenos">101</span>    <span class="p">)</span>
<span class="linenos">102</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">103</span>        <span class="s2">&quot;--output-file&quot;</span><span class="p">,</span>
<span class="linenos">104</span>        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos">105</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_output_file</span><span class="p">,</span>
<span class="linenos">106</span>        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
<span class="linenos">107</span>            <span class="s2">&quot;The output file for the Cubit model. &quot;</span>
<span class="linenos">108</span>            <span class="s2">&quot;Will be stripped of the extension and ``.cub`` will be used, e.g. ``output_file``.cub &quot;</span>
<span class="linenos">109</span>            <span class="s2">&quot;(default: </span><span class="si">%(default)s</span><span class="s2">&quot;</span>
<span class="linenos">110</span>        <span class="p">),</span>
<span class="linenos">111</span>    <span class="p">)</span>
<span class="linenos">112</span>    <span class="k">return</span> <span class="n">parser</span>
<span class="linenos">113</span>
<span class="linenos">114</span>
<span class="linenos">115</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">116</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">get_parser</span><span class="p">()</span>
<span class="linenos">117</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">118</span>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
<span class="linenos">119</span>        <span class="n">main</span><span class="p">(</span>
<span class="linenos">120</span>            <span class="n">input_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_file</span><span class="p">,</span>
<span class="linenos">121</span>            <span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
<span class="linenos">122</span>        <span class="p">)</span>
<span class="linenos">123</span>    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-waves-tutorials-tutorial-cubit-modsim-package-cubit-cube-mesh-py admonition">
<p class="admonition-title">waves-tutorials/tutorial_cubit/modsim_package/cubit/cube_mesh.py</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="sd">&quot;&quot;&quot;Mesh the simple cube geometry partitioned by ``cube_partition.py``.&quot;&quot;&quot;</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="linenos">  4</span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="linenos">  5</span><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="linenos">  6</span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="kn">import</span><span class="w"> </span><span class="nn">cubit</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
<span class="linenos"> 12</span>    <span class="n">input_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos"> 13</span>    <span class="n">output_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos"> 14</span>    <span class="n">global_seed</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos"> 15</span>    <span class="n">element_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;QUAD&quot;</span><span class="p">,</span>
<span class="linenos"> 16</span>    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;abaqus&quot;</span><span class="p">,</span>
<span class="linenos"> 17</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 18</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Mesh the simple cube geometry partitioned by ``cube_partition.py``.</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span><span class="sd">    This script meshes a simple Cubit model with a single cube part.</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="sd">    **Feature labels:**</span>
<span class="linenos"> 23</span>
<span class="linenos"> 24</span><span class="sd">    * ``NODES`` - all part nodes</span>
<span class="linenos"> 25</span><span class="sd">    * ``ELEMENTS`` - all part elements</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span><span class="sd">    :param str input_file: The Cubit model file created by ``cube_partition.py``. Will be stripped of the extension</span>
<span class="linenos"> 28</span><span class="sd">        and ``.cub`` will be used.</span>
<span class="linenos"> 29</span><span class="sd">    :param str output_file: The output file for the Cubit model. Will be stripped of the extension and ``.cub`` and</span>
<span class="linenos"> 30</span><span class="sd">        ``.inp`` will be used for the model and orphan mesh output files, respectively.</span>
<span class="linenos"> 31</span><span class="sd">    :param float global_seed: The global mesh seed size</span>
<span class="linenos"> 32</span><span class="sd">    :param str element_type: The model element type. Must be a supported Cubit 4 node element type.</span>
<span class="linenos"> 33</span><span class="sd">    :param str solver: The solver type to use when exporting the mesh</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span><span class="sd">    :returns: writes ``output_file``.cub and ``output_file``.inp</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="sd">    :raises RuntimeError: If the solver is not supported</span>
<span class="linenos"> 38</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 39</span>    <span class="n">input_file</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span>
<span class="linenos"> 40</span>    <span class="n">output_file</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span>
<span class="linenos"> 41</span>    <span class="n">abaqus_mesh_file</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.inp&quot;</span><span class="p">)</span>
<span class="linenos"> 42</span>    <span class="n">sierra_mesh_file</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.g&quot;</span><span class="p">)</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span>    <span class="c1"># Avoid modifying the contents or timestamp on the input file.</span>
<span class="linenos"> 45</span>    <span class="c1"># Required to get conditional re-builds with a build system such as GNU Make, CMake, or SCons</span>
<span class="linenos"> 46</span>    <span class="k">if</span> <span class="n">input_file</span> <span class="o">!=</span> <span class="n">output_file</span><span class="p">:</span>
<span class="linenos"> 47</span>        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">init</span><span class="p">([</span><span class="s2">&quot;cubit&quot;</span><span class="p">,</span> <span class="s2">&quot;-noecho&quot;</span><span class="p">,</span> <span class="s2">&quot;-nojournal&quot;</span><span class="p">,</span> <span class="s2">&quot;-nographics&quot;</span><span class="p">,</span> <span class="s2">&quot;-batch&quot;</span><span class="p">])</span>
<span class="linenos"> 50</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
<span class="linenos"> 51</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;reset&quot;</span><span class="p">)</span>
<span class="linenos"> 52</span>
<span class="linenos"> 53</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;open &#39;</span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;volume 1 size </span><span class="si">{</span><span class="n">global_seed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos"> 56</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;mesh volume 1&quot;</span><span class="p">)</span>
<span class="linenos"> 57</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;set duplicate block elements off&quot;</span><span class="p">)</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 9 add volume 1&quot;</span><span class="p">)</span>
<span class="linenos"> 60</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;nodeset 9 name &#39;NODES&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 61</span>
<span class="linenos"> 62</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">&quot;block 1 add volume 1&quot;</span><span class="p">)</span>
<span class="linenos"> 63</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;block 1 name &#39;ELEMENTS&#39; Element type </span><span class="si">{</span><span class="n">element_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos"> 64</span>
<span class="linenos"> 65</span>    <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;save as &#39;</span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&#39; overwrite&quot;</span><span class="p">)</span>
<span class="linenos"> 66</span>
<span class="linenos"> 67</span>    <span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abaqus&quot;</span><span class="p">:</span>
<span class="linenos"> 68</span>        <span class="c1"># Export Abaqus orphan mesh for Abaqus workflow</span>
<span class="linenos"> 69</span>        <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;export abaqus &#39;</span><span class="si">{</span><span class="n">abaqus_mesh_file</span><span class="si">}</span><span class="s2">&#39; partial dimension 2 block 1 overwrite everything&quot;</span><span class="p">)</span>
<span class="linenos"> 70</span>    <span class="k">elif</span> <span class="n">solver</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;sierra&quot;</span><span class="p">,</span> <span class="s2">&quot;adagio&quot;</span><span class="p">]:</span>
<span class="linenos"> 71</span>        <span class="c1"># Export Genesis file for Sierra workflow</span>
<span class="linenos"> 72</span>        <span class="n">cubit</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;export mesh &#39;</span><span class="si">{</span><span class="n">sierra_mesh_file</span><span class="si">}</span><span class="s2">&#39; overwrite&quot;</span><span class="p">)</span>
<span class="linenos"> 73</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 74</span>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uknown solver &#39;</span><span class="si">{</span><span class="n">solver</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="linenos"> 75</span>
<span class="linenos"> 76</span>
<span class="linenos"> 77</span><span class="k">def</span><span class="w"> </span><span class="nf">get_parser</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
<span class="linenos"> 78</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the command-line interface parser.&quot;&quot;&quot;</span>
<span class="linenos"> 79</span>    <span class="n">script_name</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="linenos"> 80</span>    <span class="c1"># Set default parameter values</span>
<span class="linenos"> 81</span>    <span class="n">default_input_file</span> <span class="o">=</span> <span class="n">script_name</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_mesh&quot;</span><span class="p">,</span> <span class="s2">&quot;_partition&quot;</span><span class="p">)</span>
<span class="linenos"> 82</span>    <span class="n">default_output_file</span> <span class="o">=</span> <span class="n">script_name</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.cub&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="linenos"> 83</span>    <span class="n">default_global_seed</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 84</span>    <span class="n">default_element_type</span> <span class="o">=</span> <span class="s2">&quot;HEX&quot;</span>
<span class="linenos"> 85</span>    <span class="n">default_solver</span> <span class="o">=</span> <span class="s2">&quot;abaqus&quot;</span>
<span class="linenos"> 86</span>
<span class="linenos"> 87</span>    <span class="n">prog</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;python </span><span class="si">{</span><span class="n">script_name</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
<span class="linenos"> 88</span>    <span class="n">cli_description</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 89</span>        <span class="s2">&quot;Mesh the simple cube geometry partitioned by ``cube_partition.py`` &quot;</span>
<span class="linenos"> 90</span>        <span class="s2">&quot;and write an ``output_file``.cub Cubit model file and ``output_file``.inp orphan mesh file.&quot;</span>
<span class="linenos"> 91</span>    <span class="p">)</span>
<span class="linenos"> 92</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">cli_description</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="n">prog</span><span class="p">)</span>
<span class="linenos"> 93</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos"> 94</span>        <span class="s2">&quot;--input-file&quot;</span><span class="p">,</span>
<span class="linenos"> 95</span>        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos"> 96</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_input_file</span><span class="p">,</span>
<span class="linenos"> 97</span>        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
<span class="linenos"> 98</span>            <span class="s2">&quot;The Cubit model file created by ``cube_partition.py``. &quot;</span>
<span class="linenos"> 99</span>            <span class="s2">&quot;Will be stripped of the extension and ``.cub`` will be used, e.g. ``input_file``.cub &quot;</span>
<span class="linenos">100</span>            <span class="s2">&quot;(default: </span><span class="si">%(default)s</span><span class="s2">&quot;</span>
<span class="linenos">101</span>        <span class="p">),</span>
<span class="linenos">102</span>    <span class="p">)</span>
<span class="linenos">103</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">104</span>        <span class="s2">&quot;--output-file&quot;</span><span class="p">,</span>
<span class="linenos">105</span>        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos">106</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_output_file</span><span class="p">,</span>
<span class="linenos">107</span>        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
<span class="linenos">108</span>            <span class="s2">&quot;The output file for the Cubit model. &quot;</span>
<span class="linenos">109</span>            <span class="s2">&quot;Will be stripped of the extension and ``.cub`` will be used, e.g. ``output_file``.cub&quot;</span>
<span class="linenos">110</span>        <span class="p">),</span>
<span class="linenos">111</span>    <span class="p">)</span>
<span class="linenos">112</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">113</span>        <span class="s2">&quot;--global-seed&quot;</span><span class="p">,</span>
<span class="linenos">114</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="linenos">115</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_global_seed</span><span class="p">,</span>
<span class="linenos">116</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The global mesh seed size (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="linenos">117</span>    <span class="p">)</span>
<span class="linenos">118</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">119</span>        <span class="s2">&quot;--element-type&quot;</span><span class="p">,</span>
<span class="linenos">120</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<span class="linenos">121</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_element_type</span><span class="p">,</span>
<span class="linenos">122</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The model element type. Must be a supported Cubit 4 node element type. (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="linenos">123</span>    <span class="p">)</span>
<span class="linenos">124</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">125</span>        <span class="s2">&quot;--solver&quot;</span><span class="p">,</span>
<span class="linenos">126</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<span class="linenos">127</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_solver</span><span class="p">,</span>
<span class="linenos">128</span>        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;abaqus&quot;</span><span class="p">,</span> <span class="s2">&quot;sierra&quot;</span><span class="p">,</span> <span class="s2">&quot;adagio&quot;</span><span class="p">],</span>
<span class="linenos">129</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The target solver for the mesh file. (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="linenos">130</span>    <span class="p">)</span>
<span class="linenos">131</span>
<span class="linenos">132</span>    <span class="k">return</span> <span class="n">parser</span>
<span class="linenos">133</span>
<span class="linenos">134</span>
<span class="linenos">135</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">136</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">get_parser</span><span class="p">()</span>
<span class="linenos">137</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">138</span>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
<span class="linenos">139</span>        <span class="n">main</span><span class="p">(</span>
<span class="linenos">140</span>            <span class="n">input_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_file</span><span class="p">,</span>
<span class="linenos">141</span>            <span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
<span class="linenos">142</span>            <span class="n">global_seed</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">global_seed</span><span class="p">,</span>
<span class="linenos">143</span>            <span class="n">element_type</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span>
<span class="linenos">144</span>            <span class="n">solver</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">solver</span><span class="p">,</span>
<span class="linenos">145</span>        <span class="p">)</span>
<span class="linenos">146</span>    <span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="python-script">
<h2>Python Script<a class="headerlink" href="#python-script" title="Link to this heading">#</a></h2>
<p>Fierro doesn’t read Sierra formatted (Genesis/Exodus) meshes natively. We need to convert from the Cubit Genesis mesh to
an older <a class="reference external" href="https://vtk.org/">vtk</a> ASCII text mesh file with <a class="reference external" href="https://github.com/nschloe/meshio">meshio</a>. The <a class="reference external" href="https://lanl.github.io/Fierro/index.html">Fierro</a> development team provided a draft conversion script
that has been updated here to use a similar CLI to <a class="reference external" href="https://github.com/nschloe/meshio">meshio</a>.</p>
<div class="admonition-waves-tutorials-tutorial-cubit-modsim-package-fierro-convert-to-vtk2ascii-py admonition">
<p class="admonition-title">waves-tutorials/tutorial_cubit/modsim_package/fierro/convert_to_vtk2ascii.py</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="sd">&quot;&quot;&quot;Convert VTK mesh files to the older VTK ASCII version 2 files required by Fierro.&quot;&quot;&quot;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kn">import</span><span class="w"> </span><span class="nn">meshio</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">def</span><span class="w"> </span><span class="nf">get_parser</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
<span class="linenos">10</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the command-line interface parser.&quot;&quot;&quot;</span>
<span class="linenos">11</span>    <span class="n">cli_description</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos">12</span>        <span class="s2">&quot;Convert mesh files to older VTK ASCII version 2 mesh files required by Fierro with MeshIO API. &quot;</span>
<span class="linenos">13</span>        <span class="s2">&quot;This output is not supported by the MeshIO CLI and must be constructed manually.&quot;</span>
<span class="linenos">14</span>    <span class="p">)</span>
<span class="linenos">15</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">cli_description</span><span class="p">)</span>
<span class="linenos">16</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">17</span>        <span class="s2">&quot;infile&quot;</span><span class="p">,</span>
<span class="linenos">18</span>        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos">19</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Input file to convert&quot;</span><span class="p">,</span>
<span class="linenos">20</span>    <span class="p">)</span>
<span class="linenos">21</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">22</span>        <span class="s2">&quot;outfile&quot;</span><span class="p">,</span>
<span class="linenos">23</span>        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos">24</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output file to write&quot;</span><span class="p">,</span>
<span class="linenos">25</span>    <span class="p">)</span>
<span class="linenos">26</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">27</span>        <span class="s2">&quot;-i&quot;</span><span class="p">,</span>
<span class="linenos">28</span>        <span class="s2">&quot;--input-format&quot;</span><span class="p">,</span>
<span class="linenos">29</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<span class="linenos">30</span>        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="linenos">31</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Explicit input file format (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="linenos">32</span>    <span class="p">)</span>
<span class="linenos">33</span>    <span class="k">return</span> <span class="n">parser</span>
<span class="linenos">34</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">37</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert VTK mesh files to the older VTK ASCII version 2 files required by Fierro.&quot;&quot;&quot;</span>
<span class="linenos">38</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">get_parser</span><span class="p">()</span>
<span class="linenos">39</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">40</span>
<span class="linenos">41</span>    <span class="n">infile</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">infile</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<span class="linenos">42</span>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_format</span><span class="p">)</span>
<span class="linenos">43</span>
<span class="linenos">44</span>    <span class="c1"># Ensure input mesh structure meets Fierro criteria</span>
<span class="linenos">45</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">46</span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;More than one kind of cell type present&quot;</span><span class="p">)</span>
<span class="linenos">47</span>    <span class="k">if</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">48</span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input file is 1D, only 2D/3D work&quot;</span><span class="p">)</span>
<span class="linenos">49</span>    <span class="k">if</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="s2">&quot;hexahedron&quot;</span> <span class="ow">and</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="s2">&quot;quad&quot;</span><span class="p">:</span>
<span class="linenos">50</span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cell type is not quad/hexahedron&quot;</span><span class="p">)</span>
<span class="linenos">51</span>
<span class="linenos">52</span>    <span class="n">points</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">points</span>
<span class="linenos">53</span>    <span class="n">npoints</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">54</span>
<span class="linenos">55</span>    <span class="n">ndim</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dim</span>
<span class="linenos">56</span>    <span class="n">cells</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="linenos">57</span>    <span class="n">ncells</span> <span class="o">=</span> <span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">58</span>    <span class="n">pts_per_cell</span> <span class="o">=</span> <span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">59</span>
<span class="linenos">60</span>    <span class="n">outfile</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">outfile</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<span class="linenos">61</span>    <span class="k">with</span> <span class="n">outfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mesh_out</span><span class="p">:</span>
<span class="linenos">62</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;# vtk DataFile Version 2.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">63</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;meshio converted to Fierro VTK</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">64</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ASCII</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">65</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;DATASET UNSTRUCTURED_GRID</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">66</span>        <span class="c1"># Write points</span>
<span class="linenos">67</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;POINTS </span><span class="si">{</span><span class="n">npoints</span><span class="si">}</span><span class="s2"> double</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">68</span>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npoints</span><span class="p">):</span>
<span class="linenos">69</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
<span class="linenos">70</span>                <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">points</span><span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
<span class="linenos">71</span>            <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">72</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">73</span>
<span class="linenos">74</span>        <span class="c1"># Write cells</span>
<span class="linenos">75</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CELLS </span><span class="si">{</span><span class="n">ncells</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">ncells</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pts_per_cell</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ncells</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">76</span>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncells</span><span class="p">):</span>
<span class="linenos">77</span>            <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pts_per_cell</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
<span class="linenos">78</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pts_per_cell</span><span class="p">):</span>
<span class="linenos">79</span>                <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cells</span><span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
<span class="linenos">80</span>            <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">81</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">82</span>        <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CELL_TYPES </span><span class="si">{</span><span class="n">ncells</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">83</span>        <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos">84</span>            <span class="k">for</span> <span class="n">_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncells</span><span class="p">):</span>
<span class="linenos">85</span>                <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;9</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">86</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">87</span>            <span class="k">for</span> <span class="n">_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncells</span><span class="p">):</span>
<span class="linenos">88</span>                <span class="n">mesh_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;12</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">89</span>
<span class="linenos">90</span>
<span class="linenos">91</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">92</span>    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="fierro-input-file-s">
<h2>Fierro Input File(s)<a class="headerlink" href="#fierro-input-file-s" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="8">
<li><p>Create or review the <a class="reference external" href="https://lanl.github.io/Fierro/index.html">Fierro</a> input file from the contents below</p></li>
</ol>
<div class="admonition-waves-tutorials-tutorial-cubit-fierro-modsim-package-fierro-cube-compression-yaml admonition">
<p class="admonition-title">waves-tutorials/tutorial_cubit_fierro/modsim_package/fierro/cube_compression.yaml</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">num_dims</span><span class="p">:</span> <span class="mi">3</span>
<span class="linenos"> 2</span><span class="n">input_options</span><span class="p">:</span>
<span class="linenos"> 3</span>    <span class="n">mesh_file_format</span><span class="p">:</span> <span class="n">vtk</span>
<span class="linenos"> 4</span>    <span class="n">mesh_file_name</span><span class="p">:</span> <span class="n">cube_mesh</span><span class="o">.</span><span class="n">vtk</span>
<span class="linenos"> 5</span>    <span class="n">element_type</span><span class="p">:</span> <span class="n">hex8</span>
<span class="linenos"> 6</span>    <span class="n">zero_index_base</span><span class="p">:</span> <span class="n">true</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">output_options</span><span class="p">:</span>
<span class="linenos"> 9</span>  <span class="n">output_fields</span><span class="p">:</span>
<span class="linenos">10</span>    <span class="o">-</span> <span class="n">displacement</span>
<span class="linenos">11</span>    <span class="o">-</span> <span class="n">strain</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="n">materials</span><span class="p">:</span>
<span class="linenos">14</span>  <span class="o">-</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">0</span>
<span class="linenos">15</span>    <span class="n">elastic_modulus</span><span class="p">:</span> <span class="mi">100</span>
<span class="linenos">16</span>    <span class="n">poisson_ratio</span><span class="p">:</span> <span class="mf">0.3</span>
<span class="linenos">17</span>    <span class="n">density</span><span class="p">:</span> <span class="mf">0.27000e-08</span>
<span class="linenos">18</span>    <span class="n">initial_temperature</span><span class="p">:</span> <span class="mi">293</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="n">fea_module_parameters</span><span class="p">:</span>
<span class="linenos">21</span>  <span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">Elasticity</span>
<span class="linenos">22</span>    <span class="n">material_id</span><span class="p">:</span> <span class="mi">0</span>
<span class="linenos">23</span>    <span class="n">boundary_conditions</span><span class="p">:</span>
<span class="linenos">24</span>      <span class="o">-</span> <span class="n">surface</span><span class="p">:</span>
<span class="linenos">25</span>          <span class="nb">type</span><span class="p">:</span> <span class="n">y_plane</span>
<span class="linenos">26</span>          <span class="c1"># TODO: replace with element set &quot;bottom&quot;</span>
<span class="linenos">27</span>          <span class="n">plane_position</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="linenos">28</span>        <span class="nb">type</span><span class="p">:</span> <span class="n">displacement</span>
<span class="linenos">29</span>        <span class="n">value</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="linenos">30</span>
<span class="linenos">31</span>      <span class="o">-</span> <span class="n">surface</span><span class="p">:</span>
<span class="linenos">32</span>          <span class="nb">type</span><span class="p">:</span> <span class="n">y_plane</span>
<span class="linenos">33</span>          <span class="c1"># TODO: replace with element set &quot;top&quot;, or at least the &quot;height&quot; parameter</span>
<span class="linenos">34</span>          <span class="n">plane_position</span><span class="p">:</span> <span class="mf">1.0</span>
<span class="linenos">35</span>        <span class="nb">type</span><span class="p">:</span> <span class="n">displacement</span>
<span class="linenos">36</span>        <span class="c1"># TODO: replace with &quot;displacement&quot; parameter</span>
<span class="linenos">37</span>        <span class="n">value</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.01</span>
</pre></div>
</div>
</div>
</section>
<section id="sconstruct">
<h2>SConstruct<a class="headerlink" href="#sconstruct" title="Link to this heading">#</a></h2>
<p>Note that Fierro differs from other solvers in the tutorials. Fierro is deployed as a Conda package and is available in
the launching Conda environment. It is still good practice to check if the executable is available and provide helpful
feedback to developers about the excutable status and workflow configuration.</p>
<p>The structure has changed enough from the core tutorials that a diff view is not as useful. Instead the contents of the
SConstruct file is duplicated below.</p>
<div class="admonition-waves-tutorials-tutorial-cubit-sconstruct admonition">
<p class="admonition-title">waves-tutorials/tutorial_cubit/SConstruct</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;Configure the WAVES Cubit+Abaqus/Fierro/Sierra tutorial.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">waves</span>

<span class="c1"># Comments used in tutorial code snippets: marker-1</span>

<span class="c1"># Accept command line options with fall back default values</span>
<span class="n">AddOption</span><span class="p">(</span>
    <span class="s2">&quot;--build-dir&quot;</span><span class="p">,</span>
    <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;variant_dir_base&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="s2">&quot;build&quot;</span><span class="p">,</span>
    <span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span>
    <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;DIR&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;SCons build (variant) root directory. Relative or absolute path. (default: &#39;</span><span class="si">%d</span><span class="s2">efault&#39;)&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">AddOption</span><span class="p">(</span>
    <span class="s2">&quot;--unconditional-build&quot;</span><span class="p">,</span>
    <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;unconditional_build&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Boolean flag to force building of conditionally ignored targets. (default: &#39;</span><span class="si">%d</span><span class="s2">efault&#39;)&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">AddOption</span><span class="p">(</span>
    <span class="s2">&quot;--print-build-failures&quot;</span><span class="p">,</span>
    <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;print_build_failures&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print task *.stdout target file(s) on build failures. (default: &#39;</span><span class="si">%d</span><span class="s2">efault&#39;)&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Python optparse appends to the default list instead of overriding. Must implement default/override ourselves.</span>
<span class="n">default_abaqus_commands</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;/apps/abaqus/Commands/abq2024&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/usr/projects/ea/abaqus/Commands/abq2024&quot;</span><span class="p">,</span>
    <span class="s2">&quot;abq2024&quot;</span><span class="p">,</span>
    <span class="s2">&quot;abaqus&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">AddOption</span><span class="p">(</span>
    <span class="s2">&quot;--abaqus-command&quot;</span><span class="p">,</span>
    <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;abaqus_command&quot;</span><span class="p">,</span>
    <span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span>
    <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;COMMAND&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Override for the Abaqus command. Repeat to specify more than one (default: </span><span class="si">{</span><span class="n">default_abaqus_commands</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">default_cubit_commands</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;/apps/Cubit-16.12/cubit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/usr/projects/ea/Cubit/Cubit-16.12/cubit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cubit&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">AddOption</span><span class="p">(</span>
    <span class="s2">&quot;--cubit-command&quot;</span><span class="p">,</span>
    <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;cubit_command&quot;</span><span class="p">,</span>
    <span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span>
    <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;COMMAND&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Override for the Cubit command. Repeat to specify more than one (default: </span><span class="si">{</span><span class="n">default_cubit_commands</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Comments used in tutorial code snippets: marker-2</span>

<span class="c1"># Inherit user&#39;s full environment and set project variables</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">waves</span><span class="o">.</span><span class="n">scons_extensions</span><span class="o">.</span><span class="n">WAVESEnvironment</span><span class="p">(</span>
    <span class="n">ENV</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
    <span class="n">variant_dir_base</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">GetOption</span><span class="p">(</span><span class="s2">&quot;variant_dir_base&quot;</span><span class="p">)),</span>
    <span class="n">unconditional_build</span><span class="o">=</span><span class="n">GetOption</span><span class="p">(</span><span class="s2">&quot;unconditional_build&quot;</span><span class="p">),</span>
    <span class="n">print_build_failures</span><span class="o">=</span><span class="n">GetOption</span><span class="p">(</span><span class="s2">&quot;print_build_failures&quot;</span><span class="p">),</span>
    <span class="n">abaqus_commands</span><span class="o">=</span><span class="n">GetOption</span><span class="p">(</span><span class="s2">&quot;abaqus_command&quot;</span><span class="p">),</span>
    <span class="n">cubit_commands</span><span class="o">=</span><span class="n">GetOption</span><span class="p">(</span><span class="s2">&quot;cubit_command&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Conditionally print failed task *.stdout files</span>
<span class="n">env</span><span class="o">.</span><span class="n">PrintBuildFailures</span><span class="p">(</span><span class="n">print_stdout</span><span class="o">=</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;print_build_failures&quot;</span><span class="p">])</span>

<span class="c1"># Comments used in tutorial code snippets: marker-3</span>

<span class="c1"># Find required programs for conditional target ignoring and absolute path for use in target actions</span>
<span class="n">env</span><span class="p">[</span><span class="s2">&quot;ABAQUS_PROGRAM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">AddProgram</span><span class="p">(</span>
    <span class="n">env</span><span class="p">[</span><span class="s2">&quot;abaqus_commands&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;abaqus_commands&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default_abaqus_commands</span>
<span class="p">)</span>
<span class="n">env</span><span class="p">[</span><span class="s2">&quot;CUBIT_PROGRAM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">AddCubit</span><span class="p">(</span>
    <span class="n">env</span><span class="p">[</span><span class="s2">&quot;cubit_commands&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;cubit_commands&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default_cubit_commands</span>
<span class="p">)</span>
<span class="n">env</span><span class="p">[</span><span class="s2">&quot;FIERRO_IMPLICIT_PROGRAM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">AddProgram</span><span class="p">([</span><span class="s2">&quot;fierro-parallel-implicit&quot;</span><span class="p">])</span>


<span class="c1"># Sierra requires a separate construction environment</span>
<span class="k">def</span><span class="w"> </span><span class="nf">return_modulepath</span><span class="p">(</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return parent path of first found module or the current working directory.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">next</span><span class="p">((</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">modules</span> <span class="k">if</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()),</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">())</span>


<span class="n">sierra_modules</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;/projects/aea_compute/modulefiles/sierra/5.21.6&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">sierra_modulefile_parent</span> <span class="o">=</span> <span class="n">return_modulepath</span><span class="p">(</span><span class="n">sierra_modules</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">env_sierra</span> <span class="o">=</span> <span class="n">waves</span><span class="o">.</span><span class="n">scons_extensions</span><span class="o">.</span><span class="n">shell_environment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;module use </span><span class="si">{</span><span class="n">sierra_modulefile_parent</span><span class="si">}</span><span class="s2"> &amp;&amp; module load sierra&quot;</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to initialize the Sierra environment&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="n">env_sierra</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">()</span>
<span class="n">env_sierra</span><span class="p">[</span><span class="s2">&quot;sierra&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">waves</span><span class="o">.</span><span class="n">scons_extensions</span><span class="o">.</span><span class="n">add_program</span><span class="p">(</span><span class="n">env_sierra</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;sierra&quot;</span><span class="p">])</span>

<span class="c1"># Comments used in tutorial code snippets: marker-4</span>

<span class="c1"># Set project internal variables and variable substitution dictionaries</span>
<span class="n">project_name</span> <span class="o">=</span> <span class="s2">&quot;WAVES-TUTORIAL&quot;</span>
<span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;0.1.0&quot;</span>
<span class="n">project_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">Dir</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">abspath</span><span class="p">)</span>
<span class="n">project_variables</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;project_name&quot;</span><span class="p">:</span> <span class="n">project_name</span><span class="p">,</span>
    <span class="s2">&quot;project_dir&quot;</span><span class="p">:</span> <span class="n">project_dir</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">project_variables</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">env</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

<span class="c1"># Comments used in tutorial code snippets: marker-5</span>

<span class="c1"># Add builders and pseudo-builders</span>
<span class="n">env</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">BUILDERS</span><span class="o">=</span><span class="p">{})</span>

<span class="n">env_sierra</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span>
    <span class="n">BUILDERS</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;Sierra&quot;</span><span class="p">:</span> <span class="n">waves</span><span class="o">.</span><span class="n">scons_extensions</span><span class="o">.</span><span class="n">sierra_builder_factory</span><span class="p">(</span><span class="n">program</span><span class="o">=</span><span class="n">env_sierra</span><span class="p">[</span><span class="s2">&quot;sierra&quot;</span><span class="p">]),</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Comments used in tutorial code snippets: marker-6</span>

<span class="c1"># Add simulation targets</span>
<span class="n">workflow_configurations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;abaqus.scons&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sierra.scons&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fierro.scons&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="k">for</span> <span class="n">workflow</span> <span class="ow">in</span> <span class="n">workflow_configurations</span><span class="p">:</span>
    <span class="n">build_dir</span> <span class="o">=</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;variant_dir_base&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">workflow</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span>
    <span class="n">SConscript</span><span class="p">(</span>
        <span class="n">workflow</span><span class="p">,</span>
        <span class="n">variant_dir</span><span class="o">=</span><span class="n">build_dir</span><span class="p">,</span>
        <span class="n">exports</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;env&quot;</span><span class="p">:</span> <span class="n">env</span><span class="p">,</span> <span class="s2">&quot;env_sierra&quot;</span><span class="p">:</span> <span class="n">env_sierra</span><span class="p">},</span>
        <span class="n">duplicate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># Comments used in tutorial code snippets: marker-7</span>

<span class="c1"># Add default target list to help message</span>
<span class="n">env</span><span class="o">.</span><span class="n">Default</span><span class="p">()</span>  <span class="c1"># Empty defaults list to avoid building all simulation targets by default</span>
<span class="c1"># Add aliases to help message so users know what build target options are available</span>
<span class="c1"># This must come *after* all expected Alias definitions and SConscript files.</span>
<span class="n">env</span><span class="o">.</span><span class="n">ProjectHelp</span><span class="p">()</span>

<span class="c1"># Comments used in tutorial code snippets: marker-8</span>
</pre></div>
</div>
</div>
</section>
<section id="build-targets">
<h2>Build Targets<a class="headerlink" href="#build-targets" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="9">
<li><p>Build the new targets</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/path/to/waves-tutorials/tutorial_cubit
$<span class="w"> </span>scons<span class="w"> </span>fierro
scons:<span class="w"> </span>Reading<span class="w"> </span>SConscript<span class="w"> </span>files<span class="w"> </span>...
Checking<span class="w"> </span>whether<span class="w"> </span>/apps/abaqus/Commands/abq2024<span class="w"> </span>program<span class="w"> </span>exists.../apps/abaqus/Commands/abq2024
Checking<span class="w"> </span>whether<span class="w"> </span>abq2024<span class="w"> </span>program<span class="w"> </span>exists...no
Checking<span class="w"> </span>whether<span class="w"> </span>/apps/Cubit-16.12/cubit<span class="w"> </span>program<span class="w"> </span>exists.../apps/Cubit-16.12/cubit
Checking<span class="w"> </span>whether<span class="w"> </span>cubit<span class="w"> </span>program<span class="w"> </span>exists...no
Checking<span class="w"> </span>whether<span class="w"> </span>fierro-parallel-implicit<span class="w"> </span>program<span class="w"> </span>exists.../projects/aea_compute/waves-env/bin/fierro-parallel-implicit
Sourcing<span class="w"> </span>the<span class="w"> </span>shell<span class="w"> </span>environment<span class="w"> </span>with<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="s1">&#39;module use /projects/aea_compute/modulefiles &amp;&amp; module load sierra&#39;</span><span class="w"> </span>...
Checking<span class="w"> </span>whether<span class="w"> </span>sierra<span class="w"> </span>program<span class="w"> </span>exists.../projects/sierra/sierra5193/install/tools/sntools/engine/sierra
scons:<span class="w"> </span><span class="k">done</span><span class="w"> </span>reading<span class="w"> </span>SConscript<span class="w"> </span>files.
scons:<span class="w"> </span>Building<span class="w"> </span>targets<span class="w"> </span>...
Copy<span class="o">(</span><span class="s2">&quot;build/fierro/cube_compression.yaml&quot;</span>,<span class="w"> </span><span class="s2">&quot;modsim_package/fierro/cube_compression.yaml&quot;</span><span class="o">)</span>
Copy<span class="o">(</span><span class="s2">&quot;build/fierro/elasticity3D.xml&quot;</span>,<span class="w"> </span><span class="s2">&quot;modsim_package/fierro/elasticity3D.xml&quot;</span><span class="o">)</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python
/home/roppenheimer/waves-tutorials/tutorial_cubit/modsim_package/cubit/cube_geometry.py<span class="w"> </span>&gt;
/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro/cube_geometry.cub.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python
/home/roppenheimer/waves-tutorials/tutorial_cubit/modsim_package/cubit/cube_partition.py<span class="w"> </span>&gt;
/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro/cube_partition.cub.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python
/home/roppenheimer/waves-tutorials/tutorial_cubit/modsim_package/cubit/cube_mesh.py<span class="w"> </span>--element-type<span class="w"> </span>HEX
--solver<span class="w"> </span>sierra<span class="w"> </span>&gt;<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro/cube_mesh.g.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python
/home/roppenheimer/waves-tutorials/tutorial_cubit/modsim_package/fierro/convert_to_vtk2ascii.py
--input-format<span class="o">=</span>exodus<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro/cube_mesh.g
/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro/cube_mesh.vtk<span class="w"> </span>&gt;
/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro/cube_mesh.vtk.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">1</span>
fierro-parallel-implicit
/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro/cube_compression.yaml<span class="w"> </span>&gt;
/home/roppenheimer/waves-tutorials/tutorial_cubit/build/fierro/cube_compression.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
scons:<span class="w"> </span><span class="k">done</span><span class="w"> </span>building<span class="w"> </span>targets.
</pre></div>
</div>
</section>
<section id="output-files">
<h2>Output Files<a class="headerlink" href="#output-files" title="Link to this heading">#</a></h2>
<p>Explore the contents of the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory using the <code class="docutils literal notranslate"><span class="pre">tree</span></code> command against the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory, as shown
below.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials/tutorial_cubit
$<span class="w"> </span>tree<span class="w"> </span>build/fierro/
build/fierro/
<span class="p">|</span>--<span class="w"> </span>TecplotTO0.dat
<span class="p">|</span>--<span class="w"> </span>TecplotTO_undeformed0.dat
<span class="p">|</span>--<span class="w"> </span>cube_compression.stdout
<span class="p">|</span>--<span class="w"> </span>cube_compression.yaml
<span class="p">|</span>--<span class="w"> </span>cube_geometry.cub
<span class="p">|</span>--<span class="w"> </span>cube_geometry.cub.stdout
<span class="p">|</span>--<span class="w"> </span>cube_mesh.cub
<span class="p">|</span>--<span class="w"> </span>cube_mesh.g
<span class="p">|</span>--<span class="w"> </span>cube_mesh.g.stdout
<span class="p">|</span>--<span class="w"> </span>cube_mesh.vtk
<span class="p">|</span>--<span class="w"> </span>cube_mesh.vtk.stdout
<span class="p">|</span>--<span class="w"> </span>cube_partition.cub
<span class="p">|</span>--<span class="w"> </span>cube_partition.cub.stdout
<span class="sb">`</span>--<span class="w"> </span>elasticity3D.xml

<span class="m">0</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">14</span><span class="w"> </span>files
</pre></div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial_cubit_sierra.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial: Cubit+Sierra</p>
      </div>
    </a>
    <a class="right-next"
       href="tutorial_escape_sequences.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorial: Escape Sequences</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment">Environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-structure">Directory Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconscript">SConscript</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cubit-journal-files">Cubit Journal Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-script">Python Script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fierro-input-file-s">Fierro Input File(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconstruct">SConstruct</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-targets">Build Targets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output Files</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kyle Brindley, Prabhu S. Khalsa, Thomas Roberts, Sergio Cordova, Matthew Fister, Chris Johnson, and Scott Ouellette
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025 Triad National Security, LLC. All Rights Reserved.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Oct 10, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>