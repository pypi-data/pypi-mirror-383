
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial: Sensitivity Study &#8212; WAVES 1.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=cb027bf8" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=cb027bf8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=423d4ce3"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=e639491b"></script>
    <script src="_static/custom.js?v=070b234d"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial_sensitivity_study';</script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial: Abaqus CAE" href="tutorial_abaqus_cae.html" />
    <link rel="prev" title="Tutorial: Part Image" href="tutorial_part_image.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Oct 10, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/waves_logo_brandmark_smaller.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/waves_logo_brandmark_smaller.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">1.0.1</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Computational Practices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="computational_practices_introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_version_control.html">Version Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_build_system.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_compute_environment.html">Compute Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_regression_testing.html">Regression Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_archival.html">Data Archival</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abstract.html">Why WAVES?</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_quickstart.html">Quickstart</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="waves_quickstart.html">Quickstart: Abaqus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_gmsh_calculix.html">Quickstart: Gmsh+CalculiX</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_introduction.html">Tutorial Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_core.html">Core Lessons</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_00_scons.html">Tutorial 00: SConstruct</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_01_geometry.html">Tutorial 01: Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_02_partition_mesh.html">Tutorial 02: Partition and Mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_03_solverprep.html">Tutorial 03: SolverPrep</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_04_simulation.html">Tutorial 04: Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_05_parameter_substitution.html">Tutorial 05: Parameter Substitution</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_06_include_files.html">Tutorial 06: Include Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_cartesian_product.html">Tutorial 07: Cartesian Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_08_data_extraction.html">Tutorial 08: Data Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_09_post_processing.html">Tutorial 09: Post-Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_10_unit_testing.html">Tutorial 10: Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_11_regression_testing.html">Tutorial 11: Regression Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_12_archival.html">Tutorial 12: Data Archival</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tutorial_supplemental.html">Supplemental Lessons</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scons_quickstart.html">SCons Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="scons_multiactiontask.html">SCons Multi-Action Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_argparse_types.html">Tutorial: Input Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cubit_abaqus.html">Tutorial: Cubit+Abaqus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cubit_sierra.html">Tutorial: Cubit+Sierra</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cubit_fierro.html">Tutorial: Cubit+Fierro</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_escape_sequences.html">Tutorial: Escape Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_latin_hypercube.html">Tutorial 07: Latin Hypercube</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_sobol_sequence.html">Tutorial 07: Sobol Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_one_at_a_time.html">Tutorial 07: One-at-a-Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_mesh_convergence.html">Tutorial: Mesh Convergence</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_part_image.html">Tutorial: Part Image</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tutorial: Sensitivity Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_abaqus_cae.html">Tutorial: Abaqus CAE</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_wip.html">Work-in-progress Lessons</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_writing_builders.html">Tutorial: Writing Builders</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_remote_execution.html">Tutorial: Simulation via SSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_sbatch.html">Tutorial: Simulation via SLURM</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_extend_study.html">Automatically Extending a Parameter Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_task_reuse.html">Tutorial: Task Definition Reuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_setuptools_scm.html">Tutorial: setuptools_scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_quinoa.html">Tutorial: Quinoa</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">ModSim Templates</a></li>

<li class="toctree-l1"><a class="reference internal" href="api.html">External API</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-Line Utilities</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Help and Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="license.html">LICENSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal_api.html">Internal API</a></li>
<li class="toctree-l1"><a class="reference internal" href="devops.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_philosophy.html">Release Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tutorial_api.html">WAVES-TUTORIAL API</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_cli.html">WAVES-TUTORIAL CLI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="tutorial_supplemental.html" class="nav-link">Supplemental Lessons</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Tutorial:...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lanl-aea/waves" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lanl-aea/waves/blob/main/docs/tutorial_sensitivity_study.rst?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/tutorial_sensitivity_study.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial: Sensitivity Study</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment">Environment</a><ul class="simple visible nav section-nav flex-column">
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-structure">Directory Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-study-file">Parameter Study File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconscript">SConscript</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-script">Post-processing script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconstruct">SConstruct</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-targets">Build Targets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output Files</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tutorial-sensitivity-study">
<span id="id1"></span><h1>Tutorial: Sensitivity Study<a class="headerlink" href="#tutorial-sensitivity-study" title="Link to this heading">#</a></h1>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.corrcoef.html">numpy.corrcoef</a> <span id="id2">[<a class="reference internal" href="zreferences.html#id59" title="NumPy Developers. NumPy documentation. 2022. URL: https://numpy.org/doc/stable/index.html (visited on 2024-03-21).">69</a>]</span></p></li>
<li><p><a class="reference external" href="https://salib.readthedocs.io/en/latest/api/SALib.analyze.html">SALib.analyze</a> <span id="id3">[<a class="reference internal" href="zreferences.html#id56" title="Jon Herman and Will Usher. SALib - sensitity analysis library in python. 2024. URL: https://salib.readthedocs.io/en/latest/ (visited on 2024-03-21).">70</a>]</span></p></li>
<li><p><a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.pairplot.html">seaborn.pairplot</a> <span id="id4">[<a class="reference internal" href="zreferences.html#id58" title="Michael Waskom. Seaborn: statistical data visualization. 2024. URL: https://seaborn.pydata.org/index.html (visited on 2024-03-21).">71</a>]</span></p></li>
</ul>
</section>
<section id="environment">
<h2>Environment<a class="headerlink" href="#environment" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://scons.org/">SCons</a> and <a class="reference external" href="https://lanl-aea.github.io/waves/index.html">WAVES</a> can be installed in a <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a> environment with the <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a> package manager. See the <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.html">Conda
installation</a> and <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">Conda environment management</a> documentation for more details about using <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The SALib and numpy versions may not need to be this strict for most tutorials. However,
<a class="reference internal" href="#tutorial-sensitivity-study"><span class="std std-ref">Tutorial: Sensitivity Study</span></a> uncovered some undocumented SALib version sensitivity to numpy surrounding the
numpy v2 rollout.</p>
</div>
<ol class="arabic">
<li><p>Create the tutorials environment if it doesn’t exist</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="OS" data-sync-id="bash" for="sd-tab-item-0">
Linux/MacOS</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda create --name waves-tutorial-env --channel conda-forge waves &#39;scons&gt;=4.6&#39; matplotlib pandas pyyaml xarray seaborn &#39;numpy&gt;=2&#39; &#39;salib&gt;=1.5.1&#39; pytest
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="OS" data-sync-id="powershell" for="sd-tab-item-1">
Windows</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span> <span class="o">&gt;</span> <span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">waves</span><span class="o">-</span><span class="n">tutorial</span><span class="o">-</span><span class="n">env</span> <span class="o">--</span><span class="n">channel</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">waves</span> <span class="n">scons</span> <span class="n">matplotlib</span> <span class="n">pandas</span> <span class="n">pyyaml</span> <span class="n">xarray</span> <span class="n">seaborn</span> <span class="n">numpy</span> <span class="n">salib</span> <span class="n">pytest</span>
</pre></div>
</div>
</div>
</div>
</li>
<li><p>Activate the environment</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="OS" data-sync-id="bash" for="sd-tab-item-2">
Linux/MacOS</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda activate waves-tutorial-env
</pre></div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="OS" data-sync-id="powershell" for="sd-tab-item-3">
Windows</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span> <span class="o">&gt;</span> <span class="n">conda</span> <span class="n">activate</span> <span class="n">waves</span><span class="o">-</span><span class="n">tutorial</span><span class="o">-</span><span class="n">env</span>
</pre></div>
</div>
</div>
</div>
</li>
</ol>
<p>Some tutorials require additional third-party software that is not available for the <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a> package manager. This
software must be installed separately and either made available to SConstruct by modifying your system’s <code class="docutils literal notranslate"><span class="pre">PATH</span></code> or by
modifying the SConstruct search paths provided to the <a class="reference internal" href="api.html#waves.scons_extensions.add_program" title="waves.scons_extensions.add_program"><code class="xref py py-meth docutils literal notranslate"><span class="pre">waves.scons_extensions.add_program()</span></code></a> method.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>STOP! Before continuing, check that the documentation version matches your installed package version.</p>
<ol class="arabic simple">
<li><p>You can find the documentation version in the upper-left corner of the webpage.</p></li>
<li><p>You can find the installed WAVES version with <code class="docutils literal notranslate"><span class="pre">waves</span> <span class="pre">--version</span></code>.</p></li>
</ol>
<p>If they don’t match, you can launch identically matched documentation with the <a class="reference internal" href="cli.html#waves-cli"><span class="std std-ref">WAVES Command-Line Utility</span></a>
<a class="reference internal" href="cli.html#waves-docs-cli"><span class="std std-ref">docs</span></a> subcommand as <code class="docutils literal notranslate"><span class="pre">waves</span> <span class="pre">docs</span></code>.</p>
</div>
</section>
<section id="directory-structure">
<h2>Directory Structure<a class="headerlink" href="#directory-structure" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="3">
<li><p>Create and change to a new project root directory to house the tutorial files if you have not already done so. For example</p></li>
</ol>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="OS" data-sync-id="bash" for="sd-tab-item-4">
Linux/MacOS</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>~/waves-tutorials
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/waves-tutorials
$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
</pre></div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="OS" data-sync-id="powershell" for="sd-tab-item-5">
Windows</label><div class="sd-tab-content docutils">
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">New-Item</span> <span class="nv">$HOME</span><span class="p">\</span><span class="n">waves-tutorials</span> <span class="n">-ItemType</span> <span class="s2">&quot;Directory&quot;</span>
<span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">Set-Location</span> <span class="nv">$HOME</span><span class="p">\</span><span class="n">waves-tutorials</span>
<span class="nb">PS </span><span class="p">&gt;</span> <span class="nb">Get-Location</span>

<span class="n">Path</span>
<span class="p">----</span>
<span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">roppenheimer</span><span class="p">\</span><span class="n">waves-tutorials</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you skipped any of the previous tutorials, run the following commands to create a copy of the necessary tutorial
files.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
$<span class="w"> </span>waves<span class="w"> </span>fetch<span class="w"> </span>--overwrite<span class="w"> </span>--tutorial<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mv<span class="w"> </span>tutorial_12_archival_SConstruct<span class="w"> </span>SConstruct
WAVES<span class="w"> </span>fetch
Destination<span class="w"> </span>directory:<span class="w"> </span><span class="s1">&#39;/home/roppenheimer/waves-tutorials&#39;</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="4">
<li><p>Download and copy the <code class="docutils literal notranslate"><span class="pre">tutorial_12_archival.scons</span></code> file to a new file named <code class="docutils literal notranslate"><span class="pre">tutorial_sensitivity_study.scons</span></code> with the
<a class="reference internal" href="cli.html#waves-cli"><span class="std std-ref">WAVES Command-Line Utility</span></a> <a class="reference internal" href="cli.html#waves-fetch-cli"><span class="std std-ref">fetch</span></a> subcommand.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
$<span class="w"> </span>waves<span class="w"> </span>fetch<span class="w"> </span>--overwrite<span class="w"> </span>tutorials/tutorial_12_archival.scons<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cp<span class="w"> </span>tutorial_12_archival.scons<span class="w"> </span>tutorial_sensitivity_study.scons
WAVES<span class="w"> </span>fetch
Destination<span class="w"> </span>directory:<span class="w"> </span><span class="s1">&#39;/home/roppenheimer/waves-tutorials&#39;</span>
</pre></div>
</div>
</section>
<section id="parameter-study-file">
<h2>Parameter Study File<a class="headerlink" href="#parameter-study-file" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="5">
<li><p>Create a new file <code class="docutils literal notranslate"><span class="pre">modsim_package/python/rectangle_compression_sensitivity_study.py</span></code> from the content below.</p></li>
</ol>
<div class="admonition-waves-tutorials-modsim-package-python-rectangle-compression-sensitivity-study-py admonition">
<p class="admonition-title">waves-tutorials/modsim_package/python/rectangle_compression_sensitivity_study.py</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Parameter sets and schemas for the rectangle compression simulation.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>


<span class="k">def</span><span class="w"> </span><span class="nf">parameter_schema</span><span class="p">(</span>
    <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
    <span class="n">width_distribution</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
    <span class="n">width_bounds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="n">height_distribution</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;norm&quot;</span><span class="p">,</span>
    <span class="n">height_bounds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return WAVES SALibSampler Sobol schema.</span>

<span class="sd">    :param N: Number of samples to generate</span>
<span class="sd">    :param width_distribution: SALib distribution name</span>
<span class="sd">    :param width_bounds: Distribution characteristics. Meaning varies depending on distribution type.</span>
<span class="sd">    :param height_distribution: SALib distribution name</span>
<span class="sd">    :param height_bounds: Distribution characteristics. Meaning varies depending on distribution type.</span>

<span class="sd">    :returns: WAVES SALibSampler Sobol schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="n">N</span><span class="p">,</span>
        <span class="s2">&quot;problem&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;num_vars&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">],</span>
            <span class="s2">&quot;bounds&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">width_bounds</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">height_bounds</span><span class="p">)],</span>
            <span class="s2">&quot;dists&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">width_distribution</span><span class="p">,</span> <span class="n">height_distribution</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">schema</span>
</pre></div>
</div>
</div>
<p>This file should look similar to the parameter study file in <a class="reference internal" href="tutorial_07_sobol_sequence.html#tutorial-sobol-sequence"><span class="std std-ref">Tutorial 07: Sobol Sequence</span></a>; however, this tutorial uses
the SALib <span id="id5">[<a class="reference internal" href="zreferences.html#id56" title="Jon Herman and Will Usher. SALib - sensitity analysis library in python. 2024. URL: https://salib.readthedocs.io/en/latest/ (visited on 2024-03-21).">70</a>]</span> based parameter generator <a class="reference internal" href="api.html#waves.parameter_generators.SALibSampler" title="waves.parameter_generators.SALibSampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">waves.parameter_generators.SALibSampler()</span></code></a> instead of the SciPy
<span id="id6">[<a class="reference internal" href="zreferences.html#id57" title="SciPy Contributors. SciPy. 2024. URL: https://scipy.org/ (visited on 2024-03-21).">72</a>]</span> based parameter generator <a class="reference internal" href="api.html#waves.parameter_generators.SobolSequence" title="waves.parameter_generators.SobolSequence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">waves.parameter_generators.SobolSequence()</span></code></a>. Both SALib and SciPy are good
packages for generating samples and post-processing data, but this tutorial will use SALib for the sensitivity analysis
post-processing workflow so the tutorial will generate samples with the matching package. It is not always necessary to
match the sample generator to the sensitivity analysis tools, but some analysis solutions are sensitive to the sample
generation algorithm. Readers are encouraged to review both packages to match the sample generation and analysis
strategy to their needs.</p>
</section>
<section id="sconscript">
<h2>SConscript<a class="headerlink" href="#sconscript" title="Link to this heading">#</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">diff</span></code> against the <code class="docutils literal notranslate"><span class="pre">tutorial_12_archival.scons</span></code> file from <a class="reference internal" href="tutorial_12_archival.html#tutorial-archival"><span class="std std-ref">Tutorial 12: Data Archival</span></a> is included below to help identify
the changes made in this tutorial.</p>
<div class="admonition-waves-tutorials-tutorial-sensitivity-study-scons admonition">
<p class="admonition-title">waves-tutorials/tutorial_sensitivity_study.scons</p>
<div class="highlight-udiff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- /home/runner/work/waves/waves/build/docs/tutorials_tutorial_12_archival.scons</span>
<span class="gi">+++ /home/runner/work/waves/waves/build/docs/tutorials_tutorial_sensitivity_study.scons</span>
<span class="gu">@@ -17,7 +17,7 @@</span>
<span class="w"> </span>
<span class="w"> </span>import waves
<span class="w"> </span>
<span class="gd">-from modsim_package.python.rectangle_compression_cartesian_product import parameter_schema</span>
<span class="gi">+from modsim_package.python.rectangle_compression_sensitivity_study import parameter_schema</span>
<span class="w"> </span>
<span class="w"> </span># Inherit the parent construction environment
<span class="w"> </span>Import(&quot;env&quot;)
<span class="gu">@@ -27,8 +27,16 @@</span>
<span class="w"> </span># Simulation variables
<span class="w"> </span>build_directory = pathlib.Path(Dir(&quot;.&quot;).abspath)
<span class="w"> </span>workflow_name = build_directory.name
<span class="gd">-workflow_configuration = [env[&quot;project_configuration&quot;], f&quot;{workflow_name}.scons&quot;]</span>
<span class="gi">+workflow_configuration = [env[&quot;project_configuration&quot;], workflow_name]</span>
<span class="w"> </span>parameter_study_file = build_directory / &quot;parameter_study.h5&quot;
<span class="gi">+simulation_constants = {</span>
<span class="gi">+    &quot;global_seed&quot;: 1,</span>
<span class="gi">+    &quot;displacement&quot;: -0.01,</span>
<span class="gi">+}</span>
<span class="gi">+kwargs = {</span>
<span class="gi">+    &quot;seed&quot;: 42,</span>
<span class="gi">+    &quot;calc_second_order&quot;: False,</span>
<span class="gi">+}</span>
<span class="w"> </span>
<span class="w"> </span># Collect the target nodes to build a concise alias for all targets
<span class="w"> </span>workflow = []
<span class="gu">@@ -36,11 +44,13 @@</span>
<span class="w"> </span>
<span class="w"> </span># Comment used in tutorial code snippets: marker-2
<span class="w"> </span>
<span class="gd">-# Parameter Study with Cartesian Product</span>
<span class="gd">-parameter_generator = waves.parameter_generators.CartesianProduct(</span>
<span class="gi">+# Parameter Study with SALib Sobol sequence sampler</span>
<span class="gi">+parameter_generator = waves.parameter_generators.SALibSampler(</span>
<span class="gi">+    &quot;sobol&quot;,</span>
<span class="w"> </span>    parameter_schema(),
<span class="w"> </span>    output_file=parameter_study_file,
<span class="w"> </span>    previous_parameter_study=parameter_study_file,
<span class="gi">+    **kwargs,</span>
<span class="w"> </span>)
<span class="w"> </span>parameter_generator.write()
<span class="w"> </span>
<span class="gu">@@ -49,7 +59,7 @@</span>
<span class="w"> </span># Parameterized targets must live inside current simulation_variables for loop
<span class="w"> </span>for set_name, parameters in parameter_generator.parameter_study_to_dict().items():
<span class="w"> </span>    set_path = pathlib.Path(set_name)
<span class="gd">-    simulation_variables = parameters</span>
<span class="gi">+    simulation_variables = {**parameters, **simulation_constants}</span>
<span class="w"> </span>
<span class="w"> </span>    # Comment used in tutorial code snippets: marker-4
<span class="w"> </span>
<span class="gu">@@ -171,26 +181,13 @@</span>
<span class="w"> </span>    for set_name in parameter_generator.parameter_study_to_dict()
<span class="w"> </span>]
<span class="w"> </span>script_options = &quot;--input-file ${SOURCES[2:].abspath}&quot;
<span class="gd">-script_options += &quot; --output-file ${TARGET.file} --x-units mm/mm --y-units MPa&quot;</span>
<span class="gi">+script_options += &quot; --output-file ${TARGET.file}&quot;</span>
<span class="w"> </span>script_options += &quot; --parameter-study-file ${SOURCES[1].abspath}&quot;
<span class="w"> </span>workflow.extend(
<span class="w"> </span>    env.PythonScript(
<span class="gd">-        target=[&quot;stress_strain_comparison.pdf&quot;, &quot;stress_strain_comparison.csv&quot;],</span>
<span class="gd">-        source=[&quot;#/modsim_package/python/post_processing.py&quot;, parameter_study_file.name, *post_processing_source],</span>
<span class="gi">+        target=[&quot;sensitivity_study.pdf&quot;, &quot;sensitivity_study.csv&quot;, &quot;sensitivity_study.yaml&quot;],</span>
<span class="gi">+        source=[&quot;#/modsim_package/python/sensitivity_study.py&quot;, parameter_study_file.name, *post_processing_source],</span>
<span class="w"> </span>        subcommand_options=script_options,
<span class="gd">-    )</span>
<span class="gd">-)</span>
<span class="gd">-</span>
<span class="gd">-# Regression test</span>
<span class="gd">-workflow.extend(</span>
<span class="gd">-    env.PythonScript(</span>
<span class="gd">-        target=[&quot;regression.yaml&quot;],</span>
<span class="gd">-        source=[</span>
<span class="gd">-            &quot;#/modsim_package/python/regression.py&quot;,</span>
<span class="gd">-            &quot;stress_strain_comparison.csv&quot;,</span>
<span class="gd">-            &quot;#/modsim_package/python/rectangle_compression_cartesian_product.csv&quot;,</span>
<span class="gd">-        ],</span>
<span class="gd">-        subcommand_options=&quot;${SOURCES[1:].abspath} --output-file ${TARGET.abspath}&quot;,</span>
<span class="w"> </span>    )
<span class="w"> </span>)
<span class="w"> </span>
<span class="gu">@@ -206,15 +203,10 @@</span>
<span class="w"> </span>env.Alias(f&quot;{workflow_name}_datacheck&quot;, datacheck)
<span class="w"> </span>env.Alias(env[&quot;datacheck_alias&quot;], datacheck)
<span class="w"> </span>env.Alias(env[&quot;regression_alias&quot;], datacheck)
<span class="gd">-archive_alias = f&quot;{workflow_name}_archive&quot;</span>
<span class="gd">-env.Alias(archive_alias, archive_target)</span>
<span class="gi">+env.Alias(f&quot;{workflow_name}_archive&quot;, archive_target)</span>
<span class="w"> </span>
<span class="w"> </span>if not env[&quot;unconditional_build&quot;] and not env[&quot;ABAQUS_PROGRAM&quot;]:
<span class="gd">-    print(</span>
<span class="gd">-        &quot;Program &#39;abaqus&#39; was not found in construction environment.&quot;</span>
<span class="gd">-        f&quot; Ignoring &#39;{workflow_name}&#39; and &#39;{archive_alias}&#39; target(s)&quot;</span>
<span class="gd">-    )</span>
<span class="gi">+    print(f&quot;Program &#39;abaqus&#39; was not found in construction environment. Ignoring &#39;{workflow_name}&#39; target(s)&quot;)</span>
<span class="w"> </span>    Ignore([&quot;.&quot;, workflow_name], workflow)
<span class="gd">-    Ignore([&quot;.&quot;, archive_alias], archive_target)</span>
<span class="w"> </span>    Ignore([&quot;.&quot;, f&quot;{workflow_name}_datacheck&quot;], datacheck)
<span class="w"> </span>    Ignore([&quot;.&quot;, env[&quot;datacheck_alias&quot;], env[&quot;regression_alias&quot;]], datacheck)
</pre></div>
</div>
</div>
</section>
<section id="post-processing-script">
<h2>Post-processing script<a class="headerlink" href="#post-processing-script" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="6">
<li><p>In the <code class="docutils literal notranslate"><span class="pre">waves-tutorials/modsim_package/python</span></code> directory, create a file called <code class="docutils literal notranslate"><span class="pre">sensitivity_study.py</span></code> using the
contents below.</p></li>
</ol>
<div class="admonition-waves-tutorials-modsim-package-python-sensitivity-study-py admonition">
<p class="admonition-title">waves-tutorials/modsim_package/python/sensitivity_study.py</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;Example of catenating WAVES parameter study results and definition.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">SALib.analyze.delta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">waves.parameter_generators</span><span class="w"> </span><span class="kn">import</span> <span class="n">SET_COORDINATE_KEY</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">modsim_package.python.rectangle_compression_sensitivity_study</span><span class="w"> </span><span class="kn">import</span> <span class="n">parameter_schema</span>

<span class="n">default_selection_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;E values&quot;</span><span class="p">:</span> <span class="s2">&quot;E22&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S values&quot;</span><span class="p">:</span> <span class="s2">&quot;S22&quot;</span><span class="p">,</span>
    <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="s2">&quot;Step-1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s2">&quot;integration point&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">combine_data</span><span class="p">(</span>
    <span class="n">input_files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="n">group_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">concat_coord</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combine input data files into one dataset.</span>

<span class="sd">    :param input_files: list of path-like or file-like objects pointing to h5netcdf files</span>
<span class="sd">        containing Xarray Datasets</span>
<span class="sd">    :param group_path: The h5netcdf group path locating the Xarray Dataset in the input files.</span>
<span class="sd">    :param concat_coord: Name of dimension</span>

<span class="sd">    :returns: Combined data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span> <span class="k">for</span> <span class="n">input_file</span> <span class="ow">in</span> <span class="n">input_files</span><span class="p">]</span>
    <span class="n">data_generator</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">xarray</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group_path</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="n">concat_coord</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span>
    <span class="p">)</span>
    <span class="n">combined_data</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data_generator</span><span class="p">,</span> <span class="n">concat_coord</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;no_conflicts&quot;</span><span class="p">)</span>
    <span class="n">combined_data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">combined_data</span>


<span class="k">def</span><span class="w"> </span><span class="nf">merge_parameter_study</span><span class="p">(</span>
    <span class="n">parameter_study_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">combined_data</span><span class="p">:</span> <span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge parameter study to existing dataset.</span>

<span class="sd">    :param parameter_study_file: path-like or file-like object containing the parameter study dataset. Assumes the</span>
<span class="sd">        h5netcdf file contains only a single dataset at the root group path, .e.g. ``/``.</span>
<span class="sd">    :param combined_data: XArray Dataset that will be merged.</span>

<span class="sd">    :returns: Combined data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parameter_study</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">parameter_study_file</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;h5netcdf&quot;</span><span class="p">)</span>
    <span class="n">combined_data</span> <span class="o">=</span> <span class="n">combined_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">parameter_study</span><span class="p">)</span>
    <span class="n">parameter_study</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">combined_data</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
    <span class="n">input_files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">group_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">selection_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">parameter_study_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Catenate ``input_files`` datasets along the ``set_name`` dimension and plot selected data.</span>

<span class="sd">    Merges the parameter study results datasets with the parameter study definition dataset, where the parameter study</span>
<span class="sd">    dataset file is assumed to be written by a WAVES parameter generator.</span>

<span class="sd">    :param list input_files: list of path-like or file-like objects pointing to h5netcdf files containing Xarray</span>
<span class="sd">        Datasets</span>
<span class="sd">    :param str output_file: The correlation coefficients plot file name. Relative or absolute path.</span>
<span class="sd">    :param str group_path: The h5netcdf group path locating the Xarray Dataset in the input files.</span>
<span class="sd">    :param dict selection_dict: Dictionary to define the down selection of data to be plotted. Dictionary ``key: value``</span>
<span class="sd">        pairs must match the data variables and coordinates of the expected Xarray Dataset object.</span>
<span class="sd">    :param str parameter_study_file: path-like or file-like object containing the parameter study dataset. Assumes the</span>
<span class="sd">        h5netcdf file contains only a single dataset at the root group path, .e.g. ``/``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
    <span class="n">output_csv</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">)</span>
    <span class="n">output_yaml</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)</span>
    <span class="n">concat_coord</span> <span class="o">=</span> <span class="n">SET_COORDINATE_KEY</span>

    <span class="c1"># Build single dataset along the &quot;set_name&quot; dimension</span>
    <span class="n">combined_data</span> <span class="o">=</span> <span class="n">combine_data</span><span class="p">(</span><span class="n">input_files</span><span class="p">,</span> <span class="n">group_path</span><span class="p">,</span> <span class="n">concat_coord</span><span class="p">)</span>

    <span class="c1"># Merge WAVES parameter study if provided</span>
    <span class="n">combined_data</span> <span class="o">=</span> <span class="n">merge_parameter_study</span><span class="p">(</span><span class="n">parameter_study_file</span><span class="p">,</span> <span class="n">combined_data</span><span class="p">)</span>

    <span class="c1"># Correlation coefficients</span>
    <span class="n">correlation_data</span> <span class="o">=</span> <span class="n">combined_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">seaborn</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">correlation_data</span><span class="p">,</span> <span class="n">corner</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

    <span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">correlation_data</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">rowvar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">correlation_coefficients</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">correlation_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">correlation_data</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">)</span>
    <span class="n">correlation_coefficients</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_csv</span><span class="p">)</span>

    <span class="c1"># Sensitivity analysis</span>
    <span class="n">stress</span> <span class="o">=</span> <span class="n">combined_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">combined_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)[[</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">sensitivity</span> <span class="o">=</span> <span class="n">SALib</span><span class="o">.</span><span class="n">analyze</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">parameter_schema</span><span class="p">()[</span><span class="s2">&quot;problem&quot;</span><span class="p">],</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">stress</span><span class="p">)</span>
    <span class="n">sensitivity_yaml</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sensitivity</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">yaml_compatible_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yaml_compatible_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">sensitivity_yaml</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">yaml_compatible_value</span>
    <span class="k">with</span> <span class="n">output_yaml</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">safe_dump</span><span class="p">(</span><span class="n">sensitivity_yaml</span><span class="p">))</span>

    <span class="c1"># Clean up open files</span>
    <span class="n">combined_data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_parser</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return parser for CLI options.&quot;&quot;&quot;</span>
    <span class="n">script_name</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
    <span class="n">default_output_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_name</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
    <span class="n">default_group_path</span> <span class="o">=</span> <span class="s2">&quot;RECTANGLE/FieldOutputs/ALL_ELEMENTS&quot;</span>
    <span class="n">default_parameter_study_file</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">prog</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;python </span><span class="si">{</span><span class="n">script_name</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
    <span class="n">cli_description</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;Read Xarray Datasets and plot correlation coefficients as a function of parameter set name. &quot;</span>
        <span class="s2">&quot; Save to ``output_file``.&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">cli_description</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="n">prog</span><span class="p">)</span>
    <span class="n">required_named</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required named arguments&quot;</span><span class="p">)</span>
    <span class="n">required_named</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-i&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--input-file&quot;</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The Xarray Dataset file(s)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">required_named</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-p&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--parameter-study-file&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default_parameter_study_file</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;An optional h5 file with a WAVES parameter study Xarray Dataset (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--output-file&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default_output_file</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;The output file for the correlation coefficients plot with extension, &quot;</span>
            <span class="s2">&quot;e.g. ``output_file.pdf``. Extension must be supported by matplotlib. File stem is also &quot;</span>
            <span class="s2">&quot;used for the CSV table output, e.g. ``output_file.csv``, and sensitivity results, e.g. &quot;</span>
            <span class="s2">&quot;``output_file.yaml``. (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-g&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--group-path&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default_group_path</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The h5py group path to the dataset object (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-s&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--selection-dict&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;The YAML formatted dictionary file to define the down selection of data to be plotted. &quot;</span>
            <span class="s2">&quot;Dictionary key: value pairs must match the data variables and coordinates of the &quot;</span>
            <span class="s2">&quot;expected Xarray Dataset object. If no file is provided, the a default selection dict &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;will be used (default: </span><span class="si">{</span><span class="n">default_selection_dict</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">parser</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">get_parser</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">selection_dict</span><span class="p">:</span>
        <span class="n">selection_dict</span> <span class="o">=</span> <span class="n">default_selection_dict</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">args</span><span class="o">.</span><span class="n">selection_dict</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_yaml</span><span class="p">:</span>
            <span class="n">selection_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">input_yaml</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
        <span class="n">main</span><span class="p">(</span>
            <span class="n">input_files</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_file</span><span class="p">,</span>
            <span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
            <span class="n">group_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">group_path</span><span class="p">,</span>
            <span class="n">selection_dict</span><span class="o">=</span><span class="n">selection_dict</span><span class="p">,</span>
            <span class="n">parameter_study_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">parameter_study_file</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<p>This file should look similar to the <code class="docutils literal notranslate"><span class="pre">post_processing.py</span></code> file from <a class="reference internal" href="tutorial_09_post_processing.html#tutorial-post-processing"><span class="std std-ref">Tutorial 09: Post-Processing</span></a>. Unused functions
have been removed and the output has changed to reflect the sensitivity study operations. In practice, modsim projects
should move the shared functions of both post-processing scripts to a common utilities module.</p>
<p>Unlike <a class="reference internal" href="tutorial_09_post_processing.html#tutorial-post-processing"><span class="std std-ref">Tutorial 09: Post-Processing</span></a>, the sensitivity study script does require the parameter study file. It is not
possible to calculate the sensitivity of output variables to input variables without associating output files with their
parameter set. After merging the output datasets with the parameter study, the correlation coefficients can be plotted
with seaborn <span id="id7">[<a class="reference internal" href="zreferences.html#id58" title="Michael Waskom. Seaborn: statistical data visualization. 2024. URL: https://seaborn.pydata.org/index.html (visited on 2024-03-21).">71</a>]</span>. Numpy <span id="id8">[<a class="reference internal" href="zreferences.html#id59" title="NumPy Developers. NumPy documentation. 2022. URL: https://numpy.org/doc/stable/index.html (visited on 2024-03-21).">69</a>]</span> is used to perform a similar correlation coefficients calculation that
can be saved to a CSV file for further post-processing or regression testing as in <a class="reference internal" href="tutorial_11_regression_testing.html#tutorial-regression-testing"><span class="std std-ref">Tutorial 11: Regression Testing</span></a>.
Finally, SALib <span id="id9">[<a class="reference internal" href="zreferences.html#id56" title="Jon Herman and Will Usher. SALib - sensitity analysis library in python. 2024. URL: https://salib.readthedocs.io/en/latest/ (visited on 2024-03-21).">70</a>]</span> is used to perform a delta moment-independent analysis, which is compatible with all SALib
sampling techniques.</p>
<p>The value of processing output data into an Xarray <span id="id10">[<a class="reference internal" href="zreferences.html#id61" title="xarray Developers. Xarray documentation. 2022. URL: https://docs.xarray.dev/en/stable/ (visited on 2022-08-08).">46</a>]</span> dataset is evident here, where each new plotting
and analysis tool requires data in a slightly different form factor. For these tutorials, WAVES provides an extraction
utility to process simulation output data into an Xarray dataset. However, it is well worth the modsim owner’s time to
seek out or write similar data serialization utilities for all project numeric solvers. Beyond the ease of
post-processing, tightly coupled and named column data structures reduce the chances of post-processing errors during
data handling operations.</p>
<p>While the post-processing approach outlined in this tutorial gives users a starting point for performing all forms of
parameter studies (sensitivity, perturbation, uncertainty propagation, etc) the choice of input sampling tools,
parameter sampling ranges and distributions, and analysis tools is highly dependent on the needs of the project and the
characteristics of the input space and numerical solvers. Modsim project owners are encouraged to read the sampling and
analysis documentation closely and seek advice from statistics and uncertainty experts in building and interpreting
their parameter studies.</p>
</section>
<section id="sconstruct">
<h2>SConstruct<a class="headerlink" href="#sconstruct" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="7">
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">SConstruct</span></code> file. A <code class="docutils literal notranslate"><span class="pre">diff</span></code> against the <code class="docutils literal notranslate"><span class="pre">SConstruct</span></code> file from <a class="reference internal" href="tutorial_12_archival.html#tutorial-archival"><span class="std std-ref">Tutorial 12: Data Archival</span></a> is included
below to help identify the changes made in this tutorial.</p></li>
</ol>
<div class="admonition-waves-tutorials-sconstruct admonition">
<p class="admonition-title">waves-tutorials/SConstruct</p>
<div class="highlight-udiff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- /home/runner/work/waves/waves/build/docs/tutorials_tutorial_12_archival_SConstruct</span>
<span class="gi">+++ /home/runner/work/waves/waves/build/docs/tutorials_tutorial_sensitivity_study_SConstruct</span>
<span class="gu">@@ -1,5 +1,5 @@</span>
<span class="w"> </span>#! /usr/bin/env python
<span class="gd">-&quot;&quot;&quot;Configure the WAVES archive tutorial.&quot;&quot;&quot;</span>
<span class="gi">+&quot;&quot;&quot;Configure the WAVES sensitivity analysis tutorial.&quot;&quot;&quot;</span>
<span class="w"> </span>
<span class="w"> </span>import inspect
<span class="w"> </span>import os
<span class="gu">@@ -122,6 +122,7 @@</span>
<span class="w"> </span>    &quot;tutorial_09_post_processing.scons&quot;,
<span class="w"> </span>    &quot;tutorial_11_regression_testing.scons&quot;,
<span class="w"> </span>    &quot;tutorial_12_archival.scons&quot;,
<span class="gi">+    &quot;tutorial_sensitivity_study.scons&quot;,</span>
<span class="w"> </span>]
<span class="w"> </span>for workflow in workflow_configurations:
<span class="w"> </span>    build_dir = env[&quot;variant_dir_base&quot;] / pathlib.Path(workflow).stem
</pre></div>
</div>
</div>
</section>
<section id="build-targets">
<h2>Build Targets<a class="headerlink" href="#build-targets" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="8">
<li><p>Build the new sensitivity study targets</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
$<span class="w"> </span>scons<span class="w"> </span>tutorial_sensitivity_study<span class="w"> </span>--jobs<span class="o">=</span><span class="m">4</span>
&lt;output<span class="w"> </span>truncated&gt;
</pre></div>
</div>
</section>
<section id="output-files">
<h2>Output Files<a class="headerlink" href="#output-files" title="Link to this heading">#</a></h2>
<p>Explore the contents of the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory using the <code class="docutils literal notranslate"><span class="pre">tree</span></code> command against the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory, as shown
below. Note that the output files from the previous tutorials may also exist in the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory, but the
directory is specified by name to reduce clutter in the output shown.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
$<span class="w"> </span>tree<span class="w"> </span>build/tutorial_sensitivity_study/<span class="w"> </span>-L<span class="w"> </span><span class="m">1</span>
build/tutorial_sensitivity_study/
<span class="p">|</span>--<span class="w"> </span>correlation_pairplot.pdf
<span class="p">|</span>--<span class="w"> </span>parameter_set0
<span class="p">|</span>--<span class="w"> </span>parameter_set1
<span class="p">|</span>--<span class="w"> </span>parameter_set10
<span class="p">|</span>--<span class="w"> </span>parameter_set11
<span class="p">|</span>--<span class="w"> </span>parameter_set12
<span class="p">|</span>--<span class="w"> </span>parameter_set13
<span class="p">|</span>--<span class="w"> </span>parameter_set14
<span class="p">|</span>--<span class="w"> </span>parameter_set15
<span class="p">|</span>--<span class="w"> </span>parameter_set16
<span class="p">|</span>--<span class="w"> </span>parameter_set17
<span class="p">|</span>--<span class="w"> </span>parameter_set18
<span class="p">|</span>--<span class="w"> </span>parameter_set19
<span class="p">|</span>--<span class="w"> </span>parameter_set2
<span class="p">|</span>--<span class="w"> </span>parameter_set3
<span class="p">|</span>--<span class="w"> </span>parameter_set4
<span class="p">|</span>--<span class="w"> </span>parameter_set5
<span class="p">|</span>--<span class="w"> </span>parameter_set6
<span class="p">|</span>--<span class="w"> </span>parameter_set7
<span class="p">|</span>--<span class="w"> </span>parameter_set8
<span class="p">|</span>--<span class="w"> </span>parameter_set9
<span class="p">|</span>--<span class="w"> </span>parameter_study.h5
<span class="p">|</span>--<span class="w"> </span>sensitivity.yaml
<span class="p">|</span>--<span class="w"> </span>sensitivity_study.csv
<span class="sb">`</span>--<span class="w"> </span>sensitivity_study.csv.stdout

<span class="m">20</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">5</span><span class="w"> </span>files
</pre></div>
</div>
<p>The purpose of the sensitivity study is to observe the relationships between the input space parameters (width and
height) on the output space parameters (peak stress). The script writes a correlation coefficients plot relating each
input and output space parameter to every other parameter.</p>
<figure class="align-center" id="tutorial-sensitivity-analysis-correlation-coefficients">
<a class="reference internal image-reference" href="_images/tutorial_sensitivity_study_sensitivity_study.png"><img alt="_images/tutorial_sensitivity_study_sensitivity_study.png" src="_images/tutorial_sensitivity_study_sensitivity_study.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Correlation coefficients</span><a class="headerlink" href="#tutorial-sensitivity-analysis-correlation-coefficients" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In the <a class="reference internal" href="#tutorial-sensitivity-analysis-correlation-coefficients"><span class="std std-ref">Correlation coefficients</span></a> figure we can see both the input and output
histograms on the diagonal. The scatter plots show the relationships between parameters. We can see very little
correlation between the stress output and the width input, and strongly linear correlation between the stress output and
the height input.  This is the result we should expect because we are applying a fixed displacement load and stress is
linearly dependent on the applied strain, which is a function of the change in displacement and the unloaded height. If
we were instead applying a force, we should expect the opposite correlation because stress would then depend on the
applied load divided by the cross-sectional area.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial_part_image.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial: Part Image</p>
      </div>
    </a>
    <a class="right-next"
       href="tutorial_abaqus_cae.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorial: Abaqus CAE</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment">Environment</a><ul class="simple visible nav section-nav flex-column">
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-structure">Directory Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-study-file">Parameter Study File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconscript">SConscript</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-script">Post-processing script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconstruct">SConstruct</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-targets">Build Targets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output Files</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kyle Brindley, Prabhu S. Khalsa, Thomas Roberts, Sergio Cordova, Matthew Fister, Chris Johnson, and Scott Ouellette
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025 Triad National Security, LLC. All Rights Reserved.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Oct 10, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>