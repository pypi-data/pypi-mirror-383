Metadata-Version: 2.4
Name: driftradar-vision
Version: 0.1.0
Summary: Vision drift monitoring with Great Expectations + Evidently + MLflow (Milestone A: DQ gates).
Author-email: Abdulvahap Mutlu <abdulvahapmutlu1@gmail.com>
License: MIT
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Requires-Python: >=3.11
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: torch>=2.3
Requires-Dist: torchvision>=0.18
Requires-Dist: numpy>=1.26
Requires-Dist: pandas>=2.2
Requires-Dist: pillow>=10.3
Requires-Dist: opencv-python>=4.9
Requires-Dist: albumentations>=1.4
Requires-Dist: scikit-learn>=1.4
Requires-Dist: hydra-core>=1.3
Requires-Dist: omegaconf>=2.3
Requires-Dist: rich>=13.7
Requires-Dist: structlog>=24.1
Requires-Dist: tqdm>=4.66
Requires-Dist: mlflow>=2.14
Requires-Dist: evidently>=0.5.0
Requires-Dist: great-expectations>=0.18
Requires-Dist: jinja2>=3.1
Requires-Dist: pyarrow>=15.0
Requires-Dist: polars>=1.6
Requires-Dist: matplotlib>=3.8
Requires-Dist: plotly>=5.22
Provides-Extra: dev
Requires-Dist: pytest>=8.0; extra == "dev"
Requires-Dist: pytest-cov>=5.0; extra == "dev"
Requires-Dist: pytest-sugar>=1.0; extra == "dev"
Requires-Dist: ruff>=0.6.9; extra == "dev"
Requires-Dist: black>=24.8; extra == "dev"
Requires-Dist: mypy>=1.11; extra == "dev"
Requires-Dist: types-PyYAML>=6.0.12; extra == "dev"
Requires-Dist: ipykernel; extra == "dev"
Requires-Dist: pre-commit; extra == "dev"
Dynamic: license-file

<h1 align="center">ğŸ›°ï¸ DriftRadar-Vision</h1>

<p align="center">
  <b>ML-Driven Drift Detection, Auto-Retraining, and Promotion System for Vision Models</b><br>
  <sub>Built with Evidently, Great Expectations, MLflow, Hydra, and GitHub Actions</sub>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/python-3.11+-blue.svg?style=flat-square"/>
  <img src="https://img.shields.io/badge/pytorch-2.3+-red.svg?style=flat-square"/>
  <img src="https://img.shields.io/github/actions/workflow/status/abdulvahapmutlu/driftradar-vision/ci.yml?label=CI&style=flat-square"/>
  <img src="https://img.shields.io/github/v/release/abdulvahapmutlu/driftradar-vision?style=flat-square"/>
  <img src="https://img.shields.io/badge/mlflow-tracking-orange.svg?style=flat-square"/>
  <img src="https://img.shields.io/badge/evidently-0.7.14-green.svg?style=flat-square"/>
</p>

---

### ğŸŒŒ Overview

**DriftRadar-Vision** is an advanced, production-ready **drift monitoring and adaptive retraining pipeline** for vision models.
It automatically detects **dataset, embedding, and prediction drifts** using Evidently and Great Expectations â€” then decides, retrains, stages, and promotes models via **GitHub Actions** and **MLflow**.

ğŸš€ Designed for **autonomous ML lifecycle management**, **vision model governance**, and **drift accountability**.

---

### ğŸ§± Core Architecture

```
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚    data_prod.py        â”‚
               â”‚   (Simulate batches)   â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚    drift_check.py      â”‚
               â”‚ (Evidently + embedding)â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ summary.json
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚    dq_validate.py      â”‚
               â”‚ (Great Expectations)   â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚     retrain.py         â”‚
               â”‚  (Policy-based trigger)â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚    train.py / eval.py      â”‚
             â”‚  (MLflow + ONNX export)    â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   drift_cron.yml + retrain_smokeâ”‚
         â”‚  (GitHub Actions automation)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
---

### ğŸ§© Features

| Category | Description |
|-----------|-------------|
| ğŸ§  **Detection** | Dataset drift, embedding drift (PSI), and prediction confidence drift |
| ğŸ” **Validation** | Great Expectations quality checks on input batches |
| âš™ï¸ **Retraining** | Automatic retrain trigger from policy thresholds |
| ğŸ§¾ **Reporting** | Evidently + GE HTML reports stored under `artifacts/reports/` |
| ğŸš€ **Automation** | Full CI/CD loop via GitHub Actions: Drift â†’ PR â†’ Smoke â†’ Promote |
| ğŸ§® **Backtesting** | Historical drift replay simulation with `backtest.py` |
| ğŸ“Š **Dashboard** | Streamlit dashboard with 5 pages for QA, drift, metrics, backtests |
| ğŸ§± **MLOps** | MLflow registry, Hydra configs, ONNX export, reproducible runs |

---

### âš™ï¸ Quick Start

#### 1ï¸âƒ£ Create environment

```
conda create -n driftradar python=3.11
conda activate driftradar
pip install -r requirements.txt
````

#### 2ï¸âƒ£ Run initial training

```
python -m driftradar_vision.train --config-path configs --config-name model.yaml
```

#### 3ï¸âƒ£ Evaluate and export ONNX

```
python -m driftradar_vision.eval --config-path configs --config-name eval.yaml --model-config-path configs --model-config-name model.yaml
```

#### 4ï¸âƒ£ Drift check (Evidently)

```
python -m driftradar_vision.drift_check --config-path configs --config-name drift.yaml --data-config-path configs --data-config-name data.yaml
```

#### 5ï¸âƒ£ Policy-based retrain

```
python -m driftradar_vision.retrain --config-path configs --config-name policy.yaml
```

#### 6ï¸âƒ£ Backtest thresholds

```
python -m driftradar_vision.backtest --mode simulate --days 10 --clean-days 3 --drift-days 7
```

#### 7ï¸âƒ£ Compare metrics (PR body)

```
python -m driftradar_vision.artifacts --what metrics-delta
```

---

### ğŸ§  Example Decision Output

```
{
  "retrain_triggered": true,
  "reason": "conf_drop(56.1%)>=thr(10.0%)",
  "embedding_top5_psi_mean": 15.29,
  "psi_threshold": 0.2,
  "run_id": "63a1a44c58b14e55b3e8e0b2d56f3bff",
  "staging_version": 7,
  "onnx_staging_path": "artifacts/runs/onnx/staging.onnx"
}
```

---

### ğŸ”„ GitHub Actions CI/CD

| Workflow            | Trigger            | Purpose                        |
| ------------------- | ------------------ | ------------------------------ |
| `ci.yml`            | Push / PR          | Lint, build, pytest            |
| `drift_cron.yml`    | Schedule           | Run drift_check + auto PR      |
| `retrain_smoke.yml` | Pull Request       | Mini retrain + GE + ONNX check |
| `promote.yml`       | `/promote` comment | Promote Staging â†’ Production   |

---

### ğŸ“ˆ Dashboard Pages

| Page              | Description                                         |
| ----------------- | --------------------------------------------------- |
| **Overview**      | Summary of latest production metrics and versions   |
| **Data Quality**  | Great Expectations blockers and warnings            |
| **Drift Monitor** | Evidently HTML + PSI statistics                     |
| **Model Metrics** | MLflow metrics, latency, ECE, size                  |
| **Backtest**      | Historical FPR/FNR, replayed days, threshold tuning |

---

### ğŸ§ª Backtest Result Example

```
{
  "mode": "simulate",
  "n_days": 10,
  "counts": {"tp": 6, "fp": 1, "tn": 3, "fn": 0},
  "rates": {"precision": 0.857, "recall": 1.0, "fpr": 0.25, "fnr": 0.0, "accuracy": 0.9}
}
```

---

### ğŸ§° Stack

* ğŸ§  **PyTorch 2.3** â€” vision model backbone (ResNet-18)
* âš™ï¸ **Hydra** â€” configuration management
* ğŸ“ˆ **Evidently** â€” dataset & embedding drift
* ğŸ§® **Great Expectations** â€” data quality validation
* ğŸ“Š **MLflow** â€” experiment tracking & model registry
* ğŸ§° **ONNX Runtime** â€” inference validation
* ğŸ’¾ **GitHub Actions** â€” CI/CD orchestration
* ğŸŒ **Streamlit** â€” dashboard visualization

---

### ğŸ§ª MLflow Registry Example

| Stage            | Version | Accuracy | ECE   | Size (MB) |
| ---------------- | ------- | -------- | ----- | --------- |
| Production       | 6       | 92.8%    | 0.031 | 88.7      |
| Staging          | 7       | 93.1%    | 0.028 | 89.1      |
| Î” (Stagingâ€“Prod) | +0.3    | âˆ’0.003   | +0.4  |           |

---

### ğŸ§­ Configuration Files

| File                    | Purpose                                |
| ----------------------- | -------------------------------------- |
| `configs/model.yaml`    | Main training hyperparameters          |
| `configs/data.yaml`     | Dataset paths and augmentations        |
| `configs/drift.yaml`    | Evidently and embedding drift settings |
| `configs/policy.yaml`   | Retraining & threshold policy          |
| `configs/eval.yaml`     | Evaluation and ONNX export             |
| `configs/model-ci.yaml` | Fast smoke test variant                |

---

### ğŸ¤– Automated Promotion

Once `drift_cron.yml` detects drift:

1. A **Pull Request** opens â†’ with `needs-review` + reports attached.
2. `retrain_smoke.yml` validates ONNX + GE expectations.
3. Maintainer comments `/promote` to approve.
4. `promote.yml` transitions model to **Production** and updates dashboard.

---

### ğŸ“œ Citation

If you use DriftRadar-Vision in your work, please cite:

```
@software{mutlu2025driftradar,
  author = {Abdulvahap Mutlu},
  title  = {DriftRadar-Vision: Autonomous Drift Detection and Retraining Pipeline for Vision Models},
  year   = {2025},
  url    = {https://github.com/abdulvahapmutlu/driftradar-vision}
}
```

---

### ğŸ‘¤ Author

**Abdulvahap Mutlu**
*M.Sc. in Artificial Intelligence | Deep Learning Engineer & Researcher*
[ğŸ”— Website](https://abdulvahapmutlu.com) Â· [ğŸ™ GitHub](https://github.com/abdulvahapmutlu) Â· [ğŸ’¼ LinkedIn](https://www.linkedin.com/in/abdulvahap-mutlu-9420b9235)

---

### ğŸ§© Related Projects

| Repository                                                           | Description                                    |
| -------------------------------------------------------------------- | ---------------------------------------------- |
| ğŸ§  [Sherpa-ML](https://github.com/abdulvahapmutlu/sherpa-ml)         | ML project scaffolding CLI with CI/CD & Docker |
| ğŸ§¬ [ReproKit-ML](https://github.com/abdulvahapmutlu/reprokit-ml)     | Deterministic reproducibility toolkit          |
| âš™ï¸ [QuantLab-8bit](https://github.com/abdulvahapmutlu/quantlab-8bit) | Quantization lab for PTQ vs QAT                |
| ğŸš¦ [EdgeServe-AB](https://github.com/abdulvahapmutlu/edgeserve-ab)   | A/B model router for ONNX Runtime              |
| ğŸ§® [Orbit-Boost](https://github.com/abdulvahapmutlu/orbit-boost)     | Novel boosting method for tree ensembles  |

---

### â­ Contributing

```
git clone https://github.com/abdulvahapmutlu/driftradar-vision
cd driftradar-vision
pip install -r requirements.txt
pytest -v
```

Contributions, ideas, and benchmarks are always welcome â€” feel free to open a pull request!

---

### ğŸªª License

Released under the **MIT License** â€” see [LICENSE](LICENSE).
