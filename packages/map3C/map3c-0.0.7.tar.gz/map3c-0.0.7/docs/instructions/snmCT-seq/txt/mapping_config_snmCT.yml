# General parameters
general:

    # Either bsdna for bisulfite-converted DNA or dna for non-bisulfite-converted DNA
    mode: "snmCTseq"

    # Full path to fastq_info.txt specifying sample name (no underscores) in the first column, R1 FASTQ path in second 
    # column, and R2 FASTQ path in the third column.
    fastq_info: "/u/project/cluo/jgalasso/snm3C_mapping_pipeline/test_snmCTseq/txt/mapping_info.txt"

    # Full path to where output data will be placed
    output_directory: "/u/project/cluo/jgalasso/snm3C_mapping_pipeline/test_snmCTseq/mapping"

preprocess:

    # Trim FASTQ reads
    # Options:
    # * "none" - No trimming performed
    # * Specific protocol (i.e. "snmCTseq") - See trim_methods section below for list of options
    # * Custom .smk path - Use your own protocol
    trim_protocol: "snmCTseq"

    # IMPORTANT: In order to improve the flexibility and readability of this YAML file, parameters for all trim
    # protocols are specified in the trim_methods section of this pipeline.
    
dna:

    run: True
    
    align:
        # Align FASTQ reads using Biscuit
        # Options:
        # * "default" - Default alignment protocol (recommended)
        # * Custom .smk path - Use your own protocol
        align_protocol: "default"

        biscuit:
        
            reference_path: "/u/project/cluo/jgalasso/resources/references/hg38_chrL/biscuit/hg38_chrL.fa"

            biscuit_params: "-T 0 -b 0"

        contamination_filter_params: >-
            --filter-type pair
            --min-mapq 10
            --max-mch-fraction 0.5
            --min-mch-fraction 0.0
            --min-ch-sites 3

    postprocess:

        postprocess_protocol: "default"

        dupsifter_params: "-r"

        # Don't specify mate annotation
        call_contacts_params: >-
            --chrom-sizes /u/project/cluo/jgalasso/resources/references/hg38_chrL/hg38_chrL.chrom.natsort.sizes 
            --reference-name hg38_chrL 
            --min-mapq 10 
            --trim-reads 
            --pairs-reporting full 

        mask_params: ""

        allc_params: ""

rna:

    run: True

    align:

        align_protocol: "default"

        star: 

            reference_path: "/u/project/cluo/jgalasso/resources/references/hg38_chrL/STAR"

            star_params: >-
                --alignEndsType EndToEnd 
                --outSAMtype BAM Unsorted 
                --outSAMattributes NH HI AS NM MD 
                --outSAMstrandField intronMotif 
                --sjdbOverhang 149 
                --outFilterType BySJout 
                --outFilterMultimapNmax 20 
                --alignSJoverhangMin 8 
                --alignSJDBoverhangMin 1 
                --outFilterMismatchNmax 999 
                --outFilterMismatchNoverLmax 0.04 
                --alignIntronMin 20 
                --alignIntronMax 1000000 
                --alignMatesGapMax 1000000 
    
        contamination_filter_pe_params: >-
            --filter-type pair 
            --min-mapq 10 
            --max-mch-fraction 1.0 
            --min-mch-fraction 0.9 
            --min-ch-sites 3

        contamination_filter_se_params: >-
            --filter-type mate 
            --min-mapq 10 
            --max-mch-fraction 1.0 
            --min-mch-fraction 0.9 
            --min-ch-sites 3

    postprocess:

        postprocess_protocol: "default"

        filter_pe_params: "-q 10 -f 2"

        filter_se_params: ""

        picard_params: ""

        featurecounts_pe_params: "-p -a /u/project/cluo/jgalasso/resources/references/hg38_chrL/gencode/gencode.v40.primary_assembly.annotation.gtf"

        featurecounts_se_params: "-a /u/project/cluo/jgalasso/resources/references/hg38_chrL/gencode/gencode.v40.primary_assembly.annotation.gtf"


stats:

    # Aggregate stats generated by all prior steps of this pipeline using map3C aggregate-qc-stats. This step is required.
    # Options:
    # * "default" - Default stats protocol
    stats_protocol: "default"

    # Extra parameters for map3C aggregate-qc-stats. Do not add --job, --out-prefix, and --mode, as these are added automatically 
    # as needed based on other parameters in this YAML file.
    stats_params: ""


trim_methods:

    snmCTseq:

        cutadapt_params: >-
            -a AGATCGGAAGAGCACACGTCTGAAC 
            -A AGATCGGAAGAGCGTCGTGTAGGGA 
            -q 20 
            -m 30
            -u 18 
            -u -10
            -U 10
            -U -10
            --pair-filter 'any'
            -O 6


