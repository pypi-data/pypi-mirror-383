# Copyright (C) 2019, Nokia

[tox]
envlist = py36, py312, docs, pylint

[base]
deps =
    mock
    pytest
    pytest-flake8
    pytest-console-scripts
    robotframework

[testenv]
parallel_show_output = true
deps =
    coverage
    {[base]deps}
changedir = {envtmpdir}
commands = {posargs:py.test \
	   --verbose {envsitepackagesdir}/crl/threadverify {toxinidir}/tests}

[pytest]
norecursedirs = bin lib include

[travis]
python =
  3.6: py36
  3.12: py312, pylint, docs

[testenv:pylint]
basepython = python3.12
deps =
    pylint
    {[base]deps}

commands = pylint {posargs: --reports=n --rcfile={toxinidir}/.pylintrc \
                   {toxinidir}/src/crl {toxinidir}/tests}

[testenv:docs]
changedir = {toxinidir}
deps=
    crl.devutils
commands=
    crl create_docs -v

[testenv:test]
changedir = {toxinidir}
deps=
    {[testenv:docs]deps}

commands=
    crl test --no-virtualenv {posargs}
