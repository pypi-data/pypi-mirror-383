"use strict";(self["webpackChunksortinghat_ui"]=self["webpackChunksortinghat_ui"]||[]).push([[849],{95849:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Y});var a=n(20641),r=n(90033),l=n(36554);function o(e,t,n,o,i,u){var s=(0,a.g2)("jobs-table");return(0,a.uX)(),(0,a.CE)("section",null,[(0,a.bF)(s,{"get-jobs":u.getJobs,onAffiliate:u.affiliate,onGenderize:u.genderize,onUnify:u.unify,onRecommendMatches:u.recommendMatches,ref:"table"},null,8,["get-jobs","onAffiliate","onGenderize","onUnify","onRecommendMatches"]),(0,a.bF)(l.K,{modelValue:i.snackbar.isOpen,"onUpdate:modelValue":t[0]||(t[0]=function(e){return i.snackbar.isOpen=e}),color:"error",text:""},{default:(0,a.k6)((function(){return[(0,a.eW)((0,r.v_)(i.snackbar.text),1)]})),_:1},8,["modelValue"])])}var i=n(14048),u=n(30388),s=n(58663),c=n(20595),d=(n(27495),n(25440),n(53751)),m=n(31969),f=n(13892),b=n(87524),h=n(43813),p=n(79669),g=n(20236),k=n(19336),v=n(83260),y=n(51161),x={class:"header"},_={class:"title"},V={class:"capitalize"},F={class:"text-center"},M={key:3,class:"text-center pa-4"},U={key:4,class:"text-subtitle-1 pa-7"};function A(e,t,n,l,o,i){var u=(0,a.g2)("job-modal");return(0,a.uX)(),(0,a.Wv)(h.I,{class:"jobs section mb-5 pa-0"},{default:(0,a.k6)((function(){return[(0,a.Lk)("header",x,[(0,a.Lk)("h4",_,[(0,a.bF)(p.w,{color:"black",size:"small",start:""},{default:(0,a.k6)((function(){return t[4]||(t[4]=[(0,a.eW)(" mdi-tray-full ",-1)])})),_:1,__:[4]}),t[5]||(t[5]=(0,a.eW)(" Jobs ",-1))]),(0,a.bF)(f.D,{color:"secondary",class:"black--text",size:"small",variant:"flat",onClick:t[0]||(t[0]=(0,d.D$)((function(e){return o.openModal=!0}),["stop"]))},{default:(0,a.k6)((function(){return t[6]||(t[6]=[(0,a.eW)(" Add ",-1)])})),_:1,__:[6]})]),o.error?((0,a.uX)(),(0,a.Wv)(m.l,{key:0,text:o.error,density:"compact",type:"error"},null,8,["text"])):(0,a.Q3)("",!0),o.isLoading?((0,a.uX)(),(0,a.Wv)(k.Z,{key:1,color:"primary",indeterminate:""})):o.jobs.length>0?((0,a.uX)(),(0,a.Wv)(v.Z,{key:2},{default:(0,a.k6)((function(){return[t[7]||(t[7]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"text-left"},"Job ID"),(0,a.Lk)("th",{class:"text-left"},"Type"),(0,a.Lk)("th",{class:"text-left"},"Date"),(0,a.Lk)("th",{class:"text-center"},"Status")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.jobs,(function(t){return(0,a.uX)(),(0,a.CE)("tr",{key:t.jobId},[(0,a.Lk)("td",null,[(0,a.bF)(y.y,{location:"bottom"},{activator:(0,a.k6)((function(e){var n=e.props;return[(0,a.bF)(b.x,(0,a.v6)({class:"text-center clip"},{ref_for:!0},n,{variant:"outlined",tile:""}),{default:(0,a.k6)((function(){return[(0,a.eW)((0,r.v_)(t.jobId),1)]})),_:2},1040)]})),default:(0,a.k6)((function(){return[(0,a.Lk)("span",null,(0,r.v_)(t.jobId),1)]})),_:2},1024)]),(0,a.Lk)("td",V,(0,r.v_)(t.jobType.replace("_"," ")),1),(0,a.Lk)("td",null,(0,r.v_)(e.$formatDate(t.enqueuedAt)),1),(0,a.Lk)("td",F,[(0,a.bF)(b.x,{class:"ma-2",color:i.getColor(t.status),"text-color":"white"},{default:(0,a.k6)((function(){return[(0,a.eW)((0,r.v_)(t.status),1)]})),_:2},1032,["color"])])])})),128))])]})),_:1})):(0,a.Q3)("",!0),o.jobs.length>0?((0,a.uX)(),(0,a.CE)("div",M,[(0,a.bF)(g.l,{modelValue:o.page,"onUpdate:modelValue":[t[1]||(t[1]=function(e){return o.page=e}),t[2]||(t[2]=function(e){return i.getPaginatedJobs(e)})],length:o.pageCount,"total-visible":5},null,8,["modelValue","length"])])):((0,a.uX)(),(0,a.CE)("p",U,"There are no jobs in the queue.")),(0,a.bF)(u,(0,a.v6)({"is-open":o.openModal,"onUpdate:isOpen":t[3]||(t[3]=function(e){return o.openModal=e})},e.$attrs),null,16,["is-open"])]})),_:1})}n(52675),n(89463);var w=n(4189),L=n(91606),j=n(30697),C=n(93745),z=n(40276),O=n(91772),W=n(1560),E=n(56756),J=n(35526),S=n(41720),$=n(57254),G=n(97505),X=n(20105);function I(e,t,n,l,o,i){return(0,a.uX)(),(0,a.Wv)(O.p,{"model-value":n.isOpen,"max-width":"550px","onClick:outside":i.onClose},{default:(0,a.k6)((function(){return[(0,a.bF)(w.J,{class:"section"},{default:(0,a.k6)((function(){return[(0,a.bF)(L.r,{class:"header title"},{default:(0,a.k6)((function(){return t[17]||(t[17]=[(0,a.eW)("New job",-1)])})),_:1,__:[17]}),(0,a.bF)(j.O,{class:"mt-3"},{default:(0,a.k6)((function(){return[(0,a.bF)(E.L,null,{default:(0,a.k6)((function(){return[(0,a.bF)(J.B,null,{default:(0,a.k6)((function(){return[(0,a.bF)(X.d4,{modelValue:o.selected,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.selected=e}),items:n.types,"menu-props":{offsetY:!0,maxWidth:500},label:"Type","item-title":"title",id:"type",density:"comfortable","hide-details":""},{item:(0,a.k6)((function(e){var t=e.item,n=e.props;return[(0,a.bF)($.g,(0,r._B)((0,a.Ng)(n)),{default:(0,a.k6)((function(){return[(0,a.bF)(G.w,null,{default:(0,a.k6)((function(){return[(0,a.eW)((0,r.v_)(t.raw.description),1)]})),_:2},1024)]})),_:2},1040)]})),_:1},8,["modelValue","items"])]})),_:1})]})),_:1}),"genderize"===o.selected?((0,a.uX)(),(0,a.Wv)(E.L,{key:0},{default:(0,a.k6)((function(){return[(0,a.bF)(J.B,null,{default:(0,a.k6)((function(){return[(0,a.bF)(z.a,{modelValue:o.forms.genderize.exclude,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.forms.genderize.exclude=e}),label:"Exclude individuals in RecommenderExclusionTerm list",id:"genderize_exclude"},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.genderize.noStrictMatching,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.forms.genderize.noStrictMatching=e}),label:"Disable strict name validation",id:"genderize_noStrictMatching"},null,8,["modelValue"])]})),_:1})]})),_:1})):(0,a.Q3)("",!0),"unify"===o.selected?((0,a.uX)(),(0,a.Wv)(W.n,{key:1},{default:(0,a.k6)((function(){return[(0,a.bF)(E.L,{class:"ma-0 mt-2"},{default:(0,a.k6)((function(){return[(0,a.bF)(J.B,{class:"pa-0 mb-3"},{default:(0,a.k6)((function(){return[(0,a.bF)(z.a,{modelValue:o.forms.unify.exclude,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.forms.unify.exclude=e}),label:"Exclude individuals in RecommenderExclusionTerm list",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.unify.strict,"onUpdate:modelValue":t[4]||(t[4]=function(e){return o.forms.unify.strict=e}),label:"Exclude individuals with invalid email addresses and names",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.unify.guessGithubUser,"onUpdate:modelValue":t[5]||(t[5]=function(e){return o.forms.unify.guessGithubUser=e}),label:"Match GitHub users to GitHub-generated emails",density:"comfortable","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,a.bF)(E.L,{class:"ma-0"},{default:(0,a.k6)((function(){return[(0,a.bF)(J.B,{class:"pa-0"},{default:(0,a.k6)((function(){return[(0,a.Lk)("fieldset",null,[t[18]||(t[18]=(0,a.Lk)("legend",{class:"subheader text--secondary"}," Unify profiles based on their: ",-1)),(0,a.bF)(z.a,{modelValue:o.forms.unify.criteria,"onUpdate:modelValue":t[6]||(t[6]=function(e){return o.forms.unify.criteria=e}),label:"Name",value:"name",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.unify.criteria,"onUpdate:modelValue":t[7]||(t[7]=function(e){return o.forms.unify.criteria=e}),label:"Email",value:"email",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.unify.criteria,"onUpdate:modelValue":t[8]||(t[8]=function(e){return o.forms.unify.criteria=e}),label:"Username",value:"username",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{class:"ml-4",modelValue:o.forms.unify.matchSource,"onUpdate:modelValue":t[9]||(t[9]=function(e){return o.forms.unify.matchSource=e}),label:"Only unify identities that share the same source",density:"comfortable","hide-details":""},null,8,["modelValue"])])]})),_:1})]})),_:1})]})),_:1})):(0,a.Q3)("",!0),"recommendMatches"===o.selected?((0,a.uX)(),(0,a.Wv)(W.n,{key:2},{default:(0,a.k6)((function(){return[(0,a.bF)(E.L,{class:"ma-0 mt-2"},{default:(0,a.k6)((function(){return[(0,a.bF)(J.B,{class:"pa-0 mb-3"},{default:(0,a.k6)((function(){return[(0,a.bF)(z.a,{modelValue:o.forms.recommendMatches.exclude,"onUpdate:modelValue":t[10]||(t[10]=function(e){return o.forms.recommendMatches.exclude=e}),label:"Exclude individuals in RecommenderExclusionTerm list",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.recommendMatches.strict,"onUpdate:modelValue":t[11]||(t[11]=function(e){return o.forms.recommendMatches.strict=e}),label:"Exclude individuals with invalid email adresses and names",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.recommendMatches.guessGithubUser,"onUpdate:modelValue":t[12]||(t[12]=function(e){return o.forms.recommendMatches.guessGithubUser=e}),label:"Match GitHub users to GitHub-generated emails",density:"comfortable","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,a.bF)(E.L,{class:"ma-0"},{default:(0,a.k6)((function(){return[(0,a.bF)(J.B,{class:"pa-0"},{default:(0,a.k6)((function(){return[(0,a.Lk)("fieldset",null,[t[19]||(t[19]=(0,a.Lk)("legend",{class:"subheader text--secondary"}," Recommend matches based on: ",-1)),(0,a.bF)(z.a,{modelValue:o.forms.recommendMatches.criteria,"onUpdate:modelValue":t[13]||(t[13]=function(e){return o.forms.recommendMatches.criteria=e}),label:"Name",value:"name",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.recommendMatches.criteria,"onUpdate:modelValue":t[14]||(t[14]=function(e){return o.forms.recommendMatches.criteria=e}),label:"Email",value:"email",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{modelValue:o.forms.recommendMatches.criteria,"onUpdate:modelValue":t[15]||(t[15]=function(e){return o.forms.recommendMatches.criteria=e}),label:"Username",value:"username",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,a.bF)(z.a,{class:"ml-4",modelValue:o.forms.recommendMatches.matchSource,"onUpdate:modelValue":t[16]||(t[16]=function(e){return o.forms.recommendMatches.matchSource=e}),label:"Only recommend identities that share the same source",density:"comfortable","hide-details":""},null,8,["modelValue"])])]})),_:1})]})),_:1})]})),_:1})):(0,a.Q3)("",!0)]})),_:1}),(0,a.bF)(C.S,null,{default:(0,a.k6)((function(){return[(0,a.bF)(S.h),(0,a.bF)(f.D,{color:"primary darken-1",variant:"text",onClick:i.onClose},{default:(0,a.k6)((function(){return t[20]||(t[20]=[(0,a.eW)(" Cancel ",-1)])})),_:1,__:[20]},8,["onClick"]),(0,a.bF)(f.D,{disabled:!o.selected,color:"primary",id:"confirm",variant:"flat",onClick:i.onSave},{default:(0,a.k6)((function(){return t[21]||(t[21]=[(0,a.eW)(" Confirm ",-1)])})),_:1,__:[21]},8,["disabled","onClick"])]})),_:1})]})),_:1})]})),_:1},8,["model-value","onClick:outside"])}var T=[{title:"Affiliate",value:"affiliate",description:"Affiliate individuals to organizations using recommendations."},{title:"Genderize",value:"genderize",description:"Autocomplete the gender information of individuals using genderize.io recommendations. "},{title:"Unify",value:"unify",description:"Merge individuals by using matching recommendations."},{title:"Recommend matches",value:"recommendMatches",description:"Recommend identity matches for individuals."}],B={genderize:{exclude:!0,noStrictMatching:!1},unify:{criteria:["name","email","username"],exclude:!0,strict:!0,matchSource:!1,guessGithubUser:!1},recommendMatches:{criteria:["name","email","username"],exclude:!0,strict:!0,matchSource:!1,guessGithubUser:!1}};const D={name:"JobModal",props:{isOpen:{type:Boolean,required:!0},types:{type:Array,required:!1,default:function(){return T}}},data:function(){return{selected:null,forms:B}},methods:{onClose:function(){this.$emit("update:isOpen",!1),this.selected=null,this.forms=Object.assign({},this.forms,B)},onSave:function(){this.$emit(this.selected,this.forms[this.selected]),this.onClose()}}};var P=n(64621);const R=(0,P.A)(D,[["render",I],["__scopeId","data-v-c6b119f8"]]),Q=R,q={name:"JobsTable",components:{JobModal:Q},props:{getJobs:{type:Function,required:!0}},data:function(){return{jobs:[],page:1,pageSize:10,pageCount:1,openModal:!1,error:null,isLoading:!1}},created:function(){this.getPaginatedJobs(1)},methods:{getPaginatedJobs:function(){var e=arguments,t=this;return(0,u.A)((0,i.A)().mark((function n(){var a,r,l;return(0,i.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:t.page,r=e.length>1&&void 0!==e[1]?e[1]:t.pageSize,t.isLoading=!0,n.prev=3,n.next=6,t.getJobs(a,r);case 6:l=n.sent,l.data.jobs.entities?(t.jobs=l.data.jobs.entities,t.pageCount=l.data.jobs.pageInfo.numPages,t.page=l.data.jobs.pageInfo.page):l.errors&&(t.error="Error fetching data: ".concat(t.$getErrorMessage(l.errors))),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](3),t.error="Error fetching data: ".concat(t.$getErrorMessage(n.t0));case 13:return n.prev=13,t.isLoading=!1,n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[3,10,13,16]])})))()},getColor:function(e){return"finished"===e?"#3fa500":"failed"===e?"#f41900":"started"===e?"primary":"rgba(0, 0, 0, 0.42)"}}},H=(0,P.A)(q,[["render",A],["__scopeId","data-v-515ab245"]]),N=H,K={name:"Jobs",components:{JobsTable:N},data:function(){return{snackbar:{isOpen:!1,text:null}}},methods:{getJobs:function(e,t){var n=this;return(0,u.A)((0,i.A)().mark((function a(){var r;return(0,i.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,s.zA)(n.$apollo,e,t);case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}}),a)})))()},affiliate:function(){var e=this;return(0,u.A)((0,i.A)().mark((function t(){return(0,i.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,c.OM)(e.$apollo);case 3:e.$refs.table.getPaginatedJobs(),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.snackbar=Object.assign(e.snackbar,{isOpen:!0,text:t.t0});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},genderize:function(e){var t=this;return(0,u.A)((0,i.A)().mark((function n(){var a,r;return(0,i.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.exclude,r=e.noStrictMatching,n.prev=1,n.next=4,(0,c.gW)(t.$apollo,a,r);case 4:t.$refs.table.getPaginatedJobs(),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](1),t.snackbar=Object.assign(t.snackbar,{isOpen:!0,text:n.t0});case 10:case"end":return n.stop()}}),n,null,[[1,7]])})))()},unify:function(e){var t=this;return(0,u.A)((0,i.A)().mark((function n(){var a,r,l,o,u;return(0,i.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.criteria,r=e.exclude,l=e.strict,o=e.matchSource,u=e.guessGithubUser,n.prev=1,n.next=4,(0,c.QF)(t.$apollo,a,r,l,o,u);case 4:t.$refs.table.getPaginatedJobs(),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](1),t.snackbar=Object.assign(t.snackbar,{isOpen:!0,text:n.t0});case 10:case"end":return n.stop()}}),n,null,[[1,7]])})))()},recommendMatches:function(e){var t=this;return(0,u.A)((0,i.A)().mark((function n(){var a,r,l,o,u;return(0,i.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.criteria,r=e.exclude,l=e.strict,o=e.matchSource,u=e.guessGithubUser,n.prev=1,n.next=4,(0,c.wg)(t.$apollo,a,r,l,[],o,u);case 4:t.$refs.table.getPaginatedJobs(),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](1),t.snackbar=Object.assign(t.snackbar,{isOpen:!0,text:n.t0});case 10:case"end":return n.stop()}}),n,null,[[1,7]])})))()}}},Z=(0,P.A)(K,[["render",o]]),Y=Z}}]);
//# sourceMappingURL=849.ab9c2a77.js.map