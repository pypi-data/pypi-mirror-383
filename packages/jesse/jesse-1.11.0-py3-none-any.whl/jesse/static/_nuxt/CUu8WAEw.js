import{_ as De}from"./1t9lhHdr.js";import{c as u,o as i,b as a,g as re,s as Le,h as C,bb as j,r as h,i as Q,v as ue,bc as Re,l as f,t as g,P as Ae,ab as Oe,bd as Ue,F as N,p as W,a as Fe,T as X,L as D,d as o,w as k,$ as Ne,C as He,k as F,K as c,m as I,q as Ee,N as Ie,a2 as Be,a1 as We,a3 as Pe,e as B,be as Ze,a4 as Je,M as _,H as L,a8 as se,I as ee}from"./DClyChXX.js";import{_ as Ke}from"./57ZEouOQ.js";import{_ as qe}from"./Cyc7KzJj.js";import{T as Ye,d as Ge,_ as Qe,b as Xe,a as et,c as tt}from"./5p1eMV4W.js";import{s as at,l as st,d as lt}from"./lA_J2Fq2.js";import{_ as ot}from"./B65OE2Ty.js";import{_ as nt}from"./BewFpM0p.js";import{u as it}from"./C3vgktDp.js";import"./BQd0uCFJ.js";function rt(P,R){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z","clip-rule":"evenodd"})])}function ut(P,R){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M10.5 3A1.501 1.501 0 0 0 9 4.5h6A1.5 1.5 0 0 0 13.5 3h-3Zm-2.693.178A3 3 0 0 1 10.5 1.5h3a3 3 0 0 1 2.694 1.678c.497.042.992.092 1.486.15 1.497.173 2.57 1.46 2.57 2.929V19.5a3 3 0 0 1-3 3H6.75a3 3 0 0 1-3-3V6.257c0-1.47 1.073-2.756 2.57-2.93.493-.057.989-.107 1.487-.15Z","clip-rule":"evenodd"})])}const dt={key:0,class:"mb-2 p-3 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-200 rounded-md"},ct={class:"text-sm font-medium"},vt={class:"mt-2 flex items-center justify-between"},gt={class:"flex items-center"},mt=["value"],ft=re({__name:"ObjectiveCurveChart",props:{data:{}},setup(P){const R=Le(),r=C(()=>R.value),s=j(),V=h(null),$=P,A=C(()=>{const l=s.results.generalInfo.find(w=>w[0]==="Objective Function");return l?{sharpe:"sharpe_ratio",calmar:"calmar_ratio",sortino:"sortino_ratio",omega:"omega_ratio",serenity:"serenity_index","smart sharpe":"smart_sharpe","smart sortino":"smart_sortino"}[l[1].toLowerCase()]||l[1].toLowerCase():"sharpe_ratio"}),b=h(null);let v=null,T=null,S=null;const Z=C(()=>$.data.length>0&&$.data[0].training?Object.keys($.data[0].training):[]),y=C({get:()=>s.results.selectedObjectiveMetric,set:l=>{s.results.selectedObjectiveMetric=l}});Q(Z,l=>{if(!s.results.selectedObjectiveMetric&&l.length){const d=A.value;l.includes(d)?y.value=d:y.value=l[0]}},{immediate:!0});const H=C(()=>$.data.map(d=>({trial:d.trial,training:d.training[y.value]!==void 0?d.training[y.value]:null,testing:d.testing[y.value]!==void 0?d.testing[y.value]:null})));function te(){if(b.value)try{V.value=null;const l={...at,width:b.value.clientWidth,height:300,timeScale:{timeVisible:!1,secondsVisible:!1,tickMarkFormatter:d=>Math.floor(d)},localization:{timeFormatter:d=>Math.floor(d)}};v=Ye(b.value,l),T=v.addLineSeries({color:"#60A5FA",lineWidth:2,title:"Training"}),S=v.addLineSeries({color:"#F87171",lineWidth:2,title:"Testing"}),J(r.value),E()}catch(l){O(l)}}function E(){if(!(!T||!S))try{V.value=null;const l=H.value.sort((p,q)=>p.trial-q.trial),d=l.filter(p=>p.training!==null).map(p=>({time:p.trial,value:p.training})),w=l.filter(p=>p.testing!==null).map(p=>({time:p.trial,value:p.testing}));T.setData(d),S.setData(w),v==null||v.timeScale().fitContent()}catch(l){O(l)}}function O(l){console.error("Chart error:",l),V.value=`Failed to render chart: ${l.message||"Unknown error"}`,v&&(v.remove(),v=null,T=null,S=null)}function J(l){if(v)try{v.applyOptions(l==="light"?st.chart:lt.chart)}catch(d){O(d)}}function K(){if(v&&b.value)try{v.applyOptions({width:b.value.clientWidth})}catch(l){O(l)}}ue(()=>{te(),window.addEventListener("resize",K)}),Re(()=>{v&&(v.remove(),v=null),window.removeEventListener("resize",K)}),Q(H,E),Q(y,E),Q(r,J);function U(l){return l.replace(/_/g," ").toUpperCase()}return(l,d)=>(i(),u("div",null,[V.value?(i(),u("div",dt,[a("p",ct,g(V.value),1)])):f("",!0),a("div",{ref_key:"chartContainer",ref:b,class:"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600",style:{"min-height":"300px"}},null,512),a("div",vt,[d[2]||(d[2]=Ae('<div class="flex items-center" data-v-a7d13feb><span class="text-xs mr-2 rounded bg-white dark:bg-gray-700 p-1" data-v-a7d13feb><span class="inline-block" style="background-color:#60A5FA;width:25px;height:10px;" data-v-a7d13feb></span><span class="ml-2" data-v-a7d13feb>Training</span></span><span class="text-xs mr-2 rounded bg-white dark:bg-gray-700 p-1" data-v-a7d13feb><span class="inline-block" style="background-color:#F87171;width:25px;height:10px;" data-v-a7d13feb></span><span class="ml-2" data-v-a7d13feb>Testing</span></span></div>',1)),a("div",gt,[d[1]||(d[1]=a("label",{class:"text-sm text-gray-700 dark:text-gray-300 mr-2"},"Metric:",-1)),Oe(a("select",{"onUpdate:modelValue":d[0]||(d[0]=w=>y.value=w),class:"text-sm py-1 px-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-800"},[(i(!0),u(N,null,W(Z.value,w=>(i(),u("option",{key:w,value:w},g(U(w)),9,mt))),128))],512),[[Ue,y.value]])])])]))}}),pt=Fe(ft,[["__scopeId","data-v-a7d13feb"]]),_t={key:0,class:"divide-y divide-gray-200 dark:divide-gray-700"},yt=["onClick"],bt={class:"grid grid-cols-12 text-center items-center"},xt={class:"col-span-3 flex items-center text-sm"},ht={class:"text-gray-500 dark:text-gray-400"},wt={class:"col-span-2 flex items-center justify-center text-sm"},kt={class:"text-gray-500 dark:text-gray-400"},Ct={class:"col-span-2 text-sm"},Tt={class:"col-span-2 text-sm text-gray-500 dark:text-gray-400"},St={class:"col-span-1 flex justify-end items-center"},$t={key:1,class:"py-4 text-center text-gray-500 dark:text-gray-400"},jt={key:0,class:"mb-8"},Vt={key:1,class:"mb-8"},zt={key:2},Mt={key:0,class:"mb-8"},Dt={class:"mt-16"},Lt={class:"border border-gray-200 bg-white dark:border-gray-700 rounded-lg overflow-hidden"},Rt={class:"flex justify-between font-semibold p-4 bg-gray-100 dark:bg-gray-900 text-sm"},At={class:"w-[33%] text-center"},Ot={key:0},Ut={class:"w-[12%] text-sm font-medium"},Ft={class:"w-[15%] text-sm"},Nt={class:"w-[33%] text-sm text-center"},Ht={class:"w-[24%] text-sm"},Et={class:"w-[16%] flex justify-center space-x-1"},It={key:1,class:"text-center py-4 text-gray-500 dark:text-gray-400 dark:bg-gray-800"},Bt={key:3},Wt={class:"mb-8"},Pt={class:"flex items-center select-none flex-1 mb-4"},Zt={class:"flex items-center select-none flex-1 mb-4"},Jt={class:"select-none"},Kt={class:"grid grid-cols-1 gap-6"},qt={key:0},Yt={key:1,class:"flex flex-col items-center justify-center select-none"},Gt={class:"mb-8 w-full"},Qt={class:"flex flex-col gap-4 mt-4"},Xt=["textContent"],ea={key:2},ta={class:"mb-8 w-full"},aa={class:"flex flex-col gap-4 mt-4"},sa={key:3,class:"mt-8 w-full"},la={class:"p-4"},oa={class:"mt-4"},na={class:"w-full text-sm"},ia={class:"w-full"},ra={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ua={class:"w-full flex justify-between py-2 px-4"},da={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ca={class:"w-full flex justify-between py-2 px-4"},va={class:"w-full"},ga={class:"font-bold"},ma={class:"w-full"},fa={class:"w-1/3 font-bold italic"},pa={class:"w-1/3 text-center"},_a={class:"w-1/3 text-center"},ya={class:"flex justify-end mt-8 space-x-2"},ba={class:"p-4"},xa={class:"mt-4 flex justify-end space-x-3"},Ma=re({__name:"index",setup(P){it({title:"Optimization - Jesse"});const R=j(),r=C(()=>R.form),s=C(()=>R.results),V=h(!1),$=h(!1),A=h([]),b=h(!1),v=h([]),T=h(!1),S=h(null),Z=C(()=>X().jesseSupportedTimeframes.map(n=>({label:n,value:n})));ue(()=>{setTimeout(()=>{H()},50)});const y=h([]);async function H(){y.value=await X().getExchangeSupportedSymbols(r.value.exchange);for(let n=0;n<r.value.routes.length;n++)y.value.includes(r.value.routes[n].symbol)||(r.value.routes[n].symbol=y.value[0])}r.value.exchange=r.value.exchange||X().backtestingExchangeNames[0];const te=C(()=>D.remainingTimeText(s.value.progressbar.estimated_remaining_seconds)),E=C(()=>{const n=s.value.generalInfo.find(e=>e[0]==="Objective Function");return n?n[1]:"sharpe"});function O(){if(A.value.length){for(let n=0;n<A.value.length;n++)L("error",A.value[n]);return}if(r.value.routes.length>1){L("error","Optimization mode does not support multiple routes at the moment.");return}j().start()}function J(){D.copyToClipboard(s.value.infoLogs),L("success","Info logs copied successfully"),$.value=!0,setTimeout(()=>{$.value=!1},3e3)}async function K(){await j().terminate(),await ae(r.value.id)}const U=h(!1),l=h({});async function d(n){(await D.copyToClipboard(n)).success?L("success","DNA copied to clipboard"):L("error","Failed to copy DNA. Please try manually selecting and copying.")}function w(n){l.value=n,U.value=!0}function p(){b.value=!0,q()}async function q(){try{const e=(await se("/optimization/sessions",{},!0)).data.value;v.value=(e==null?void 0:e.sessions)||[]}catch(n){ee(n)}}function de(n){switch(n.toLowerCase()){case"running":return"blue";case"finished":return"green";case"stopped":return"red";case"terminated":return"yellow";default:return"gray"}}async function ce(n){await j().loadSession(n)&&(await ae(n),b.value=!1)}const le=C(()=>s.value.status==="terminated");async function ve(){await j().resume(),await ae(r.value.id)}async function ge(n){try{const e=await se(`/optimization/sessions/${n}`,{},!0);if(e.error.value)return null;const x=e.data.value;return x==null?void 0:x.session}catch(e){return ee(e),null}}async function ae(n){if(!b.value||!v.value.length)return;const e=await ge(n);if(!e)return;const x=v.value.findIndex(Y=>Y.id===n);x!==-1&&(v.value[x]=e)}function me(n){S.value=n,T.value=!0}async function fe(){S.value&&(await _e(S.value),await q()),T.value=!1,S.value=null}function pe(){T.value=!1,S.value=null}async function _e(n){if(n===r.value.id){L("error","You cannot delete the current session.");return}try{const e=await se(`/optimization/sessions/${n}/remove`,{},!0);if(e.error.value){ee(e.error.value);return}L("success","Session deleted successfully.")}catch(e){ee(e)}}const ye=n=>{const e=[];return n.forEach(x=>{e.push([{value:x.symbol,style:""},{value:x.timeframe,style:""},{value:x.strategy,style:""}])}),e},be=n=>[["Training Start Date",n.training_start_date],["Training Finish Date",n.training_finish_date],["Testing Start Date",n.testing_start_date],["Testing Finish Date",n.testing_finish_date]];return(n,e)=>{const x=De,Y=Ne,xe=Ke,m=Ee,he=qe,we=et,M=Be,ke=pt,Ce=ot,Te=tt,G=Pe,Se=Ze,$e=Je,je=Qe,oe=We,ne=nt,Ve=Xe,ze=Ge,ie=He;return i(),u(N,null,[o(Y,{modelValue:s.value.logsModal,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.logsModal=t),title:"Logs"},{default:k(()=>[o(x,{logs:s.value.infoLogs},null,8,["logs"])]),buttons:k(()=>[a("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:J},[$.value?(i(),F(c(rt),{key:0,class:"h-6 w-6","aria-hidden":"true"})):f("",!0),!$.value&&s.value.infoLogs.length!=0?(i(),F(c(ut),{key:1,class:"h-6 w-6","aria-hidden":"true"})):f("",!0)])]),_:1},8,["modelValue"]),o(Y,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=t=>b.value=t),title:"Optimization History"},{default:k(()=>[v.value.length?(i(),u("div",_t,[(i(!0),u(N,null,W(v.value,t=>(i(),u("div",{key:t.id,class:I([s.value.showResults&&r.value.id===t.id?"bg-gray-100 dark:bg-gray-900":"cursor-pointer","py-3 px-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"]),onClick:z=>ce(t.id)},[a("div",bt,[a("div",xt,[a("span",ht,g(t.id.substring(0,5))+"-"+g(Object.keys(t.state).length>0?t.state.form.routes[0].strategy:"strategy"),1)]),a("div",wt,[a("span",kt,g(t.completed_trials)+" trials",1)]),a("div",Ct,[o(xe,{color:de(t.status),label:t.status,variant:"soft",size:"sm"},null,8,["color","label"])]),a("div",Tt,g(c(D).timestampToReadableDateTime(t.updated_at)),1),e[26]||(e[26]=a("div",{class:"col-span-1 flex items-center justify-center text-gray-400"},[a("i",{class:"i-heroicons-chevron-right h-5 w-5"})],-1)),a("div",St,[o(m,{icon:"i-heroicons-trash",size:"xs",color:"red",variant:"ghost","aria-label":"Delete session",onClick:Ie(z=>me(t.id),["stop"])},null,8,["onClick"])])])],10,yt))),128))])):(i(),u("div",$t," No optimization history found "))]),_:1},8,["modelValue"]),o(ze,null,{left:k(()=>[s.value.alert.message?(i(),u("div",jt,[o(he,{color:"teal",icon:"i-heroicons-check-circle",variant:"soft",title:s.value.alert.message,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"white",variant:"link"},onClose:e[2]||(e[2]=t=>s.value.alert.message="")},null,8,["title"])])):f("",!0),s.value.exception.error&&s.value.executing?(i(),u("div",Vt,[o(we,{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=t=>V.value=t),title:s.value.exception.error,content:s.value.exception.traceback,mode:"optimize"},null,8,["modelValue","title","content"])])):f("",!0),(s.value.executing||s.value.showResults)&&!s.value.exception.error?(i(),u("div",zt,[s.value.objective_curve&&s.value.objective_curve.length?(i(),u("div",Mt,[o(M,{title:"Objective Progress",class:"mb-4"}),o(ke,{data:s.value.objective_curve},null,8,["data"])])):f("",!0),a("div",Dt,[o(M,{title:"Best Trials",class:"my-4"}),e[31]||(e[31]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-4"}," Showing top 20 trials sorted by fitness score ",-1)),a("div",Lt,[a("div",Rt,[e[27]||(e[27]=a("div",{class:"w-[12%]"},"Rank",-1)),e[28]||(e[28]=a("div",{class:"w-[15%]"},"Trial",-1)),a("div",At,"Training/Testing "+g(E.value),1),e[29]||(e[29]=a("div",{class:"w-[24%]"},"Fitness",-1)),e[30]||(e[30]=a("div",{class:"w-[16%] text-center"},"Actions",-1))]),s.value.best_candidates.length?(i(),u("div",Ot,[(i(!0),u(N,null,W(s.value.best_candidates,(t,z)=>(i(),u("div",{key:z,class:I(["flex items-center justify-between border-t border-gray-200 dark:border-gray-700 p-2 dark:bg-gray-700",{"bg-gray-50 dark:bg-gray-800":z%2===0}])},[a("div",Ut,g(t.rank),1),a("div",Ft,g(t.trial),1),a("div",Nt,g(t.objective_metric),1),a("div",Ht,g(t.fitness),1),a("div",Et,[o(m,{variant:"ghost",color:"gray",icon:"i-heroicons-clipboard-document-list",onClick:Me=>d(t.dna)},null,8,["onClick"]),o(m,{variant:"ghost",icon:"i-heroicons-information-circle",onClick:Me=>w(t)},null,8,["onClick"])])],2))),128))])):(i(),u("div",It," No candidates found yet... "))])])])):f("",!0),!s.value.executing&&!s.value.showResults?(i(),u("div",Bt,[o(M,{class:"mb-4",title:"Exchange"}),o(Ce,{modelValue:r.value.exchange,"onUpdate:modelValue":e[4]||(e[4]=t=>r.value.exchange=t),placeholder:"Select an exchange...",searchable:"",options:c(X)().backtestingExchangeNames,size:"lg",class:"mt-2 mb-16",onChange:H},null,8,["modelValue","options"]),o(Te,{"total-routes-error":A.value,form:r.value,results:s.value,mode:"optimization",symbols:y.value,timeframes:Z.value},null,8,["total-routes-error","form","results","symbols","timeframes"]),o(M,{class:"mt-16 mb-4",title:"Duration"}),a("div",Wt,[e[32]||(e[32]=a("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"},"Training Period",-1)),a("div",Pt,[o(G,{modelValue:r.value.training_start_date,"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.training_start_date=t),type:"date",variant:"outline",size:"lg",class:"w-full mr-2"},null,8,["modelValue"]),o(G,{modelValue:r.value.training_finish_date,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.training_finish_date=t),type:"date",variant:"outline",size:"lg",class:"w-full ml-2"},null,8,["modelValue"])])]),a("div",null,[e[33]||(e[33]=a("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"},"Testing Period",-1)),a("div",Zt,[o(G,{modelValue:r.value.testing_start_date,"onUpdate:modelValue":e[7]||(e[7]=t=>r.value.testing_start_date=t),type:"date",variant:"outline",size:"lg",class:"w-full mr-2"},null,8,["modelValue"]),o(G,{modelValue:r.value.testing_finish_date,"onUpdate:modelValue":e[8]||(e[8]=t=>r.value.testing_finish_date=t),type:"date",variant:"outline",size:"lg",class:"w-full ml-2"},null,8,["modelValue"])])]),o(M,{class:"mt-16 mb-4",title:"Optimal Trades"}),a("div",Jt,[e[34]||(e[34]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400"},[B(" The number that tells Jesse how many trades you would find optimal for your strategy in the targeted time period so that it can filter out those DNAs that cause too few trades. "),a("a",{href:"https://docs.jesse.trade/docs/optimize/executing-the-optimize-mode.html",target:"_blank",class:"font-semibold hover:underline italic"},"More Details...")],-1)),e[35]||(e[35]=a("br",null,null,-1)),o(Se,{modelValue:r.value.optimal_total,"onUpdate:modelValue":e[9]||(e[9]=t=>r.value.optimal_total=t),title:"Optimal number of trades:"},null,8,["modelValue"])]),o(M,{class:"mt-16 mb-4",title:"Options"}),a("div",Kt,[o($e,{modelValue:r.value.fast_mode,"onUpdate:modelValue":e[10]||(e[10]=t=>r.value.fast_mode=t),title:"Fast Mode",description:"Runs the backtest faster using an improved algorithm. Use with caution as this is experimental."},null,8,["modelValue"])])])):f("",!0)]),right:k(()=>[!s.value.executing&&!s.value.showResults?(i(),u("div",qt,[a("div",null,[o(m,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",trailing:!1,onClick:e[11]||(e[11]=t=>O())}),o(m,{class:"w-full flex justify-center mt-4",icon:"i-heroicons-clock",size:"xl",variant:"solid",color:"gray",label:"History",trailing:!1,onClick:e[12]||(e[12]=t=>p())})])])):f("",!0),s.value.executing&&!s.value.showResults?(i(),u("div",Yt,[a("div",Gt,[s.value.exception.error?(i(),F(m,{key:0,class:"w-full flex justify-center mt-4",icon:"i-heroicons-arrow-path",size:"xl",variant:"solid",label:"Rerun",trailing:!1,onClick:e[13]||(e[13]=t=>c(j)().rerun())})):f("",!0),s.value.exception.error?(i(),F(m,{key:1,class:"w-full flex justify-center mt-4",icon:"i-heroicons-arrow-uturn-left",size:"xl",variant:"solid",color:"green",label:"New Session",trailing:!1,onClick:e[14]||(e[14]=t=>c(j)().newSession())})):s.value.showResults?f("",!0):(i(),F(m,{key:2,color:"gray",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},class:"w-full flex justify-center mt-4",icon:"i-heroicons-pause",size:"xl",variant:"solid",label:"Terminate",trailing:!1,onClick:e[15]||(e[15]=t=>K())})),a("div",Qt,[o(m,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"Logs",icon:"i-heroicons-document-text",trailing:!1,onClick:e[16]||(e[16]=t=>s.value.logsModal=!0)}),o(m,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"History",icon:"i-heroicons-clock",trailing:!1,onClick:e[17]||(e[17]=t=>p())})])]),a("div",null,[o(je,{progress:s.value.progressbar.current},null,8,["progress"])]),!s.value.exception.error&&!s.value.best_candidates.length?(i(),u("h3",{key:0,class:"mt-8 animate-pulse",textContent:g(te.value)},null,8,Xt)):f("",!0)])):f("",!0),s.value.showResults?(i(),u("div",ea,[a("div",ta,[le.value?(i(),F(m,{key:0,class:"w-full flex justify-center",icon:"i-heroicons-play",size:"xl",variant:"solid",color:"primary",label:"Resume",trailing:!1,onClick:e[18]||(e[18]=t=>ve())})):f("",!0),o(m,{class:I(["w-full flex justify-center",{"mt-4":le.value}]),icon:"i-heroicons-arrow-uturn-left",size:"xl",variant:"solid",color:"green",label:"New Session",trailing:!1,onClick:e[19]||(e[19]=t=>c(j)().newSession())},null,8,["class"]),a("div",aa,[o(m,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"Logs",icon:"i-heroicons-document-text",trailing:!1,onClick:e[20]||(e[20]=t=>s.value.logsModal=!0)}),o(m,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"History",icon:"i-heroicons-clock",trailing:!1,onClick:e[21]||(e[21]=t=>p())})])])])):f("",!0),(s.value.executing||s.value.showResults)&&s.value.generalInfo.length?(i(),u("div",sa,[o(M,{title:"Info",class:"mb-4"}),o(oe,{data:s.value.generalInfo},null,8,["data"]),o(ne,{class:"mt-8 mb-4",size:"lg",label:"Duration"}),o(oe,{data:be(r.value)},null,8,["data"]),o(ne,{class:"mt-8 mb-4",size:"lg",label:"Routes"}),o(Ve,{data:ye(r.value.routes),"header-items":["Symbol","Timeframe","Strategy"],header:""},null,8,["data"])])):f("",!0)]),_:1}),o(ie,{modelValue:U.value,"onUpdate:modelValue":e[24]||(e[24]=t=>U.value=t)},{default:k(()=>[a("div",la,[a("div",oa,[a("div",na,[e[42]||(e[42]=a("h2",{class:"text-lg mb-2 font-bold italic dark:text-white text-center"}," Candidate Info ",-1)),a("div",ia,[a("div",ra,[e[36]||(e[36]=a("div",{class:"font-bold"},"Rank",-1)),a("div",null,g(l.value.rank),1)]),a("div",ua,[e[37]||(e[37]=a("div",{class:"font-bold"},"Trial",-1)),a("div",null,g(l.value.trial),1)]),a("div",da,[e[38]||(e[38]=a("div",{class:"font-bold"},"Fitness",-1)),a("div",null,g(l.value.fitness),1)]),a("div",ca,[e[40]||(e[40]=a("div",{class:"font-bold"},"DNA",-1)),o(m,{size:"xs",color:"primary",onClick:e[22]||(e[22]=t=>d(l.value.dna))},{default:k(()=>e[39]||(e[39]=[B(" Copy DNA ")])),_:1})])]),e[43]||(e[43]=a("h2",{class:"text-lg font-bold italic dark:text-white mt-6 mb-2 text-center"}," Parameters ",-1)),a("div",va,[(i(!0),u(N,null,W(Object.keys(l.value.params),(t,z)=>(i(),u("div",{key:t,class:I([{"bg-gray-50 dark:bg-gray-800":z%2===0},"w-full flex justify-between py-2 px-4"])},[a("div",ga,g(t),1),a("div",null,g(typeof l.value.params[t]=="number"?c(_).round(l.value.params[t],6):l.value.params[t]),1)],2))),128))]),e[44]||(e[44]=a("h2",{class:"text-lg font-bold italic dark:text-white mt-6 mb-2 text-center"}," Metrics Comparison ",-1)),a("div",ma,[e[41]||(e[41]=a("div",{class:"flex justify-between py-2 px-4 bg-gray-100 dark:bg-gray-800 font-bold text-sm"},[a("div",{class:"w-1/3 font-bold"},"Metric"),a("div",{class:"w-1/3 text-center font-bold"},"Training"),a("div",{class:"w-1/3 text-center font-bold"},"Testing")],-1)),(i(!0),u(N,null,W([{key:"total",label:"Total Closed Trades"},{key:"net_profit",label:"Total Net Profit",format:t=>`${c(_).round(t.net_profit,2)} (${c(_).round(t.net_profit_percentage,2)}%)`},{key:"starting_balance",label:"Starting => Finishing Balance",format:t=>`${c(_).round(t.starting_balance,2)} => ${c(_).round(t.finishing_balance,2)}`},{key:"total_open_trades",label:"Open Trades"},{key:"fee",label:"Total Paid Fees",round:2},{key:"max_drawdown",label:"Max Drawdown",round:2},{key:"annual_return",label:"Annual Return",format:t=>`${c(_).round(t.annual_return,2)}%`},{key:"expectancy",label:"Expectancy",format:t=>`${c(_).round(t.expectancy,2)} (${c(_).round(t.expectancy_percentage,2)}%)`},{key:"average_win",label:"Avg Win | Avg Loss",format:t=>`${c(_).round(t.average_win,2)} | ${c(_).round(t.average_loss,2)}`},{key:"ratio_avg_win_loss",label:"Ratio Avg Win / Avg Loss",round:2},{key:"win_rate",label:"Win-rate",format:t=>`${c(_).round(t.win_rate*100,2)}%`},{key:"longs_percentage",label:"Longs | Shorts",format:t=>`${c(_).round(t.longs_percentage,2)}% | ${c(_).round(t.shorts_percentage,2)}%`},{key:"average_holding_period",label:"Avg Holding Time",format:t=>c(D).secondsToHumanReadable(t.average_holding_period)},{key:"average_winning_holding_period",label:"Winning Trades Avg Holding Time",format:t=>c(D).secondsToHumanReadable(t.average_winning_holding_period)},{key:"average_losing_holding_period",label:"Losing Trades Avg Holding Time",format:t=>c(D).secondsToHumanReadable(t.average_losing_holding_period)},{key:"sharpe_ratio",label:"Sharpe Ratio",round:2},{key:"calmar_ratio",label:"Calmar Ratio",round:2},{key:"sortino_ratio",label:"Sortino Ratio",round:2},{key:"omega_ratio",label:"Omega Ratio",round:2},{key:"winning_streak",label:"Winning Streak"},{key:"losing_streak",label:"Losing Streak"},{key:"largest_winning_trade",label:"Largest Winning Trade",round:2},{key:"largest_losing_trade",label:"Largest Losing Trade",round:2},{key:"total_winning_trades",label:"Total Winning Trades"},{key:"total_losing_trades",label:"Total Losing Trades"}],(t,z)=>(i(),u("div",{key:t.key,class:I([{"bg-gray-50 dark:bg-gray-800":z%2===0},"w-full flex justify-between py-2 px-4"])},[a("div",fa,g(t.label),1),a("div",pa,g(t.format?t.format(l.value.training_metrics):t.round?c(_).round(l.value.training_metrics[t.key],t.round):l.value.training_metrics[t.key]),1),a("div",_a,g(t.format?t.format(l.value.testing_metrics):t.round?c(_).round(l.value.testing_metrics[t.key],t.round):l.value.testing_metrics[t.key]),1)],2))),128))])])]),a("div",ya,[o(m,{color:"gray",block:"",onClick:e[23]||(e[23]=t=>U.value=!1)},{default:k(()=>e[45]||(e[45]=[B(" Close ")])),_:1})])])]),_:1},8,["modelValue"]),o(ie,{modelValue:T.value,"onUpdate:modelValue":e[25]||(e[25]=t=>T.value=t)},{default:k(()=>[a("div",ba,[e[48]||(e[48]=a("h3",{class:"text-lg font-medium leading-6 text-gray-900 dark:text-white"}," Confirm Deletion ",-1)),e[49]||(e[49]=a("div",{class:"mt-2"},[a("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," Are you sure you want to delete this optimization session? This action cannot be undone. ")],-1)),a("div",xa,[o(m,{color:"gray",variant:"ghost",onClick:pe},{default:k(()=>e[46]||(e[46]=[B(" Cancel ")])),_:1}),o(m,{color:"red",onClick:fe},{default:k(()=>e[47]||(e[47]=[B(" Delete ")])),_:1})])])]),_:1},8,["modelValue"])],64)}}});export{Ma as default};
