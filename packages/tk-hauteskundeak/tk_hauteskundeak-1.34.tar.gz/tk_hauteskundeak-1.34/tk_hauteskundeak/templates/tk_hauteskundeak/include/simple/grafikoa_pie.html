{% load l10n %}
<div id="eserlekuakgraph-{{ hauteskundea.izena|slugify }}"
     style="width: 100%;
            margin: 0 auto"></div>
<script type="text/javascript">

var pieColors = [{% for alderdia in taula %}{% if alderdia.jarlekuak%}'{{alderdia.alderdia__kolorea}}'{% if forloop.last %}{% else %},{% endif %}{% endif %}{% endfor %}];

{% include "tk_hauteskundeak/include/highchart/setoptions.js" %}

Highcharts.chart('eserlekuakgraph-{{hauteskundea.izena|slugify}}', {
    {% include "tk_hauteskundeak/include/highchart/menuoptions.js" %}
    chart: {
        plotBackgroundColor: null,
        plotBorderWidth: 0,
        plotShadow: false,
    },

    title: {
        text: '{{hauteskundea.izena}} - {{tokia.izena}}',
    },
    subtitle: {
        text: 'Eserlekuak{% if info %} - Eskrutinioa: %{{info.info.eskrutinioa}}{% endif %}'
    },
    tooltip: {
        pointFormat: '{series.name}: <b>{point.y}</b>'
    },
    plotOptions: {
        pie: {
            dataLabels: {
                enabled: true,
                distance: -50,
                format: '{point.txt}',
                style: {
                    color: 'white',
                    fontSize: '120%'
                },
                formatter: function(){
                    return this.y;
                },
            },
            colors: pieColors,
            startAngle: -90,
            endAngle: 90,
            center: ['50%', '80%'],
            size: '150%',
            showInLegend: true
        }
    },
    legend: {
        verticalAlign: 'bottom',
        y: -10,
        floating: true
    },
    series: [{
            type: 'pie',
            name: 'Eserlekuak',
            innerSize: '30%',
            borderWidth:0,
            data: [
            {% for alderdia in taula %}{% if alderdia.jarlekuak%}
            {name:'{{alderdia.alderdia__akronimoa|escapejs}}',y:{{alderdia.jarlekuak}}, txt:'{{alderdia.jarlekuak}}'},
            {% endif %}
            {% endfor %}
            ],
        }],

        responsive: {
            rules: [{
                condition: {
                    maxWidth: 500
                },
                chartOptions: {
                    plotOptions: {
                        pie: {
                            size: '100%',
                        },
                    },
                },
            }]
        }
    }
);

</script>
