{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<style>
    // Create variables
    :root {
        --main-radius: 25px;
        --main-padding: 15px;
    }

    .grid {
        display: grid;
        margin-top: 0px;
        min-height: 100vh;
        grid-template-columns: auto 50%;
        grid-template-rows: minmax(auto, .05fr) minmax(auto, 1fr);
        grid-template-areas:
            "selectUserGroupsButton selectedUserGroupsRemoveButton"
            "selectUserGroups selectedUserGroups";      
        grid-gap: 0.1rem;
        background-color: white;
    }

    #selectedUserGroupsRemoveButton {
        grid-area: selectedUserGroupsRemoveButton;
        border-radius:var(--main-radius);
        padding-top:var(--main-padding);
        //color: #66F854;
        color: black;
        background: white;
    }

    #selectUserGroupsButton {
        grid-area: selectUserGroupsButton;
        border-radius:var(--main-radius);
        padding-top:var(--main-padding);
        //color: #66F854;
        color: black;
        background: white;
    }

    #selectedUserGroups {
        grid-area: selectedUserGroups;
        border-radius:var(--main-radius);
        padding-top:var(--main-padding);
        //color: #66F854;
        color: black;
        background: white;
    }

    #selectUserGroups {
        grid-area: selectUserGroups;
        border-radius:var(--main-radius);
        padding-top:var(--main-padding);
        overflow: auto;
        color: #66F854;
        background: white;
        //border-right: 2px solid black;
    }

    @media only screen and (max-width: 550px) {
        .grid {
            grid-template-columns: 1fr;
            grid-template-rows: .3fr 3fr;
            grid-template-areas:
                "selectUserGroupsButton selectedUserGroupsRemoveButton"
                "selectUserGroups"
                "selectedUserGroups"
                ;
        }
    }

</style>
{% endblock extra_css %}

{% block content %}
<div class="mainBodyDiv">
    <nav class="navbar navbar-expand-sm topbar fixed-top secondNavbarStyle">
        <div style="display:inline-block; margin-top:5px">
            <a id="deleteBackupFiles" href="#" >Delete</a>&emsp;&emsp;
            <!-- <a id="backupScheduler" href="#" >Scheduler</a>&emsp;&emsp; -->
        </div>
    </nav>

    <span class="textBlack marginLeft20px"><strong>Backup System To File</strong>:</span><br>
    <div class="flexRowInlineBlockLeft">
        <label for='backupFilename' class="textBlack marginLeft40px">Add Backup File Label (Optional):</label>&emsp; 
        <input type="text" id="backupFilename" class="form-control inputBoxWidth300px defaultFontSize" placeholder="Default: timestamp.gz" /><br> 
    </div>
    <button type="button" id="systemBackup" class="marginLeft40px btn btn-sm btn-outline-primary">System Backup</button>

    <br><br><br>

    <label for='uploadSystemBackupFileInput' class="textBlack marginLeft20px"><strong>Upload System Backup File</strong>:</label>
    <form id="uploadBackupFileForm" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input class="marginLeft40px" id="uploadSystemBackupFileInput" name="uploadSystemBackupFile" type="file" accept=".gz" /><br><br>
        <button type="submit" id="systemBackup" class="btn btn-sm btn-outline-primary marginLeft40px">Upload System Backup</button>
    </form>
    <br>

    <form action="{% url 'downloadBackupFile' %}" method="post">
        {% csrf_token %}
        <div id="backupFileTable" class="mt-3 pl-3" style="width:80%">
            <table class="mt-0 table table-sm table-bordered tableFixHead3"> 
                <thead>
                    <tr>
                        <th scope="col" class="textAlignCenter">Delete</th>
                        <th scope="col" class="textAlignCenter">Backup Files</th>
                        <th scope="col" class="textAlignCenter">Download</th>
                        <th scope="col" class="textAlignCenter">Restore</th>
                    </tr>
                </thead>
                <tbody id="backupFiles"></tbody>
            </table>
        </div>
    </form>

    <div class="modal" id="restoreSystemBackupModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" 
    aria-labelledby="restoreSystemBackup" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable" style="max-width:30%; height:300px; overflow:auto; color:black">
        <div class="modal-content">
            
            <div class="modal-header">
				<div class="fileRowInlineBlockRight">
					<h6 class="modal-title" id="editFile">Restore System Backup&ensp;</h6>
				</div>
            </div>

            <div class="modal-body" style="margin-top:2px">
				<div class="row">&ensp;&ensp;Are you sure that you want to restore a system backup?</div>
            </div>

            <div class="modal-footer">
                <button type="button" id="restoreSystemBackupConfirmed" class="btn btn-outline-primary" data-dismiss="modal">Restore System Backup</button>
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
        
</div>

{% endblock content %}

{% block extra_js %}
    <script type="module" src="{% static 'commons/js/systemBackup.js' %}"></script>
{% endblock extra_js %}