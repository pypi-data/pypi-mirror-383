---
# Parameter values inside globalSettings applies to all stages and modules
# You could over write these globalSetting param values in each stage and modules
# so they're all different.
#
globalSettings:
   # The key use to use with specific login credentials
   # from the file .loginCredentials.yml
   # For example: logins for AWS S3 and Jira
   loginCredentialKey: keystack

   # Default = False
   # Abort the current module on failure, and still run the next module.
   abortTaskOnFailure: False

   # Default = True
   abortStageOnFailure: False

   # Abort entire test if a testcase failed. Will not jump to Teardown.
   # Default = False
   abortTestOnFailure: False
   
   # env has precedence over loadBalanceGroup
   #env: DOMAIN=Communal/Samples/demoEnv1
   loadBalanceGroup: qa

   verifyFailurePatterns: ['Failed']
   
   # Add additional test report details to the test report header. 
   # The test report will show these additional keys and values that
   # you are staing here. Create as many as you like with a dash.
   # reportHeadingAdditions:
   #    - key: 'valueString'

stages:
    setup:
        enable: True
        runTasksConcurrently: False
        tasks:
          - bringup:
              enable: True
              env: DOMAIN=Communal/Samples/demoEnv1
              playlist:
                 - Modules/Demo/Testcases/Bringups

    # Run standalone python scripts.                                         
    Test:
        enable: True
        runTasksConcurrently: False
        abortTaskOnFailure: False

        tasks:
            - Setup:
                enable: True
                abortTaskOnFailure: False
                playlist:
                 - /Modules/Demo/Testcases/L2L3_Testcases/isis.yml

            - layer3:
                enable: True
                #env: DOMAIN=Communal/Samples/demoEnv1
                #env: not-required
                abortTaskOnFailure: False

                #playlistExclusions:
                    # - Example: A list of folders and files to exclude
                    #   from the playlist  
                playlist:
                    - Modules/Demo/Testcases/L2L3_Testcases/bgp.yml
                    - Modules/Demo/Testcases/L2L3_Testcases/ospf.yml
                    - Modules/Demo/Testcases/L2L3_Testcases/isis.yml
                    
                outerLoop: 1
                innerLoop:
                    allTestcases: 1
                    folders:
                        - /Testcases/Demo/L2L3_Testcases: 2
                    #testcases:

                dependencies:
                    # Example: To run isis.yml testcase, bgp.yml testcase must pass
                    Modules/Demo/Testcases/L2L3_Testcases/isis.yml:
                        enable: True
                        dependOnCases:
                            - Modules/Demo/Testcases/L2L3_Testcases/bgp.yml

            - standAloneTests:
                enable: True
                # Pass in variable values to scripts to digest.
                # Look at pythonSample.py script for sample on getting this variables
                playbookVars:
                   serverIp: 10.10.10.1
                   serverName: qa
                   server: sanity
                #env: Samples/demoEnv2
                #env: not-required
                playlist:
                    - Modules/Demo/Testcases/standalonePython.yml

            - combination:
                enable: 

                env: DOMAIN=Communal/Samples/demoEnv1
                playlist:
                    - Modules/Demo/Testcases/bashScript.yml
                    - Modules/Demo/Testcases/runPytest.yml
                    - /opt/KeystackTests/Modules/Demo/Scripts/shellScript.bash
                    - /opt/KeystackTests/Modules/Demo/Scripts/standalonePython.py -arg1 hello -arg2 world
                    - /opt/KeystackTests/Modules/Demo/Scripts/teardownDuts.py   

            - Teardown:
                enable: True
                #abortTaskOnFailure: True
                #teardownOnFailure: False
                playlist:
                 - Modules/Demo/Testcases/L2L3_Testcases/isis.yml

    # Run python scripts with Keystack Env integration. 
    # This allows your Python scripts to consume env parameter values inside Python scripts.
    # And in your scripts, instead of using print, use logInfo(), logFailed(), logWarning(), logError()
    DynamicVariableSample:
        enable: True
        tasks:
          - dynamicVariables:
              enable: True
              env: DOMAIN=Communal/Samples/demoEnv1
              # Pass in variable values to scripts to digest.
              playbookVars:
                 serverIp: 10.10.10.1
                 serverName: qa
                 server: sanity
              playlist:
                 - Modules/Demo/Testcases/dynamicVariableSample.yml

    Teardown:
        enable: True
        runTasksConcurrently: False

        # Default = False
        teardownOnFailure: True
        tasks:
          - teardown:
              enable: True
              #env: DOMAIN=Communal/Samples/demoEnv1
              env: not-required
              playlist:
                 - Modules/Demo/Testcases/Teardowns
