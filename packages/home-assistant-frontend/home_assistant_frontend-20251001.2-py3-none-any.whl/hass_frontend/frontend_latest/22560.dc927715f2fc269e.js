export const __webpack_id__="22560";export const __webpack_ids__=["22560"];export const __webpack_modules__={94327:function(t,s,e){e.d(s,{Vy:()=>o,fI:()=>n,ux:()=>c});var i=e(65940),r=e(83510);const a=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(t){return a[t%a.length]}function n(t,s){const e=s.getPropertyValue(`--graph-color-${t+1}`)||o(t);return(0,r.RQ)(e)}const c=(0,i.A)(t=>a.map((s,e)=>n(e,t)),(t,s)=>t[0].getPropertyValue("--graph-color-1")===s[0].getPropertyValue("--graph-color-1"))},92900:function(t,s,e){e.d(s,{c:()=>l});var i=e(94327),r=e(83510),a=e(6788),o=e(88341),n=e(25442),c=e(14523),h=e(45736);const _={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};let d=0;const u=new Map;function l(t,s,e){return function(t,s,e){if(!e||t===c.Hh)return(0,h.a)("--history-unavailable-color",s);if(t===c.HV)return(0,h.a)("--history-unknown-color",s);const i=(0,n.mg)(e,t);if(!i)return;const d=(0,h.a)(i,s);if(!d)return;const u=(0,o.m)(e.entity_id),l=_[u]?.[t];return l?(0,r.zm)((0,a.T)((0,r.Nc)((0,r.xp)(d)),l)):d}(t,s,e)||function(t,s){if(u.has(t))return u.get(t);const e=(0,i.fI)(d,s);return d++,u.set(t,e),e}(t,s)}},63002:function(t,s,e){e.d(s,{$3:()=>p,$O:()=>S,$j:()=>y,ED:()=>a,JE:()=>H,OQ:()=>I,PU:()=>$,Ph:()=>l,Uf:()=>v,W1:()=>f,Wr:()=>_,Z:()=>c,gF:()=>g,iY:()=>m,jU:()=>o,nN:()=>x,p3:()=>h,pJ:()=>u,r_:()=>n,sz:()=>d});e(65315),e(59023);var i=e(72652),r=e(50654),a=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({});const o=59509==e.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,n=["L","gal","ft³","m³","CCF","MCF"],c=t=>t.sendMessagePromise({type:"recorder/info"}),h=(t,s)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:s}),_=(t,s)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:s}),d=(t,s,e,i,r="hour",a,o)=>t.callWS({type:"recorder/statistics_during_period",start_time:s.toISOString(),end_time:e?.toISOString(),statistic_ids:i,period:r,units:a,types:o}),u=(t,s,e,i)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:s,units:i,fixed_period:e.fixed_period?{start_time:e.fixed_period.start instanceof Date?e.fixed_period.start.toISOString():e.fixed_period.start,end_time:e.fixed_period.end instanceof Date?e.fixed_period.end.toISOString():e.fixed_period.end}:void 0,calendar:e.calendar?{..."week"===e.calendar.period?{first_weekday:(0,r.DD)(t.locale).substring(0,3)}:{},...e.calendar}:void 0,rolling_window:e.rolling_window}),l=t=>t.callWS({type:"recorder/validate_statistics"}),f=(t,s,e)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:s,unit_of_measurement:e}),p=(t,s)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:s}),y=t=>{let s=null;if(!t)return null;for(const e of t)null!==e.change&&void 0!==e.change&&(null===s?s=e.change:s+=e.change);return s},g=(t,s)=>{let e=null;for(const i of s){if(!(i in t))continue;const s=y(t[i]);null!==s&&(null===e?e=s:e+=s)}return e},m=(t,s)=>t.some(t=>void 0!==t[s]&&null!==t[s]),b=["mean","min","max"],w=["sum","state","change"],x=(t,s)=>!(!b.includes(s)||0===t.mean_type)||!(!w.includes(s)||!t.has_sum),v=(t,s,e,i,r)=>{const a=new Date(e).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:s,start_time:a,adjustment:i,adjustment_unit_of_measurement:r})},S=(t,s,e)=>{const r=t.states[s];return r?(0,i.u)(r):e?.name||s},H=(t,s,e)=>{let i;return s&&(i=t.states[s]?.attributes.unit_of_measurement),void 0===i?e?.statistics_unit_of_measurement:i},I=t=>t.includes(":"),$=t=>t.callWS({type:"recorder/update_statistics_issues"})},18318:function(t,s,e){e.a(t,async function(t,i){try{e.r(s),e.d(s,{DEFAULT_HOURS_TO_SHOW:()=>g,HuiHistoryGraphCard:()=>m});e(99342),e(65315),e(22416);var r=e(69868),a=e(84922),o=e(22019),n=e(75907),c=e(26946),h=e(47807),_=(e(94124),e(70490),e(42163),e(69006)),d=e(3274),u=e(8510),l=e(38177),f=e(94372),p=e(63002),y=t([h,_]);[h,_]=y.then?(await y)():y;const g=24;class m extends a.WF{static async getConfigElement(){return await Promise.all([e.e("42153"),e.e("87110"),e.e("30199"),e.e("5255"),e.e("78589"),e.e("71691")]).then(e.bind(e,89227)),document.createElement("hui-history-graph-card-editor")}static getStubConfig(){return{type:"history-graph",entities:["sun.sun"]}}getCardSize(){return this._config?.title?2:0+2*(this._entityIds?.length||1)}getGridOptions(){return{columns:12,min_columns:6,min_rows:2}}setConfig(t){if(!t.entities||!Array.isArray(t.entities))throw new Error("Entities need to be an array");if(!t.entities.length)throw new Error("You must include at least one entity");const s=t.entities?(0,l.L)(t.entities):[];this._entityIds=[],s.forEach(t=>{this._entityIds.push(t.entity),t.name&&(this._names[t.entity]=t.name)}),this._hoursToShow=t.hours_to_show||g,this._config=t}connectedCallback(){super.connectedCallback(),this.hasUpdated&&this._subscribeHistory()}disconnectedCallback(){super.disconnectedCallback(),this._unsubscribeHistory()}async _subscribeHistory(){if(!(0,c.x)(this.hass,"history")||this._subscribed)return;const{numeric_device_classes:t}=await(0,d.KL)(this.hass);this._subscribed=(0,_.IQ)(this.hass,s=>{this._subscribed&&(this._stateHistory=(0,_.Mm)(this.hass,s,this._entityIds,this.hass.localize,t,this._config?.split_device_classes),this._mergeHistory())},this._hoursToShow,this._entityIds).catch(t=>{this._subscribed=void 0,this._error=t}),await this._fetchStatistics(t),this._setRedrawTimer()}_mergeHistory(){this._stateHistory&&(this._history=(0,_.tG)(this._stateHistory,this._statisticsHistory,this._config?.split_device_classes))}async _fetchStatistics(t){const s=new Date,e=new Date;e.setHours(e.getHours()-this._hoursToShow);const i=await(0,p.sz)(this.hass,e,s,this._entityIds,"hour",void 0,["mean","state"]);this._statisticsHistory=(0,_._1)(this.hass,i,this._entityIds,t,this._config?.split_device_classes),this._mergeHistory()}_redrawGraph(){this._history&&(this._history={...this._history})}_setRedrawTimer(){clearInterval(this._interval),this._interval=window.setInterval(()=>this._redrawGraph(),6e4)}_unsubscribeHistory(){clearInterval(this._interval),this._subscribed&&(this._subscribed.then(t=>t?.()),this._subscribed=void 0)}shouldUpdate(t){return(0,u.pY)(this,t)||t.size>1||!t.has("hass")}updated(t){if(super.updated(t),!(this._config&&this.hass&&this._hoursToShow&&this._entityIds.length))return;if(!t.has("_config")&&!t.has("hass"))return;const s=t.get("_config");!t.has("_config")||s?.entities===this._config.entities&&s?.hours_to_show===this._config.hours_to_show||(this._unsubscribeHistory(),this._subscribeHistory())}render(){if(!this.hass||!this._config)return a.s6;const t=new Date;t.setHours(t.getHours()-this._hoursToShow);const s=`/history?${(0,f.KH)({entity_id:this._entityIds.join(","),start_date:t.toISOString()})}`,e=this._config.grid_options?.columns??12,i="number"==typeof e&&e<=12,r="number"==typeof this._config.grid_options?.rows;return a.qy` <ha-card> ${this._config.title?a.qy` <h1 class="card-header"> ${this._config.title} <a href="${s}"><ha-icon-next></ha-icon-next></a> </h1> `:a.s6} <div class="content ${(0,n.H)({"has-header":!!this._config.title,"has-rows":!!this._config.grid_options?.rows,"has-height":r})}"> ${this._error?a.qy` <ha-alert alert-type="error"> ${this.hass.localize("ui.components.history_charts.error")}: ${this._error.message||this._error.code} </ha-alert> `:a.qy` <state-history-charts .hass="${this.hass}" .isLoadingData="${!this._history}" .historyData="${this._history}" .names="${this._names}" up-to-now .hoursToShow="${this._hoursToShow}" .showNames="${void 0===this._config.show_names||this._config.show_names}" .logarithmicScale="${this._config.logarithmic_scale||!1}" .minYAxis="${this._config.min_y_axis}" .maxYAxis="${this._config.max_y_axis}" .fitYData="${this._config.fit_y_data||!1}" .height="${r?"100%":void 0}" .narrow="${i}" .expandLegend="${this._config.expand_legend}"></state-history-charts> `} </div> </ha-card> `}constructor(...t){super(...t),this._names={},this._entityIds=[],this._hoursToShow=g}}m.styles=a.AH`ha-card{display:flex;flex-direction:column;height:100%}.card-header{justify-content:space-between;display:flex;padding-bottom:0}.card-header ha-icon-next{--mdc-icon-button-size:24px;line-height:24px;color:var(--primary-text-color)}.content{padding:0 16px 8px;flex:1;overflow:hidden}.has-header{padding-top:0}state-history-charts{--timeline-top-margin:16px}.has-height state-history-charts{height:100%}.has-rows{--chart-max-height:100%}`,(0,r.__decorate)([(0,o.MZ)({attribute:!1})],m.prototype,"hass",void 0),(0,r.__decorate)([(0,o.wk)()],m.prototype,"_history",void 0),(0,r.__decorate)([(0,o.wk)()],m.prototype,"_statisticsHistory",void 0),(0,r.__decorate)([(0,o.wk)()],m.prototype,"_config",void 0),(0,r.__decorate)([(0,o.wk)()],m.prototype,"_error",void 0),m=(0,r.__decorate)([(0,o.EM)("hui-history-graph-card")],m),i()}catch(t){i(t)}})}};
//# sourceMappingURL=22560.dc927715f2fc269e.js.map