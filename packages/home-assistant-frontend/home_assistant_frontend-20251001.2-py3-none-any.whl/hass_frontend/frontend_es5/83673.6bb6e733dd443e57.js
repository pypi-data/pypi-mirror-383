"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["83673"],{6418:function(t,i,e){e.a(t,async function(t,s){try{e.r(i),e.d(i,{HaIconOverflowMenu:function(){return $}});e(35748),e(65315),e(37089),e(95013);var a=e(69868),o=e(84922),r=e(11991),n=e(75907),l=e(50809),h=(e(19912),e(9058),e(86160),e(7245)),c=(e(92409),e(28565),t([h]));h=(c.then?(await c)():c)[0];let d,p,u,_,g,f,m,v,y=t=>t;const b="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z";class $ extends o.WF{render(){return(0,o.qy)(d||(d=y` ${0} `),this.narrow?(0,o.qy)(p||(p=y` <ha-md-button-menu @click="${0}" positioning="popover"> <ha-icon-button .label="${0}" .path="${0}" slot="trigger"></ha-icon-button> ${0} </ha-md-button-menu>`),this._handleIconOverflowMenuOpened,this.hass.localize("ui.common.overflow_menu"),b,this.items.map(t=>t.divider?(0,o.qy)(u||(u=y`<ha-md-divider role="separator" tabindex="-1"></ha-md-divider>`)):(0,o.qy)(_||(_=y`<ha-md-menu-item ?disabled="${0}" .clickAction="${0}" class="${0}"> <ha-svg-icon slot="start" class="${0}" .path="${0}"></ha-svg-icon> ${0} </ha-md-menu-item> `),t.disabled,t.action,(0,n.H)({warning:Boolean(t.warning)}),(0,n.H)({warning:Boolean(t.warning)}),t.path,t.label))):(0,o.qy)(g||(g=y` ${0} `),this.items.map(t=>{var i;return t.narrowOnly?o.s6:t.divider?(0,o.qy)(f||(f=y`<div role="separator"></div>`)):(0,o.qy)(m||(m=y`<ha-tooltip .disabled="${0}" .for="icon-button-${0}">${0} </ha-tooltip><ha-icon-button .id="icon-button-${0}" @click="${0}" .label="${0}" .path="${0}" ?disabled="${0}"></ha-icon-button> `),!t.tooltip,t.label,null!==(i=t.tooltip)&&void 0!==i?i:"",t.label,t.action,t.label,t.path,t.disabled)})))}_handleIconOverflowMenuOpened(t){t.stopPropagation()}static get styles(){return[l.RF,(0,o.AH)(v||(v=y`:host{display:flex;justify-content:flex-end}div[role=separator]{border-right:1px solid var(--divider-color);width:1px}`))]}constructor(...t){super(...t),this.items=[],this.narrow=!1}}(0,a.__decorate)([(0,r.MZ)({attribute:!1})],$.prototype,"hass",void 0),(0,a.__decorate)([(0,r.MZ)({type:Array})],$.prototype,"items",void 0),(0,a.__decorate)([(0,r.MZ)({type:Boolean})],$.prototype,"narrow",void 0),$=(0,a.__decorate)([(0,r.EM)("ha-icon-overflow-menu")],$),s()}catch(d){s(d)}})},36951:function(t,i,e){e.a(t,async function(t,i){try{e(32203),e(35748),e(5934),e(95013);var s=e(69868),a=e(84922),o=e(11991),r=e(44017),n=(e(10547),e(56657),e(27161)),l=e(954),h=e(21829),c=t([h]);h=(c.then?(await c)():c)[0];let d,p,u,_=t=>t;const g="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z";class f extends h.D{get _config(){return this.config}render(){return(0,a.qy)(d||(d=_` ${0} ${0} <ha-fab slot="fab" class="${0}" .label="${0}" .disabled="${0}" extended @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab> `),this.config.description?(0,a.qy)(p||(p=_`<ha-markdown class="description" breaks .content="${0}"></ha-markdown>`),this.config.description):a.s6,this.renderCard(),this.dirty?"dirty":"",this.hass.localize("ui.common.save"),this.saving,this._saveScript,g)}_saveScript(){(0,r.r)(this,"save-script")}async _getBlueprints(){this._blueprints=await(0,n.Xg)(this.hass,"script")}static get styles(){return[h.D.styles,l.T_,(0,a.AH)(u||(u=_`:host{position:relative;height:100%;min-height:calc(100vh - 85px);min-height:calc(100dvh - 85px)}ha-fab{position:fixed}`))]}constructor(...t){super(...t),this.saving=!1,this.dirty=!1}}(0,s.__decorate)([(0,o.MZ)({attribute:!1})],f.prototype,"config",void 0),(0,s.__decorate)([(0,o.MZ)({type:Boolean})],f.prototype,"saving",void 0),(0,s.__decorate)([(0,o.MZ)({type:Boolean})],f.prototype,"dirty",void 0),f=(0,s.__decorate)([(0,o.EM)("blueprint-script-editor")],f),i()}catch(d){i(d)}})},78080:function(t,i,e){e.a(t,async function(t,s){try{e.r(i);e(35748),e(65315),e(12840),e(837),e(5934),e(95013);var a=e(69868),o=e(97809),r=e(11991),n=e(65940),l=e(12275),h=e(51849),c=e(32293),d=e(69134),p=e(72421),u=e(31786),_=t([p,u]);[p,u]=_.then?(await _)():_;const g=(t,i)=>t.length===i.length&&t.every((t,e)=>t===i[e]);class f extends d.a{firstUpdated(t){super.firstUpdated(t),this.hass.loadBackendTranslation("device_automation")}updatePageEl(t,i){if(t.hass=this.hass,t.narrow=this.narrow,t.isWide=this.isWide,t.route=this.routeTail,t.showAdvanced=this.showAdvanced,t.entityRegistry=this._entityReg,this.hass&&(t.scripts&&i?i.has("hass")&&this._debouncedUpdateScripts(t):t.scripts=this._getScripts(this.hass.states)),(!i||i.has("route"))&&"show"===this._currentPage){t.creatingNew=void 0;const i=this.routeTail.path.substr(1);return void(t.entityId="new"===i?null:i)}if((!i||i.has("route"))&&"dashboard"!==this._currentPage){t.creatingNew=void 0;const i=this.routeTail.path.substr(1);t.scriptId="new"===i?null:i}}constructor(...t){super(...t),this.narrow=!1,this.isWide=!1,this.showAdvanced=!1,this.scripts=[],this.routerOptions={defaultPage:"dashboard",routes:{dashboard:{tag:"ha-script-picker",cache:!0},edit:{tag:"ha-script-editor"},show:{tag:"ha-script-editor"},trace:{tag:"ha-script-trace",load:()=>Promise.all([e.e("12265"),e.e("14632"),e.e("32888")]).then(e.bind(e,34667))}}},this._debouncedUpdateScripts=(0,h.s)(t=>{const i=this._getScripts(this.hass.states);g(i,t.scripts)||(t.scripts=i)},10),this._getScripts=(0,n.A)(t=>Object.values(t).filter(t=>"script"===(0,l.t)(t)&&!t.attributes.restored))}}(0,a.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,a.__decorate)([(0,r.MZ)({type:Boolean})],f.prototype,"narrow",void 0),(0,a.__decorate)([(0,r.MZ)({attribute:"is-wide",type:Boolean})],f.prototype,"isWide",void 0),(0,a.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"showAdvanced",void 0),(0,a.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"scripts",void 0),(0,a.__decorate)([(0,r.wk)(),(0,o.Fg)({context:c.ih,subscribe:!0})],f.prototype,"_entityReg",void 0),f=(0,a.__decorate)([(0,r.EM)("ha-config-script")],f),s()}catch(g){s(g)}})},72421:function(t,i,e){e.a(t,async function(t,i){try{e(32203),e(46852),e(35748),e(65315),e(84136),e(37089),e(59023),e(12977),e(5934),e(47849),e(95013);var s=e(69868),a=e(97809),o=e(84922),r=e(11991),n=e(75907),l=e(44017),h=e(77240),c=e(63870),d=e(73619),p=e(54337),u=e(17372),_=(e(78918),e(10547),e(61646)),g=(e(9058),e(77510),e(86160),e(6345)),f=e(27161),m=e(40550),v=e(32293),y=e(14523),b=e(59569),$=e(42699),w=e(15241),C=e(81579),A=(e(41564),e(79370)),k=e(81061),x=e(40328),H=e(22029),M=e(50809),V=e(40980),z=e(91197),S=e(31208),L=e(47503),q=e(31494),R=e(36951),I=e(75320),O=t([u,g,R,I]);[u,g,R,I]=O.then?(await O)():O;let Z,E,P,j,F,U,B,T,W,D,Y,K,N,G,J,Q,X,tt,it,et,st,at,ot=t=>t;const rt="M6,2A4,4 0 0,1 10,6V8H14V6A4,4 0 0,1 18,2A4,4 0 0,1 22,6A4,4 0 0,1 18,10H16V14H18A4,4 0 0,1 22,18A4,4 0 0,1 18,22A4,4 0 0,1 14,18V16H10V18A4,4 0 0,1 6,22A4,4 0 0,1 2,18A4,4 0 0,1 6,14H8V10H6A4,4 0 0,1 2,6A4,4 0 0,1 6,2M16,18A2,2 0 0,0 18,20A2,2 0 0,0 20,18A2,2 0 0,0 18,16H16V18M14,10H10V14H14V10M6,16A2,2 0 0,0 4,18A2,2 0 0,0 6,20A2,2 0 0,0 8,18V16H6M8,6A2,2 0 0,0 6,4A2,2 0 0,0 4,6A2,2 0 0,0 6,8H8V6M18,8A2,2 0 0,0 20,6A2,2 0 0,0 18,4A2,2 0 0,0 16,6V8H18Z",nt="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",lt="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z",ht="M12,14A2,2 0 0,1 14,16A2,2 0 0,1 12,18A2,2 0 0,1 10,16A2,2 0 0,1 12,14M23.46,8.86L21.87,15.75L15,14.16L18.8,11.78C17.39,9.5 14.87,8 12,8C8.05,8 4.77,10.86 4.12,14.63L2.15,14.28C2.96,9.58 7.06,6 12,6C15.58,6 18.73,7.89 20.5,10.72L23.46,8.86Z",ct="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",dt="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",pt="M6 2C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H10V20.1L20 10.1V8L14 2H6M13 3.5L18.5 9H13V3.5M20.1 13C20 13 19.8 13.1 19.7 13.2L18.7 14.2L20.8 16.3L21.8 15.3C22 15.1 22 14.7 21.8 14.5L20.5 13.2C20.4 13.1 20.3 13 20.1 13M18.1 14.8L12 20.9V23H14.1L20.2 16.9L18.1 14.8Z",ut="M17,7H22V17H17V19A1,1 0 0,0 18,20H20V22H17.5C16.95,22 16,21.55 16,21C16,21.55 15.05,22 14.5,22H12V20H14A1,1 0 0,0 15,19V5A1,1 0 0,0 14,4H12V2H14.5C15.05,2 16,2.45 16,3C16,2.45 16.95,2 17.5,2H20V4H18A1,1 0 0,0 17,5V7M2,7H13V9H4V15H13V17H2V7M20,15V9H17V15H20Z",_t="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",gt="M8,5.14V19.14L19,12.14L8,5.14Z",ft="M3 6V8H14V6H3M3 10V12H14V10H3M20 10.1C19.9 10.1 19.7 10.2 19.6 10.3L18.6 11.3L20.7 13.4L21.7 12.4C21.9 12.2 21.9 11.8 21.7 11.6L20.4 10.3C20.3 10.2 20.2 10.1 20 10.1M18.1 11.9L12 17.9V20H14.1L20.2 13.9L18.1 11.9M3 14V16H10V14H3Z",mt="M16,8H14V11H11V13H14V16H16V13H19V11H16M2,12C2,9.21 3.64,6.8 6,5.68V3.5C2.5,4.76 0,8.09 0,12C0,15.91 2.5,19.24 6,20.5V18.32C3.64,17.2 2,14.79 2,12M15,3C10.04,3 6,7.04 6,12C6,16.96 10.04,21 15,21C19.96,21 24,16.96 24,12C24,7.04 19.96,3 15,3M15,19C11.14,19 8,15.86 8,12C8,8.14 11.14,5 15,5C18.86,5 22,8.14 22,12C22,15.86 18.86,19 15,19Z",vt="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z",yt="M18,17H10.5L12.5,15H18M6,17V14.5L13.88,6.65C14.07,6.45 14.39,6.45 14.59,6.65L16.35,8.41C16.55,8.61 16.55,8.92 16.35,9.12L8.47,17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z",bt="M20 4H18V3H20.5C20.78 3 21 3.22 21 3.5V5.5C21 5.78 20.78 6 20.5 6H20V7H19V5H20V4M19 9H20V8H19V9M17 3H16V7H17V3M23 15V18C23 18.55 22.55 19 22 19H21V20C21 21.11 20.11 22 19 22H5C3.9 22 3 21.11 3 20V19H2C1.45 19 1 18.55 1 18V15C1 14.45 1.45 14 2 14H3C3 10.13 6.13 7 10 7H11V5.73C10.4 5.39 10 4.74 10 4C10 2.9 10.9 2 12 2S14 2.9 14 4C14 4.74 13.6 5.39 13 5.73V7H14C14.34 7 14.67 7.03 15 7.08V10H19.74C20.53 11.13 21 12.5 21 14H22C22.55 14 23 14.45 23 15M10 15.5C10 14.12 8.88 13 7.5 13S5 14.12 5 15.5 6.12 18 7.5 18 10 16.88 10 15.5M19 15.5C19 14.12 17.88 13 16.5 13S14 14.12 14 15.5 15.12 18 16.5 18 19 16.88 19 15.5M17 8H16V9H17V8Z",$t="M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z",wt="M15,12C15,10.7 14.16,9.6 13,9.18V6.82C14.16,6.4 15,5.3 15,4A3,3 0 0,0 12,1A3,3 0 0,0 9,4C9,5.3 9.84,6.4 11,6.82V9.19C9.84,9.6 9,10.7 9,12C9,13.3 9.84,14.4 11,14.82V17.18C9.84,17.6 9,18.7 9,20A3,3 0 0,0 12,23A3,3 0 0,0 15,20C15,18.7 14.16,17.6 13,17.18V14.82C14.16,14.4 15,13.3 15,12M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M12,21A1,1 0 0,1 11,20A1,1 0 0,1 12,19A1,1 0 0,1 13,20A1,1 0 0,1 12,21Z",Ct="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z",At=(0,x.E)((0,k._)((0,A.b)(o.WF)));class kt extends((0,H.w)(At)){willUpdate(t){if(super.willUpdate(t),this._entityRegCreated&&this._newScriptId&&t.has("entityRegistry")){const t=this.entityRegistry.find(t=>"script"===t.platform&&t.unique_id===this._newScriptId);t&&(this._entityRegCreated(t),this._entityRegCreated=void 0)}}render(){var t;if(!this._config)return o.s6;const i=this._entityId?this.hass.states[this._entityId]:void 0,e="use_blueprint"in this._config,s=V.c?(0,o.qy)(Z||(Z=ot`<ha-svg-icon .path="${0}"></ha-svg-icon>`),rt):this.hass.localize("ui.panel.config.automation.editor.ctrl");return(0,o.qy)(E||(E=ot` <hass-subpage .hass="${0}" .narrow="${0}" .route="${0}" .backCallback="${0}" .header="${0}"> ${0} ${0} <ha-button-menu slot="toolbar-icon"> <ha-icon-button slot="trigger" .label="${0}" .path="${0}"></ha-icon-button> ${0} <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> ${0} ${0} <ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> ${0} <ha-list-item .disabled="${0}" graphic="icon" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> ${0} <ha-list-item graphic="icon" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <li divider role="separator"></li> <ha-list-item .disabled="${0}" class="${0}" graphic="icon" @click="${0}"> ${0} <ha-svg-icon class="${0}" slot="graphic" .path="${0}"> </ha-svg-icon> </ha-list-item> </ha-button-menu> <div class="${0}"> ${0} </div> </hass-subpage> `),this.hass,this.narrow,this.route,this._backTapped,this._config.alias||this.hass.localize("ui.panel.config.script.editor.default_name"),"gui"!==this._mode||this.narrow?o.s6:(0,o.qy)(P||(P=ot`<ha-icon-button slot="toolbar-icon" .label="${0}" .path="${0}" @click="${0}" .disabled="${0}" id="button-undo"> </ha-icon-button> <ha-tooltip placement="bottom" for="button-undo"> ${0} <span class="shortcut"> (<span>${0}</span> <span>+</span> <span>Z</span>) </span> </ha-tooltip> <ha-icon-button slot="toolbar-icon" .label="${0}" .path="${0}" @click="${0}" .disabled="${0}" id="button-redo"> </ha-icon-button> <ha-tooltip placement="bottom" for="button-redo"> ${0} <span class="shortcut">( ${0}) </span> </ha-tooltip>`),this.hass.localize("ui.common.undo"),Ct,this.undo,!this.canUndo,this.hass.localize("ui.common.undo"),s,this.hass.localize("ui.common.redo"),vt,this.redo,!this.canRedo,this.hass.localize("ui.common.redo"),V.c?(0,o.qy)(j||(j=ot`<span>${0}</span> <span>+</span> <span>Shift</span> <span>+</span> <span>Z</span>`),s):(0,o.qy)(F||(F=ot`<span>${0}</span> <span>+</span> <span>Y</span>`),s)),this.scriptId&&!this.narrow?(0,o.qy)(U||(U=ot` <ha-button appearance="plain" @click="${0}" slot="toolbar-icon"> ${0} </ha-button> `),this._showTrace,this.hass.localize("ui.panel.config.script.editor.show_trace")):"",this.hass.localize("ui.common.menu"),dt,"gui"===this._mode&&this.narrow?(0,o.qy)(B||(B=ot`<ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item>`),this.undo,!this.canUndo,this.hass.localize("ui.common.undo"),Ct,this.redo,!this.canRedo,this.hass.localize("ui.common.redo"),vt):o.s6,!this.scriptId,this._showInfo,this.hass.localize("ui.panel.config.script.editor.show_info"),_t,!i,this._showSettings,this.hass.localize("ui.panel.config.automation.picker.show_settings"),nt,!i,this._editCategory,this.hass.localize("ui.panel.config.scene.picker."+(null!==(t=this._registryEntry)&&void 0!==t&&null!==(t=t.categories)&&void 0!==t&&t.script?"edit_category":"assign_category")),$t,!this.scriptId,this._runScript,this.hass.localize("ui.panel.config.script.picker.run_script"),gt,this.scriptId&&this.narrow?(0,o.qy)(T||(T=ot` <a href="/config/script/trace/${0}"> <ha-list-item graphic="icon"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> </a> `),this.scriptId,this.hass.localize("ui.panel.config.script.editor.show_trace"),wt):o.s6,e||"fields"in this._config?o.s6:(0,o.qy)(W||(W=ot` <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> `),this._readOnly||"yaml"===this._mode,this._addFields,this.hass.localize("ui.panel.config.script.editor.field.add_fields"),ut),this._promptScriptAlias,!this.scriptId||this._readOnly||"yaml"===this._mode,this.hass.localize("ui.panel.config.script.editor.rename"),yt,e?o.s6:(0,o.qy)(D||(D=ot` <ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> `),this._promptScriptMode,this._readOnly||"yaml"===this._mode,this.hass.localize("ui.panel.config.script.editor.change_mode"),ht),this._blueprintConfig||!this._readOnly&&!this.scriptId,this._duplicate,this.hass.localize(this._readOnly?"ui.panel.config.script.editor.migrate":"ui.panel.config.script.editor.duplicate"),mt,e?(0,o.qy)(Y||(Y=ot` <ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> `),this._takeControl,this._readOnly,this.hass.localize("ui.panel.config.script.editor.take_control"),pt):o.s6,"gui"===this._mode?this._switchYamlMode:this._switchUiMode,this.hass.localize("ui.panel.config.automation.editor.edit_"+("gui"===this._mode?"yaml":"ui")),ft,this._readOnly||!this.scriptId,(0,n.H)({warning:Boolean(this.scriptId)}),this._deleteConfirm,this.hass.localize("ui.panel.config.script.picker.delete"),(0,n.H)({warning:Boolean(this.scriptId)}),ct,"yaml"===this._mode?"yaml-mode":"","gui"===this._mode?(0,o.qy)(K||(K=ot` <div> ${0} </div> `),e?(0,o.qy)(N||(N=ot` <blueprint-script-editor .hass="${0}" .narrow="${0}" .isWide="${0}" .config="${0}" .disabled="${0}" .saving="${0}" .dirty="${0}" @value-changed="${0}" @save-script="${0}"></blueprint-script-editor> `),this.hass,this.narrow,this.isWide,this._config,this._readOnly,this._saving,this._dirty,this._valueChanged,this._handleSaveScript):(0,o.qy)(G||(G=ot` <manual-script-editor .hass="${0}" .narrow="${0}" .isWide="${0}" .config="${0}" .disabled="${0}" .dirty="${0}" .saving="${0}" @value-changed="${0}" @editor-save="${0}" @save-script="${0}" @undo-paste="${0}"> <div class="alert-wrapper" slot="alerts"> ${0} ${0} </div> </manual-script-editor> `),this.hass,this.narrow,this.isWide,this._config,this._readOnly,this._dirty,this._saving,this._valueChanged,this._handleSaveScript,this._handleSaveScript,this.undo,this._errors||(null==i?void 0:i.state)===y.Hh?(0,o.qy)(J||(J=ot`<ha-alert alert-type="error" .title="${0}"> ${0} ${0} </ha-alert>`),(null==i?void 0:i.state)===y.Hh?this.hass.localize("ui.panel.config.script.editor.unavailable"):void 0,this._errors||this._validationErrors,(null==i?void 0:i.state)===y.Hh?(0,o.qy)(Q||(Q=ot`<ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon>`),bt):o.s6):o.s6,this._blueprintConfig?(0,o.qy)(X||(X=ot`<ha-alert alert-type="info"> ${0} <div slot="action" style="display:flex"> <ha-button appearance="plain" @click="${0}">${0}</ha-button> <ha-button appearance="plain" @click="${0}">${0}</ha-button> </div> </ha-alert>`),this.hass.localize("ui.panel.config.script.editor.confirm_take_control"),this._takeControlSave,this.hass.localize("ui.common.yes"),this._revertBlueprint,this.hass.localize("ui.common.no")):this._readOnly?(0,o.qy)(tt||(tt=ot`<ha-alert alert-type="warning" dismissable>${0} <ha-button appearance="plain" slot="action" @click="${0}"> ${0} </ha-button> </ha-alert>`),this.hass.localize("ui.panel.config.script.editor.read_only"),this._duplicate,this.hass.localize("ui.panel.config.script.editor.migrate")):o.s6)):"yaml"===this._mode?(0,o.qy)(it||(it=ot`<ha-yaml-editor .hass="${0}" .defaultValue="${0}" .readOnly="${0}" disable-fullscreen @value-changed="${0}" @editor-save="${0}" .showErrors="${0}"></ha-yaml-editor> <ha-fab slot="fab" class="${0}" .label="${0}" .disabled="${0}" extended @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab>`),this.hass,this._preprocessYaml(),this._readOnly,this._yamlChanged,this._handleSaveScript,!1,!this._readOnly&&this._dirty?"dirty":"",this.hass.localize("ui.common.save"),this._saving,this._handleSaveScript,lt):o.s6)}updated(t){super.updated(t);const i=t.get("scriptId");if(!t.has("scriptId")||!this.scriptId||this.entityId||!this.hass||i&&i===this.scriptId||this._loadConfig(),(t.has("scriptId")||t.has("entityRegistry"))&&this.scriptId&&this.entityRegistry){const t=this.entityRegistry.find(t=>"script"===t.platform&&t.unique_id===this.scriptId);this._entityId=null==t?void 0:t.entity_id}if(t.has("scriptId")&&!this.scriptId&&this.hass){const t=(0,$.NX)();this._dirty=!!t;const i={};t&&"use_blueprint"in t||(i.sequence=[]),this._config=Object.assign(Object.assign({},i),t),this._readOnly=!1}if(t.has("entityId")&&this.entityId){(0,$.R$)(this.hass,this.entityId).then(t=>{this._config=(0,$.nB)(t.config),this._checkValidation()});const t=this.entityRegistry.find(t=>t.entity_id===this.entityId);null!=t&&t.unique_id&&(this.scriptId=t.unique_id),this._entityId=this.entityId,this._dirty=!1,this._readOnly=!0}}async _checkValidation(){if(this._validationErrors=void 0,!this._entityId||!this._config)return;const t=this.hass.states[this._entityId];if((null==t?void 0:t.state)!==y.Hh)return;const i=await(0,m.$)(this.hass,{actions:this._config.sequence});this._validationErrors=Object.entries(i).map(([t,i])=>i.valid?"":(0,o.qy)(et||(et=ot`${0}: ${0}<br>`),this.hass.localize(`ui.panel.config.automation.editor.${t}.name`),i.error))}async _loadConfig(){(0,$.Kq)(this.hass,this.scriptId).then(t=>{this._dirty=!1,this._readOnly=!1,this._config=(0,$.nB)(t);const i=this.entityRegistry.find(t=>"script"===t.platform&&t.unique_id===this.scriptId);this._entityId=null==i?void 0:i.entity_id,this._checkValidation()},t=>{const i=this.entityRegistry.find(t=>"script"===t.platform&&t.unique_id===this.scriptId);i?(0,h.o)(`/config/script/show/${i.entity_id}`,{replace:!0}):(alert(404===t.status_code?this.hass.localize("ui.panel.config.script.editor.load_error_not_editable"):this.hass.localize("ui.panel.config.script.editor.load_error_unknown",{err_no:t.status_code||t.code})),(0,h.O)("/config"))})}_valueChanged(t){this._config&&this.pushToUndo(this._config),this._config=t.detail.value,this._errors=void 0,this._dirty=!0}async _runScript(t){t.stopPropagation(),(0,$.TP)(this.hass,this._entityId)?(0,C.p)(this,{entityId:this._entityId}):(await(0,$.kR)(this.hass,this.scriptId),(0,z.P)(this,{message:this.hass.localize("ui.notification_toast.triggered",{name:this._config.alias})}))}_showSettings(){(0,C.p)(this,{entityId:this._entityId,view:"settings"})}_editCategory(){this._registryEntry?(0,q.j)(this,{scope:"script",entityReg:this._registryEntry}):(0,w.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.scene.picker.no_category_support"),text:this.hass.localize("ui.panel.config.scene.picker.no_category_entity_reg")})}_computeEntityIdFromAlias(t){const i=(0,c.Y)(t);let e=i,s=2;for(;this._idIsUsed(e);)e=`${i}_${s}`,s++;return e}_idIsUsed(t){return`script.${t}`in this.hass.states||this.entityRegistry.some(i=>i.unique_id===t)}async _showInfo(){if(!this.scriptId)return;const t=this.entityRegistry.find(t=>t.unique_id===this.scriptId);t&&(0,l.r)(this,"hass-more-info",{entityId:t.entity_id})}async _showTrace(){if(this.scriptId){await this._confirmUnsavedChanged()&&(0,h.o)(`/config/script/trace/${this.scriptId}`)}}_addFields(){var t;"fields"in this._config||(this._config&&this.pushToUndo(this._config),null===(t=this._manualEditor)||void 0===t||t.addFields(),this._dirty=!0)}_preprocessYaml(){return this._config}_yamlChanged(t){t.stopPropagation(),this._dirty=!0,t.detail.isValid?(this._yamlErrors=void 0,this._config=t.detail.value,this._errors=void 0):this._yamlErrors=t.detail.errorMsg}async _confirmUnsavedChanged(){return!this._dirty||new Promise(t=>{(0,L._)(this,{config:this._config,domain:"script",updateConfig:async(i,e)=>{this._config=i,this._entityRegistryUpdate=e,this._dirty=!0,this.requestUpdate();const s=this.scriptId||String(Date.now());try{await this._saveScript(s)}catch(a){return this.requestUpdate(),void t(!1)}t(!0)},onClose:()=>t(!1),onDiscard:()=>t(!0),entityRegistryUpdate:this._entityRegistryUpdate,entityRegistryEntry:this._registryEntry,title:this.hass.localize(this.scriptId?"ui.panel.config.script.editor.leave.unsaved_confirm_title":"ui.panel.config.script.editor.leave.unsaved_new_title"),description:this.hass.localize(this.scriptId?"ui.panel.config.script.editor.leave.unsaved_confirm_text":"ui.panel.config.script.editor.leave.unsaved_new_text"),hideInputs:null!==this.scriptId})})}async _takeControl(){const t=this._config;try{const e=await(0,f.oz)(this.hass,"script",t.use_blueprint.path,t.use_blueprint.input||{}),s=Object.assign(Object.assign({},(0,$.nB)(e.substituted_config)),{},{alias:t.alias,description:t.description});var i;if(this._blueprintConfig=t,this._config=s,"yaml"===this._mode)null===(i=this.renderRoot.querySelector("ha-yaml-editor"))||void 0===i||i.setValue(this._config);this._readOnly=!0,this._errors=void 0}catch(e){this._errors=e.message}}_revertBlueprint(){var t;(this._config=this._blueprintConfig,"yaml"===this._mode)&&(null===(t=this.renderRoot.querySelector("ha-yaml-editor"))||void 0===t||t.setValue(this._config));this._blueprintConfig=void 0,this._readOnly=!1}_takeControlSave(){this._readOnly=!1,this._dirty=!0,this._blueprintConfig=void 0}async _duplicate(){var t,i;(this._readOnly?await(0,w.showConfirmationDialog)(this,{title:this.hass.localize("ui.panel.config.script.picker.migrate_script"),text:this.hass.localize("ui.panel.config.script.picker.migrate_script_description")}):await this._confirmUnsavedChanged())&&(this._entityId=void 0,(0,$.AM)(Object.assign(Object.assign({},this._config),{},{alias:this._readOnly?null===(t=this._config)||void 0===t?void 0:t.alias:`${null===(i=this._config)||void 0===i?void 0:i.alias} (${this.hass.localize("ui.panel.config.script.picker.duplicate")})`})))}async _deleteConfirm(){var t;(0,w.showConfirmationDialog)(this,{title:this.hass.localize("ui.panel.config.script.editor.delete_confirm_title"),text:this.hass.localize("ui.panel.config.script.editor.delete_confirm_text",{name:null===(t=this._config)||void 0===t?void 0:t.alias}),confirmText:this.hass.localize("ui.common.delete"),destructive:!0,dismissText:this.hass.localize("ui.common.cancel"),confirm:()=>this._delete()})}async _delete(){await(0,$.Ht)(this.hass,this.scriptId),(0,h.O)("/config")}async _switchUiMode(){if(this._yamlErrors){if(!(await(0,w.showConfirmationDialog)(this,{text:(0,o.qy)(st||(st=ot`${0}<br><br>${0}`),this.hass.localize("ui.panel.config.automation.editor.switch_ui_yaml_error"),this._yamlErrors),confirmText:this.hass.localize("ui.common.continue"),destructive:!0,dismissText:this.hass.localize("ui.common.cancel")})))return}this._yamlErrors=void 0,this._mode="gui"}_switchYamlMode(){this._mode="yaml"}async _promptScriptAlias(){return new Promise(t=>{(0,L._)(this,{config:this._config,domain:"script",updateConfig:async(i,e)=>{this._config=i,this._entityRegistryUpdate=e,this._dirty=!0,this.requestUpdate(),t(!0)},onClose:()=>t(!1),entityRegistryUpdate:this._entityRegistryUpdate,entityRegistryEntry:this.entityRegistry.find(t=>t.unique_id===this.scriptId)})})}async _promptScriptMode(){return new Promise(t=>{(0,S.e)(this,{config:this._config,updateConfig:i=>{this._config=i,this._dirty=!0,this.requestUpdate(),t()},onClose:()=>t()})})}async _handleSaveScript(){var t;if(this._yamlErrors)return void(0,z.P)(this,{message:this._yamlErrors});if(null===(t=this._manualEditor)||void 0===t||t.resetPastedConfig(),!this.scriptId){if(!(await this._promptScriptAlias()))return;this._entityId=this._computeEntityIdFromAlias(this._config.alias)}const i=this.scriptId||this._entityId||Date.now();await this._saveScript(i),this.scriptId||(0,h.o)(`/config/script/edit/${i}`,{replace:!0})}async _saveScript(t){let i;this._saving=!0,void 0===this._entityRegistryUpdate||this.scriptId||(this._newScriptId=t.toString(),i=new Promise(t=>{this._entityRegCreated=t}));try{if(await this.hass.callApi("POST","config/script/config/"+t,this._config),void 0!==this._entityRegistryUpdate){let t=this._entityId;if(i)try{t=(await(0,d.h)(5e3,i)).entity_id}catch(a){if(t=void 0,!(a instanceof Error&&"TimeoutError"===a.name))throw a;(0,w.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.automation.editor.new_automation_setup_failed_title",{type:this.hass.localize("ui.panel.config.automation.editor.type_script")}),text:this.hass.localize("ui.panel.config.automation.editor.new_automation_setup_failed_text",{type:this.hass.localize("ui.panel.config.automation.editor.type_script"),types:this.hass.localize("ui.panel.config.automation.editor.type_script_plural")}),warning:!0})}t&&await(0,b.G_)(this.hass,t,{categories:{script:this._entityRegistryUpdate.category||null},labels:this._entityRegistryUpdate.labels||[],area_id:this._entityRegistryUpdate.area||null})}this._dirty=!1}catch(o){var e,s;throw this._errors=(null===(e=o.body)||void 0===e?void 0:e.message)||o.error||o.body,(0,z.P)(this,{message:(null===(s=o.body)||void 0===s?void 0:s.message)||o.error||o.body}),o}finally{this._saving=!1}}supportedShortcuts(){return{s:()=>this._handleSaveScript(),c:()=>this._copySelectedRow(),x:()=>this._cutSelectedRow(),Delete:()=>this._deleteSelectedRow(),Backspace:()=>this._deleteSelectedRow(),z:()=>this.undo(),Z:()=>this.redo(),y:()=>this.redo()}}get isDirty(){return this._dirty}async promptDiscardChanges(){return this._confirmUnsavedChanged()}_collapseAll(){var t;null===(t=this._manualEditor)||void 0===t||t.collapseAll()}_expandAll(){var t;null===(t=this._manualEditor)||void 0===t||t.expandAll()}_copySelectedRow(){var t;null===(t=this._manualEditor)||void 0===t||t.copySelectedRow()}_cutSelectedRow(){var t;null===(t=this._manualEditor)||void 0===t||t.cutSelectedRow()}_deleteSelectedRow(){var t;null===(t=this._manualEditor)||void 0===t||t.deleteSelectedRow()}get currentConfig(){return this._config}applyUndoRedo(t){var i;null===(i=this._manualEditor)||void 0===i||i.triggerCloseSidebar(),this._config=t,this._dirty=!0}static get styles(){return[M.RF,(0,o.AH)(at||(at=ot`:host{--ha-automation-editor-max-width:var(
            --ha-automation-editor-width,
            1540px
          );--hass-subpage-bottom-inset:0px}.yaml-mode{height:100%;display:flex;flex-direction:column;padding-bottom:0}blueprint-script-editor,manual-script-editor{margin:0 auto;max-width:1040px;padding:28px 20px 0;display:block}:not(.yaml-mode)>.error-wrapper{position:absolute;top:4px;z-index:3;width:100%;display:flex;flex-direction:column;align-items:center}:not(.yaml-mode)>.error-wrapper ha-alert{background-color:var(--card-background-color);box-shadow:0 2px 4px rgba(0,0,0,.2);border-radius:var(--ha-border-radius-sm)}.alert-wrapper{position:sticky;top:-24px;margin-top:-24px;margin-bottom:8px;z-index:1;width:100%;display:flex;flex-direction:column;align-items:center;gap:8px;pointer-events:none}.alert-wrapper ha-alert{background-color:var(--card-background-color);box-shadow:0 2px 4px rgba(0,0,0,.2);border-radius:var(--ha-border-radius-sm);margin-bottom:0;pointer-events:auto}manual-script-editor{max-width:var(--ha-automation-editor-max-width);padding:0 12px}ha-yaml-editor{flex-grow:1;--actions-border-radius:0;--code-mirror-height:100%;min-height:0;display:flex;flex-direction:column}p{margin-bottom:0}span[slot=introduction] a{color:var(--primary-color)}ha-fab{position:fixed;right:16px;bottom:calc(-80px - var(--safe-area-inset-bottom));transition:bottom .3s}ha-fab.dirty{bottom:calc(16px + var(--safe-area-inset-bottom,0px))}li[role=separator]{border-bottom-color:var(--divider-color)}.header{display:flex;margin:16px 0;align-items:center}.header .name{font-size:var(--ha-font-size-xl);font-weight:var(--ha-font-weight-normal);flex:1}.header a{color:var(--secondary-text-color)}ha-button-menu a{text-decoration:none;color:var(--primary-color)}ha-tooltip ha-svg-icon{width:12px}ha-tooltip .shortcut{display:inline-flex;flex-direction:row;align-items:center;gap:2px}`))]}constructor(...t){super(...t),this.scriptId=null,this.entityId=null,this.isWide=!1,this.narrow=!1,this._dirty=!1,this._mode="gui",this._readOnly=!1,this._saving=!1,this._backTapped=async()=>{await this._confirmUnsavedChanged()&&(0,p.m)(()=>(0,h.O)("/config"))}}}(0,s.__decorate)([(0,r.MZ)({attribute:!1})],kt.prototype,"hass",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],kt.prototype,"scriptId",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],kt.prototype,"entityId",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],kt.prototype,"entityRegistry",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"is-wide",type:Boolean})],kt.prototype,"isWide",void 0),(0,s.__decorate)([(0,r.MZ)({type:Boolean})],kt.prototype,"narrow",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],kt.prototype,"route",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_config",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_dirty",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_errors",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_yamlErrors",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_entityId",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_mode",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_readOnly",void 0),(0,s.__decorate)([(0,r.wk)(),(0,a.Fg)({context:v.ih,subscribe:!0}),(0,_.p)({transformer:function(t){return t.find(({entity_id:t})=>t===this._entityId)},watch:["_entityId"]})],kt.prototype,"_registryEntry",void 0),(0,s.__decorate)([(0,r.P)("manual-script-editor")],kt.prototype,"_manualEditor",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_validationErrors",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_blueprintConfig",void 0),(0,s.__decorate)([(0,r.wk)()],kt.prototype,"_saving",void 0),customElements.define("ha-script-editor",kt),i()}catch(Z){i(Z)}})},46263:function(t,i,e){e.a(t,async function(t,i){try{e(79827),e(35748),e(12977),e(18223),e(95013);var s=e(69868),a=e(84922),o=e(11991),r=e(75907),n=e(44017),l=e(72722),h=e(63211),c=(e(10366),e(70490),e(19912),e(92409),e(70053)),d=e(15241),p=e(50809),u=e(40980),_=e(954),g=e(33926),f=t([g]);g=(f.then?(await f)():f)[0];let m,v,y,b,$,w,C,A=t=>t;const k="M6,2A4,4 0 0,1 10,6V8H14V6A4,4 0 0,1 18,2A4,4 0 0,1 22,6A4,4 0 0,1 18,10H16V14H18A4,4 0 0,1 22,18A4,4 0 0,1 18,22A4,4 0 0,1 14,18V16H10V18A4,4 0 0,1 6,22A4,4 0 0,1 2,18A4,4 0 0,1 6,14H8V10H6A4,4 0 0,1 2,6A4,4 0 0,1 6,2M16,18A2,2 0 0,0 18,20A2,2 0 0,0 20,18A2,2 0 0,0 18,16H16V18M14,10H10V14H14V10M6,16A2,2 0 0,0 4,18A2,2 0 0,0 6,20A2,2 0 0,0 8,18V16H6M8,6A2,2 0 0,0 6,4A2,2 0 0,0 4,6A2,2 0 0,0 6,8H8V6M18,8A2,2 0 0,0 20,6A2,2 0 0,0 18,4A2,2 0 0,0 16,6V8H18Z",x="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",H="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",M="M3 6V8H14V6H3M3 10V12H14V10H3M20 10.1C19.9 10.1 19.7 10.2 19.6 10.3L18.6 11.3L20.7 13.4L21.7 12.4C21.9 12.2 21.9 11.8 21.7 11.6L20.4 10.3C20.3 10.2 20.2 10.1 20 10.1M18.1 11.9L12 17.9V20H14.1L20.2 13.9L18.1 11.9M3 14V16H10V14H3Z";class V extends a.WF{render(){return(0,a.qy)(m||(m=A` <ha-card outlined> <ha-automation-row .disabled="${0}" @click="${0}" .selected="${0}" left-chevron @toggle-collapsed="${0}" .collapsed="${0}" .highlight="${0}" @delete-row="${0}"> <ha-md-button-menu quick slot="icons" @click="${0}" @keydown="${0}" @closed="${0}" positioning="fixed" anchor-corner="end-end" menu-corner="start-end"> <ha-icon-button slot="trigger" .label="${0}" .path="${0}"></ha-icon-button> <ha-md-menu-item .clickAction="${0}"> <ha-svg-icon slot="start" .path="${0}"></ha-svg-icon> <div class="overflow-label"> ${0} <span class="shortcut-placeholder ${0}"></span> </div> </ha-md-menu-item> <ha-md-menu-item .clickAction="${0}" .disabled="${0}" class="warning"> <ha-svg-icon slot="start" .path="${0}"></ha-svg-icon> <div class="overflow-label"> ${0} ${0} </div> </ha-md-menu-item> </ha-md-button-menu> <h3 slot="header">${0}</h3> <slot name="icons" slot="icons"></slot> </ha-automation-row> </ha-card> <div class="${0}"> <ha-card> <ha-automation-row .selected="${0}" @click="${0}" .collapsed="${0}" @toggle-collapsed="${0}" .leftChevron="${0}" .highlight="${0}"> <h3 slot="header"> ${0} ${0} </h3> <ha-md-button-menu quick slot="icons" @click="${0}" @keydown="${0}" @closed="${0}" positioning="fixed" anchor-corner="end-end" menu-corner="start-end"> <ha-icon-button slot="trigger" .label="${0}" .path="${0}"></ha-icon-button> <ha-md-menu-item .clickAction="${0}" selector-row> <ha-svg-icon slot="start" .path="${0}"></ha-svg-icon> <div class="overflow-label"> ${0} <span class="shortcut-placeholder ${0}"></span> </div> </ha-md-menu-item> <ha-md-menu-item .clickAction="${0}" .disabled="${0}" class="warning"> <ha-svg-icon slot="start" .path="${0}"></ha-svg-icon> <div class="overflow-label"> ${0} ${0} </div> </ha-md-menu-item> </ha-md-button-menu> </ha-automation-row> </ha-card> ${0} </div> `),this.disabled,this._toggleSidebar,this._selected,this._toggleCollapse,this._collapsed,this.highlight,this._onDelete,l.C,h.d,h.d,this.hass.localize("ui.common.menu"),H,this._toggleYamlMode,M,this.hass.localize("ui.panel.config.automation.editor.edit_"+(this._yamlMode?"ui":"yaml")),u.c?"mac":"",this._onDelete,this.disabled,x,this.hass.localize("ui.panel.config.automation.editor.actions.delete"),this.narrow?a.s6:(0,a.qy)(v||(v=A`<span class="shortcut"> <span>${0}</span> <span>+</span> <span>${0}</span> </span>`),u.c?(0,a.qy)(y||(y=A`<ha-svg-icon slot="start" .path="${0}"></ha-svg-icon>`),k):this.hass.localize("ui.panel.config.automation.editor.ctrl"),this.hass.localize("ui.panel.config.automation.editor.del")),this.key,(0,r.H)({"selector-row":!0,"parent-selected":this._selected,hidden:this._collapsed}),this._selectorRowSelected,this._toggleSelectorSidebar,this._selectorRowCollapsed,this._toggleSelectorRowCollapse,c.W.includes(Object.keys(this.field.selector)[0]),this.highlight,this.hass.localize(`ui.components.selectors.selector.types.${Object.keys(this.field.selector)[0]}`),this.hass.localize("ui.panel.config.script.editor.field.selector"),l.C,h.d,h.d,this.hass.localize("ui.common.menu"),H,this._toggleYamlMode,M,this.hass.localize("ui.panel.config.automation.editor.edit_"+(this._yamlMode?"ui":"yaml")),u.c?"mac":"",this._onDelete,this.disabled,x,this.hass.localize("ui.panel.config.automation.editor.actions.delete"),this.narrow?a.s6:(0,a.qy)(b||(b=A`<span class="shortcut"> <span>${0}</span> <span>+</span> <span>${0}</span> </span>`),u.c?(0,a.qy)($||($=A`<ha-svg-icon slot="start" .path="${0}"></ha-svg-icon>`),k):this.hass.localize("ui.panel.config.automation.editor.ctrl"),this.hass.localize("ui.panel.config.automation.editor.del")),"object"==typeof this.field.selector&&c.W.includes(Object.keys(this.field.selector)[0])?(0,a.qy)(w||(w=A` <ha-script-field-selector-editor class="${0}" .selected="${0}" .hass="${0}" .field="${0}" .disabled="${0}" indent @value-changed="${0}" .narrow="${0}"></ha-script-field-selector-editor> `),this._selectorRowCollapsed?"hidden":"",this._selectorRowSelected,this.hass,this.field,this.disabled,this._selectorValueChanged,this.narrow):a.s6)}_toggleCollapse(){this._collapsed=!this._collapsed}expand(){this._collapsed=!1}collapse(){this._collapsed=!0}expandSelectorRow(){this._selectorRowCollapsed=!1}collapseSelectorRow(){this._selectorRowCollapsed=!0}_toggleSelectorRowCollapse(){this._selectorRowCollapsed=!this._selectorRowCollapsed}expandAll(){var t;this.expand(),this.expandSelectorRow(),null===(t=this._selectorEditor)||void 0===t||t.expandAll()}collapseAll(){var t;this.collapse(),this.collapseSelectorRow(),null===(t=this._selectorEditor)||void 0===t||t.collapseAll()}_toggleSidebar(t){null==t||t.stopPropagation(),this._selected?(0,n.r)(this,"request-close-sidebar"):(this._selected=!0,this._collapsed=!1,this.openSidebar())}_toggleSelectorSidebar(t){null==t||t.stopPropagation(),this._selectorRowSelected?(0,n.r)(this,"request-close-sidebar"):(this._selectorRowSelected=!0,this._selectorRowCollapsed=!1,this.openSidebar(!0))}_selectorValueChanged(t){t.stopPropagation(),(0,n.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.field),{},{key:this.key},t.detail.value)})}openSidebar(t=!1){t||(this._selected=!0),(0,n.r)(this,"open-sidebar",{save:t=>{(0,n.r)(this,"value-changed",{value:t})},close:i=>{t?(this._selectorRowSelected=!1,i&&this.focusSelector()):(this._selected=!1,i&&this.focus()),(0,n.r)(this,"close-sidebar")},toggleYamlMode:()=>{this._toggleYamlMode(),this.openSidebar()},delete:this._onDelete,config:{field:this.field,selector:t,key:this.key,excludeKeys:this.excludeKeys},yamlMode:this._yamlMode}),this.narrow&&window.setTimeout(()=>{this.scrollIntoView({block:"start",behavior:"smooth"})},180)}focus(){var t;null===(t=this._fieldRowElement)||void 0===t||t.focus()}focusSelector(){var t;null===(t=this._selectorRowElement)||void 0===t||t.focus()}static get styles(){return[p.RF,_.aM,_.Lt,(0,a.AH)(C||(C=A`.disabled{opacity:.5;pointer-events:none}.hidden{display:none}h3{margin:0;font-size:inherit;font-weight:inherit}.action-icon{display:none}@media (min-width:870px){.action-icon{display:inline-block;color:var(--secondary-text-color);opacity:.9;margin-right:8px;margin-inline-end:8px;margin-inline-start:initial}}.card-content{padding:16px}.disabled-bar{background:var(--divider-color,#e0e0e0);text-align:center;border-top-right-radius:calc(var(--ha-card-border-radius,12px) - var(--ha-card-border-width,1px));border-top-left-radius:calc(var(--ha-card-border-radius,12px) - var(--ha-card-border-width,1px))}.warning ul{margin:4px 0}.selected_menu_item{color:var(--primary-color)}li[role=separator]{border-bottom-color:var(--divider-color)}.selector-row{padding-top:12px;padding-bottom:16px;padding-inline-start:16px;padding-inline-end:0px}`))]}constructor(...t){super(...t),this.excludeKeys=[],this.disabled=!1,this.narrow=!1,this._yamlMode=!1,this._selected=!1,this._collapsed=!1,this._selectorRowSelected=!1,this._selectorRowCollapsed=!1,this._toggleYamlMode=t=>{this._yamlMode=!this._yamlMode,t&&this.openSidebar(t.hasAttribute("selector-row"))},this._onDelete=()=>{(0,d.showConfirmationDialog)(this,{title:this.hass.localize("ui.panel.config.script.editor.field_delete_confirm_title"),text:this.hass.localize("ui.panel.config.script.editor.field_delete_confirm_text"),dismissText:this.hass.localize("ui.common.cancel"),confirmText:this.hass.localize("ui.common.delete"),destructive:!0,confirm:()=>{(0,n.r)(this,"value-changed",{value:null}),(this._selected||this._selectorRowSelected)&&(0,n.r)(this,"close-sidebar")}})}}}(0,s.__decorate)([(0,o.MZ)({attribute:!1})],V.prototype,"hass",void 0),(0,s.__decorate)([(0,o.MZ)()],V.prototype,"key",void 0),(0,s.__decorate)([(0,o.MZ)({attribute:!1,type:Array})],V.prototype,"excludeKeys",void 0),(0,s.__decorate)([(0,o.MZ)({attribute:!1})],V.prototype,"field",void 0),(0,s.__decorate)([(0,o.MZ)({type:Boolean})],V.prototype,"disabled",void 0),(0,s.__decorate)([(0,o.MZ)({type:Boolean})],V.prototype,"narrow",void 0),(0,s.__decorate)([(0,o.MZ)({type:Boolean})],V.prototype,"highlight",void 0),(0,s.__decorate)([(0,o.wk)()],V.prototype,"_yamlMode",void 0),(0,s.__decorate)([(0,o.wk)()],V.prototype,"_selected",void 0),(0,s.__decorate)([(0,o.wk)()],V.prototype,"_collapsed",void 0),(0,s.__decorate)([(0,o.wk)()],V.prototype,"_selectorRowSelected",void 0),(0,s.__decorate)([(0,o.wk)()],V.prototype,"_selectorRowCollapsed",void 0),(0,s.__decorate)([(0,o.P)("ha-script-field-selector-editor")],V.prototype,"_selectorEditor",void 0),(0,s.__decorate)([(0,o.P)("ha-automation-row:first-of-type")],V.prototype,"_fieldRowElement",void 0),(0,s.__decorate)([(0,o.P)(".selector-row ha-automation-row")],V.prototype,"_selectorRowElement",void 0),V=(0,s.__decorate)([(0,o.EM)("ha-script-field-row")],V),i()}catch(m){i(m)}})},20233:function(t,i,e){e.a(t,async function(t,i){try{e(35748),e(65315),e(837),e(22416),e(37089),e(12977),e(95013);var s=e(69868),a=e(84922),o=e(11991),r=e(44017),n=e(17372),l=(e(78918),e(86160),e(46263)),h=t([n,l]);[n,l]=h.then?(await h)():h;let c,d,p,u,_=t=>t;const g="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z";class f extends a.WF{render(){return(0,a.qy)(c||(c=_` ${0} <ha-button @click="${0}" .disabled="${0}"> <ha-svg-icon .path="${0}" slot="start"></ha-svg-icon> ${0} </ha-button> `),this.fields?(0,a.qy)(d||(d=_`<div class="fields"> ${0} </div> `),Object.entries(this.fields).map(([t,i])=>{var e;return(0,a.qy)(p||(p=_` <ha-script-field-row .key="${0}" .excludeKeys="${0}" .field="${0}" .disabled="${0}" @value-changed="${0}" .hass="${0}" .highlight="${0}" .narrow="${0}"> </ha-script-field-row> `),t,Object.keys(this.fields).filter(i=>i!==t),i,this.disabled,this._fieldChanged,this.hass,void 0!==(null===(e=this.highlightedFields)||void 0===e?void 0:e[t]),this.narrow)})):a.s6,this._addField,this.disabled,g,this.hass.localize("ui.panel.config.script.editor.field.add_field"))}updated(t){super.updated(t),t.has("fields")&&this._focusLastActionOnChange&&(this._focusLastActionOnChange=!1,this.focusLastField())}focusLastField(){const t=this.shadowRoot.querySelector("ha-script-field-row:last-of-type");t.updateComplete.then(()=>{t.openSidebar(),t.focus(),this.narrow&&window.setTimeout(()=>{t.scrollIntoView({block:"start",behavior:"smooth"})},180)})}_addField(){const t=this._getUniqueKey(this.hass.localize("ui.panel.config.script.editor.field.field")||"field",this.fields||{}),i=Object.assign(Object.assign({},this.fields||{}),{},{[t]:{selector:{text:null}}});this._focusLastActionOnChange=!0,(0,r.r)(this,"value-changed",{value:i})}_fieldChanged(t){t.stopPropagation();const i=t.target.key;let e={};if(null===t.detail.value)e=Object.assign({},this.fields),delete e[i];else{const s=Object.assign({},t.detail.value),a=s.key;delete s.key;i!==a?Object.entries(this.fields).forEach(([t,o])=>{t===i?e[a]=s:e[t]=o}):(e=Object.assign({},this.fields),e[i]=s)}(0,r.r)(this,"value-changed",{value:e})}_getUniqueKey(t,i){let e=t;if(t in i){let s=2;do{e=`${t}_${s}`,s++}while(e in i)}return e}expandAll(){var t;null===(t=this._fieldRowElements)||void 0===t||t.forEach(t=>{t.expandAll()})}collapseAll(){var t;null===(t=this._fieldRowElements)||void 0===t||t.forEach(t=>{t.collapseAll()})}constructor(...t){super(...t),this.disabled=!1,this.narrow=!1,this._focusLastActionOnChange=!1}}f.styles=(0,a.AH)(u||(u=_`ha-script-field-row{display:block;margin-bottom:16px;scroll-margin-top:48px}ha-svg-icon{height:20px}`)),(0,s.__decorate)([(0,o.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,s.__decorate)([(0,o.MZ)({type:Boolean})],f.prototype,"disabled",void 0),(0,s.__decorate)([(0,o.MZ)({attribute:!1})],f.prototype,"fields",void 0),(0,s.__decorate)([(0,o.MZ)({attribute:!1})],f.prototype,"highlightedFields",void 0),(0,s.__decorate)([(0,o.MZ)({type:Boolean})],f.prototype,"narrow",void 0),(0,s.__decorate)([(0,o.YG)("ha-script-field-row")],f.prototype,"_fieldRowElements",void 0),f=(0,s.__decorate)([(0,o.EM)("ha-script-fields")],f),i()}catch(c){i(c)}})},31786:function(t,i,e){e.a(t,async function(t,i){try{e(79827),e(35748),e(99342),e(65315),e(12840),e(837),e(84136),e(22416),e(37089),e(59023),e(12977),e(5934),e(84755),e(67579),e(88238),e(34536),e(16257),e(20152),e(44711),e(72108),e(77030),e(18223),e(79566),e(95013),e(13484),e(81071),e(92714),e(55885);var s=e(69868),a=e(88006),o=e(97809),r=e(41484),n=e(84922),l=e(11991),h=e(48893),c=e(65940),d=e(78412),p=e(26946),u=e(6149),_=e(94029),g=e(20051),f=e(44017),m=e(72652),v=e(77240),y=e(46244),b=(e(21977),e(10547),e(71347),e(66120),e(65508),e(76940)),$=(e(76758),e(80624),e(9058),e(6418)),w=(e(28565),e(68937),e(92409),e(73634),e(86160),e(9171)),C=e(8384),A=e(32293),k=e(48727),x=e(14523),H=e(59569),M=e(40804),V=e(42699),z=e(54600),S=e(15241),L=e(81579),q=e(68891),R=e(40328),I=e(50809),O=e(72144),Z=e(91197),E=e(38525),P=e(18885),j=e(31494),F=e(91168),U=e(84193),B=e(61627),T=t([b,$,q,a,u,_]);[b,$,q,a,u,_]=T.then?(await T)():T;let W,D,Y,K,N,G,J,Q,X,tt,it,et,st,at,ot,rt,nt,lt,ht,ct,dt,pt,ut,_t,gt,ft,mt,vt,yt,bt,$t,wt=t=>t;const Ct="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z",At="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",kt="M11,17H4A2,2 0 0,1 2,15V3A2,2 0 0,1 4,1H16V3H4V15H11V13L15,16L11,19V17M19,21V7H8V13H6V7A2,2 0 0,1 8,5H19A2,2 0 0,1 21,7V21A2,2 0 0,1 19,23H8A2,2 0 0,1 6,21V19H8V21H19Z",xt="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",Ht="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",Mt="M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z",Vt="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",zt="M7,10L12,15L17,10H7Z",St="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z",Lt="M8,5.14V19.14L19,12.14L8,5.14Z",qt="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",Rt="M17.8,20C17.4,21.2 16.3,22 15,22H5C3.3,22 2,20.7 2,19V18H5L14.2,18C14.6,19.2 15.7,20 17,20H17.8M19,2C20.7,2 22,3.3 22,5V6H20V5C20,4.4 19.6,4 19,4C18.4,4 18,4.4 18,5V18H17C16.4,18 16,17.6 16,17V16H5V5C5,3.3 6.3,2 8,2H19M8,6V8H15V6H8M8,10V12H14V10H8Z",It="M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z",Ot="M20 2H4C2.9 2 2 2.9 2 4V20C2 21.11 2.9 22 4 22H20C21.11 22 22 21.11 22 20V4C22 2.9 21.11 2 20 2M4 6L6 4H10.9L4 10.9V6M4 13.7L13.7 4H18.6L4 18.6V13.7M20 18L18 20H13.1L20 13.1V18M20 10.3L10.3 20H5.4L20 5.4V10.3Z",Zt="M15,12C15,10.7 14.16,9.6 13,9.18V6.82C14.16,6.4 15,5.3 15,4A3,3 0 0,0 12,1A3,3 0 0,0 9,4C9,5.3 9.84,6.4 11,6.82V9.19C9.84,9.6 9,10.7 9,12C9,13.3 9.84,14.4 11,14.82V17.18C9.84,17.6 9,18.7 9,20A3,3 0 0,0 12,23A3,3 0 0,0 15,20C15,18.7 14.16,17.6 13,17.18V14.82C14.16,14.4 15,13.3 15,12M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M12,21A1,1 0 0,1 11,20A1,1 0 0,1 12,19A1,1 0 0,1 13,20A1,1 0 0,1 12,21Z";class Et extends((0,R.E)(n.WF)){hassSubscribe(){return[(0,C.Ar)(this.hass.connection,"script",t=>{this._categories=t}),(0,M.o5)(this.hass.connection,t=>{this._labels=t})]}render(){var t,i,e,s,a,o,r,l,h;const c=(0,n.qy)(W||(W=wt`${0} <ha-md-menu-item .value="${0}" .clickAction="${0}"> <div slot="headline"> ${0} </div> </ha-md-menu-item><ha-md-divider role="separator" tabindex="-1"></ha-md-divider> <ha-md-menu-item .clickAction="${0}"> <div slot="headline"> ${0} </div> </ha-md-menu-item>`),null===(t=this._categories)||void 0===t?void 0:t.map(t=>(0,n.qy)(D||(D=wt`<ha-md-menu-item .value="${0}" .clickAction="${0}"> ${0} <div slot="headline">${0}</div> </ha-md-menu-item>`),t.category_id,this._handleBulkCategory,t.icon?(0,n.qy)(Y||(Y=wt`<ha-icon slot="start" .icon="${0}"></ha-icon>`),t.icon):(0,n.qy)(K||(K=wt`<ha-svg-icon slot="start" .path="${0}"></ha-svg-icon>`),It),t.name)),null,this._handleBulkCategory,this.hass.localize("ui.panel.config.automation.picker.bulk_actions.no_category"),this._bulkCreateCategory,this.hass.localize("ui.panel.config.category.editor.add")),p=(0,n.qy)(N||(N=wt`${0} <ha-md-divider role="separator" tabindex="-1"></ha-md-divider> <ha-md-menu-item .clickAction="${0}"> <div slot="headline"> ${0} </div></ha-md-menu-item>`),null===(i=this._labels)||void 0===i?void 0:i.map(t=>{const i=t.color?(0,d.M)(t.color):void 0,e=this._selected.every(i=>{var e;return null===(e=this.hass.entities[i])||void 0===e?void 0:e.labels.includes(t.label_id)}),s=!e&&this._selected.some(i=>{var e;return null===(e=this.hass.entities[i])||void 0===e?void 0:e.labels.includes(t.label_id)});return(0,n.qy)(G||(G=wt`<ha-md-menu-item .value="${0}" .action="${0}" @click="${0}" keep-open reducedTouchTarget> <ha-checkbox slot="start" .checked="${0}" .indeterminate="${0}"></ha-checkbox> <ha-label style="${0}"> ${0} ${0} </ha-label> </ha-md-menu-item>`),t.label_id,e?"remove":"add",this._handleBulkLabel,e,s,i?`--color: ${i}`:"",t.icon?(0,n.qy)(J||(J=wt`<ha-icon slot="icon" .icon="${0}"></ha-icon>`),t.icon):n.s6,t.name)}),this._bulkCreateLabel,this.hass.localize("ui.panel.config.labels.add_label")),u=(0,n.qy)(Q||(Q=wt`${0} <ha-md-menu-item .value="${0}" .clickAction="${0}"> <div slot="headline"> ${0} </div> </ha-md-menu-item> <ha-md-divider role="separator" tabindex="-1"></ha-md-divider> <ha-md-menu-item .clickAction="${0}"> <div slot="headline"> ${0} </div> </ha-md-menu-item>`),Object.values(this.hass.areas).map(t=>(0,n.qy)(X||(X=wt`<ha-md-menu-item .value="${0}" .clickAction="${0}"> ${0} <div slot="headline">${0}</div> </ha-md-menu-item>`),t.area_id,this._handleBulkArea,t.icon?(0,n.qy)(tt||(tt=wt`<ha-icon slot="start" .icon="${0}"></ha-icon>`),t.icon):(0,n.qy)(it||(it=wt`<ha-svg-icon slot="start" .path="${0}"></ha-svg-icon>`),Ot),t.name)),null,this._handleBulkArea,this.hass.localize("ui.panel.config.devices.picker.bulk_actions.no_area"),this._bulkCreateArea,this.hass.localize("ui.panel.config.devices.picker.bulk_actions.add_area")),_=this._sizeController.value&&this._sizeController.value<900||!this._sizeController.value&&"docked"===this.hass.dockedSidebar,g=_&&(!this._sizeController.value||this._sizeController.value<700),f=this._scripts(this.scripts,this._entityReg,this.hass.areas,this._categories,this._labels,this._filteredScripts);return(0,n.qy)(et||(et=wt` <hass-tabs-subpage-data-table .hass="${0}" .narrow="${0}" back-path="/config" .route="${0}" .tabs="${0}" .searchLabel="${0}" has-filters .initialGroupColumn="${0}" .initialCollapsedGroups="${0}" .initialSorting="${0}" .columnOrder="${0}" .hiddenColumns="${0}" @columns-changed="${0}" @sorting-changed="${0}" @grouping-changed="${0}" @collapsed-changed="${0}" selectable .selected="${0}" @selection-changed="${0}" .filters="${0}" .columns="${0}" .data="${0}" .empty="${0}" .activeFilters="${0}" id="entity_id" .noDataText="${0}" @clear-filter="${0}" .filter="${0}" @search-changed="${0}" has-fab clickable class="${0}" @row-click="${0}"> <ha-icon-button slot="toolbar-icon" .label="${0}" .path="${0}" @click="${0}"></ha-icon-button> <ha-filter-floor-areas .hass="${0}" .type="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-floor-areas> <ha-filter-devices .hass="${0}" .type="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-devices> <ha-filter-entities .hass="${0}" .type="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-entities> <ha-filter-labels .hass="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-labels> <ha-filter-categories .hass="${0}" scope="script" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-categories> <ha-filter-blueprints .hass="${0}" .type="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-blueprints> ${0} ${0} ${0} <ha-fab slot="fab" ?is-wide="${0}" ?narrow="${0}" .label="${0}" extended @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab> </hass-tabs-subpage-data-table> `),this.hass,this.narrow,this.route,U.configSections.automations,this.hass.localize("ui.panel.config.script.picker.search",{number:f.length}),null!==(e=this._activeGrouping)&&void 0!==e?e:"category",this._activeCollapsed,this._activeSorting,this._activeColumnOrder,this._activeHiddenColumns,this._handleColumnsChanged,this._handleSortingChanged,this._handleGroupingChanged,this._handleCollapseChanged,this._selected.length,this._handleSelectionChanged,Object.values(this._filters).filter(t=>Array.isArray(t.value)?t.value.length:t.value&&Object.values(t.value).some(t=>Array.isArray(t)?t.length:t)).length,this._columns(this.hass.localize),f,!this.scripts.length,this._activeFilters,this.hass.localize("ui.panel.config.script.picker.no_scripts"),this._clearFilter,this._filter,this._handleSearchChange,this.narrow?"narrow":"",this._handleRowClicked,this.hass.localize("ui.common.help"),Mt,this._showHelp,this.hass,"script",null===(s=this._filters["ha-filter-floor-areas"])||void 0===s?void 0:s.value,this._filterChanged,"ha-filter-floor-areas"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,"script",null===(a=this._filters["ha-filter-devices"])||void 0===a?void 0:a.value,this._filterChanged,"ha-filter-devices"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,"script",null===(o=this._filters["ha-filter-entities"])||void 0===o?void 0:o.value,this._filterChanged,"ha-filter-entities"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,null===(r=this._filters["ha-filter-labels"])||void 0===r?void 0:r.value,this._filterChanged,"ha-filter-labels"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,null===(l=this._filters["ha-filter-categories"])||void 0===l?void 0:l.value,this._filterChanged,"ha-filter-categories"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,"script",null===(h=this._filters["ha-filter-blueprints"])||void 0===h?void 0:h.value,this._filterChanged,"ha-filter-blueprints"===this._expandedFilter,this.narrow,this._filterExpanded,this.narrow?n.s6:(0,n.qy)(st||(st=wt`<ha-md-button-menu slot="selection-bar"> <ha-assist-chip slot="trigger" .label="${0}"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip> ${0} </ha-md-button-menu> ${0} ${0}`),this.hass.localize("ui.panel.config.automation.picker.bulk_actions.move_category"),zt,c,g?n.s6:(0,n.qy)(at||(at=wt`<ha-md-button-menu slot="selection-bar"> <ha-assist-chip slot="trigger" .label="${0}"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip> ${0} </ha-md-button-menu>`),this.hass.localize("ui.panel.config.automation.picker.bulk_actions.add_label"),zt,p),_?n.s6:(0,n.qy)(ot||(ot=wt`<ha-md-button-menu slot="selection-bar"> <ha-assist-chip slot="trigger" .label="${0}"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip> ${0} </ha-md-button-menu>`),this.hass.localize("ui.panel.config.devices.picker.bulk_actions.move_area"),zt,u)),this.narrow||_?(0,n.qy)(rt||(rt=wt` <ha-md-button-menu has-overflow slot="selection-bar"> ${0} <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> ${0} ${0} ${0} </ha-md-button-menu>`),this.narrow?(0,n.qy)(nt||(nt=wt`<ha-assist-chip .label="${0}" slot="trigger"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip>`),this.hass.localize("ui.panel.config.automation.picker.bulk_action"),zt):(0,n.qy)(lt||(lt=wt`<ha-icon-button .path="${0}" .label="${0}" slot="trigger"></ha-icon-button>`),Ht,this.hass.localize("ui.panel.config.automation.picker.bulk_action")),zt,this.narrow?(0,n.qy)(ht||(ht=wt`<ha-sub-menu> <ha-md-menu-item slot="item"> <div slot="headline"> ${0} </div> <ha-svg-icon slot="end" .path="${0}"></ha-svg-icon> </ha-md-menu-item> <ha-md-menu slot="menu">${0}</ha-md-menu> </ha-sub-menu>`),this.hass.localize("ui.panel.config.automation.picker.bulk_actions.move_category"),Ct,c):n.s6,this.narrow||g?(0,n.qy)(ct||(ct=wt`<ha-sub-menu> <ha-md-menu-item slot="item"> <div slot="headline"> ${0} </div> <ha-svg-icon slot="end" .path="${0}"></ha-svg-icon> </ha-md-menu-item> <ha-md-menu slot="menu">${0}</ha-md-menu> </ha-sub-menu>`),this.hass.localize("ui.panel.config.automation.picker.bulk_actions.add_label"),Ct,p):n.s6,this.narrow||_?(0,n.qy)(dt||(dt=wt`<ha-sub-menu> <ha-md-menu-item slot="item"> <div slot="headline"> ${0} </div> <ha-svg-icon slot="end" .path="${0}"></ha-svg-icon> </ha-md-menu-item> <ha-md-menu slot="menu">${0}</ha-md-menu> </ha-sub-menu>`),this.hass.localize("ui.panel.config.devices.picker.bulk_actions.move_area"),Ct,u):n.s6):n.s6,this.scripts.length?n.s6:(0,n.qy)(pt||(pt=wt` <div class="empty" slot="empty"> <ha-svg-icon .path="${0}"></ha-svg-icon> <h1> ${0} </h1> <p> ${0} </p> <ha-button appearance="plain" href="${0}" target="_blank" rel="noreferrer" size="small"> ${0} <ha-svg-icon slot="end" .path="${0}"></ha-svg-icon> </ha-button> </div>`),Rt,this.hass.localize("ui.panel.config.script.picker.empty_header"),this.hass.localize("ui.panel.config.script.picker.empty_text"),(0,O.o)(this.hass,"/docs/script/editor/"),this.hass.localize("ui.panel.config.common.learn_more"),St),this.isWide,this.narrow,this.hass.localize("ui.panel.config.script.picker.add_script"),this._createNew,qt)}_handleSearchChange(t){this._filter=t.detail.value}_filterExpanded(t){t.detail.expanded?this._expandedFilter=t.target.localName:this._expandedFilter===t.target.localName&&(this._expandedFilter=void 0)}_filterChanged(t){const i=t.target.localName;this._filters=Object.assign(Object.assign({},this._filters),{},{[i]:t.detail}),this._applyFilters()}_clearFilter(){this._filters={},this._applyFilters()}_applyFilters(){const t=Object.entries(this._filters);let i;for(const[e,s]of t){if(s.items){if(!i){i=s.items;continue}i="intersection"in i?i.intersection(s.items):new Set([...i].filter(t=>s.items.has(t)))}if("ha-filter-categories"===e&&Array.isArray(s.value)&&s.value.length){const t=new Set;if(this.scripts.filter(t=>{var i;return s.value[0]===(null===(i=this._entityReg.find(i=>i.entity_id===t.entity_id))||void 0===i?void 0:i.categories.script)}).forEach(i=>t.add(i.entity_id)),!i){i=t;continue}i="intersection"in i?i.intersection(t):new Set([...i].filter(i=>t.has(i)))}if("ha-filter-labels"===e&&Array.isArray(s.value)&&s.value.length){const t=new Set;if(this.scripts.filter(t=>{var i;return null===(i=this._entityReg.find(i=>i.entity_id===t.entity_id))||void 0===i?void 0:i.labels.some(t=>s.value.includes(t))}).forEach(i=>t.add(i.entity_id)),!i){i=t;continue}i="intersection"in i?i.intersection(t):new Set([...i].filter(i=>t.has(i)))}}this._filteredScripts=i?[...i]:void 0}updated(t){super.updated(t),t.has("_entityReg")&&this._applyFilters()}firstUpdated(){this._searchParms.has("blueprint")&&this._filterBlueprint(),this._searchParms.has("label")&&this._filterLabel()}_filterLabel(){const t=this._searchParms.get("label");t&&(this._filters=Object.assign(Object.assign({},this._filters),{},{"ha-filter-labels":{value:[t],items:void 0}}),this._applyFilters())}async _filterBlueprint(){const t=this._searchParms.get("blueprint");if(!t)return;const i=await(0,z.f)(this.hass,"script_blueprint",t);this._filters=Object.assign(Object.assign({},this._filters),{},{"ha-filter-blueprints":{value:[t],items:new Set(i.automation||[])}}),this._applyFilters()}_editCategory(t){const i=this._entityReg.find(i=>i.entity_id===t.entity_id);i?(0,j.j)(this,{scope:"script",entityReg:i}):(0,S.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.script.picker.no_category_support"),text:this.hass.localize("ui.panel.config.script.picker.no_category_entity_reg")})}_handleSelectionChanged(t){this._selected=t.detail.value}async _bulkAddCategory(t){const i=[];this._selected.forEach(e=>{i.push((0,H.G_)(this.hass,e,{categories:{script:t}}))});const e=await Promise.allSettled(i);if((0,y.$)(e)){const t=(0,y.N)(e);(0,S.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.common.multiselect.failed",{number:t.length}),text:(0,n.qy)(ut||(ut=wt`<pre>
${0}</pre>`),t.map(t=>t.reason.message||t.reason.code||t.reason).join("\r\n"))})}}async _handleBulkLabel(t){const i=t.currentTarget.value,e=t.currentTarget.action;this._bulkLabel(i,e)}async _bulkLabel(t,i){const e=[];this._selected.forEach(s=>{e.push((0,H.G_)(this.hass,s,{labels:"add"===i?this.hass.entities[s].labels.concat(t):this.hass.entities[s].labels.filter(i=>i!==t)}))});const s=await Promise.allSettled(e);if((0,y.$)(s)){const t=(0,y.N)(s);(0,S.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.common.multiselect.failed",{number:t.length}),text:(0,n.qy)(_t||(_t=wt`<pre>
${0}</pre>`),t.map(t=>t.reason.message||t.reason.code||t.reason).join("\r\n"))})}}_handleRowClicked(t){const i=this.entityRegistry.find(i=>i.entity_id===t.detail.id);i?(0,v.o)(`/config/script/edit/${i.unique_id}`):(0,v.o)(`/config/script/show/${t.detail.id}`)}_createNew(){(0,p.x)(this.hass,"blueprint")?(0,P.l)(this,{mode:"script"}):(0,v.o)("/config/script/edit/new")}_showInfo(t){(0,f.r)(this,"hass-more-info",{entityId:t.entity_id})}_openSettings(t){(0,L.p)(this,{entityId:t.entity_id,view:"settings"})}_showTrace(t){const i=this.entityRegistry.find(i=>i.entity_id===t.entity_id);i&&(0,v.o)(`/config/script/trace/${i.unique_id}`)}_showHelp(){(0,S.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.script.caption"),text:(0,n.qy)(gt||(gt=wt` ${0} <p> <a href="${0}" target="_blank" rel="noreferrer"> ${0} </a> </p> `),this.hass.localize("ui.panel.config.script.picker.introduction"),(0,O.o)(this.hass,"/docs/scripts/"),this.hass.localize("ui.panel.config.script.picker.learn_more"))})}async _duplicate(t){try{const i=this.entityRegistry.find(i=>i.entity_id===t.entity_id);if(!i)return;const e=await(0,V.Kq)(this.hass,i.unique_id);(0,V.AM)(Object.assign(Object.assign({},e),{},{alias:`${null==e?void 0:e.alias} (${this.hass.localize("ui.panel.config.script.picker.duplicate")})`}))}catch(i){if(404===i.status_code){const i=await(0,V.R$)(this.hass,t.entity_id);return void(0,V.AM)(i.config)}await(0,S.showAlertDialog)(this,{text:this.hass.localize("ui.panel.config.script.editor.load_error_unknown",{err_no:i.status_code})})}}async _deleteConfirm(t){(0,S.showConfirmationDialog)(this,{title:this.hass.localize("ui.panel.config.script.editor.delete_confirm_title"),text:this.hass.localize("ui.panel.config.script.editor.delete_confirm_text",{name:t.name}),confirmText:this.hass.localize("ui.common.delete"),dismissText:this.hass.localize("ui.common.cancel"),confirm:()=>this._delete(t),destructive:!0})}async _delete(t){try{const i=this.entityRegistry.find(i=>i.entity_id===t.entity_id);i&&await(0,V.Ht)(this.hass,i.unique_id)}catch(i){await(0,S.showAlertDialog)(this,{text:400===i.status_code?this.hass.localize("ui.panel.config.script.editor.load_error_not_deletable"):this.hass.localize("ui.panel.config.script.editor.load_error_unknown",{err_no:i.status_code})})}}async _bulkAddArea(t){const i=[];this._selected.forEach(e=>{i.push((0,H.G_)(this.hass,e,{area_id:t}))});const e=await Promise.allSettled(i);if((0,y.$)(e)){const t=(0,y.N)(e);(0,S.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.common.multiselect.failed",{number:t.length}),text:(0,n.qy)(ft||(ft=wt`<pre>
${0}</pre>`),t.map(t=>t.reason.message||t.reason.code||t.reason).join("\r\n"))})}}_handleSortingChanged(t){this._activeSorting=t.detail}_handleGroupingChanged(t){var i;this._activeGrouping=null!==(i=t.detail.value)&&void 0!==i?i:""}_handleCollapseChanged(t){this._activeCollapsed=t.detail.value}_handleColumnsChanged(t){this._activeColumnOrder=t.detail.columnOrder,this._activeHiddenColumns=t.detail.hiddenColumns}static get styles(){return[I.RF,(0,n.AH)(mt||(mt=wt`:host{display:block;height:100%}hass-tabs-subpage-data-table{--data-table-row-height:60px}hass-tabs-subpage-data-table.narrow{--data-table-row-height:72px}a{text-decoration:none}.empty{--mdc-icon-size:80px;max-width:500px}.empty ha-button{--mdc-icon-size:24px}.empty h1{font-size:var(--ha-font-size-3xl)}ha-assist-chip{--ha-assist-chip-container-shape:10px}ha-md-button-menu ha-assist-chip{--md-assist-chip-trailing-space:8px}ha-label{--ha-label-background-color:var(--color, var(--grey-color));--ha-label-background-opacity:0.5}`))]}constructor(...t){super(...t),this.isWide=!1,this.narrow=!1,this._searchParms=new URLSearchParams(window.location.search),this._selected=[],this._filter="",this._filters={},this._sizeController=new a.P(this,{callback:t=>{var i;return null===(i=t[0])||void 0===i?void 0:i.contentRect.width}}),this._scripts=(0,c.A)((t,i,e,s,a,o)=>null===o?[]:(o?t.filter(t=>o.includes(t.entity_id)):t).map(t=>{var o,r;const n=i.find(i=>i.entity_id===t.entity_id),l=null==n?void 0:n.categories.script,h=a&&(null==n?void 0:n.labels);return Object.assign(Object.assign({},t),{},{name:(0,m.u)(t),area:null!=n&&n.area_id?null===(o=e[null==n?void 0:n.area_id])||void 0===o?void 0:o.name:void 0,last_triggered:t.attributes.last_triggered||void 0,category:l?null==s||null===(r=s.find(t=>t.category_id===l))||void 0===r?void 0:r.name:void 0,labels:(h||[]).map(t=>a.find(i=>i.label_id===t)),selectable:void 0!==n})})),this._columns=(0,c.A)(t=>({icon:{title:"",showNarrow:!0,moveable:!1,label:t("ui.panel.config.script.picker.headers.icon"),type:"icon",template:t=>(0,n.qy)(vt||(vt=wt`<ha-state-icon .hass="${0}" .stateObj="${0}" style="${0}"></ha-state-icon>`),this.hass,t,(0,h.W)({color:t.state===x.Hh?"var(--error-color)":"unset"}))},name:{title:t("ui.panel.config.script.picker.headers.name"),main:!0,sortable:!0,filterable:!0,direction:"asc",flex:2,extraTemplate:t=>t.labels.length?(0,n.qy)(yt||(yt=wt`<ha-data-table-labels @label-clicked="${0}" .labels="${0}"></ha-data-table-labels>`),this._labelClicked,t.labels):n.s6},area:{title:t("ui.panel.config.script.picker.headers.area"),defaultHidden:!0,groupable:!0,filterable:!0,sortable:!0},category:{title:t("ui.panel.config.script.picker.headers.category"),defaultHidden:!0,groupable:!0,filterable:!0,sortable:!0},labels:{title:"",hidden:!0,filterable:!0,template:t=>t.labels.map(t=>t.name).join(" ")},last_triggered:{sortable:!0,title:t("ui.card.automation.last_triggered"),template:t=>{const i=new Date(t.last_triggered),e=new Date,s=(0,r.c)(e,i);return(0,n.qy)(bt||(bt=wt` ${0} `),t.last_triggered?s>3?(0,u.CL)(i,this.hass.locale,this.hass.config):(0,_.K)(i,this.hass.locale):this.hass.localize("ui.components.relative_time.never"))}},actions:{title:"",label:this.hass.localize("ui.panel.config.generic.headers.actions"),type:"overflow-menu",showNarrow:!0,moveable:!1,hideable:!1,template:t=>(0,n.qy)($t||($t=wt` <ha-icon-overflow-menu .hass="${0}" narrow .items="${0}"> </ha-icon-overflow-menu> `),this.hass,[{path:Vt,label:this.hass.localize("ui.panel.config.script.picker.show_info"),action:()=>this._showInfo(t)},{path:At,label:this.hass.localize("ui.panel.config.automation.picker.show_settings"),action:()=>this._openSettings(t)},{path:It,label:this.hass.localize("ui.panel.config.script.picker."+(t.category?"edit_category":"assign_category")),action:()=>this._editCategory(t)},{path:Lt,label:this.hass.localize("ui.panel.config.script.picker.run"),action:()=>this._runScript(t)},{path:Zt,label:this.hass.localize("ui.panel.config.script.picker.show_trace"),action:()=>this._showTrace(t)},{divider:!0},{path:kt,label:this.hass.localize("ui.panel.config.script.picker.duplicate"),action:()=>this._duplicate(t)},{label:this.hass.localize("ui.panel.config.script.picker.delete"),path:xt,action:()=>this._deleteConfirm(t),warning:!0}])}})),this._labelClicked=t=>{const i=t.detail.label;this._filters=Object.assign(Object.assign({},this._filters),{},{"ha-filter-labels":{value:[i.label_id],items:void 0}}),this._applyFilters()},this._handleBulkCategory=t=>{const i=t.value;this._bulkAddCategory(i)},this._runScript=async t=>{const i=this.entityRegistry.find(i=>i.entity_id===t.entity_id);i&&((0,V.TP)(this.hass,i.unique_id)?this._showInfo(t):(await(0,V.kR)(this.hass,i.unique_id),(0,Z.P)(this,{message:this.hass.localize("ui.notification_toast.triggered",{name:(0,m.u)(t)})})))},this._bulkCreateCategory=()=>{(0,F.S)(this,{scope:"script",createEntry:async t=>{const i=await(0,C.s_)(this.hass,"script",t);return this._bulkAddCategory(i.category_id),i}})},this._bulkCreateLabel=()=>{(0,B.f)(this,{createEntry:async t=>{const i=await(0,M._9)(this.hass,t);this._bulkLabel(i.label_id,"add")}})},this._handleBulkArea=t=>{const i=t.value;this._bulkAddArea(i)},this._bulkCreateArea=()=>{(0,E.J)(this,{createEntry:async t=>{const i=await(0,w.L3)(this.hass,t);return this._bulkAddArea(i.area_id),i}})}}}(0,s.__decorate)([(0,l.MZ)({attribute:!1})],Et.prototype,"hass",void 0),(0,s.__decorate)([(0,l.MZ)({attribute:!1})],Et.prototype,"scripts",void 0),(0,s.__decorate)([(0,l.MZ)({attribute:"is-wide",type:Boolean})],Et.prototype,"isWide",void 0),(0,s.__decorate)([(0,l.MZ)({type:Boolean})],Et.prototype,"narrow",void 0),(0,s.__decorate)([(0,l.MZ)({attribute:!1})],Et.prototype,"route",void 0),(0,s.__decorate)([(0,l.MZ)({attribute:!1})],Et.prototype,"entityRegistry",void 0),(0,s.__decorate)([(0,l.wk)()],Et.prototype,"_searchParms",void 0),(0,s.__decorate)([(0,l.wk)()],Et.prototype,"_selected",void 0),(0,s.__decorate)([(0,l.wk)()],Et.prototype,"_activeFilters",void 0),(0,s.__decorate)([(0,l.wk)()],Et.prototype,"_filteredScripts",void 0),(0,s.__decorate)([(0,l.wk)(),(0,g.I)({storage:"sessionStorage",key:"script-table-search",state:!0,subscribe:!1})],Et.prototype,"_filter",void 0),(0,s.__decorate)([(0,l.wk)(),(0,g.I)({storage:"sessionStorage",key:"script-table-filters-full",state:!0,subscribe:!1,serializer:k.i,deserializer:k.D})],Et.prototype,"_filters",void 0),(0,s.__decorate)([(0,l.wk)()],Et.prototype,"_expandedFilter",void 0),(0,s.__decorate)([(0,l.wk)()],Et.prototype,"_categories",void 0),(0,s.__decorate)([(0,l.wk)()],Et.prototype,"_labels",void 0),(0,s.__decorate)([(0,l.wk)(),(0,o.Fg)({context:A.ih,subscribe:!0})],Et.prototype,"_entityReg",void 0),(0,s.__decorate)([(0,g.I)({key:"script-table-sort",state:!1,subscribe:!1})],Et.prototype,"_activeSorting",void 0),(0,s.__decorate)([(0,g.I)({key:"script-table-grouping",state:!1,subscribe:!1})],Et.prototype,"_activeGrouping",void 0),(0,s.__decorate)([(0,g.I)({key:"script-table-collapsed",state:!1,subscribe:!1})],Et.prototype,"_activeCollapsed",void 0),(0,s.__decorate)([(0,g.I)({key:"script-table-column-order",state:!1,subscribe:!1})],Et.prototype,"_activeColumnOrder",void 0),(0,s.__decorate)([(0,g.I)({key:"script-table-hidden-columns",state:!1,subscribe:!1})],Et.prototype,"_activeHiddenColumns",void 0),Et=(0,s.__decorate)([(0,l.EM)("ha-script-picker")],Et),i()}catch(W){i(W)}})},75320:function(t,i,e){e.a(t,async function(t,i){try{e(32203),e(79827),e(35748),e(65315),e(837),e(22416),e(36874),e(12977),e(5934),e(95013);var s=e(69868),a=e(90227),o=e(84922),r=e(11991),n=e(75907),l=e(36207),h=e(11111),c=e(20051),d=e(61246),p=e(44017),u=e(15676),_=e(94372),g=(e(9058),e(56657),e(42699)),f=e(72144),m=e(91197),v=e(8567),y=e(14466),b=e(46156),$=e(85173),w=e(954),C=e(20233),A=t([v,y,C,b]);[v,y,C,b]=A.then?(await A)():A;let k,x,H,M,V,z=t=>t;const S="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z",L="M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z",q=(0,l.Ik)({alias:(0,l.lq)((0,l.Yj)()),description:(0,l.lq)((0,l.Yj)()),sequence:(0,l.lq)((0,l.YO)((0,l.bz)())),icon:(0,l.lq)((0,l.Yj)()),mode:(0,l.lq)((0,l.vP)([typeof g.FN])),max:(0,l.lq)((0,l.ai)()),fields:(0,l.lq)((0,l.Ik)())});class R extends o.WF{addFields(){this._openFields=!0,(0,p.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.config),{},{fields:{[this.hass.localize("ui.panel.config.script.editor.field.field")||"field"]:{selector:{text:null}}}})})}updated(t){var i;this._openFields&&t.has("config")&&(this._openFields=!1,null===(i=this._scriptFields)||void 0===i||i.updateComplete.then(()=>{var t;return null===(t=this._scriptFields)||void 0===t?void 0:t.focusLastField()}))}_renderContent(){var t,i;return(0,o.qy)(k||(k=z` ${0} ${0} <div class="header"> <h2 id="sequence-heading" class="name"> ${0} </h2> <a href="${0}" target="_blank" rel="noreferrer"> <ha-icon-button .path="${0}" .label="${0}"></ha-icon-button> </a> </div> <ha-automation-action role="region" aria-labelledby="sequence-heading" .actions="${0}" .highlightedActions="${0}" @value-changed="${0}" @open-sidebar="${0}" @request-close-sidebar="${0}" @close-sidebar="${0}" .hass="${0}" .narrow="${0}" .disabled="${0}" root sidebar></ha-automation-action> `),this.config.description?(0,o.qy)(x||(x=z`<ha-markdown class="description" breaks .content="${0}"></ha-markdown>`),this.config.description):o.s6,this.config.fields?(0,o.qy)(H||(H=z`<div class="header"> <h2 id="fields-heading" class="name"> ${0} </h2> <a href="${0}" target="_blank" rel="noreferrer"> <ha-icon-button .path="${0}" .label="${0}"></ha-icon-button> </a> </div> <ha-script-fields role="region" aria-labelledby="fields-heading" .fields="${0}" .highlightedFields="${0}" @value-changed="${0}" .hass="${0}" .disabled="${0}" .narrow="${0}" @open-sidebar="${0}" @request-close-sidebar="${0}" @close-sidebar="${0}"></ha-script-fields>`),this.hass.localize("ui.panel.config.script.editor.field.fields"),(0,f.o)(this.hass,"/integrations/script/#fields"),L,this.hass.localize("ui.panel.config.script.editor.field.link_help_fields"),this.config.fields,null===(t=this._pastedConfig)||void 0===t?void 0:t.fields,this._fieldsChanged,this.hass,this.disabled,this.narrow,this._openSidebar,this.triggerCloseSidebar,this._handleCloseSidebar):o.s6,this.hass.localize("ui.panel.config.script.editor.sequence"),(0,f.o)(this.hass,"/docs/scripts/"),L,this.hass.localize("ui.panel.config.script.editor.link_available_actions"),this.config.sequence||[],null===(i=this._pastedConfig)||void 0===i?void 0:i.sequence,this._sequenceChanged,this._openSidebar,this.triggerCloseSidebar,this._handleCloseSidebar,this.hass,this.narrow,this.disabled||this.saving)}render(){return(0,o.qy)(M||(M=z` <div class="${0}"> <div class="content-wrapper"> <div class="content ${0}"> <slot name="alerts"></slot> ${0} </div> <div class="fab-positioner"> <div class="fab-positioner"> <ha-fab slot="fab" class="${0}" .label="${0}" .disabled="${0}" extended @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab> </div> </div> </div> <div class="sidebar-positioner"> <ha-automation-sidebar .sidebarKey="${0}" tabindex="-1" class="${0}" .narrow="${0}" .isWide="${0}" .hass="${0}" .config="${0}" .disabled="${0}" @value-changed="${0}" @sidebar-resized="${0}" @sidebar-resizing-stopped="${0}"></ha-automation-sidebar> </div> </div> `),(0,n.H)({"has-sidebar":this._sidebarConfig&&!this.narrow}),this._sidebarConfig&&this.narrow?"has-bottom-sheet":"",this._renderContent(),this.dirty?"dirty":"",this.hass.localize("ui.common.save"),this.saving,this._saveScript,S,this._sidebarKey,(0,n.H)({hidden:!this._sidebarConfig}),this.narrow,this.isWide,this.hass,this._sidebarConfig,this.disabled,this._sidebarConfigChanged,this._resizeSidebar,this._stopResizeSidebar)}firstUpdated(t){super.firstUpdated(t),this.style.setProperty("--sidebar-dynamic-width",`${this._sidebarWidthPx}px`);"1"===(0,_.p9)("expanded")&&(this._clearParam("expanded"),this.expandAll())}_clearParam(t){window.history.replaceState(null,"",(0,u.Z)((0,_.s8)(t)))}_fieldsChanged(t){t.stopPropagation(),this.resetPastedConfig(),(0,p.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.config),{},{fields:t.detail.value})})}_sequenceChanged(t){t.stopPropagation(),this.resetPastedConfig(),(0,p.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.config),{},{sequence:t.detail.value})})}connectedCallback(){super.connectedCallback(),window.addEventListener("paste",this._handlePaste)}disconnectedCallback(){window.removeEventListener("paste",this._handlePaste),super.disconnectedCallback()}_appendToExistingConfig(t){this._pastedConfig=t;const i=Object.assign({},this.config);i&&("fields"in t&&(i.fields=Object.assign(Object.assign({},i.fields),t.fields)),"sequence"in t&&(i.sequence=(0,h.e)(i.sequence||[]).concat((0,h.e)(t.sequence))),this._showPastedToastWithUndo(),(0,p.r)(this,"value-changed",{value:Object.assign({},i)}))}_replaceExistingConfig(t){this._pastedConfig=t,this._showPastedToastWithUndo(),(0,p.r)(this,"value-changed",{value:Object.assign({},t)})}_showPastedToastWithUndo(){(0,m.P)(this,{message:this.hass.localize("ui.panel.config.script.editor.paste_toast_message"),duration:4e3,action:{text:this.hass.localize("ui.common.undo"),action:()=>{(0,p.r)(this,"undo-paste"),this._pastedConfig=void 0}}})}resetPastedConfig(){this._pastedConfig=void 0,(0,m.P)(this,{message:"",duration:0})}async _openSidebar(t){var i,e,s,a;null===(i=this._sidebarConfig)||void 0===i||null===(e=i.close)||void 0===e||e.call(i),this._sidebarConfig=t.detail,this._sidebarKey=JSON.stringify(this._sidebarConfig),await(null===(s=this._sidebarElement)||void 0===s?void 0:s.updateComplete),null===(a=this._sidebarElement)||void 0===a||a.focus()}_sidebarConfigChanged(t){t.stopPropagation(),this._sidebarConfig&&(this._sidebarConfig=Object.assign(Object.assign({},this._sidebarConfig),t.detail.value))}triggerCloseSidebar(){if(this._sidebarConfig){var t;if(this._sidebarElement)return void this._sidebarElement.triggerCloseSidebar();null===(t=this._sidebarConfig)||void 0===t||t.close()}}_handleCloseSidebar(){this._sidebarConfig=void 0}_saveScript(){this.triggerCloseSidebar(),(0,p.r)(this,"save-script")}_tryInsertAfterSelected(t){return!(!this._sidebarConfig||!("insertAfter"in this._sidebarConfig))&&this._sidebarConfig.insertAfter(t)}expandAll(){var t;null===(t=this._collapsableElements)||void 0===t||t.forEach(t=>{t.expandAll()})}collapseAll(){var t;null===(t=this._collapsableElements)||void 0===t||t.forEach(t=>{t.collapseAll()})}copySelectedRow(){var t;null!==(t=this._sidebarConfig)&&void 0!==t&&t.copy&&this._sidebarConfig.copy()}cutSelectedRow(){var t;null!==(t=this._sidebarConfig)&&void 0!==t&&t.cut&&this._sidebarConfig.cut()}deleteSelectedRow(){var t;null!==(t=this._sidebarConfig)&&void 0!==t&&t.delete&&this._sidebarConfig.delete()}_resizeSidebar(t){t.stopPropagation();const i=t.detail.deltaInPx;var e;this._prevSidebarWidthPx||(this._prevSidebarWidthPx=(null===(e=this._sidebarElement)||void 0===e?void 0:e.clientWidth)||b.Q);const s=i+this._prevSidebarWidthPx;this._sidebarWidthPx=s,this.style.setProperty("--sidebar-dynamic-width",`${this._sidebarWidthPx}px`)}_stopResizeSidebar(t){t.stopPropagation(),this._prevSidebarWidthPx=void 0}static get styles(){return[w.T_,w.qK,(0,o.AH)(V||(V=z`.header{display:flex;align-items:center}.header:first-child{margin-top:-16px}.header .name{font-size:var(--ha-font-size-xl);font-weight:var(--ha-font-weight-normal);flex:1}.description{margin-top:16px}`))]}constructor(...t){super(...t),this.isWide=!1,this.narrow=!1,this.disabled=!1,this.saving=!1,this.dirty=!1,this._sidebarWidthPx=b.Q,this._openFields=!1,this._handlePaste=async t=>{var i;if(!(0,d.u)(t.composedPath()))return;const e=null===(i=t.clipboardData)||void 0===i?void 0:i.getData("text");if(!e)return;let s;try{s=(0,a.load)(e)}catch(c){return void(0,m.P)(this,{message:this.hass.localize("ui.panel.config.script.editor.paste_invalid_config"),duration:4e3,dismissable:!0})}if(!s||"object"!=typeof s)return;let o,r=s;"script"in r&&(r=r.script,Object.keys(r).length&&(r=r[Object.keys(r)[0]])),Array.isArray(r)&&(r=1===r.length?r[0]:{sequence:r}),["sequence","unknown"].includes((0,g.pq)(r))||(r={sequence:[r]});try{o=(0,g.nB)(r)}catch(c){return}try{(0,l.vA)(o,q)}catch(c){return void(0,m.P)(this,{message:this.hass.localize("ui.panel.config.script.editor.paste_invalid_config"),duration:4e3,dismissable:!0})}if(o){var n;t.preventDefault();const i=Object.keys(o).filter(t=>(0,h.e)(o[t]).length);if(1===i.length&&["sequence"].includes(i[0])&&this._tryInsertAfterSelected(o[i[0]]))return void this._showPastedToastWithUndo();if(this.dirty||null!==(n=(0,h.e)(this.config.sequence))&&void 0!==n&&n.length||Object.keys(this.config.fields||{}).length){if(!(await new Promise(t=>{(0,$.Z)(this,{domain:"script",pastedConfig:o,onClose:()=>t(!1),onAppend:()=>{this._appendToExistingConfig(o),t(!1)},onReplace:()=>t(!0)})})))return}this._replaceExistingConfig(o)}}}}(0,s.__decorate)([(0,r.MZ)({attribute:!1})],R.prototype,"hass",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"is-wide",type:Boolean})],R.prototype,"isWide",void 0),(0,s.__decorate)([(0,r.MZ)({type:Boolean})],R.prototype,"narrow",void 0),(0,s.__decorate)([(0,r.MZ)({type:Boolean})],R.prototype,"disabled",void 0),(0,s.__decorate)([(0,r.MZ)({type:Boolean})],R.prototype,"saving",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],R.prototype,"config",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],R.prototype,"dirty",void 0),(0,s.__decorate)([(0,r.wk)()],R.prototype,"_pastedConfig",void 0),(0,s.__decorate)([(0,r.wk)()],R.prototype,"_sidebarConfig",void 0),(0,s.__decorate)([(0,r.wk)()],R.prototype,"_sidebarKey",void 0),(0,s.__decorate)([(0,c.I)({key:"automation-sidebar-width",state:!1,subscribe:!1})],R.prototype,"_sidebarWidthPx",void 0),(0,s.__decorate)([(0,r.P)("ha-script-fields")],R.prototype,"_scriptFields",void 0),(0,s.__decorate)([(0,r.P)("ha-automation-sidebar")],R.prototype,"_sidebarElement",void 0),(0,s.__decorate)([(0,r.YG)("ha-automation-action, ha-script-fields")],R.prototype,"_collapsableElements",void 0),R=(0,s.__decorate)([(0,r.EM)("manual-script-editor")],R),i()}catch(k){i(k)}})}}]);
//# sourceMappingURL=83673.6bb6e733dd443e57.js.map