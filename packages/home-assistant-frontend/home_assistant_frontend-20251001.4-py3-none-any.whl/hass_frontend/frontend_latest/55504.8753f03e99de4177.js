export const __webpack_id__="55504";export const __webpack_ids__=["55504"];export const __webpack_modules__={63002:function(t,e,i){i.d(e,{$3:()=>g,$O:()=>E,$j:()=>p,ED:()=>r,JE:()=>x,OQ:()=>k,PU:()=>M,Ph:()=>u,Uf:()=>S,W1:()=>f,Wr:()=>d,Z:()=>c,gF:()=>y,iY:()=>m,jU:()=>a,nN:()=>b,p3:()=>h,pJ:()=>l,r_:()=>o,sz:()=>_});i(65315),i(59023);var n=i(72652),s=i(50654),r=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({});const a=59509==i.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,o=["L","gal","ft³","m³","CCF","MCF"],c=t=>t.sendMessagePromise({type:"recorder/info"}),h=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),d=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),_=(t,e,i,n,s="hour",r,a)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:i?.toISOString(),statistic_ids:n,period:s,units:r,types:a}),l=(t,e,i,n)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:n,fixed_period:i.fixed_period?{start_time:i.fixed_period.start instanceof Date?i.fixed_period.start.toISOString():i.fixed_period.start,end_time:i.fixed_period.end instanceof Date?i.fixed_period.end.toISOString():i.fixed_period.end}:void 0,calendar:i.calendar?{..."week"===i.calendar.period?{first_weekday:(0,s.DD)(t.locale).substring(0,3)}:{},...i.calendar}:void 0,rolling_window:i.rolling_window}),u=t=>t.callWS({type:"recorder/validate_statistics"}),f=(t,e,i)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:i}),g=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),p=t=>{let e=null;if(!t)return null;for(const i of t)null!==i.change&&void 0!==i.change&&(null===e?e=i.change:e+=i.change);return e},y=(t,e)=>{let i=null;for(const n of e){if(!(n in t))continue;const e=p(t[n]);null!==e&&(null===i?i=e:i+=e)}return i},m=(t,e)=>t.some(t=>void 0!==t[e]&&null!==t[e]),v=["mean","min","max"],w=["sum","state","change"],b=(t,e)=>!(!v.includes(e)||0===t.mean_type)||!(!w.includes(e)||!t.has_sum),S=(t,e,i,n,s)=>{const r=new Date(i).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:r,adjustment:n,adjustment_unit_of_measurement:s})},E=(t,e,i)=>{const s=t.states[e];return s?(0,n.u)(s):i?.name||e},x=(t,e,i)=>{let n;return e&&(n=t.states[e]?.attributes.unit_of_measurement),void 0===n?i?.statistics_unit_of_measurement:n},k=t=>t.includes(":"),M=t=>t.callWS({type:"recorder/update_statistics_issues"})},15819:function(t,e,i){i.a(t,async function(t,n){try{i.r(e),i.d(e,{HuiStatisticCard:()=>w,PERIOD_ENERGY:()=>v});var s=i(69868),r=i(84922),a=i(22019),o=i(91634),c=i(44017),h=i(22527),d=i(8868),_=(i(94124),i(70490),i(84553)),l=i(43716),u=i(63002),f=i(85191),g=i(44630),p=i(8510),y=i(24096),m=t([_,l,d]);[_,l,d]=m.then?(await m)():m;const v="energy_date_selection";class w extends r.WF{static async getConfigElement(){return await i.e("69805").then(i.bind(i,1020)),document.createElement("hui-statistic-card-editor")}static getStubConfig(t,e,i){return{entity:(0,g.B)(t,1,e,i,["sensor"],t=>"state_class"in t.attributes)[0]||"",period:{calendar:{period:"month"}}}}disconnectedCallback(){super.disconnectedCallback(),this._unsubscribeEnergy(),clearInterval(this._interval)}connectedCallback(){super.connectedCallback(),this._config?.period===v?this._subscribeEnergy():this._setFetchStatisticTimer()}_subscribeEnergy(){this._energySub||(this._energySub=(0,l.tb)(this.hass,{key:this._config?.collection_key}).subscribe(t=>{this._energyStart=t.start;let e=t.end;e&&999===e.getMilliseconds()&&(e=new Date(e),e.setMilliseconds(1e3)),this._energyEnd=e,this._fetchStatistic()}))}_unsubscribeEnergy(){this._energySub&&(this._energySub(),this._energySub=void 0),this._energyStart=void 0,this._energyEnd=void 0}setConfig(t){if(!t.entity)throw new Error("Entity must be specified");if(!t.stat_type)throw new Error("Statistic type must be specified");if(!t.period)throw new Error("Period must be specified");if(t.entity&&!(0,u.OQ)(t.entity)&&!(0,h.n)(t.entity))throw new Error("Invalid entity");this._config=t,this._error=void 0,this._config.footer?this._footerElement=(0,y.x)(this._config.footer):this._footerElement&&(this._footerElement=void 0)}async getCardSize(){let t=2;if(this._footerElement){const e=(0,f.Z)(this._footerElement);t+=e instanceof Promise?await e:e}return t}render(){if(!this._config||!this.hass)return r.s6;if(this._error)return r.qy` <ha-alert alert-type="error">${this._error}</ha-alert> `;const t=this.hass.states[this._config.entity],e=this._config.name||(0,u.$O)(this.hass,this._config.entity,this._metadata);return r.qy` <ha-card @click="${this._handleClick}" tabindex="0"> <div class="header"> <div class="name" .title="${e}">${e}</div> <div class="icon"> <ha-state-icon .icon="${this._config.icon}" .stateObj="${t}" .hass="${this.hass}"></ha-state-icon> </div> </div> <div class="info"> <span class="value">${void 0===this._value?"":null===this._value?"?":(0,d.ZV)(this._value,this.hass.locale)}</span> <span class="measurement">${this._config.unit||(0,u.JE)(this.hass,this._config.entity,this._metadata)}</span> </div> ${this._footerElement} </ha-card> `}shouldUpdate(t){return this._footerElement&&(this._footerElement.hass=this.hass),!!(t.has("_value")||t.has("_metadata")||t.has("_error")||t.has("_energyStart")||t.has("_energyEnd"))||(!this._config||(0,p.LX)(this,t))}willUpdate(t){if(super.willUpdate(t),!this._config||!t.has("_config"))return;const e=t.get("_config");if(this.hass){if(this._config.period===v&&!this._energySub)return void this._subscribeEnergy();if(this._config.period!==v&&this._energySub)return this._unsubscribeEnergy(),void this._setFetchStatisticTimer();this._config.period===v&&this._energySub&&t.has("_config")&&e?.collection_key!==this._config.collection_key&&(this._unsubscribeEnergy(),this._subscribeEnergy())}t.has("_config")&&e?.entity!==this._config.entity&&this._fetchMetadata().then(()=>{this._setFetchStatisticTimer()})}firstUpdated(){this._fetchStatistic(),this._fetchMetadata()}updated(t){if(super.updated(t),!this._config||!this.hass)return;const e=t.get("hass"),i=t.get("_config");e&&i&&e.themes===this.hass.themes&&i.theme===this._config.theme||(0,o.Q)(this,this.hass.themes,this._config.theme)}_setFetchStatisticTimer(){this._fetchStatistic(),clearInterval(this._interval),this._config?.period!==v&&(this._interval=window.setInterval(()=>this._fetchStatistic(),3e5))}async _fetchStatistic(){if(this.hass&&this._config)try{const t=await(0,u.pJ)(this.hass,this._config.entity,this._energyStart&&this._energyEnd?{fixed_period:{start:this._energyStart,end:this._energyEnd}}:"object"==typeof this._config?.period?this._config?.period:{});this._value=t[this._config.stat_type],this._error=void 0}catch(t){this._error=t.message}}async _fetchMetadata(){if(this.hass&&this._config)try{this._metadata=(await(0,u.Wr)(this.hass,[this._config.entity]))?.[0]}catch(t){this._error=t.message}}_handleClick(){(0,c.r)(this,"hass-more-info",{entityId:this._config.entity})}getGridOptions(){return{columns:6,rows:2,min_columns:6,min_rows:2}}static get styles(){return[r.AH`ha-card{height:100%;display:flex;flex-direction:column;justify-content:space-between;cursor:pointer;outline:0}.header{display:flex;padding:8px 16px 0;justify-content:space-between}.name{color:var(--secondary-text-color);line-height:var(--ha-line-height-expanded);font-size:var(--ha-font-size-l);font-weight:var(--ha-font-weight-medium);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.icon{color:var(--state-icon-color,#44739e);line-height:40px}.info{padding:0px 16px 16px;margin-top:-4px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;line-height:var(--ha-line-height-expanded)}.value{font-size:var(--ha-font-size-3xl);margin-right:4px;margin-inline-end:4px;margin-inline-start:initial}.measurement{font-size:var(--ha-font-size-l);color:var(--secondary-text-color)}`]}}(0,s.__decorate)([(0,a.MZ)({attribute:!1})],w.prototype,"hass",void 0),(0,s.__decorate)([(0,a.wk)()],w.prototype,"_config",void 0),(0,s.__decorate)([(0,a.wk)()],w.prototype,"_value",void 0),(0,s.__decorate)([(0,a.wk)()],w.prototype,"_metadata",void 0),(0,s.__decorate)([(0,a.wk)()],w.prototype,"_error",void 0),(0,s.__decorate)([(0,a.wk)()],w.prototype,"_energyStart",void 0),(0,s.__decorate)([(0,a.wk)()],w.prototype,"_energyEnd",void 0),w=(0,s.__decorate)([(0,a.EM)("hui-statistic-card")],w),n()}catch(t){n(t)}})},4681:function(t,e,i){i.d(e,{L:()=>r});var n=i(49418),s=i(27554);function r(t,e,i){return(0,n.A)(t,e*s.s0,i)}},49418:function(t,e,i){i.d(e,{A:()=>r});var n=i(67874),s=i(19490);function r(t,e,i){return(0,n.w)(i?.in||t,+(0,s.a)(t)+e)}},38227:function(t,e,i){i.d(e,{z:()=>s});var n=i(19490);function s(t,e){const i=+(0,n.a)(t)-+(0,n.a)(e);return i<0?-1:i>0?1:i}},28829:function(t,e,i){i.d(e,{b:()=>s});var n=i(19490);function s(t,e){return+(0,n.a)(t)-+(0,n.a)(e)}},99904:function(t,e,i){i.d(e,{W:()=>o});var n=i(90298),s=i(38227);function r(t,e,i){const[s,r]=(0,n.x)(i?.in,t,e);return 12*(s.getFullYear()-r.getFullYear())+(s.getMonth()-r.getMonth())}var a=i(78320);function o(t,e,i){const[o,c,h]=(0,n.x)(i?.in,t,t,e),d=(0,s.z)(c,h),_=Math.abs(r(c,h));if(_<1)return 0;1===c.getMonth()&&c.getDate()>27&&c.setDate(30),c.setMonth(c.getMonth()-d*_);let l=(0,s.z)(c,h)===-d;(0,a.c)(o)&&1===_&&1===(0,s.z)(o,h)&&(l=!1);const u=d*(_-+l);return 0===u?0:u}},44943:function(t,e,i){i.d(e,{j:()=>s});var n=i(19490);function s(t,e){const i=(0,n.a)(t,e?.in),s=i.getMonth(),r=s-s%3+3;return i.setMonth(r,0),i.setHours(23,59,59,999),i}},25223:function(t,e,i){i.d(e,{$:()=>r});var n=i(6223),s=i(19490);function r(t,e){const i=(0,n.q)(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,a=(0,s.a)(t,e?.in),o=a.getDay(),c=6+(o<r?-7:0)-(o-r);return a.setDate(a.getDate()+c),a.setHours(23,59,59,999),a}},93910:function(t,e,i){i.d(e,{Q:()=>s});var n=i(19490);function s(t,e){const i=(0,n.a)(t,e?.in),s=i.getFullYear();return i.setFullYear(s+1,0,0),i.setHours(23,59,59,999),i}},80850:function(t,e,i){i.d(e,{e:()=>s});var n=i(19490);function s(t,e){return 1===(0,n.a)(t,e?.in).getDate()}},83466:function(t,e,i){i.d(e,{w:()=>s});var n=i(19490);function s(t,e){const i=(0,n.a)(t,e?.in);return i.setDate(1),i.setHours(0,0,0,0),i}},47432:function(t,e,i){i.d(e,{a:()=>s});var n=i(19490);function s(t,e){const i=(0,n.a)(t,e?.in),s=i.getMonth(),r=s-s%3;return i.setMonth(r,1),i.setHours(0,0,0,0),i}},13486:function(t,e,i){i.d(e,{e:()=>s});var n=i(91927);function s(t,e,i){return(0,n.f)(t,-e,i)}},4494:function(t,e,i){i.d(e,{O:()=>s});var n=i(4681);function s(t,e,i){return(0,n.L)(t,-e,i)}},11042:function(t,e,i){i.d(e,{a:()=>s});var n=i(9151);function s(t,e,i){return(0,n.P)(t,-e,i)}}};
//# sourceMappingURL=55504.8753f03e99de4177.js.map