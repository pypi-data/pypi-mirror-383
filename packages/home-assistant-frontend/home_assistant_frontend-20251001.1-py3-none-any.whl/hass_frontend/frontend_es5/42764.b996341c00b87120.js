"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["42764"],{94327:function(t,e,a){a.d(e,{Vy:function(){return s},fI:function(){return o},ux:function(){return c}});var i=a(65940),n=a(83510);const r=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function s(t){return r[t%r.length]}function o(t,e){const a=e.getPropertyValue(`--graph-color-${t+1}`)||s(t);return(0,n.RQ)(a)}const c=(0,i.A)(t=>r.map((e,a)=>o(a,t)),(t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1"))},37382:function(t,e,a){a.d(e,{D:function(){return r}});var i=a(10416),n=a.n(i);const r=t=>n()(t,{whiteList:{},stripIgnoreTag:!0,stripIgnoreTagBody:!0})},71770:function(t,e,a){a(35748),a(12977),a(95013);var i=a(69868),n=a(30103),r=a(86811),s=a(49377),o=a(34800),c=a(84922),l=a(11991);let d,u,h,f,p=t=>t;class _ extends n.k{renderOutline(){return this.filled?(0,c.qy)(d||(d=p`<span class="filled"></span>`)):super.renderOutline()}getContainerClasses(){return Object.assign(Object.assign({},super.getContainerClasses()),{},{active:this.active})}renderPrimaryContent(){return(0,c.qy)(u||(u=p` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}renderTrailingIcon(){return(0,c.qy)(h||(h=p`<slot name="trailing-icon"></slot>`))}constructor(...t){super(...t),this.filled=!1,this.active=!1}}_.styles=[s.R,o.R,r.R,(0,c.AH)(f||(f=p`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,i.__decorate)([(0,l.MZ)({type:Boolean,reflect:!0})],_.prototype,"filled",void 0),(0,i.__decorate)([(0,l.MZ)({type:Boolean})],_.prototype,"active",void 0),_=(0,i.__decorate)([(0,l.EM)("ha-assist-chip")],_)},63002:function(t,e,a){a.a(t,async function(t,i){try{a.d(e,{$3:function(){return v},$O:function(){return $},$j:function(){return m},ED:function(){return o},JE:function(){return O},OQ:function(){return k},PU:function(){return D},Ph:function(){return _},Uf:function(){return w},W1:function(){return g},Wr:function(){return h},Z:function(){return d},gF:function(){return y},iY:function(){return b},jU:function(){return c},nN:function(){return S},p3:function(){return u},pJ:function(){return p},r_:function(){return l},sz:function(){return f}});a(79827),a(35748),a(65315),a(59023),a(12977),a(18223),a(95013);var n=a(72652),r=a(50654),s=t([r]);r=(s.then?(await s)():s)[0];var o=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({});const c=59509==a.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,l=["L","gal","ft³","m³","CCF","MCF"],d=t=>t.sendMessagePromise({type:"recorder/info"}),u=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),h=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),f=(t,e,a,i,n="hour",r,s)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==a?void 0:a.toISOString(),statistic_ids:i,period:n,units:r,types:s}),p=(t,e,a,i)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:i,fixed_period:a.fixed_period?{start_time:a.fixed_period.start instanceof Date?a.fixed_period.start.toISOString():a.fixed_period.start,end_time:a.fixed_period.end instanceof Date?a.fixed_period.end.toISOString():a.fixed_period.end}:void 0,calendar:a.calendar?Object.assign(Object.assign({},"week"===a.calendar.period?{first_weekday:(0,r.DD)(t.locale).substring(0,3)}:{}),a.calendar):void 0,rolling_window:a.rolling_window}),_=t=>t.callWS({type:"recorder/validate_statistics"}),g=(t,e,a)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:a}),v=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),m=t=>{let e=null;if(!t)return null;for(const a of t)null!==a.change&&void 0!==a.change&&(null===e?e=a.change:e+=a.change);return e},y=(t,e)=>{let a=null;for(const i of e){if(!(i in t))continue;const e=m(t[i]);null!==e&&(null===a?a=e:a+=e)}return a},b=(t,e)=>t.some(t=>void 0!==t[e]&&null!==t[e]),x=["mean","min","max"],C=["sum","state","change"],S=(t,e)=>!(!x.includes(e)||0===t.mean_type)||!(!C.includes(e)||!t.has_sum),w=(t,e,a,i,n)=>{const r=new Date(a).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:r,adjustment:i,adjustment_unit_of_measurement:n})},$=(t,e,a)=>{const i=t.states[e];return i?(0,n.u)(i):(null==a?void 0:a.name)||e},O=(t,e,a)=>{let i;var n;e&&(i=null===(n=t.states[e])||void 0===n?void 0:n.attributes.unit_of_measurement);return void 0===i?null==a?void 0:a.statistics_unit_of_measurement:i},k=t=>t.includes(":"),D=t=>t.callWS({type:"recorder/update_statistics_issues"});i()}catch(c){i(c)}})},51337:function(t,e,a){a.a(t,async function(t,i){try{a.r(e),a.d(e,{HuiEnergyDevicesGraphCard:function(){return w}});a(35748),a(99342),a(35058),a(65315),a(84136),a(22416),a(37089),a(5934),a(95013);var n=a(69868),r=a(84922),s=a(11991),o=a(75907),c=a(65940),l=a(37382),d=a(94327),u=a(8868),h=a(68717),f=a(43716),p=a(63002),_=a(40328),g=a(8510),v=(a(70490),a(44017)),m=a(35083),y=t([h,f,u,p]);[h,f,u,p]=y.then?(await y)():y;let b,x,C,S=t=>t;class w extends((0,_.E)(r.WF)){hassSubscribe(){var t;return[(0,f.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe(t=>{this._data=t,this._getStatistics(t)})]}getCardSize(){return 3}setConfig(t){this._config=t}shouldUpdate(t){return(0,g.xP)(this,t)||t.size>1||!t.has("hass")}render(){var t;return this.hass&&this._config?(0,r.qy)(b||(b=S` <ha-card> ${0} <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}" @chart-click="${0}"></ha-chart-base> </div> </ha-card> `),this._config.title?(0,r.qy)(x||(x=S`<h1 class="card-header">${0}</h1>`),this._config.title):"",(0,o.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._chartData),28*((null===(t=this._chartData[0])||void 0===t||null===(t=t.data)||void 0===t?void 0:t.length)||0)+50+"px",this._handleChartClick):r.s6}_renderTooltip(t){const e=`<h4 style="text-align: center; margin: 0;">${(0,l.D)(this._getDeviceName(t.value[1]))}</h4>`,a=`${(0,u.ZV)(t.value[0],this.hass.locale,t.value[0]<.1?{maximumFractionDigits:3}:void 0)} kWh`;return`${e}${t.marker} ${t.seriesName}: ${a}`}_getDeviceName(t){var e,a;return(null===(e=this._data)||void 0===e||null===(e=e.prefs.device_consumption.find(e=>e.stat_consumption===t))||void 0===e?void 0:e.name)||(0,p.$O)(this.hass,t,null===(a=this._data)||void 0===a?void 0:a.statsMetadata[t])}async _getStatistics(t){var e;const a=t.stats,i=t.statsCompare,n=[],r=[],s=[{type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:n,barWidth:i?10:20,cursor:"default"}];i&&s.push({type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.previous_energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:r,barWidth:10,cursor:"default"});const o=getComputedStyle(this);t.prefs.device_consumption.forEach((t,e)=>{const s=t.stat_consumption in a&&(0,p.$j)(a[t.stat_consumption])||0,c=(0,d.fI)(e,o);if(n.push({id:e,value:[s,t.stat_consumption],itemStyle:{color:c+"7F",borderColor:c}}),i){const a=t.stat_consumption in i&&(0,p.$j)(i[t.stat_consumption])||0;r.push({id:e,value:[a,t.stat_consumption],itemStyle:{color:c+"32",borderColor:c+"7F"}})}}),n.sort((t,e)=>e.value[0]-t.value[0]),n.length=Math.min((null===(e=this._config)||void 0===e?void 0:e.max_devices)||1/0,n.length),this._chartData=s,await this.updateComplete}_handleChartClick(t){"axisLabel"===t.detail.targetType&&t.detail.value&&!(0,p.OQ)(t.detail.value)&&(0,v.r)(this,"hass-more-info",{entityId:t.detail.value})}constructor(...t){super(...t),this._chartData=[],this.hassSubscribeRequiredHostProps=["_config"],this._createOptions=(0,c.A)(t=>{var e,a;const i=window.matchMedia("all and (max-width: 450px), all and (max-height: 500px)").matches;return{xAxis:{type:"value",name:"kWh"},yAxis:{type:"category",inverse:!0,triggerEvent:!0,data:null===(e=t[0])||void 0===e||null===(e=e.data)||void 0===e?void 0:e.map(t=>t.value[1]),axisLabel:{formatter:this._getDeviceName.bind(this),overflow:"truncate",fontSize:12,margin:5,width:Math.min(i?100:200,Math.max(...(null===(a=t[0])||void 0===a||null===(a=a.data)||void 0===a?void 0:a.map(t=>(0,m.W)(this._getDeviceName(t.value[1]),12)+5))||[]))}},grid:{top:5,left:5,right:40,bottom:0,containLabel:!0},tooltip:{show:!0,formatter:this._renderTooltip.bind(this)}}})}}w.styles=(0,r.AH)(C||(C=S`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}ha-chart-base{--chart-max-height:none}`)),(0,n.__decorate)([(0,s.MZ)({attribute:!1})],w.prototype,"hass",void 0),(0,n.__decorate)([(0,s.wk)()],w.prototype,"_config",void 0),(0,n.__decorate)([(0,s.wk)()],w.prototype,"_chartData",void 0),(0,n.__decorate)([(0,s.wk)()],w.prototype,"_data",void 0),w=(0,n.__decorate)([(0,s.EM)("hui-energy-devices-graph-card")],w),i()}catch(b){i(b)}})},35083:function(t,e,a){let i;function n(t,e,a="Roboto, Noto, sans-serif"){i||(i=document.createElement("canvas"));const n=i.getContext("2d");if(!n)return 0;n.font=`${e}px ${a}`;const r=n.measureText(t);return Math.ceil(Math.max(r.actualBoundingBoxRight+r.actualBoundingBoxLeft,r.width))}a.d(e,{W:function(){return n}})},74879:function(t,e,a){var i=a(87642),n=a(36196),r=a(48630),s=a(85456),o=TypeError,c=Object.defineProperty,l=n.self!==n;try{if(s){var d=Object.getOwnPropertyDescriptor(n,"self");!l&&d&&d.get&&d.enumerable||r(n,"self",{get:function(){return n},set:function(t){if(this!==n)throw new o("Illegal invocation");c(n,"self",{value:t,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else i({global:!0,simple:!0,forced:l},{self:n})}catch(u){}},74758:function(t,e,a){a.d(e,{o:function(){return s}});var i=a(48869),n=a(27554),r=a(28829);function s(t,e,a){const s=(0,r.b)(t,e)/n.Cg;return(0,i.u)(null==a?void 0:a.roundingMethod)(s)}}}]);
//# sourceMappingURL=42764.b996341c00b87120.js.map