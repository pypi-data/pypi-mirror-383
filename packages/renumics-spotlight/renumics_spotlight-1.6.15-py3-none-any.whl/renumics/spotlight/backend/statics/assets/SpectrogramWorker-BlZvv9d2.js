(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const q=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),Y=Symbol("Comlink.releaseProxy"),f=Symbol("Comlink.finalizer"),T=Symbol("Comlink.thrown"),_=t=>typeof t=="object"&&t!==null||typeof t=="function",B={canHandle:t=>_(t)&&t[q],serialize(t){const{port1:e,port2:r}=new MessageChannel;return F(t,e),[r,[r]]},deserialize(t){return t.start(),K(t)}},X={canHandle:t=>_(t)&&T in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},U=new Map([["proxy",B],["throw",X]]);function $(t,e){for(const r of t)if(e===r||r==="*"||r instanceof RegExp&&r.test(e))return!0;return!1}function F(t,e=globalThis,r=["*"]){e.addEventListener("message",function h(s){if(!s||!s.data)return;if(!$(r,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:o,type:a,path:n}=Object.assign({path:[]},s.data),i=(s.data.argumentList||[]).map(M);let c;try{const u=n.slice(0,-1).reduce((l,w)=>l[w],t),g=n.reduce((l,w)=>l[w],t);switch(a){case"GET":c=g;break;case"SET":u[n.slice(-1)[0]]=M(s.data.value),c=!0;break;case"APPLY":c=g.apply(u,i);break;case"CONSTRUCT":{const l=new g(...i);c=tt(l)}break;case"ENDPOINT":{const{port1:l,port2:w}=new MessageChannel;F(t,w),c=z(l,[l])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[T]:0}}Promise.resolve(c).catch(u=>({value:u,[T]:0})).then(u=>{const[g,l]=R(u);e.postMessage(Object.assign(Object.assign({},g),{id:o}),l),a==="RELEASE"&&(e.removeEventListener("message",h),W(e),f in t&&typeof t[f]=="function"&&t[f]())}).catch(u=>{const[g,l]=R({value:new TypeError("Unserializable return value"),[T]:0});e.postMessage(Object.assign(Object.assign({},g),{id:o}),l)})}),e.start&&e.start()}function J(t){return t.constructor.name==="MessagePort"}function W(t){J(t)&&t.close()}function K(t,e){return L(t,[],e)}function A(t){if(t)throw new Error("Proxy has been released and is not useable")}function j(t){return p(t,{type:"RELEASE"}).then(()=>{W(t)})}const x=new WeakMap,I="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(x.get(t)||0)-1;x.set(t,e),e===0&&j(t)});function Q(t,e){const r=(x.get(e)||0)+1;x.set(e,r),I&&I.register(t,e,t)}function Z(t){I&&I.unregister(t)}function L(t,e=[],r=function(){}){let h=!1;const s=new Proxy(r,{get(o,a){if(A(h),a===Y)return()=>{Z(s),j(t),h=!0};if(a==="then"){if(e.length===0)return{then:()=>s};const n=p(t,{type:"GET",path:e.map(i=>i.toString())}).then(M);return n.then.bind(n)}return L(t,[...e,a])},set(o,a,n){A(h);const[i,c]=R(n);return p(t,{type:"SET",path:[...e,a].map(u=>u.toString()),value:i},c).then(M)},apply(o,a,n){A(h);const i=e[e.length-1];if(i===G)return p(t,{type:"ENDPOINT"}).then(M);if(i==="bind")return L(t,e.slice(0,-1));const[c,u]=v(n);return p(t,{type:"APPLY",path:e.map(g=>g.toString()),argumentList:c},u).then(M)},construct(o,a){A(h);const[n,i]=v(a);return p(t,{type:"CONSTRUCT",path:e.map(c=>c.toString()),argumentList:n},i).then(M)}});return Q(s,t),s}function S(t){return Array.prototype.concat.apply([],t)}function v(t){const e=t.map(R);return[e.map(r=>r[0]),S(e.map(r=>r[1]))]}const D=new WeakMap;function z(t,e){return D.set(t,e),t}function tt(t){return Object.assign(t,{[q]:!0})}function R(t){for(const[e,r]of U)if(r.canHandle(t)){const[h,s]=r.serialize(t);return[{type:"HANDLER",name:e,value:h},s]}return[{type:"RAW",value:t},D.get(t)||[]]}function M(t){switch(t.type){case"HANDLER":return U.get(t.name).deserialize(t.value);case"RAW":return t.value}}function p(t,e,r){return new Promise(h=>{const s=nt();t.addEventListener("message",function o(a){!a.data||!a.data.id||a.data.id!==s||(t.removeEventListener("message",o),h(a.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:s},e),r)})}function nt(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}const et=(t,e,r)=>{const h=new Float32Array(t),s=new Float32Array(t),o=new Float32Array(t),a=new Uint32Array(t);let n;switch(e){case"bartlett":for(n=0;n<t;n++)o[n]=2/(t-1)*((t-1)/2-Math.abs(n-(t-1)/2));break;case"bartlettHann":for(n=0;n<t;n++)o[n]=.62-.48*Math.abs(n/(t-1)-.5)-.38*Math.cos(Math.PI*2*n/(t-1));break;case"blackman":for(r=r||.16,n=0;n<t;n++)o[n]=(1-r)/2-.5*Math.cos(Math.PI*2*n/(t-1))+r/2*Math.cos(4*Math.PI*n/(t-1));break;case"cosine":for(n=0;n<t;n++)o[n]=Math.cos(Math.PI*n/(t-1)-Math.PI/2);break;case"gauss":for(r=r||.25,n=0;n<t;n++)o[n]=Math.pow(Math.E,-.5*Math.pow((n-(t-1)/2)/(r*(t-1)/2),2));break;case"hamming":for(n=0;n<t;n++)o[n]=.54-.46*Math.cos(Math.PI*2*n/(t-1));break;case"hann":case void 0:for(n=0;n<t;n++)o[n]=.5*(1-Math.cos(Math.PI*2*n/(t-1)));break;case"lanczoz":for(n=0;n<t;n++)o[n]=Math.sin(Math.PI*(2*n/(t-1)-1))/(Math.PI*(2*n/(t-1)-1));break;case"rectangular":for(n=0;n<t;n++)o[n]=1;break;case"triangular":for(n=0;n<t;n++)o[n]=2/t*(t/2-Math.abs(n-(t-1)/2));break;default:throw Error("No such window function '"+e+"'")}let i=1,c=t>>1;for(;i<t;){for(n=0;n<i;n++)a[n+i]=a[n]+c;i=i<<1,c=c>>1}for(n=0;n<t;n++)h[n]=Math.sin(-Math.PI/n),s[n]=Math.cos(-Math.PI/n);return{sinTable:h,cosTable:s,windowValues:o,reverseTable:a}},rt=(t,e,r,h,s,o)=>{const a=new Float32Array(e),n=new Float32Array(e),i=2/e,c=Math.sqrt,u=new Float32Array(e/2);let g,l,w;const O=Math.floor(Math.log(e)/Math.LN2);if(Math.pow(2,O)!==e)throw new Error("Invalid buffer size, must be a power of 2.");if(e!==t.length)throw new Error("Supplied buffer is not the same size as defined FFT. FFT Size: "+e+" Buffer Size: "+t.length);let d=1,C,N,k,P,E,b,H,V;for(let m=0;m<e;m++)a[m]=t[r[m]]*h[r[m]],n[m]=0;for(;d<e;){C=o[d],N=s[d],k=1,P=0;for(let m=0;m<d;m++){let y=m;for(;y<e;)E=y+d,b=k*a[E]-P*n[E],H=k*n[E]+P*a[E],a[E]=a[y]-b,n[E]=n[y]-H,a[y]+=b,n[y]+=H,y+=d<<1;V=k,k=V*C-P*N,P=V*N+P*C}d=d<<1}for(let m=0,y=e/2;m<y;m++)g=a[m],l=n[m],w=i*c(g*g+l*l),u[m]=w;return u};F((t,e,r,h,s,o)=>{const a=[],n=o.length/h,i=Math.min(s-1,Math.round(Math.max(0,s-n))),c=et(t,e,r),u=1;for(let g=0;g<u;g++){const l=[];let w=0;for(;w+s<o.length;){const O=o.slice(w,w+s),d=rt(O,t,c.reverseTable,c.windowValues,c.sinTable,c.cosTable);l.push(d),w+=s-i}a.push(l)}return a[0]})})();
