---
id: upload-plugins
title: ì—…ë¡œë“œ í”ŒëŸ¬ê·¸ì¸
sidebar_position: 3
---

# ì—…ë¡œë“œ í”ŒëŸ¬ê·¸ì¸

ì—…ë¡œë“œ í”ŒëŸ¬ê·¸ì¸ì€ í¬ê´„ì ì¸ ë©”íƒ€ë°ì´í„° ì§€ì›, ë³´ì•ˆ ê²€ì¦ ë° ì²´ê³„ì ì¸ ë°ì´í„° ë‹¨ìœ„ ìƒì„±ì„ í†µí•´ íŒŒì¼ì„ Synapse í”Œë«í¼ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ íŒŒì¼ ì—…ë¡œë“œ ë° ë°ì´í„° ìˆ˜ì§‘ ì‘ì—…ì„ ì œê³µí•©ë‹ˆë‹¤.

## ê°œìš”

**ì‚¬ìš© ê°€ëŠ¥í•œ ì•¡ì…˜:**

- `upload` - ì„ íƒì  Excel ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ë¥¼ í†µí•œ íŒŒì¼ ë° ë””ë ‰í† ë¦¬ ìŠ¤í† ë¦¬ì§€ ì—…ë¡œë“œ

**ì‚¬ìš© ì‚¬ë¡€:**

- ë©”íƒ€ë°ì´í„° ì£¼ì„ì„ í¬í•¨í•œ ëŒ€ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ
- Excel ê¸°ë°˜ ë©”íƒ€ë°ì´í„° ë§¤í•‘ ë° ê²€ì¦
- ì¬ê·€ì  ë””ë ‰í† ë¦¬ ì²˜ë¦¬
- íƒ€ì… ê¸°ë°˜ íŒŒì¼ êµ¬ì„±
- ë°°ì¹˜ ë°ì´í„° ë‹¨ìœ„ ìƒì„±
- í¬ê¸° ë° ë‚´ìš© ê²€ì¦ì„ í†µí•œ ì•ˆì „í•œ íŒŒì¼ ì²˜ë¦¬

**ì§€ì›ë˜ëŠ” ì—…ë¡œë“œ ì†ŒìŠ¤:**

- ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œ ê²½ë¡œ (íŒŒì¼ ë° ë””ë ‰í† ë¦¬)
- ì¬ê·€ì  ë””ë ‰í† ë¦¬ ìŠ¤ìº”
- í–¥ìƒëœ íŒŒì¼ ì£¼ì„ì„ ìœ„í•œ Excel ë©”íƒ€ë°ì´í„° íŒŒì¼
- ìë™ êµ¬ì„±ì„ í†µí•œ í˜¼í•© íŒŒì¼ íƒ€ì…

## ì—…ë¡œë“œ ì•¡ì…˜ ì•„í‚¤í…ì²˜

ì—…ë¡œë“œ ì‹œìŠ¤í…œì€ ê²€ì¦ëœ ë””ìì¸ íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¶•ëœ í˜„ëŒ€ì ì´ê³  í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¦¬íŒ©í† ë§ëœ êµ¬í˜„ì€ ì´ì „ì˜ ëª¨ë†€ë¦¬ì‹ ì ‘ê·¼ ë°©ì‹ì„ ê´€ì‹¬ì‚¬ì˜ ëª…í™•í•œ ë¶„ë¦¬ê°€ ìˆëŠ” ëª¨ë“ˆì‹ ì „ëµ ê¸°ë°˜ ì‹œìŠ¤í…œìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

### ë””ìì¸ íŒ¨í„´

ì•„í‚¤í…ì²˜ëŠ” ì—¬ëŸ¬ í•µì‹¬ ë””ìì¸ íŒ¨í„´ì„ í™œìš©í•©ë‹ˆë‹¤:

- **ì „ëµ íŒ¨í„´**: ê²€ì¦, íŒŒì¼ ë°œê²¬, ë©”íƒ€ë°ì´í„° ì²˜ë¦¬, ì—…ë¡œë“œ ì‘ì—… ë° ë°ì´í„° ë‹¨ìœ„ ìƒì„±ì„ ìœ„í•œ í”ŒëŸ¬ê·¸í˜• ë™ì‘
- **íŒŒì‚¬ë“œ íŒ¨í„´**: UploadOrchestratorëŠ” ë³µì¡í•œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì¡°ì •í•˜ê¸° ìœ„í•œ ë‹¨ìˆœí™”ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µ
- **íŒ©í† ë¦¬ íŒ¨í„´**: StrategyFactoryëŠ” ëŸ°íƒ€ì„ ë§¤ê°œë³€ìˆ˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì ì ˆí•œ ì „ëµ êµ¬í˜„ì„ ìƒì„±
- **ì»¨í…ìŠ¤íŠ¸ íŒ¨í„´**: UploadContextëŠ” ì›Œí¬í”Œë¡œìš° êµ¬ì„± ìš”ì†Œ ê°„ì˜ ê³µìœ  ìƒíƒœ ë° í†µì‹ ì„ ìœ ì§€

### ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜

```mermaid
classDiagram
    %% Light/Dark mode compatible colors
    classDef coreClass fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000000
    classDef strategyClass fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,color:#000000
    classDef stepClass fill:#fff9c4,stroke:#f57c00,stroke-width:2px,color:#000000
    classDef contextClass fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#000000

    class UploadAction {
        +name: str = "upload"
        +category: PluginCategory.UPLOAD
        +method: RunMethod.JOB
        +run_class: UploadRun
        +params_model: UploadParams
        +strategy_factory: StrategyFactory
        +step_registry: StepRegistry

        +start() dict
        +get_workflow_summary() dict
        +_configure_workflow() None
        +_configure_strategies() dict
    }

    class UploadOrchestrator {
        +context: UploadContext
        +step_registry: StepRegistry
        +strategies: dict
        +executed_steps: list
        +current_step_index: int
        +rollback_executed: bool

        +execute() dict
        +get_workflow_summary() dict
        +get_executed_steps() list
        +is_rollback_executed() bool
        +_execute_step(step) StepResult
        +_handle_step_failure(step, error) None
        +_rollback_executed_steps() None
    }

    class UploadContext {
        +params: dict
        +run: UploadRun
        +client: Any
        +storage: Any
        +pathlib_cwd: Path
        +metadata: dict
        +file_specifications: dict
        +organized_files: list
        +uploaded_files: list
        +data_units: list
        +metrics: dict
        +errors: list
        +strategies: dict
        +rollback_data: dict

        +update(result: StepResult) None
        +get_result() dict
        +has_errors() bool
        +update_metrics(category, metrics) None
    }

    class StepRegistry {
        +_steps: list
        +register(step: BaseStep) None
        +get_steps() list
        +get_total_progress_weight() float
        +clear() None
    }

    class StrategyFactory {
        +create_validation_strategy(params, context) BaseValidationStrategy
        +create_file_discovery_strategy(params, context) BaseFileDiscoveryStrategy
        +create_metadata_strategy(params, context) BaseMetadataStrategy
        +create_upload_strategy(params, context) BaseUploadStrategy
        +create_data_unit_strategy(params, context) BaseDataUnitStrategy
        +get_available_strategies() dict
    }

    class BaseStep {
        <<abstract>>
        +name: str
        +progress_weight: float
        +execute(context: UploadContext) StepResult
        +can_skip(context: UploadContext) bool
        +rollback(context: UploadContext) None
        +create_success_result(data) StepResult
        +create_error_result(error) StepResult
        +create_skip_result() StepResult
    }

    class StepResult {
        +success: bool
        +data: dict
        +error: str
        +rollback_data: dict
        +skipped: bool
        +original_exception: Exception
        +timestamp: datetime
    }

    %% Strategy Base Classes
    class BaseValidationStrategy {
        <<abstract>>
        +validate_files(files, context) bool
        +validate_security(file_path) bool
    }

    class BaseFileDiscoveryStrategy {
        <<abstract>>
        +discover_files(path, context) list
        +organize_files(files, specs, context) list
    }

    class BaseMetadataStrategy {
        <<abstract>>
        +process_metadata(context) dict
        +extract_metadata(file_path) dict
    }

    class BaseUploadStrategy {
        <<abstract>>
        +upload_files(files, context) list
        +upload_batch(batch, context) list
    }

    class BaseDataUnitStrategy {
        <<abstract>>
        +generate_data_units(files, context) list
        +create_data_unit_batch(batch, context) list
    }

    %% Workflow Steps
    class InitializeStep {
        +name = "initialize"
        +progress_weight = 0.05
    }

    class ProcessMetadataStep {
        +name = "process_metadata"
        +progress_weight = 0.05
    }

    class AnalyzeCollectionStep {
        +name = "analyze_collection"
        +progress_weight = 0.05
    }

    class OrganizeFilesStep {
        +name = "organize_files"
        +progress_weight = 0.10
    }

    class ValidateFilesStep {
        +name = "validate_files"
        +progress_weight = 0.05
    }

    class UploadFilesStep {
        +name = "upload_files"
        +progress_weight = 0.30
    }

    class GenerateDataUnitsStep {
        +name = "generate_data_units"
        +progress_weight = 0.35
    }

    class CleanupStep {
        +name = "cleanup"
        +progress_weight = 0.05
    }

    %% Relationships
    UploadAction --> UploadOrchestrator : creates and executes
    UploadAction --> StrategyFactory : configures strategies
    UploadAction --> StepRegistry : manages workflow steps
    UploadOrchestrator --> UploadContext : coordinates state
    UploadOrchestrator --> StepRegistry : executes steps from
    UploadOrchestrator --> BaseStep : executes
    BaseStep --> StepResult : returns
    UploadContext --> StepResult : updates with
    StrategyFactory --> BaseValidationStrategy : creates
    StrategyFactory --> BaseFileDiscoveryStrategy : creates
    StrategyFactory --> BaseMetadataStrategy : creates
    StrategyFactory --> BaseUploadStrategy : creates
    StrategyFactory --> BaseDataUnitStrategy : creates
    StepRegistry --> BaseStep : contains

    %% Step inheritance
    InitializeStep --|> BaseStep : extends
    ProcessMetadataStep --|> BaseStep : extends
    AnalyzeCollectionStep --|> BaseStep : extends
    OrganizeFilesStep --|> BaseStep : extends
    ValidateFilesStep --|> BaseStep : extends
    UploadFilesStep --|> BaseStep : extends
    GenerateDataUnitsStep --|> BaseStep : extends
    CleanupStep --|> BaseStep : extends

    %% Note: Class styling defined above - Mermaid will apply based on classDef definitions
```

### ë‹¨ê³„ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰

ë¦¬íŒ©í† ë§ëœ ì•„í‚¤í…ì²˜ëŠ” UploadOrchestratorì— ì˜í•´ ì¡°ì •ë˜ëŠ” ë‹¨ê³„ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ê° ë‹¨ê³„ëŠ” ì •ì˜ëœ ì±…ì„ê³¼ ì§„í–‰ë¥  ê°€ì¤‘ì¹˜ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

#### ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ê°œìš”

| ë‹¨ê³„ | ì´ë¦„                | ê°€ì¤‘ì¹˜ | ì±…ì„                               |
| ---- | ------------------- | ------ | ---------------------------------- |
| 1    | Initialize          | 5%     | ìŠ¤í† ë¦¬ì§€, pathlib, ê¸°ë³¸ ê²€ì¦ ì„¤ì •  |
| 2    | Process Metadata    | 5%     | ì œê³µëœ Excel ë©”íƒ€ë°ì´í„° ì²˜ë¦¬       |
| 3    | Analyze Collection  | 5%     | ë°ì´í„° ì»¬ë ‰ì…˜ ì‚¬ì–‘ ê²€ìƒ‰ ë° ê²€ì¦    |
| 4    | Organize Files      | 10%    | íƒ€ì…ë³„ íŒŒì¼ ë°œê²¬ ë° êµ¬ì„±           |
| 5    | Validate Files      | 5%     | ë³´ì•ˆ ë° ë‚´ìš© ê²€ì¦                  |
| 6    | Upload Files        | 30%    | ìŠ¤í† ë¦¬ì§€ì— íŒŒì¼ ì—…ë¡œë“œ             |
| 7    | Generate Data Units | 35%    | ì—…ë¡œë“œëœ íŒŒì¼ì—ì„œ ë°ì´í„° ë‹¨ìœ„ ìƒì„± |
| 8    | Cleanup             | 5%     | ì„ì‹œ ë¦¬ì†ŒìŠ¤ ì •ë¦¬                   |

#### ì‹¤í–‰ í”Œë¡œìš°

```mermaid
flowchart TD
    %% Start
    A["ğŸš€ ì—…ë¡œë“œ ì•¡ì…˜ ì‹œì‘"] --> B["ğŸ“‹ UploadContext ìƒì„±"]
    B --> C["âš™ï¸ ì „ëµ êµ¬ì„±"]
    C --> D["ğŸ“ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ë“±ë¡"]
    D --> E["ğŸ¯ UploadOrchestrator ìƒì„±"]

    %% Strategy Injection
    E --> F["ğŸ’‰ ì»¨í…ìŠ¤íŠ¸ì— ì „ëµ ì£¼ì…"]
    F --> G["ğŸ“Š ì§„í–‰ë¥  ì¶”ì  ì´ˆê¸°í™”"]

    %% Step Execution Loop
    G --> H["ğŸ”„ ë‹¨ê³„ ì‹¤í–‰ ë£¨í”„ ì‹œì‘"]
    H --> I["ğŸ“ ë‹¤ìŒ ë‹¨ê³„ ê°€ì ¸ì˜¤ê¸°"]
    I --> J{"ğŸ¤” ë‹¨ê³„ë¥¼ ê±´ë„ˆë›¸ ìˆ˜ ìˆëŠ”ê°€?"}
    J -->|Yes| K["â­ï¸ ë‹¨ê³„ ê±´ë„ˆë›°ê¸°"]
    J -->|No| L["â–¶ï¸ ë‹¨ê³„ ì‹¤í–‰"]

    %% Step Execution
    L --> M{"âœ… ë‹¨ê³„ ì„±ê³µ?"}
    M -->|Yes| N["ğŸ“ˆ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸"]
    M -->|No| O["âŒ ë‹¨ê³„ ì‹¤íŒ¨ ì²˜ë¦¬"]

    %% Success Path
    N --> P["ğŸ’¾ ë‹¨ê³„ ê²°ê³¼ ì €ì¥"]
    P --> Q["ğŸ“ ì‹¤í–‰ëœ ë‹¨ê³„ì— ì¶”ê°€"]
    Q --> R{"ğŸ ë” ë§ì€ ë‹¨ê³„?"}
    R -->|Yes| I
    R -->|No| S["ğŸ‰ ì›Œí¬í”Œë¡œìš° ì™„ë£Œ"]

    %% Skip Path
    K --> T["ğŸ“Š ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ (ê±´ë„ˆë›°ê¸°)"]
    T --> R

    %% Error Handling
    O --> U["ğŸ”™ ë¡¤ë°± í”„ë¡œì„¸ìŠ¤ ì‹œì‘"]
    U --> V["âª ì‹¤í–‰ëœ ë‹¨ê³„ ë¡¤ë°±"]
    V --> W["ğŸ“ ë¡¤ë°± ê²°ê³¼ ë¡œê·¸"]
    W --> X["ğŸ’¥ ì˜ˆì™¸ ì „íŒŒ"]

    %% Final Results
    S --> Y["ğŸ“Š ìµœì¢… ë©”íŠ¸ë¦­ ìˆ˜ì§‘"]
    Y --> Z["ğŸ“‹ ê²°ê³¼ ìš”ì•½ ìƒì„±"]
    Z --> AA["ğŸ”„ UploadActionìœ¼ë¡œ ë°˜í™˜"]

    %% Apply styles - Light/Dark mode compatible
    classDef startNode fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000000
    classDef processNode fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000000
    classDef decisionNode fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#000000
    classDef successNode fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,color:#000000
    classDef errorNode fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#000000
    classDef stepNode fill:#f0f4c3,stroke:#689f38,stroke-width:1px,color:#000000

    class A,B,E startNode
    class C,D,F,G,H,I,L,N,P,Q,T,Y,Z,AA processNode
    class J,M,R decisionNode
    class K,S successNode
    class O,U,V,W,X errorNode
```

#### ë‹¨ê³„ ì‹¤í–‰ ì„¸ë¶€ì‚¬í•­

```mermaid
flowchart TD
    %% Individual Step Details
    A["ğŸš€ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ê°œìš”"]

    A --> B1["1. ğŸ—ï¸ ì´ˆê¸°í™” ë‹¨ê³„<br/>ê°€ì¤‘ì¹˜: 5%<br/>â€¢ ìŠ¤í† ë¦¬ì§€ ì—°ê²° ì„¤ì •<br/>â€¢ pathlib ì•¡ì„¸ìŠ¤ ê²€ì¦<br/>â€¢ ì»¨í…ìŠ¤íŠ¸ ìƒíƒœ ì´ˆê¸°í™”"]
    A --> B2["2. ğŸ“‹ ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ ë‹¨ê³„<br/>ê°€ì¤‘ì¹˜: 5%<br/>â€¢ Excel ë©”íƒ€ë°ì´í„° íŒŒì‹±<br/>â€¢ ë³´ì•ˆ ì œì•½ ê²€ì¦<br/>â€¢ íŒŒì¼ëª… ë§¤í•‘ ìƒì„±"]
    A --> B3["3. ğŸ” ì»¬ë ‰ì…˜ ë¶„ì„ ë‹¨ê³„<br/>ê°€ì¤‘ì¹˜: 5%<br/>â€¢ íŒŒì¼ ì‚¬ì–‘ ê²€ìƒ‰<br/>â€¢ ì»¬ë ‰ì…˜ ì ‘ê·¼ ê²€ì¦<br/>â€¢ êµ¬ì„± ê·œì¹™ ì„¤ì •"]
    A --> B4["4. ğŸ—‚ï¸ íŒŒì¼ êµ¬ì„± ë‹¨ê³„<br/>ê°€ì¤‘ì¹˜: 10%<br/>â€¢ íŒŒì¼ ë°œê²¬ (ì¬ê·€/í‰ë©´)<br/>â€¢ íŒŒì¼ íƒ€ì…ë³„ ê·¸ë£¹í™”<br/>â€¢ êµ¬ì„±ëœ êµ¬ì¡° ìƒì„±"]
    A --> B5["5. âœ… íŒŒì¼ ê²€ì¦ ë‹¨ê³„<br/>ê°€ì¤‘ì¹˜: 5%<br/>â€¢ ë³´ì•ˆ ê²€ì¦<br/>â€¢ í¬ê¸° ë° ë‚´ìš© ê²€ì‚¬<br/>â€¢ ê²€ì¦ ì „ëµ ì ìš©"]
    A --> B6["6. â¬†ï¸ íŒŒì¼ ì—…ë¡œë“œ ë‹¨ê³„<br/>ê°€ì¤‘ì¹˜: 30%<br/>â€¢ ë°°ì¹˜ íŒŒì¼ ì—…ë¡œë“œ<br/>â€¢ ì§„í–‰ë¥  ì¶”ì <br/>â€¢ ì‹¤íŒ¨í•œ ì—…ë¡œë“œ ì¬ì‹œë„"]
    A --> B7["7. ğŸ—ï¸ ë°ì´í„° ë‹¨ìœ„ ìƒì„± ë‹¨ê³„<br/>ê°€ì¤‘ì¹˜: 35%<br/>â€¢ ë°ì´í„° ë‹¨ìœ„ ìƒì„±<br/>â€¢ ë°°ì¹˜ ì²˜ë¦¬<br/>â€¢ íŒŒì¼ì„ ë‹¨ìœ„ì— ì—°ê²°"]
    A --> B8["8. ğŸ§¹ ì •ë¦¬ ë‹¨ê³„<br/>ê°€ì¤‘ì¹˜: 5%<br/>â€¢ ì„ì‹œ íŒŒì¼ ì •ë¦¬<br/>â€¢ ë¦¬ì†ŒìŠ¤ í•´ì œ<br/>â€¢ ìµœì¢… ê²€ì¦"]

    %% Step Details
    B1 --> C1["ì±…ì„ì‚¬í•­:<br/>â€¢ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìŠ¤í† ë¦¬ì§€ ê°€ì ¸ì˜¤ê¸°<br/>â€¢ pathlib ì‘ì—… ë””ë ‰í„°ë¦¬ ì´ˆê¸°í™”<br/>â€¢ ê¸°ë³¸ ì—…ë¡œë“œ ì „ì œì¡°ê±´ ê²€ì¦"]
    B2 --> C2["ì±…ì„ì‚¬í•­:<br/>â€¢ Excel ë©”íƒ€ë°ì´í„° íŒŒì¼ ë¡œë“œ ë° íŒŒì‹±<br/>â€¢ ë³´ì•ˆ ê²€ì¦ ì ìš©<br/>â€¢ íŒŒì¼ëª…-ë©”íƒ€ë°ì´í„° ë§¤í•‘ ìƒì„±"]
    B3 --> C3["ì±…ì„ì‚¬í•­:<br/>â€¢ ë°ì´í„° ì»¬ë ‰ì…˜ ì‚¬ì–‘ ê°€ì ¸ì˜¤ê¸°<br/>â€¢ íŒŒì¼ íƒ€ì… ìš”êµ¬ì‚¬í•­ ê²€ì¦<br/>â€¢ êµ¬ì„± ê·œì¹™ ì„¤ì •"]
    B4 --> C4["ì±…ì„ì‚¬í•­:<br/>â€¢ íŒŒì¼ ë°œê²¬ ì „ëµ ì‚¬ìš©<br/>â€¢ íŒŒì¼ í•„í„°ë§ ë° ë¶„ë¥˜<br/>â€¢ êµ¬ì„±ëœ íŒŒì¼ êµ¬ì¡° ìƒì„±"]
    B5 --> C5["ì±…ì„ì‚¬í•­:<br/>â€¢ ê²€ì¦ ì „ëµ ì‚¬ìš©<br/>â€¢ íŒŒì¼ ë³´ì•ˆ ë° ë‚´ìš© ê²€ì‚¬<br/>â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ê²€ì¦ ê·œì¹™ ì ìš©"]
    B6 --> C6["ì±…ì„ì‚¬í•­:<br/>â€¢ ì—…ë¡œë“œ ì „ëµ ì‚¬ìš©<br/>â€¢ êµ¬ì„± ê°€ëŠ¥í•œ ë°°ì¹˜ë¡œ íŒŒì¼ ì²˜ë¦¬<br/>â€¢ ì§„í–‰ë¥  ì¶”ì  ë° ì‹¤íŒ¨ ì²˜ë¦¬"]
    B7 --> C7["ì±…ì„ì‚¬í•­:<br/>â€¢ ë°ì´í„° ë‹¨ìœ„ ì „ëµ ì‚¬ìš©<br/>â€¢ ì—…ë¡œë“œëœ íŒŒì¼ì—ì„œ ë°ì´í„° ë‹¨ìœ„ ìƒì„±<br/>â€¢ íŒŒì¼ì„ ì ì ˆí•œ ë‹¨ìœ„ì— ì—°ê²°"]
    B8 --> C8["ì±…ì„ì‚¬í•­:<br/>â€¢ ì„ì‹œ íŒŒì¼ ë° ë¦¬ì†ŒìŠ¤ ì •ë¦¬<br/>â€¢ ìµœì¢… ì‹œìŠ¤í…œ ê²€ì¦ ìˆ˜í–‰<br/>â€¢ ê¹¨ë—í•œ ì¢…ë£Œ ë³´ì¥"]

    %% Apply styles - Light/Dark mode compatible
    classDef overviewNode fill:#e3f2fd,stroke:#1976d2,stroke-width:3px,color:#000000
    classDef stepNode fill:#fff9c4,stroke:#f57c00,stroke-width:2px,color:#000000
    classDef detailNode fill:#f0f4c3,stroke:#689f38,stroke-width:1px,color:#000000

    class A overviewNode
    class B1,B2,B3,B4,B5,B6,B7,B8 stepNode
    class C1,C2,C3,C4,C5,C6,C7,C8 detailNode
```

#### ì „ëµ í†µí•© ì§€ì 

ì „ëµì€ ì›Œí¬í”Œë¡œìš°ì˜ íŠ¹ì • ì§€ì ì—ì„œ ì£¼ì…ë©ë‹ˆë‹¤:

- **ê²€ì¦ ì „ëµ**: ValidateFilesStepì—ì„œ ì‚¬ìš©
- **íŒŒì¼ ë°œê²¬ ì „ëµ**: OrganizeFilesStepì—ì„œ ì‚¬ìš©
- **ë©”íƒ€ë°ì´í„° ì „ëµ**: ProcessMetadataStepì—ì„œ ì‚¬ìš©
- **ì—…ë¡œë“œ ì „ëµ**: UploadFilesStepì—ì„œ ì‚¬ìš©
- **ë°ì´í„° ë‹¨ìœ„ ì „ëµ**: GenerateDataUnitsStepì—ì„œ ì‚¬ìš©

#### ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë¡¤ë°±

ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ëŠ” ìë™ ë¡¤ë°± ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

1. **ì˜ˆì™¸ ìº¡ì²˜**: ë””ë²„ê¹…ì„ ìœ„í•´ ì›ë³¸ ì˜ˆì™¸ ë³´ì¡´
2. **ë¡¤ë°± ì‹¤í–‰**: ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ëœ ëª¨ë“  ë‹¨ê³„ì—ì„œ ì—­ìˆœìœ¼ë¡œ rollback() í˜¸ì¶œ
3. **ìš°ì•„í•œ ì €í•˜**: ê°œë³„ ë‹¨ê³„ ë¡¤ë°±ì´ ì‹¤íŒ¨í•´ë„ ë¡¤ë°± ê³„ì† ì§„í–‰
4. **ìƒíƒœ ë³´ì¡´**: ì‹¤íŒ¨ í›„ ë¶„ì„ì„ ìœ„í•œ ì‹¤í–‰ ìƒíƒœ ìœ ì§€

## ê°œë°œ ê°€ì´ë“œ

ì´ ì„¹ì…˜ì€ ì‚¬ìš©ì ì •ì˜ ì „ëµê³¼ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ë¡œ ì—…ë¡œë“œ ì•¡ì…˜ì„ í™•ì¥í•˜ê¸° ìœ„í•œ í¬ê´„ì ì¸ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### ì‚¬ìš©ì ì •ì˜ ì „ëµ ìƒì„±

ì „ëµì€ ì—…ë¡œë“œ í”„ë¡œì„¸ìŠ¤ì˜ ë‹¤ì–‘í•œ ì¸¡ë©´ì— ëŒ€í•œ íŠ¹ì • ë™ì‘ì„ êµ¬í˜„í•©ë‹ˆë‹¤. ê° ì „ëµ íƒ€ì…ì€ ì˜ ì •ì˜ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

#### ì‚¬ìš©ì ì •ì˜ ê²€ì¦ ì „ëµ

```python
from synapse_sdk.plugins.categories.upload.actions.upload.strategies.validation.base import BaseValidationStrategy
from synapse_sdk.plugins.categories.upload.actions.upload.context import UploadContext

class CustomValidationStrategy(BaseValidationStrategy):
    """ê³ ê¸‰ ë³´ì•ˆ ê²€ì‚¬ë¥¼ í¬í•¨í•œ ì‚¬ìš©ì ì •ì˜ ê²€ì¦ ì „ëµ."""

    def validate_files(self, files: List[Path], context: UploadContext) -> bool:
        """ì‚¬ìš©ì ì •ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ê²€ì¦."""
        for file_path in files:
            # ì‚¬ìš©ì ì •ì˜ ê²€ì¦ ë¡œì§
            if not self._validate_custom_rules(file_path):
                return False

            # ë³´ì•ˆ ê²€ì¦ í˜¸ì¶œ
            if not self.validate_security(file_path):
                return False
        return True

    def validate_security(self, file_path: Path) -> bool:
        """ì‚¬ìš©ì ì •ì˜ ë³´ì•ˆ ê²€ì¦."""
        # ì‚¬ìš©ì ì •ì˜ ë³´ì•ˆ ê²€ì‚¬ êµ¬í˜„
        if file_path.suffix in ['.exe', '.bat', '.sh']:
            return False

        # íŒŒì¼ í¬ê¸° ê²€ì‚¬
        if file_path.stat().st_size > 100 * 1024 * 1024:  # 100MB
            return False

        return True

    def _validate_custom_rules(self, file_path: Path) -> bool:
        """ë„ë©”ì¸ë³„ ê²€ì¦ ê·œì¹™ êµ¬í˜„."""
        # ì‚¬ìš©ì ì •ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
        return True
```

#### ì‚¬ìš©ì ì •ì˜ íŒŒì¼ ë°œê²¬ ì „ëµ

```python
from synapse_sdk.plugins.categories.upload.actions.upload.strategies.file_discovery.base import BaseFileDiscoveryStrategy
from pathlib import Path
from typing import List, Dict, Any

class CustomFileDiscoveryStrategy(BaseFileDiscoveryStrategy):
    """ê³ ê¸‰ í•„í„°ë§ì„ í¬í•¨í•œ ì‚¬ìš©ì ì •ì˜ íŒŒì¼ ë°œê²¬."""

    def discover_files(self, path: Path, context: UploadContext) -> List[Path]:
        """ì‚¬ìš©ì ì •ì˜ í•„í„°ë§ ê·œì¹™ìœ¼ë¡œ íŒŒì¼ ë°œê²¬."""
        files = []

        if context.get_param('is_recursive', False):
            files = list(path.rglob('*'))
        else:
            files = list(path.iterdir())

        # ì‚¬ìš©ì ì •ì˜ í•„í„°ë§ ì ìš©
        return self._apply_custom_filters(files, context)

    def organize_files(self, files: List[Path], specs: Dict[str, Any], context: UploadContext) -> List[Dict[str, Any]]:
        """ì‚¬ìš©ì ì •ì˜ ë¶„ë¥˜ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ êµ¬ì„±."""
        organized = []

        for file_path in files:
            if file_path.is_file():
                category = self._determine_category(file_path)
                organized.append({
                    'file_path': file_path,
                    'category': category,
                    'metadata': self._extract_file_metadata(file_path)
                })

        return organized

    def _apply_custom_filters(self, files: List[Path], context: UploadContext) -> List[Path]:
        """ë„ë©”ì¸ë³„ íŒŒì¼ í•„í„° ì ìš©."""
        filtered = []
        for file_path in files:
            if self._should_include_file(file_path):
                filtered.append(file_path)
        return filtered

    def _determine_category(self, file_path: Path) -> str:
        """ì‚¬ìš©ì ì •ì˜ ë¡œì§ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ì¹´í…Œê³ ë¦¬ ê²°ì •."""
        # ì‚¬ìš©ì ì •ì˜ ë¶„ë¥˜ ë¡œì§
        ext = file_path.suffix.lower()
        if ext in ['.jpg', '.png', '.gif']:
            return 'images'
        elif ext in ['.pdf', '.doc', '.docx']:
            return 'documents'
        else:
            return 'other'
```

#### ì‚¬ìš©ì ì •ì˜ ì—…ë¡œë“œ ì „ëµ

```python
from synapse_sdk.plugins.categories.upload.actions.upload.strategies.upload.base import BaseUploadStrategy
from typing import List, Dict, Any

class CustomUploadStrategy(BaseUploadStrategy):
    """ê³ ê¸‰ ì¬ì‹œë„ ë¡œì§ì„ í¬í•¨í•œ ì‚¬ìš©ì ì •ì˜ ì—…ë¡œë“œ ì „ëµ."""

    def upload_files(self, files: List[Dict[str, Any]], context: UploadContext) -> List[Dict[str, Any]]:
        """ì‚¬ìš©ì ì •ì˜ ë°°ì¹˜ ë° ì¬ì‹œë„ ë¡œì§ìœ¼ë¡œ íŒŒì¼ ì—…ë¡œë“œ."""
        uploaded_files = []
        batch_size = context.get_param('upload_batch_size', 10)

        # ì‚¬ìš©ì ì •ì˜ ë°°ì¹˜ë¡œ ì²˜ë¦¬
        for i in range(0, len(files), batch_size):
            batch = files[i:i + batch_size]
            batch_results = self.upload_batch(batch, context)
            uploaded_files.extend(batch_results)

        return uploaded_files

    def upload_batch(self, batch: List[Dict[str, Any]], context: UploadContext) -> List[Dict[str, Any]]:
        """ì¬ì‹œë„ ë¡œì§ìœ¼ë¡œ íŒŒì¼ ë°°ì¹˜ ì—…ë¡œë“œ."""
        results = []

        for file_info in batch:
            max_retries = 3
            for attempt in range(max_retries):
                try:
                    result = self._upload_single_file(file_info, context)
                    results.append(result)
                    break
                except Exception as e:
                    if attempt == max_retries - 1:
                        # ìµœì¢… ì‹œë„ ì‹¤íŒ¨
                        context.add_error(f"Failed to upload {file_info['file_path']}: {e}")
                    else:
                        # ì¬ì‹œë„ ì „ ëŒ€ê¸°
                        time.sleep(2 ** attempt)

        return results

    def _upload_single_file(self, file_info: Dict[str, Any], context: UploadContext) -> Dict[str, Any]:
        """ì‚¬ìš©ì ì •ì˜ ë¡œì§ìœ¼ë¡œ ë‹¨ì¼ íŒŒì¼ ì—…ë¡œë“œ."""
        # ì‚¬ìš©ì ì •ì˜ ì—…ë¡œë“œ êµ¬í˜„
        file_path = file_info['file_path']

        # ì»¨í…ìŠ¤íŠ¸ì—ì„œ ìŠ¤í† ë¦¬ì§€ ì‚¬ìš©
        storage = context.storage

        # ì—¬ê¸°ì— ì‚¬ìš©ì ì •ì˜ ì—…ë¡œë“œ ë¡œì§
        uploaded_file = {
            'file_path': str(file_path),
            'storage_path': f"uploads/{file_path.name}",
            'size': file_path.stat().st_size,
            'checksum': self._calculate_checksum(file_path)
        }

        return uploaded_file
```

### ì‚¬ìš©ì ì •ì˜ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ìƒì„±

ì‚¬ìš©ì ì •ì˜ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ëŠ” ê¸°ë³¸ ë‹¨ê³„ í´ë˜ìŠ¤ë¥¼ í™•ì¥í•˜ê³  í•„ìˆ˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

#### ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ ë‹¨ê³„

```python
from synapse_sdk.plugins.categories.upload.actions.upload.steps.base import BaseStep
from synapse_sdk.plugins.categories.upload.actions.upload.context import UploadContext, StepResult
from pathlib import Path

class CustomProcessingStep(BaseStep):
    """íŠ¹ìˆ˜ íŒŒì¼ ì²˜ë¦¬ë¥¼ ìœ„í•œ ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ ë‹¨ê³„."""

    @property
    def name(self) -> str:
        return 'custom_processing'

    @property
    def progress_weight(self) -> float:
        return 0.15  # ì „ì²´ ì›Œí¬í”Œë¡œìš°ì˜ 15%

    def execute(self, context: UploadContext) -> StepResult:
        """ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ ë¡œì§ ì‹¤í–‰."""
        try:
            # ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ ë¡œì§
            processed_files = self._process_files(context)

            # ê²°ê³¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            return self.create_success_result({
                'processed_files': processed_files,
                'processing_stats': self._get_processing_stats()
            })

        except Exception as e:
            return self.create_error_result(f'Custom processing failed: {str(e)}')

    def can_skip(self, context: UploadContext) -> bool:
        """ë‹¨ê³„ë¥¼ ê±´ë„ˆë›¸ ìˆ˜ ìˆëŠ”ì§€ ê²°ì •."""
        # ì²˜ë¦¬í•  íŒŒì¼ì´ ì—†ìœ¼ë©´ ê±´ë„ˆë›°ê¸°
        return len(context.organized_files) == 0

    def rollback(self, context: UploadContext) -> None:
        """ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ ì‘ì—… ë¡¤ë°±."""
        # ì²˜ë¦¬ ì¤‘ì— ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
        self._cleanup_processing_resources(context)

    def _process_files(self, context: UploadContext) -> List[Dict]:
        """ì‚¬ìš©ì ì •ì˜ íŒŒì¼ ì²˜ë¦¬ êµ¬í˜„."""
        processed = []

        for file_info in context.organized_files:
            # ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ ë¡œì§
            result = self._process_single_file(file_info)
            processed.append(result)

        return processed

    def _process_single_file(self, file_info: Dict) -> Dict:
        """ë‹¨ì¼ íŒŒì¼ ì²˜ë¦¬."""
        # ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ êµ¬í˜„
        return {
            'original': file_info,
            'processed': True,
            'timestamp': datetime.now()
        }
```

### ì „ëµ íŒ©í† ë¦¬ í™•ì¥

ì‚¬ìš©ì ì •ì˜ ì „ëµì„ ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ í•˜ë ¤ë©´ StrategyFactoryë¥¼ í™•ì¥í•˜ì„¸ìš”:

```python
from synapse_sdk.plugins.categories.upload.actions.upload.factory import StrategyFactory

class CustomStrategyFactory(StrategyFactory):
    """ì‚¬ìš©ì ì •ì˜ ì „ëµì„ í¬í•¨í•œ í™•ì¥ íŒ©í† ë¦¬."""

    def create_validation_strategy(self, params: Dict, context=None):
        """ì‚¬ìš©ì ì •ì˜ ì˜µì…˜ìœ¼ë¡œ ê²€ì¦ ì „ëµ ìƒì„±."""
        validation_type = params.get('custom_validation_type', 'default')

        if validation_type == 'strict':
            return CustomValidationStrategy()
        else:
            return super().create_validation_strategy(params, context)

    def create_file_discovery_strategy(self, params: Dict, context=None):
        """ì‚¬ìš©ì ì •ì˜ ì˜µì…˜ìœ¼ë¡œ íŒŒì¼ ë°œê²¬ ì „ëµ ìƒì„±."""
        discovery_mode = params.get('discovery_mode', 'default')

        if discovery_mode == 'advanced':
            return CustomFileDiscoveryStrategy()
        else:
            return super().create_file_discovery_strategy(params, context)
```

### ì‚¬ìš©ì ì •ì˜ ì—…ë¡œë“œ ì•¡ì…˜

í¬ê´„ì ì¸ ì»¤ìŠ¤í„°ë§ˆì´ì œì´ì…˜ì„ ìœ„í•´ì„œëŠ” UploadAction ìì²´ë¥¼ í™•ì¥í•˜ì„¸ìš”:

```python
from synapse_sdk.plugins.categories.upload.actions.upload.action import UploadAction
from synapse_sdk.plugins.categories.decorators import register_action

@register_action
class CustomUploadAction(UploadAction):
    """í™•ì¥ ì›Œí¬í”Œë¡œìš°ë¥¼ í¬í•¨í•œ ì‚¬ìš©ì ì •ì˜ ì—…ë¡œë“œ ì•¡ì…˜."""

    name = 'custom_upload'

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        # ì‚¬ìš©ì ì •ì˜ ì „ëµ íŒ©í† ë¦¬ ì‚¬ìš©
        self.strategy_factory = CustomStrategyFactory()

    def _configure_workflow(self) -> None:
        """ì¶”ê°€ ë‹¨ê³„ë¡œ ì‚¬ìš©ì ì •ì˜ ì›Œí¬í”Œë¡œìš° êµ¬ì„±."""
        # í‘œì¤€ ë‹¨ê³„ ë“±ë¡
        super()._configure_workflow()

        # ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ ë‹¨ê³„ ì¶”ê°€
        self.step_registry.register(CustomProcessingStep())

    def _configure_strategies(self, context=None) -> Dict[str, Any]:
        """ì‚¬ìš©ì ì •ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ëµ êµ¬ì„±."""
        strategies = super()._configure_strategies(context)

        # ì‚¬ìš©ì ì •ì˜ ì „ëµ ì¶”ê°€
        strategies['custom_processing'] = self._create_custom_processing_strategy()

        return strategies

    def _create_custom_processing_strategy(self):
        """ì‚¬ìš©ì ì •ì˜ ì²˜ë¦¬ ì „ëµ ìƒì„±."""
        return CustomProcessingStrategy(self.params)
```

### ì‚¬ìš©ì ì •ì˜ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸

#### ì‚¬ìš©ì ì •ì˜ ì „ëµ í…ŒìŠ¤íŠ¸

```python
import pytest
from unittest.mock import Mock
from pathlib import Path

class TestCustomValidationStrategy:

    def setup_method(self):
        self.strategy = CustomValidationStrategy()
        self.context = Mock()

    def test_validate_files_success(self):
        """ì„±ê³µì ì¸ íŒŒì¼ ê²€ì¦ í…ŒìŠ¤íŠ¸."""
        files = [Path('/test/file1.txt'), Path('/test/file2.jpg')]
        result = self.strategy.validate_files(files, self.context)
        assert result is True

    def test_validate_files_security_failure(self):
        """ë³´ì•ˆìƒ ì´ìœ ë¡œ ê²€ì¦ ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸."""
        files = [Path('/test/malware.exe')]
        result = self.strategy.validate_files(files, self.context)
        assert result is False

    def test_validate_large_file_failure(self):
        """í° íŒŒì¼ì— ëŒ€í•œ ê²€ì¦ ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸."""
        # í° í¬ê¸°ë¥¼ ë°˜í™˜í•˜ë„ë¡ íŒŒì¼ stat ëª¨í‚¹
        large_file = Mock(spec=Path)
        large_file.suffix = '.txt'
        large_file.stat.return_value.st_size = 200 * 1024 * 1024  # 200MB

        result = self.strategy.validate_security(large_file)
        assert result is False
```

#### ì‚¬ìš©ì ì •ì˜ ë‹¨ê³„ í…ŒìŠ¤íŠ¸

```python
class TestCustomProcessingStep:

    def setup_method(self):
        self.step = CustomProcessingStep()
        self.context = Mock()
        self.context.organized_files = [
            {'file_path': '/test/file1.txt'},
            {'file_path': '/test/file2.jpg'}
        ]

    def test_execute_success(self):
        """ì„±ê³µì ì¸ ë‹¨ê³„ ì‹¤í–‰ í…ŒìŠ¤íŠ¸."""
        result = self.step.execute(self.context)

        assert result.success is True
        assert 'processed_files' in result.data
        assert len(result.data['processed_files']) == 2

    def test_can_skip_with_no_files(self):
        """ë‹¨ê³„ ê±´ë„ˆë›°ê¸° ë¡œì§ í…ŒìŠ¤íŠ¸."""
        self.context.organized_files = []
        assert self.step.can_skip(self.context) is True

    def test_rollback_cleanup(self):
        """ë¡¤ë°± ì •ë¦¬ í…ŒìŠ¤íŠ¸."""
        # ì´ê²ƒì€ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ì§€ ì•Šì•„ì•¼ í•¨
        self.step.rollback(self.context)
```

## ì—…ë¡œë“œ ë§¤ê°œë³€ìˆ˜

ì—…ë¡œë“œ ì•¡ì…˜ì€ í¬ê´„ì ì¸ ë§¤ê°œë³€ìˆ˜ ê²€ì¦ì„ ìœ„í•´ `UploadParams`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

### í•„ìˆ˜ ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜          | íƒ€ì…  | ì„¤ëª…                    | ê²€ì¦                   |
| ----------------- | ----- | ----------------------- | ---------------------- |
| `name`            | `str` | ì½ê¸° ì‰¬ìš´ ì—…ë¡œë“œ ì´ë¦„   | ë¹ˆ ê°’ì´ ì•„ë‹ˆì–´ì•¼ í•¨    |
| `path`            | `str` | ì†ŒìŠ¤ íŒŒì¼/ë””ë ‰í† ë¦¬ ê²½ë¡œ | ìœ íš¨í•œ ê²½ë¡œì—¬ì•¼ í•¨     |
| `storage`         | `int` | ëŒ€ìƒ ìŠ¤í† ë¦¬ì§€ ID        | APIë¥¼ í†µí•´ ì¡´ì¬í•´ì•¼ í•¨ |
| `data_collection` | `int` | ë°ì´í„° ì»¬ë ‰ì…˜ ID        | APIë¥¼ í†µí•´ ì¡´ì¬í•´ì•¼ í•¨ |

### ì„ íƒì  ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜                        | íƒ€ì…          | ê¸°ë³¸ê°’  | ì„¤ëª…                        |
| ------------------------------- | ------------- | ------- | --------------------------- |
| `description`                   | `str \| None` | `None`  | ì—…ë¡œë“œ ì„¤ëª…                 |
| `project`                       | `int \| None` | `None`  | í”„ë¡œì íŠ¸ ID (ì œê³µì‹œ ê²€ì¦ë¨) |
| `excel_metadata_path`           | `str \| None` | `None`  | Excel ë©”íƒ€ë°ì´í„° íŒŒì¼ ê²½ë¡œ  |
| `is_recursive`                  | `bool`        | `False` | ë””ë ‰í† ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ ìŠ¤ìº”  |
| `max_file_size_mb`              | `int`         | `50`    | ìµœëŒ€ íŒŒì¼ í¬ê¸° (MB)         |
| `creating_data_unit_batch_size` | `int`         | `100`   | ë°ì´í„° ë‹¨ìœ„ ë°°ì¹˜ í¬ê¸°       |
| `use_async_upload`              | `bool`        | `True`  | ë¹„ë™ê¸° ì²˜ë¦¬ ì‚¬ìš©            |

### ë§¤ê°œë³€ìˆ˜ ê²€ì¦

ì‹œìŠ¤í…œì€ ì‹¤ì‹œê°„ ê²€ì¦ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤:

```python
# ìŠ¤í† ë¦¬ì§€ ê²€ì¦
@field_validator('storage', mode='before')
@classmethod
def check_storage_exists(cls, value: str, info) -> str:
    action = info.context['action']
    client = action.client
    try:
        client.get_storage(value)
    except ClientError:
        raise PydanticCustomError('client_error', 'Storage not found')
    return value
```

**ê²€ì¦ ê·œì¹™:**

- `source_path`: ì½ê¸° ê°€ëŠ¥í•œ ë””ë ‰í„°ë¦¬ ë˜ëŠ” íŒŒì¼ì´ì–´ì•¼ í•¨
- ëª¨ë“  ID í•„ë“œ: ë¹„ì–´ìˆì§€ ì•Šì€ ë¬¸ìì—´ì´ì–´ì•¼ í•¨
- `batch_size`: 1 ì´ìƒì˜ ì •ìˆ˜
- `max_workers`: 1 ì´ìƒì˜ ì •ìˆ˜
- `include_patterns`/`exclude_patterns`: ìœ íš¨í•œ glob íŒ¨í„´ ëª©ë¡

### UploadRun

ì—…ë¡œë“œ ì‹¤í–‰ê³¼ ë¡œê¹…ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.

```python
class UploadRun(BaseRun):
    def __init__(self, action_name: str = "upload"):
        """ì—…ë¡œë“œ ì‹¤í–‰ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤."""

    def log_message_with_code(self, log_code: LogCode, **kwargs):
        """ë¡œê·¸ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ë¡œê¹…í•©ë‹ˆë‹¤."""

    def log_upload_event(self, event_type: str, details: Dict):
        """ì—…ë¡œë“œ ì´ë²¤íŠ¸ë¥¼ ë¡œê¹…í•©ë‹ˆë‹¤."""
```

### ì—´ê±°í˜•

#### LogCode

ì—…ë¡œë“œ ì‘ì—…ì— ëŒ€í•œ íƒ€ì… ì•ˆì „ ë¡œê¹… ì½”ë“œ:

```python
class LogCode(Enum):
    UPLOAD_STARTED = "UPLOAD_001"
    FILE_DISCOVERED = "UPLOAD_002"
    FILE_PROCESSED = "UPLOAD_003"
    BATCH_COMPLETED = "UPLOAD_004"
    UPLOAD_COMPLETED = "UPLOAD_005"
    UPLOAD_FAILED = "UPLOAD_006"
    # ... ì´ 36ê°œ ì½”ë“œ
```

#### UploadStatus

ì—…ë¡œë“œ ì‘ì—… ìƒíƒœ:

```python
class UploadStatus(Enum):
    SUCCESS = "success"
    FAILED = "failed"
```

### ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤

#### ExcelSecurityConfig

Excel íŒŒì¼ ë³´ì•ˆ ì„¤ì •:

```python
class ExcelSecurityConfig:
    max_file_size_mb: int = 10      # íŒŒì¼ í¬ê¸° ì œí•œ (MB)
    max_rows: int = 100000          # í–‰ ìˆ˜ ì œí•œ
    max_columns: int = 50           # ì—´ ìˆ˜ ì œí•œ

    @classmethod
    def from_action_config(cls, action_config) -> 'ExcelSecurityConfig':
        """config.yamlì—ì„œ ì„¤ì •ì„ ë¡œë“œí•©ë‹ˆë‹¤."""
```

#### PathAwareJSONEncoder

Path ë° datetime ê°ì²´ë¥¼ ìœ„í•œ ì‚¬ìš©ì ì •ì˜ JSON ì¸ì½”ë”:

```python
class PathAwareJSONEncoder:
    """JSON ì§ë ¬í™”ë¥¼ ìœ„í•œ ì‚¬ìš©ì ì •ì˜ ì¸ì½”ë”"""

    @staticmethod
    def default(obj):
        """ì§€ì›ë˜ëŠ” íƒ€ì…ì„ JSON í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ë³€í™˜"""
        if isinstance(obj, Path):
            return str(obj)
        elif isinstance(obj, datetime):
            return obj.isoformat()
        return json.JSONEncoder.default(obj)
```

**ì§€ì› íƒ€ì…:**

- Path ê°ì²´ (ë¬¸ìì—´ë¡œ ë³€í™˜)
- Datetime ê°ì²´ (ISO í˜•ì‹)
- í‘œì¤€ JSON ì§ë ¬í™” ê°€ëŠ¥ íƒ€ì…

## Excel ë©”íƒ€ë°ì´í„° ì²˜ë¦¬

ì—…ë¡œë“œ í”ŒëŸ¬ê·¸ì¸ì€ í¬ê´„ì ì¸ íŒŒì¼ëª… ë§¤ì¹­, ìœ ì—°í•œ í—¤ë” ì§€ì› ë° ìµœì í™”ëœ ì„±ëŠ¥ì„ í†µí•œ ê³ ê¸‰ Excel ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤:

### Excel íŒŒì¼ í˜•ì‹

Excel íŒŒì¼ì€ ìœ ì—°í•œ í—¤ë” í˜•ì‹ê³¼ í¬ê´„ì ì¸ íŒŒì¼ëª… ë§¤ì¹­ì„ ì§€ì›í•©ë‹ˆë‹¤:

#### ì§€ì›ë˜ëŠ” í—¤ë” í˜•ì‹

ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ” ë§¤ì¹­ìœ¼ë¡œ ë‘ í—¤ë” í˜•ì‹ ëª¨ë‘ ì§€ì›ë©ë‹ˆë‹¤:

**ì˜µì…˜ 1: "filename" í—¤ë”**
| filename | category | description | custom_field |
| ---------- | -------- | ------------------ | ------------ |
| image1.jpg | nature | Mountain landscape | high_res |
| image2.png | urban | City skyline | processed |

**ì˜µì…˜ 2: "file_name" í—¤ë”**  
| file_name | category | description | custom_field |
| ---------- | -------- | ------------------ | ------------ |
| image1.jpg | nature | Mountain landscape | high_res |
| image2.png | urban | City skyline | processed |

#### íŒŒì¼ëª… ë§¤ì¹­ ì „ëµ

ì‹œìŠ¤í…œì€ íŒŒì¼ê³¼ ë©”íƒ€ë°ì´í„°ë¥¼ ì—°ê²°í•˜ê¸° ìœ„í•´ í¬ê´„ì ì¸ 5ë‹¨ê³„ ìš°ì„ ìˆœìœ„ ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

1. **ì •í™•í•œ stem ë§¤ì¹­** (ìµœìš°ì„ ): `image1`ì´ `image1.jpg`ì™€ ë§¤ì¹­
2. **ì •í™•í•œ íŒŒì¼ëª… ë§¤ì¹­**: `image1.jpg`ê°€ `image1.jpg`ì™€ ë§¤ì¹­
3. **ë©”íƒ€ë°ì´í„° í‚¤ stem ë§¤ì¹­**: `path/image1.ext` stemì´ `image1`ê³¼ ë§¤ì¹­
4. **ë¶€ë¶„ ê²½ë¡œ ë§¤ì¹­**: `/uploads/image1.jpg`ì— `image1` í¬í•¨
5. **ì „ì²´ ê²½ë¡œ ë§¤ì¹­**: ë³µì¡í•œ êµ¬ì¡°ì— ëŒ€í•œ ì™„ì „í•œ ê²½ë¡œ ë§¤ì¹­

ì´ ê°•ë ¥í•œ ë§¤ì¹­ì€ íŒŒì¼ êµ¬ì„±ì´ë‚˜ ëª…ëª… ê·œì¹™ì— ê´€ê³„ì—†ì´ ë©”íƒ€ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ê²Œ ì—°ê²°ë˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.

### ë³´ì•ˆ ê²€ì¦

Excel íŒŒì¼ì€ í¬ê´„ì ì¸ ë³´ì•ˆ ê²€ì¦ì„ ë°›ìŠµë‹ˆë‹¤:

```python
class ExcelSecurityConfig:
    max_file_size_mb: int = 10      # íŒŒì¼ í¬ê¸° ì œí•œ (MB)
    max_rows: int = 100000          # í–‰ ìˆ˜ ì œí•œ
    max_columns: int = 50           # ì—´ ìˆ˜ ì œí•œ
```

#### ê³ ê¸‰ ë³´ì•ˆ ê¸°ëŠ¥

- **íŒŒì¼ í˜•ì‹ ê²€ì¦**: Excel íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ í™•ì¸ (.xlsxì˜ ê²½ìš° PK, .xlsì˜ ê²½ìš° ë³µí•© ë¬¸ì„œ)
- **ë©”ëª¨ë¦¬ ì¶”ì •**: ëŒ€ìš©ëŸ‰ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¡œ ì¸í•œ ë©”ëª¨ë¦¬ ê³ ê°ˆ ë°©ì§€
- **ë‚´ìš© ì •í™”**: ì§€ë‚˜ì¹˜ê²Œ ê¸´ ê°’ì˜ ìë™ ì˜ë¼ë‚´ê¸°
- **ì˜¤ë¥˜ ë³µì›ë ¥**: ì†ìƒë˜ê±°ë‚˜ ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” íŒŒì¼ì˜ ìš°ì•„í•œ ì²˜ë¦¬

### config.yamlì„ í†µí•œ êµ¬ì„±

ë³´ì•ˆ ì œí•œ ë° ì²˜ë¦¬ ì˜µì…˜ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```yaml
actions:
  upload:
    excel_config:
      max_file_size_mb: 10 # Excel íŒŒì¼ ìµœëŒ€ í¬ê¸° (MB)
      max_rows: 100000 # í—ˆìš©ë˜ëŠ” ìµœëŒ€ í–‰ ìˆ˜
      max_columns: 50 # í—ˆìš©ë˜ëŠ” ìµœëŒ€ ì—´ ìˆ˜
```

### ì„±ëŠ¥ ìµœì í™”

Excel ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ì—ëŠ” ì—¬ëŸ¬ ì„±ëŠ¥ í–¥ìƒ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

#### ë©”íƒ€ë°ì´í„° ì¸ë±ì‹±

- **O(1) í•´ì‹œ ê²€ìƒ‰**: ì •í™•í•œ stem ë° íŒŒì¼ëª… ë§¤ì¹­ìš©
- **ì‚¬ì „ êµ¬ì¶•ëœ ì¸ë±ìŠ¤**: ì¼ë°˜ì ì¸ ë§¤ì¹­ íŒ¨í„´ìš©
- **ëŒ€ì²´ ì•Œê³ ë¦¬ì¦˜**: ë³µì¡í•œ ê²½ë¡œ ë§¤ì¹­ ì‹œë‚˜ë¦¬ì˜¤ìš©

#### íš¨ìœ¨ì ì¸ ì²˜ë¦¬

- **ìµœì í™”ëœ í–‰ ì²˜ë¦¬**: ë¹ˆ í–‰ì„ ì¡°ê¸°ì— ê±´ë„ˆë›°ê¸°
- **ë©”ëª¨ë¦¬ ì¸ì‹ ì‘ì—…**: ë°°ì¹˜ë¡œ íŒŒì¼ ì²˜ë¦¬
- **ìŠ¤ë§ˆíŠ¸ íŒŒì¼ ë°œê²¬**: ë°˜ë³µë˜ëŠ” ë³€í™˜ì„ í”¼í•˜ê¸° ìœ„í•œ ê²½ë¡œ ë¬¸ìì—´ ìºì‹œ

### ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ í”Œë¡œìš°

1. **ë³´ì•ˆ ê²€ì¦**: íŒŒì¼ í¬ê¸°, í˜•ì‹ ë° ë‚´ìš© ì œí•œ
2. **í—¤ë” ê²€ì¦**: ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ” ë§¤ì¹­ìœ¼ë¡œ "filename" ë° "file_name" ëª¨ë‘ ì§€ì›
3. **ì¸ë±ìŠ¤ êµ¬ì¶•**: ì„±ëŠ¥ì„ ìœ„í•œ O(1) ê²€ìƒ‰ êµ¬ì¡° ìƒì„±
4. **ë‚´ìš© ì²˜ë¦¬**: ìµœì í™”ë¥¼ í†µí•œ í–‰ë³„ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
5. **ë°ì´í„° ì •í™”**: ìë™ ì˜ë¼ë‚´ê¸° ë° ê²€ì¦
6. **íŒ¨í„´ ë§¤ì¹­**: 5ë‹¨ê³„ íŒŒì¼ëª… ì—°ê²° ì•Œê³ ë¦¬ì¦˜
7. **ë§¤í•‘ ìƒì„±**: ìµœì í™”ëœ íŒŒì¼ëª…ì—ì„œ ë©”íƒ€ë°ì´í„°ë¡œì˜ ë§¤í•‘

### Excel ë©”íƒ€ë°ì´í„° ë§¤ê°œë³€ìˆ˜

ì‚¬ìš©ì ì •ì˜ Excel ë©”íƒ€ë°ì´í„° íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
params = {
    "name": "Excel ë©”íƒ€ë°ì´í„° ì—…ë¡œë“œ",
    "path": "/data/files",
    "storage": 1,
    "data_collection": 5,
    "excel_metadata_path": "/data/custom_metadata.xlsx"  # ì‚¬ìš©ì ì •ì˜ Excel íŒŒì¼
}
```

#### ê²½ë¡œ í•´ê²°

- **ì ˆëŒ€ ê²½ë¡œ**: ì¡´ì¬í•˜ê³  ì ‘ê·¼ ê°€ëŠ¥í•œ ê²½ìš° ì§ì ‘ ì‚¬ìš©
- **ìƒëŒ€ ê²½ë¡œ**: ì—…ë¡œë“œ ê²½ë¡œì— ìƒëŒ€ì ìœ¼ë¡œ í•´ê²°
- **ê¸°ë³¸ ë°œê²¬**: ê²½ë¡œê°€ ì§€ì •ë˜ì§€ ì•Šì€ ê²½ìš° ìë™ìœ¼ë¡œ `meta.xlsx` ë˜ëŠ” `meta.xls` ê²€ìƒ‰
- **ìŠ¤í† ë¦¬ì§€ í†µí•©**: ì ì ˆí•œ ê²½ë¡œ í•´ê²°ì„ ìœ„í•´ ìŠ¤í† ë¦¬ì§€ êµ¬ì„± ì‚¬ìš©

### ì˜¤ë¥˜ ì²˜ë¦¬

í¬ê´„ì ì¸ ì˜¤ë¥˜ ì²˜ë¦¬ë¡œ ê°•ë ¥í•œ ì‘ì—…ì„ ë³´ì¥í•©ë‹ˆë‹¤:

```python
# Excel ì²˜ë¦¬ ì˜¤ë¥˜ëŠ” ìš°ì•„í•˜ê²Œ ì²˜ë¦¬ë©ë‹ˆë‹¤
try:
    metadata = process_excel_metadata(excel_path)
except ExcelSecurityError as e:
    # ë³´ì•ˆ ìœ„ë°˜ - íŒŒì¼ì´ ë„ˆë¬´ í¬ê±°ë‚˜ í–‰ì´ ë„ˆë¬´ ë§ìŒ ë“±
    log_security_violation(e)
except ExcelParsingError as e:
    # íŒŒì‹± ì‹¤íŒ¨ - ì†ìƒëœ íŒŒì¼, ì˜ëª»ëœ í˜•ì‹ ë“±
    log_parsing_error(e)
```

#### ì˜¤ë¥˜ ë³µêµ¬

- **ìš°ì•„í•œ ì„±ëŠ¥ ì €í•˜**: Excelì´ ì‹¤íŒ¨í•˜ë©´ ë¹ˆ ë©”íƒ€ë°ì´í„°ë¡œ ì²˜ë¦¬ ê³„ì†
- **ìƒì„¸ ë¡œê¹…**: ë‹¤ì–‘í•œ ì‹¤íŒ¨ ìœ í˜•ì— ëŒ€í•œ íŠ¹ì • ì˜¤ë¥˜ ì½”ë“œ
- **ê²½ë¡œ ê²€ì¦**: ë§¤ê°œë³€ìˆ˜ ì²˜ë¦¬ ì¤‘ í¬ê´„ì ì¸ ê²€ì¦
- **ëŒ€ì²´ ë™ì‘**: ë©”íƒ€ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ì—†ì„ ë•Œ ìŠ¤ë§ˆíŠ¸ ê¸°ë³¸ê°’

## íŒŒì¼ êµ¬ì„±

ì—…ë¡œë“œ ì‹œìŠ¤í…œì€ íŒŒì¼ì„ íƒ€ì…ì— ë”°ë¼ ìë™ìœ¼ë¡œ êµ¬ì„±í•©ë‹ˆë‹¤:

### íƒ€ì… ê°ì§€

íŒŒì¼ì€ ë‹¤ìŒì„ ê¸°ë°˜ìœ¼ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤:

- íŒŒì¼ í™•ì¥ì íŒ¨í„´
- MIME íƒ€ì… ê°ì§€
- ë‚´ìš© ë¶„ì„
- ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê·œì¹™

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
upload_output/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ image1.jpg
â”‚   â””â”€â”€ image2.png
â”œâ”€â”€ documents/
â”‚   â”œâ”€â”€ report.pdf
â”‚   â””â”€â”€ data.xlsx
â””â”€â”€ videos/
    â””â”€â”€ presentation.mp4
```

### ë°°ì¹˜ ì²˜ë¦¬

íŒŒì¼ì€ êµ¬ì„± ê°€ëŠ¥í•œ ë°°ì¹˜ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤:

```python
# ë°°ì¹˜ í¬ê¸° êµ¬ì„±
params = {
    "creating_data_unit_batch_size": 100,
    "use_async_upload": True
}
```

## ì§„í–‰ë¥  ì¶”ì  ë° ë©”íŠ¸ë¦­

### ì§„í–‰ë¥  ì¹´í…Œê³ ë¦¬

ì—…ë¡œë“œ ì•¡ì…˜ì€ ì„¸ ê°€ì§€ ì£¼ìš” ë‹¨ê³„ì—ì„œ ì§„í–‰ë¥ ì„ ì¶”ì í•©ë‹ˆë‹¤:

| ì¹´í…Œê³ ë¦¬              | ë¹„ìœ¨ | ì„¤ëª…                     |
| --------------------- | ---- | ------------------------ |
| `analyze_collection`  | 2%   | ë§¤ê°œë³€ìˆ˜ ê²€ì¦ ë° ì„¤ì •    |
| `upload_data_files`   | 38%  | íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬         |
| `generate_data_units` | 60%  | ë°ì´í„° ë‹¨ìœ„ ìƒì„± ë° ì™„ë£Œ |

### ë©”íŠ¸ë¦­ ìˆ˜ì§‘

ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´ ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ì´ ìˆ˜ì§‘ë©ë‹ˆë‹¤:

```python
metrics_categories = {
    'data_files': {
        'stand_by': 0,    # ì²˜ë¦¬ ëŒ€ê¸° ì¤‘ì¸ íŒŒì¼
        'failed': 0,      # ì—…ë¡œë“œ ì‹¤íŒ¨í•œ íŒŒì¼
        'success': 0,     # ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œëœ íŒŒì¼
    },
    'data_units': {
        'stand_by': 0,    # ìƒì„± ëŒ€ê¸° ì¤‘ì¸ ë‹¨ìœ„
        'failed': 0,      # ìƒì„± ì‹¤íŒ¨í•œ ë‹¨ìœ„
        'success': 0,     # ì„±ê³µì ìœ¼ë¡œ ìƒì„±ëœ ë‹¨ìœ„
    },
}
```

## íƒ€ì… ì•ˆì „ ë¡œê¹…

ì—…ë¡œë“œ ì‹œìŠ¤í…œì€ ì¼ê´€ì„±ì„ ìœ„í•´ ì—´ê±°í˜• ê¸°ë°˜ ë¡œê¹…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

### ë¡œê·¸ ì½”ë“œ

```python
class LogCode(str, Enum):
    VALIDATION_FAILED = 'VALIDATION_FAILED'
    NO_FILES_FOUND = 'NO_FILES_FOUND'
    EXCEL_SECURITY_VIOLATION = 'EXCEL_SECURITY_VIOLATION'
    EXCEL_PARSING_ERROR = 'EXCEL_PARSING_ERROR'
    FILES_DISCOVERED = 'FILES_DISCOVERED'
    UPLOADING_DATA_FILES = 'UPLOADING_DATA_FILES'
    GENERATING_DATA_UNITS = 'GENERATING_DATA_UNITS'
    IMPORT_COMPLETED = 'IMPORT_COMPLETED'
```

### ë¡œê¹… ì‚¬ìš©ë²•

```python
# ê¸°ë³¸ ë¡œê¹…
run.log_message_with_code(LogCode.FILES_DISCOVERED, file_count)

# ì‚¬ìš©ì ì •ì˜ ë ˆë²¨ë¡œ
run.log_message_with_code(
    LogCode.EXCEL_SECURITY_VIOLATION,
    filename,
    level=Context.DANGER
)

# ì—…ë¡œë“œ íŠ¹ì • ì´ë²¤íŠ¸
run.log_upload_event(LogCode.UPLOADING_DATA_FILES, batch_size)
```

## ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### ë ˆê±°ì‹œì—ì„œ ë¦¬íŒ©í† ë§ëœ ì•„í‚¤í…ì²˜ë¡œ

ì—…ë¡œë“œ ì•¡ì…˜ì€ **100% í•˜ìœ„ í˜¸í™˜ì„±**ì„ ìœ ì§€í•˜ë©´ì„œ í˜„ëŒ€ì ì¸ ë””ìì¸ íŒ¨í„´ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬íŒ©í† ë§ë˜ì—ˆìŠµë‹ˆë‹¤. ê¸°ì¡´ ì½”ë“œëŠ” ë³€ê²½ ì—†ì´ ê³„ì† ì‘ë™í•©ë‹ˆë‹¤.

#### ì£¼ìš” ë³€ê²½ ì‚¬í•­

**ì´ì „ (ë ˆê±°ì‹œ ëª¨ë†€ë¦¬ì‹):**

- ëª¨ë“  ë¡œì§ì„ í¬í•¨í•œ ë‹¨ì¼ 900+ ì¤„ ì•¡ì…˜ í´ë˜ìŠ¤
- ê²€ì¦, íŒŒì¼ ë°œê²¬ ë“±ì— ëŒ€í•œ í•˜ë“œì½”ë”©ëœ ë™ì‘
- í™•ì¥ì„±ì´ë‚˜ ì»¤ìŠ¤í„°ë§ˆì´ì œì´ì…˜ ì˜µì…˜ ì—†ìŒ
- ì „ë°˜ì— ê±¸ì¹œ ìˆ˜ë™ ì˜¤ë¥˜ ì²˜ë¦¬

**ì´í›„ (ì „ëµ/íŒŒì‚¬ë“œ íŒ¨í„´):**

- 8ê°œ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ë¡œ ëª…í™•í•œ ê´€ì‹¬ì‚¬ ë¶„ë¦¬
- ë‹¤ì–‘í•œ ë™ì‘ì„ ìœ„í•œ í”ŒëŸ¬ê·¸í˜• ì „ëµ
- ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ì„ ìœ„í•œ í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜
- ìë™ ë¡¤ë°± ë° í¬ê´„ì ì¸ ì˜¤ë¥˜ ì²˜ë¦¬

#### í•˜ìœ„ í˜¸í™˜ì„±

```python
# ì´ ë ˆê±°ì‹œ ì‚¬ìš©ë²•ì€ ë™ì¼í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤
from synapse_sdk.plugins.categories.upload.actions.upload.action import UploadAction

params = {
    "name": "My Upload",
    "path": "/data/files",
    "storage": 1,
    "data_collection": 5  # 'collection'ì—ì„œ 'data_collection'ìœ¼ë¡œ ë³€ê²½
}

action = UploadAction(params=params, plugin_config=config)
result = action.start()  # ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ì‘ë™
```

#### í–¥ìƒëœ ê¸°ëŠ¥

ë¦¬íŒ©í† ë§ëœ ì•„í‚¤í…ì²˜ëŠ” ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

```python
# ìì„¸í•œ ì›Œí¬í”Œë¡œìš° ì •ë³´ ê°€ì ¸ì˜¤ê¸°
action = UploadAction(params=params, plugin_config=config)
workflow_info = action.get_workflow_summary()
print(f"Configured with {workflow_info['step_count']} steps")
print(f"Available strategies: {workflow_info['available_strategies']}")

# ì‹¤í–‰í•˜ê³  ìì„¸í•œ ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
result = action.start()
print(f"Success: {result['success']}")
print(f"Uploaded files: {result['uploaded_files_count']}")
print(f"Generated data units: {result['generated_data_units_count']}")
print(f"Errors: {result['errors']}")
print(f"Metrics: {result['metrics']}")
```

#### ë§¤ê°œë³€ìˆ˜ ë³€ê²½

í•˜ë‚˜ì˜ ë§¤ê°œë³€ìˆ˜ ì´ë¦„ë§Œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤:

| ë ˆê±°ì‹œ             | ë¦¬íŒ©í† ë§          | ìƒíƒœ          |
| ------------------ | ----------------- | ------------- |
| `collection`       | `data_collection` | **í•„ìˆ˜ ë³€ê²½** |
| ê¸°íƒ€ ëª¨ë“  ë§¤ê°œë³€ìˆ˜ | ë³€ê²½ ì—†ìŒ         | ì™„ì „ í˜¸í™˜     |

#### ë§ˆì´ê·¸ë ˆì´ì…˜ì˜ ì´ì 

- **ë” ë‚˜ì€ ì˜¤ë¥˜ ì²˜ë¦¬**: ì‹¤íŒ¨ ì‹œ ìë™ ë¡¤ë°±
- **ì§„í–‰ë¥  ì¶”ì **: ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ì „ë°˜ì˜ ìì„¸í•œ ì§„í–‰ë¥  ë©”íŠ¸ë¦­
- **í™•ì¥ì„±**: ì‚¬ìš©ì ì •ì˜ ì „ëµ ë° ë‹¨ê³„ ì¶”ê°€
- **í…ŒìŠ¤íŠ¸**: ëª¨í‚¹ ì¹œí™”ì ì¸ ì•„í‚¤í…ì²˜ë¡œ ë” ë‚˜ì€ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±
- **ìœ ì§€ë³´ìˆ˜ì„±**: ëª…í™•í•œ ê´€ì‹¬ì‚¬ ë¶„ë¦¬
- **ì„±ëŠ¥**: ë” íš¨ìœ¨ì ì¸ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬

## ì‚¬ìš© ì˜ˆì œ

### ê¸°ë³¸ íŒŒì¼ ì—…ë¡œë“œ (ë¦¬íŒ©í† ë§ëœ ì•„í‚¤í…ì²˜)

```python
from synapse_sdk.plugins.categories.upload.actions.upload.action import UploadAction

# ìƒˆ ì•„í‚¤í…ì²˜ë¡œ ê¸°ë³¸ ì—…ë¡œë“œ êµ¬ì„±
params = {
    "name": "Dataset Upload",
    "description": "Training dataset for ML model",
    "path": "/data/training_images",
    "storage": 1,
    "data_collection": 5,  # ì°¸ê³ : 'collection' ëŒ€ì‹  'data_collection'
    "is_recursive": True,
    "max_file_size_mb": 100
}

action = UploadAction(
    params=params,
    plugin_config=plugin_config
)

# ìë™ ë‹¨ê³„ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš° ë° ë¡¤ë°±ìœ¼ë¡œ ì‹¤í–‰
result = action.start()

# í–¥ìƒëœ ê²°ê³¼ ì •ë³´
print(f"Upload successful: {result['success']}")
print(f"Uploaded {result['uploaded_files_count']} files")
print(f"Generated {result['generated_data_units_count']} data units")
print(f"Workflow errors: {result['errors']}")

# ìì„¸í•œ ë©”íŠ¸ë¦­ì— ì•¡ì„¸ìŠ¤
workflow_metrics = result['metrics'].get('workflow', {})
print(f"Total steps executed: {workflow_metrics.get('current_step', 0)}")
print(f"Progress completed: {workflow_metrics.get('progress_percentage', 0)}%")
```

### ì§„í–‰ë¥  ì¶”ì ì´ í¬í•¨ëœ Excel ë©”íƒ€ë°ì´í„° ì—…ë¡œë“œ

```python
# Excel ë©”íƒ€ë°ì´í„° ë° ì§„í–‰ë¥  ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ì—…ë¡œë“œ
params = {
    "name": "Annotated Dataset Upload",
    "path": "/data/images",
    "storage": 1,
    "data_collection": 5,
    "excel_metadata_path": "/data/metadata.xlsx",
    "is_recursive": False,
    "creating_data_unit_batch_size": 50
}

action = UploadAction(
    params=params,
    plugin_config=plugin_config
)

# ì‹¤í–‰ ì „ ì›Œí¬í”Œë¡œìš° ìš”ì•½ ê°€ì ¸ì˜¤ê¸°
workflow_info = action.get_workflow_summary()
print(f"Workflow configured with {workflow_info['step_count']} steps")
print(f"Total progress weight: {workflow_info['total_progress_weight']}")
print(f"Steps: {workflow_info['steps']}")

# í–¥ìƒëœ ì˜¤ë¥˜ ì²˜ë¦¬ë¡œ ì‹¤í–‰
try:
    result = action.start()
    if result['success']:
        print("Upload completed successfully!")
        print(f"Files: {result['uploaded_files_count']}")
        print(f"Data units: {result['generated_data_units_count']}")
    else:
        print("Upload failed with errors:")
        for error in result['errors']:
            print(f"  - {error}")
except Exception as e:
    print(f"Upload action failed: {e}")
```

### ì‚¬ìš©ì ì •ì˜ ì „ëµ ì—…ë¡œë“œ

```python
from synapse_sdk.plugins.categories.upload.actions.upload.action import UploadAction
from my_custom_strategies import CustomValidationStrategy

# ì‚¬ìš©ì ì •ì˜ íŒ©í† ë¦¬ë¡œ ì•¡ì…˜ ìƒì„±
class CustomUploadAction(UploadAction):
    def _configure_strategies(self, context=None):
        strategies = super()._configure_strategies(context)

        # ì‚¬ìš©ì ì •ì˜ ê²€ì¦ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë“œ
        if self.params.get('use_strict_validation'):
            strategies['validation'] = CustomValidationStrategy()

        return strategies

# ì‚¬ìš©ì ì •ì˜ ì•¡ì…˜ ì‚¬ìš©
params = {
    "name": "Strict Validation Upload",
    "path": "/data/sensitive_files",
    "storage": 1,
    "data_collection": 5,
    "use_strict_validation": True,
    "max_file_size_mb": 10  # ë” ì—„ê²©í•œ ì œí•œ
}

action = CustomUploadAction(
    params=params,
    plugin_config=plugin_config
)

result = action.start()
```

### ì‚¬ìš©ì ì •ì˜ êµ¬ì„±ì„ í¬í•¨í•œ ë°°ì¹˜ ì²˜ë¦¬

```python
import os

# Excel ì²˜ë¦¬ ì œí•œ êµ¬ì„±
os.environ['EXCEL_MAX_FILE_SIZE_MB'] = '20'
os.environ['EXCEL_MAX_ROWS'] = '20000'

# ì‚¬ìš©ì ì •ì˜ ì„¤ì •ì„ í¬í•¨í•œ ëŒ€ëŸ‰ ë°°ì¹˜ ì—…ë¡œë“œ
params = {
    "name": "Large Batch Upload",
    "path": "/data/large_dataset",
    "storage": 2,
    "data_collection": 10,
    "is_recursive": True,
    "max_file_size_mb": 500,
    "creating_data_unit_batch_size": 200,
    "use_async_upload": True
}

action = UploadAction(
    params=params,
    plugin_config=plugin_config
)

# ì§„í–‰ë¥  ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ì‹¤í–‰
result = action.start()

# ê²°ê³¼ ë¶„ì„
print(f"Batch upload summary:")
print(f"  Success: {result['success']}")
print(f"  Files processed: {result['uploaded_files_count']}")
print(f"  Data units created: {result['generated_data_units_count']}")

# ì¹´í…Œê³ ë¦¬ë³„ ë©”íŠ¸ë¦­ í™•ì¸
metrics = result['metrics']
if 'data_files' in metrics:
    files_metrics = metrics['data_files']
    print(f"  Files - Success: {files_metrics.get('success', 0)}")
    print(f"  Files - Failed: {files_metrics.get('failed', 0)}")

if 'data_units' in metrics:
    units_metrics = metrics['data_units']
    print(f"  Units - Success: {units_metrics.get('success', 0)}")
    print(f"  Units - Failed: {units_metrics.get('failed', 0)}")
```

### ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë¡¤ë°±

```python
# ìë™ ë¡¤ë°±ì„ í¬í•¨í•œ í–¥ìƒëœ ì˜¤ë¥˜ ì²˜ë¦¬ ì‹œì—°
params = {
    "name": "Error Recovery Example",
    "path": "/data/problematic_files",
    "storage": 1,
    "data_collection": 5,
    "is_recursive": True
}

action = UploadAction(
    params=params,
    plugin_config=plugin_config
)

try:
    result = action.start()

    if not result['success']:
        print("Upload failed, but cleanup was automatic:")
        print(f"Errors encountered: {len(result['errors'])}")
        for i, error in enumerate(result['errors'], 1):
            print(f"  {i}. {error}")

        # ë¡¤ë°±ì´ ìˆ˜í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸ (ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° ë‚´ë¶€ë¥¼ í†µí•´)
        workflow_metrics = result['metrics'].get('workflow', {})
        current_step = workflow_metrics.get('current_step', 0)
        total_steps = workflow_metrics.get('total_steps', 0)
        print(f"Workflow stopped at step {current_step} of {total_steps}")

except Exception as e:
    print(f"Critical upload failure: {e}")
    # ì˜ˆì™¸ ì „íŒŒ ì „ì— ë¡¤ë°±ì´ ìë™ìœ¼ë¡œ ìˆ˜í–‰ë¨
```

## ì˜¤ë¥˜ ì²˜ë¦¬

### ì˜ˆì™¸ íƒ€ì…

ì—…ë¡œë“œ ì‹œìŠ¤í…œì€ íŠ¹ì • ì˜ˆì™¸ë¥¼ ì •ì˜í•©ë‹ˆë‹¤:

```python
# ë³´ì•ˆ ìœ„ë°˜
try:
    action.start()
except ExcelSecurityError as e:
    print(f"Excel security violation: {e}")

# íŒŒì‹± ì˜¤ë¥˜
except ExcelParsingError as e:
    print(f"Excel parsing failed: {e}")

# ì¼ë°˜ ì—…ë¡œë“œ ì˜¤ë¥˜
except ActionError as e:
    print(f"Upload action failed: {e}")
```

### ê²€ì¦ ì˜¤ë¥˜

ë§¤ê°œë³€ìˆ˜ ê²€ì¦ì€ ìì„¸í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì œê³µí•©ë‹ˆë‹¤:

```python
from pydantic import ValidationError

try:
    params = UploadParams(**invalid_params)
except ValidationError as e:
    for error in e.errors():
        print(f"Field {error['loc']}: {error['msg']}")
```

## API ë ˆí¼ëŸ°ìŠ¤

### í•µì‹¬ ì»´í¬ë„ŒíŠ¸

#### UploadAction

íŒŒì¼ ì²˜ë¦¬ ì‘ì—…ì„ ìœ„í•œ ì „ëµ ë° íŒŒì‚¬ë“œ íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ë©”ì¸ ì—…ë¡œë“œ ì•¡ì…˜ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**í´ë˜ìŠ¤ ì†ì„±:**

- `name = 'upload'` - ì•¡ì…˜ ì‹ë³„ì
- `category = PluginCategory.UPLOAD` - í”ŒëŸ¬ê·¸ì¸ ì¹´í…Œê³ ë¦¬
- `method = RunMethod.JOB` - ì‹¤í–‰ ë°©ë²•
- `run_class = UploadRun` - ì „ë¬¸ ì‹¤í–‰ ê´€ë¦¬
- `params_model = UploadParams` - ë§¤ê°œë³€ìˆ˜ ê²€ì¦ ëª¨ë¸
- `strategy_factory: StrategyFactory` - ì „ëµ êµ¬í˜„ ìƒì„±
- `step_registry: StepRegistry` - ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ê´€ë¦¬

**ì£¼ìš” ë©”ì„œë“œ:**

- `start() -> Dict[str, Any]` - ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ëœ ì—…ë¡œë“œ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
- `get_workflow_summary() -> Dict[str, Any]` - êµ¬ì„±ëœ ì›Œí¬í”Œë¡œìš° ìš”ì•½ ê°€ì ¸ì˜¤ê¸°
- `_configure_workflow() -> None` - ì‹¤í–‰ ìˆœì„œë¡œ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ë“±ë¡
- `_configure_strategies(context=None) -> Dict[str, Any]` - ì „ëµ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

**ì§„í–‰ë¥  ì¹´í…Œê³ ë¦¬:**

```python
progress_categories = {
    'analyze_collection': {'proportion': 2},
    'upload_data_files': {'proportion': 38},
    'generate_data_units': {'proportion': 60},
}
```

#### UploadOrchestrator

ìë™ ë¡¤ë°±ì„ í¬í•¨í•œ ì™„ì „í•œ ì—…ë¡œë“œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì¡°ì •í•˜ëŠ” íŒŒì‚¬ë“œ ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.

**í´ë˜ìŠ¤ ì†ì„±:**

- `context: UploadContext` - ì›Œí¬í”Œë¡œìš° ì „ë°˜ì˜ ê³µìœ  ìƒíƒœ
- `step_registry: StepRegistry` - ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ë ˆì§€ìŠ¤íŠ¸ë¦¬
- `strategies: Dict[str, Any]` - ì „ëµ êµ¬í˜„
- `executed_steps: List[BaseStep]` - ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ëœ ë‹¨ê³„
- `current_step_index: int` - ì›Œí¬í”Œë¡œìš°ì˜ í˜„ì¬ ìœ„ì¹˜
- `rollback_executed: bool` - ë¡¤ë°±ì´ ìˆ˜í–‰ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€

**ì£¼ìš” ë©”ì„œë“œ:**

- `execute() -> Dict[str, Any]` - ì˜¤ë¥˜ ì²˜ë¦¬ë¥¼ í¬í•¨í•œ ì™„ì „í•œ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
- `get_workflow_summary() -> Dict[str, Any]` - ì‹¤í–‰ ìš”ì•½ ë° ë©”íŠ¸ë¦­ ê°€ì ¸ì˜¤ê¸°
- `get_executed_steps() -> List[BaseStep]` - ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ëœ ë‹¨ê³„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
- `is_rollback_executed() -> bool` - ë¡¤ë°±ì´ ìˆ˜í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸
- `_execute_step(step: BaseStep) -> StepResult` - ê°œë³„ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ì‹¤í–‰
- `_handle_step_failure(step: BaseStep, error: Exception) -> None` - ë‹¨ê³„ ì‹¤íŒ¨ ì²˜ë¦¬
- `_rollback_executed_steps() -> None` - ì‹¤í–‰ëœ ë‹¨ê³„ë¥¼ ì—­ìˆœìœ¼ë¡œ ë¡¤ë°±

#### UploadContext

ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ê°„ì˜ ê³µìœ  ìƒíƒœ ë° í†µì‹ ì„ ìœ ì§€í•˜ëŠ” ì»¨í…ìŠ¤íŠ¸ ê°ì²´ì…ë‹ˆë‹¤.

**ìƒíƒœ ì†ì„±:**

- `params: Dict` - ì—…ë¡œë“œ ë§¤ê°œë³€ìˆ˜
- `run: UploadRun` - ì‹¤í–‰ ê´€ë¦¬ ì¸ìŠ¤í„´ìŠ¤
- `client: Any` - ì™¸ë¶€ ì‘ì—…ì„ ìœ„í•œ API í´ë¼ì´ì–¸íŠ¸
- `storage: Any` - ìŠ¤í† ë¦¬ì§€ êµ¬ì„± ê°ì²´
- `pathlib_cwd: Path` - í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬ ê²½ë¡œ
- `metadata: Dict[str, Dict[str, Any]]` - íŒŒì¼ ë©”íƒ€ë°ì´í„° ë§¤í•‘
- `file_specifications: Dict[str, Any]` - ë°ì´í„° ì»¬ë ‰ì…˜ íŒŒì¼ ì‚¬ì–‘
- `organized_files: List[Dict[str, Any]]` - êµ¬ì„±ëœ íŒŒì¼ ì •ë³´
- `uploaded_files: List[Dict[str, Any]]` - ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œëœ íŒŒì¼
- `data_units: List[Dict[str, Any]]` - ìƒì„±ëœ ë°ì´í„° ë‹¨ìœ„

**ì§„í–‰ë¥  ë° ë©”íŠ¸ë¦­:**

- `metrics: Dict[str, Any]` - ì›Œí¬í”Œë¡œìš° ë©”íŠ¸ë¦­ ë° í†µê³„
- `errors: List[str]` - ì¶•ì ëœ ì˜¤ë¥˜ ë©”ì‹œì§€
- `step_results: List[StepResult]` - ì‹¤í–‰ëœ ë‹¨ê³„ì˜ ê²°ê³¼

**ì „ëµ ë° ë¡¤ë°±:**

- `strategies: Dict[str, Any]` - ì£¼ì…ëœ ì „ëµ êµ¬í˜„
- `rollback_data: Dict[str, Any]` - ë¡¤ë°± ì‘ì—…ì„ ìœ„í•œ ë°ì´í„°

**ì£¼ìš” ë©”ì„œë“œ:**

- `update(result: StepResult) -> None` - ë‹¨ê³„ ê²°ê³¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
- `get_result() -> Dict[str, Any]` - ìµœì¢… ê²°ê³¼ ë”•ì…”ë„ˆë¦¬ ìƒì„±
- `has_errors() -> bool` - ì¶•ì ëœ ì˜¤ë¥˜ í™•ì¸
- `get_last_step_result() -> Optional[StepResult]` - ê°€ì¥ ìµœê·¼ ë‹¨ê³„ ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
- `update_metrics(category: str, metrics: Dict[str, Any]) -> None` - ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸
- `add_error(error: str) -> None` - ì»¨í…ìŠ¤íŠ¸ì— ì˜¤ë¥˜ ì¶”ê°€
- `get_param(key: str, default: Any = None) -> Any` - ê¸°ë³¸ê°’ì´ ìˆëŠ” ë§¤ê°œë³€ìˆ˜ ê°€ì ¸ì˜¤ê¸°

#### StepRegistry

ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ì˜ ì»¬ë ‰ì…˜ ë° ì‹¤í–‰ ìˆœì„œë¥¼ ê´€ë¦¬í•˜ëŠ” ë ˆì§€ìŠ¤íŠ¸ë¦¬ì…ë‹ˆë‹¤.

**ì†ì„±:**

- `_steps: List[BaseStep]` - ì‹¤í–‰ ìˆœì„œë¡œ ë“±ë¡ëœ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„

**ì£¼ìš” ë©”ì„œë“œ:**

- `register(step: BaseStep) -> None` - ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ë“±ë¡
- `get_steps() -> List[BaseStep]` - ìˆœì„œëŒ€ë¡œ ëª¨ë“  ë“±ë¡ëœ ë‹¨ê³„ ê°€ì ¸ì˜¤ê¸°
- `get_total_progress_weight() -> float` - ì´ ì§„í–‰ë¥  ê°€ì¤‘ì¹˜ ê³„ì‚°
- `clear() -> None` - ëª¨ë“  ë“±ë¡ëœ ë‹¨ê³„ ì§€ìš°ê¸°
- `__len__() -> int` - ë“±ë¡ëœ ë‹¨ê³„ ìˆ˜ ê°€ì ¸ì˜¤ê¸°

#### StrategyFactory

ë§¤ê°œë³€ìˆ˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì ì ˆí•œ ì „ëµ êµ¬í˜„ì„ ìƒì„±í•˜ëŠ” íŒ©í† ë¦¬ ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.

**ì£¼ìš” ë©”ì„œë“œ:**

- `create_validation_strategy(params: Dict, context=None) -> BaseValidationStrategy` - ê²€ì¦ ì „ëµ ìƒì„±
- `create_file_discovery_strategy(params: Dict, context=None) -> BaseFileDiscoveryStrategy` - íŒŒì¼ ë°œê²¬ ì „ëµ ìƒì„±
- `create_metadata_strategy(params: Dict, context=None) -> BaseMetadataStrategy` - ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ ì „ëµ ìƒì„±
- `create_upload_strategy(params: Dict, context: UploadContext) -> BaseUploadStrategy` - ì—…ë¡œë“œ ì „ëµ ìƒì„± (ì»¨í…ìŠ¤íŠ¸ í•„ìš”)
- `create_data_unit_strategy(params: Dict, context: UploadContext) -> BaseDataUnitStrategy` - ë°ì´í„° ë‹¨ìœ„ ì „ëµ ìƒì„± (ì»¨í…ìŠ¤íŠ¸ í•„ìš”)
- `get_available_strategies() -> Dict[str, List[str]]` - ì‚¬ìš© ê°€ëŠ¥í•œ ì „ëµ íƒ€ì… ë° êµ¬í˜„ ê°€ì ¸ì˜¤ê¸°

### ì›Œí¬í”Œë¡œìš° ë‹¨ê³„

#### BaseStep (ì¶”ìƒ)

ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ë° ìœ í‹¸ë¦¬í‹°ë¥¼ ì œê³µí•˜ëŠ” ëª¨ë“  ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ì˜ ê¸°ë³¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**ì¶”ìƒ ì†ì„±:**

- `name: str` - ê³ ìœ í•œ ë‹¨ê³„ ì‹ë³„ì
- `progress_weight: float` - ì§„í–‰ë¥  ê³„ì‚°ì„ ìœ„í•œ ê°€ì¤‘ì¹˜ (í•©ì€ 1.0ì´ì–´ì•¼ í•¨)

**ì¶”ìƒ ë©”ì„œë“œ:**

- `execute(context: UploadContext) -> StepResult` - ë‹¨ê³„ ë¡œì§ ì‹¤í–‰
- `can_skip(context: UploadContext) -> bool` - ë‹¨ê³„ë¥¼ ê±´ë„ˆë›¸ ìˆ˜ ìˆëŠ”ì§€ ê²°ì •
- `rollback(context: UploadContext) -> None` - ë‹¨ê³„ ì‘ì—… ë¡¤ë°±

**ìœ í‹¸ë¦¬í‹° ë©”ì„œë“œ:**

- `create_success_result(data: Dict = None) -> StepResult` - ì„±ê³µ ê²°ê³¼ ìƒì„±
- `create_error_result(error: str, original_exception: Exception = None) -> StepResult` - ì˜¤ë¥˜ ê²°ê³¼ ìƒì„±
- `create_skip_result() -> StepResult` - ê±´ë„ˆë›°ê¸° ê²°ê³¼ ìƒì„±

#### StepResult

ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ ì‹¤í–‰ì—ì„œ ë°˜í™˜ë˜ëŠ” ê²°ê³¼ ê°ì²´ì…ë‹ˆë‹¤.

**ì†ì„±:**

- `success: bool` - ë‹¨ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€
- `data: Dict[str, Any]` - ë‹¨ê³„ ê²°ê³¼ ë°ì´í„°
- `error: str` - ë‹¨ê³„ê°€ ì‹¤íŒ¨í•œ ê²½ìš° ì˜¤ë¥˜ ë©”ì‹œì§€
- `rollback_data: Dict[str, Any]` - ë¡¤ë°±ì— í•„ìš”í•œ ë°ì´í„°
- `skipped: bool` - ë‹¨ê³„ê°€ ê±´ë„ˆë›°ì–´ì¡ŒëŠ”ì§€ ì—¬ë¶€
- `original_exception: Optional[Exception]` - ë””ë²„ê¹…ì„ ìœ„í•œ ì›ë³¸ ì˜ˆì™¸
- `timestamp: datetime` - ì‹¤í–‰ íƒ€ì„ìŠ¤íƒ¬í”„

**ì‚¬ìš©ë²•:**

```python
# ë¶ˆë¦° í‰ê°€
if step_result:
    # ë‹¨ê³„ê°€ ì„±ê³µí•¨
    process_success(step_result.data)
```

#### êµ¬ì²´ì ì¸ ë‹¨ê³„

**InitializeStep** (`name: "initialize"`, `weight: 0.05`)

- ìŠ¤í† ë¦¬ì§€ ì—°ê²° ë° pathlib ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
- ê¸°ë³¸ ì—…ë¡œë“œ ì „ì œì¡°ê±´ ê²€ì¦

**ProcessMetadataStep** (`name: "process_metadata"`, `weight: 0.05`)

- ì œê³µëœ Excel ë©”íƒ€ë°ì´í„° ì²˜ë¦¬
- ë©”íƒ€ë°ì´í„° ë³´ì•ˆ ë° í˜•ì‹ ê²€ì¦

**AnalyzeCollectionStep** (`name: "analyze_collection"`, `weight: 0.05`)

- ë°ì´í„° ì»¬ë ‰ì…˜ íŒŒì¼ ì‚¬ì–‘ ê²€ìƒ‰ ë° ê²€ì¦
- íŒŒì¼ êµ¬ì„± ê·œì¹™ ì„¤ì •

**OrganizeFilesStep** (`name: "organize_files"`, `weight: 0.10`)

- íŒŒì¼ ë°œê²¬ ì „ëµì„ ì‚¬ìš©í•œ íŒŒì¼ ë°œê²¬
- íƒ€ì… ë° ì‚¬ì–‘ë³„ íŒŒì¼ êµ¬ì„±

**ValidateFilesStep** (`name: "validate_files"`, `weight: 0.05`)

- ê²€ì¦ ì „ëµì„ ì‚¬ìš©í•œ íŒŒì¼ ê²€ì¦
- ë³´ì•ˆ ë° ë‚´ìš© ê²€ì‚¬ ìˆ˜í–‰

**UploadFilesStep** (`name: "upload_files"`, `weight: 0.30`)

- ì—…ë¡œë“œ ì „ëµì„ ì‚¬ìš©í•œ íŒŒì¼ ì—…ë¡œë“œ
- ë°°ì¹˜ ë° ì§„í–‰ë¥  ì¶”ì  ì²˜ë¦¬

**GenerateDataUnitsStep** (`name: "generate_data_units"`, `weight: 0.35`)

- ë°ì´í„° ë‹¨ìœ„ ì „ëµì„ ì‚¬ìš©í•œ ë°ì´í„° ë‹¨ìœ„ ìƒì„±
- ì—…ë¡œë“œëœ íŒŒì¼ì„ ë°ì´í„° ë‹¨ìœ„ì— ì—°ê²°

**CleanupStep** (`name: "cleanup"`, `weight: 0.05`)

- ì„ì‹œ ë¦¬ì†ŒìŠ¤ ë° íŒŒì¼ ì •ë¦¬
- ìµœì¢… ê²€ì¦ ìˆ˜í–‰

### ì „ëµ ê¸°ë³¸ í´ë˜ìŠ¤

#### BaseValidationStrategy (ì¶”ìƒ)

íŒŒì¼ ê²€ì¦ ì „ëµì˜ ê¸°ë³¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**ì¶”ìƒ ë©”ì„œë“œ:**

- `validate_files(files: List[Path], context: UploadContext) -> bool` - íŒŒì¼ ì»¬ë ‰ì…˜ ê²€ì¦
- `validate_security(file_path: Path) -> bool` - ê°œë³„ íŒŒì¼ ë³´ì•ˆ ê²€ì¦

#### BaseFileDiscoveryStrategy (ì¶”ìƒ)

íŒŒì¼ ë°œê²¬ ë° êµ¬ì„± ì „ëµì˜ ê¸°ë³¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**ì¶”ìƒ ë©”ì„œë“œ:**

- `discover_files(path: Path, context: UploadContext) -> List[Path]` - ê²½ë¡œì—ì„œ íŒŒì¼ ë°œê²¬
- `organize_files(files: List[Path], specs: Dict[str, Any], context: UploadContext) -> List[Dict[str, Any]]` - ë°œê²¬ëœ íŒŒì¼ êµ¬ì„±

#### BaseMetadataStrategy (ì¶”ìƒ)

ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ ì „ëµì˜ ê¸°ë³¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**ì¶”ìƒ ë©”ì„œë“œ:**

- `process_metadata(context: UploadContext) -> Dict[str, Any]` - ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë©”íƒ€ë°ì´í„° ì²˜ë¦¬
- `extract_metadata(file_path: Path) -> Dict[str, Any]` - íŒŒì¼ì—ì„œ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ

#### BaseUploadStrategy (ì¶”ìƒ)

íŒŒì¼ ì—…ë¡œë“œ ì „ëµì˜ ê¸°ë³¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**ì¶”ìƒ ë©”ì„œë“œ:**

- `upload_files(files: List[Dict[str, Any]], context: UploadContext) -> List[Dict[str, Any]]` - íŒŒì¼ ì»¬ë ‰ì…˜ ì—…ë¡œë“œ
- `upload_batch(batch: List[Dict[str, Any]], context: UploadContext) -> List[Dict[str, Any]]` - íŒŒì¼ ë°°ì¹˜ ì—…ë¡œë“œ

#### BaseDataUnitStrategy (ì¶”ìƒ)

ë°ì´í„° ë‹¨ìœ„ ìƒì„± ì „ëµì˜ ê¸°ë³¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

**ì¶”ìƒ ë©”ì„œë“œ:**

- `generate_data_units(files: List[Dict[str, Any]], context: UploadContext) -> List[Dict[str, Any]]` - ë°ì´í„° ë‹¨ìœ„ ìƒì„±
- `create_data_unit_batch(batch: List[Dict[str, Any]], context: UploadContext) -> List[Dict[str, Any]]` - ë°ì´í„° ë‹¨ìœ„ ë°°ì¹˜ ìƒì„±

### ë ˆê±°ì‹œ ì»´í¬ë„ŒíŠ¸

#### UploadRun

ì—…ë¡œë“œ ì‘ì—…ì„ ìœ„í•œ ì „ë¬¸ ì‹¤í–‰ ê´€ë¦¬ (ë ˆê±°ì‹œì—ì„œ ë³€ê²½ ì—†ìŒ).

**ë¡œê¹… ë©”ì„œë“œ:**

- `log_message_with_code(code, *args, level=None)` - íƒ€ì… ì•ˆì „ ë¡œê¹…
- `log_upload_event(code, *args, level=None)` - ì—…ë¡œë“œ íŠ¹ì • ì´ë²¤íŠ¸

**ì¤‘ì²© ëª¨ë¸:**

- `UploadEventLog` - ì—…ë¡œë“œ ì´ë²¤íŠ¸ ë¡œê¹…
- `DataFileLog` - ë°ì´í„° íŒŒì¼ ì²˜ë¦¬ ë¡œê·¸
- `DataUnitLog` - ë°ì´í„° ë‹¨ìœ„ ìƒì„± ë¡œê·¸
- `TaskLog` - ì‘ì—… ì‹¤í–‰ ë¡œê·¸
- `MetricsRecord` - ë©”íŠ¸ë¦­ ì¶”ì 

#### UploadParams

Pydantic í†µí•©ì„ í¬í•¨í•œ ë§¤ê°œë³€ìˆ˜ ê²€ì¦ ëª¨ë¸ (ë ˆê±°ì‹œì—ì„œ ë³€ê²½ ì—†ìŒ).

**í•„ìˆ˜ ë§¤ê°œë³€ìˆ˜:**

- `name: str` - ì—…ë¡œë“œ ì´ë¦„
- `path: str` - ì†ŒìŠ¤ ê²½ë¡œ
- `storage: int` - ìŠ¤í† ë¦¬ì§€ ID
- `data_collection: int` - ë°ì´í„° ì»¬ë ‰ì…˜ ID

**ì„ íƒì  ë§¤ê°œë³€ìˆ˜:**

- `description: str | None = None` - ì—…ë¡œë“œ ì„¤ëª…
- `project: int | None = None` - í”„ë¡œì íŠ¸ ID
- `excel_metadata_path: str | None = None` - Excel ë©”íƒ€ë°ì´í„° íŒŒì¼ ê²½ë¡œ
- `is_recursive: bool = False` - ì¬ê·€ì  íŒŒì¼ ë°œê²¬
- `max_file_size_mb: int = 50` - ìµœëŒ€ íŒŒì¼ í¬ê¸°
- `creating_data_unit_batch_size: int = 100` - ë°ì´í„° ë‹¨ìœ„ ë°°ì¹˜ í¬ê¸°
- `use_async_upload: bool = True` - ë¹„ë™ê¸° ì—…ë¡œë“œ ì²˜ë¦¬

**ê²€ì¦ ê¸°ëŠ¥:**

- storage/data_collection/projectì— ëŒ€í•œ ì‹¤ì‹œê°„ API ê²€ì¦
- ë¬¸ìì—´ ì •í™” ë° ê¸¸ì´ ê²€ì¦
- íƒ€ì… ê²€ì‚¬ ë° ë³€í™˜
- ì‚¬ìš©ì ì •ì˜ ê²€ì¦ì ë©”ì„œë“œ

### ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤

#### ExcelSecurityConfig

Excel íŒŒì¼ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë³´ì•ˆ êµ¬ì„±ì…ë‹ˆë‹¤.

**êµ¬ì„± ì†ì„±:**

- íŒŒì¼ í¬ê¸° ë° ë©”ëª¨ë¦¬ ì œí•œ
- í–‰ ë° ì—´ ê°œìˆ˜ ì œí•œ
- ë¬¸ìì—´ ê¸¸ì´ ì œí•œ
- í™˜ê²½ ë³€ìˆ˜ ì˜¤ë²„ë¼ì´ë“œ

#### ExcelMetadataUtils

Excel ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ìœ í‹¸ë¦¬í‹° ë©”ì„œë“œì…ë‹ˆë‹¤.

**ì£¼ìš” ë©”ì„œë“œ:**

- `validate_and_truncate_string()` - ë¬¸ìì—´ ì •í™”
- `is_valid_filename_length()` - íŒŒì¼ëª… ê²€ì¦

#### PathAwareJSONEncoder

Path ë° datetime ê°ì²´ë¥¼ ìœ„í•œ ì‚¬ìš©ì ì •ì˜ JSON ì¸ì½”ë”ì…ë‹ˆë‹¤.

**ì§€ì›ë˜ëŠ” íƒ€ì…:**

- Path ê°ì²´ (ë¬¸ìì—´ë¡œ ë³€í™˜)
- Datetime ê°ì²´ (ISO í˜•ì‹)
- í‘œì¤€ JSON ì§ë ¬í™” ê°€ëŠ¥í•œ íƒ€ì…

### ì—´ê±°í˜•

#### LogCode

ì—…ë¡œë“œ ì‘ì—…ì„ ìœ„í•œ íƒ€ì… ì•ˆì „ ë¡œê¹… ì½”ë“œì…ë‹ˆë‹¤.

**ì¹´í…Œê³ ë¦¬:**

- ê²€ì¦ ì½”ë“œ (VALIDATION_FAILED, STORAGE_VALIDATION_FAILED)
- íŒŒì¼ ì²˜ë¦¬ ì½”ë“œ (NO_FILES_FOUND, FILES_DISCOVERED)
- Excel ì²˜ë¦¬ ì½”ë“œ (EXCEL_SECURITY_VIOLATION, EXCEL_PARSING_ERROR)
- ì§„í–‰ë¥  ì½”ë“œ (UPLOADING_DATA_FILES, GENERATING_DATA_UNITS)

#### UploadStatus

ì—…ë¡œë“œ ì²˜ë¦¬ ìƒíƒœ ì—´ê±°í˜•ì…ë‹ˆë‹¤.

**ê°’:**

- `SUCCESS = 'success'` - ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë¨
- `FAILED = 'failed'` - ì‘ì—…ì´ ì˜¤ë¥˜ë¡œ ì‹¤íŒ¨í•¨

### ì˜ˆì™¸

#### ExcelSecurityError

Excel íŒŒì¼ì´ ë³´ì•ˆ ì œì•½ì„ ìœ„ë°˜í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

**ì¼ë°˜ì ì¸ ì›ì¸:**

- íŒŒì¼ í¬ê¸°ê°€ ì œí•œì„ ì´ˆê³¼í•¨
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¶”ì •ì´ ë„ˆë¬´ ë†’ìŒ
- ë‚´ìš© ë³´ì•ˆ ìœ„ë°˜

#### ExcelParsingError

Excel íŒŒì¼ì„ íŒŒì‹±í•  ìˆ˜ ì—†ì„ ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

**ì¼ë°˜ì ì¸ ì›ì¸:**

- íŒŒì¼ í˜•ì‹ ì†ìƒ
- ìœ íš¨í•˜ì§€ ì•Šì€ Excel êµ¬ì¡°
- í•„ìš”í•œ ì—´ ëˆ„ë½
- ë‚´ìš© íŒŒì‹± ì‹¤íŒ¨

## ëª¨ë²” ì‚¬ë¡€

### ì•„í‚¤í…ì²˜ íŒ¨í„´

1. **ì „ëµ ì„ íƒ**: ì‚¬ìš© ì‚¬ë¡€ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ì ì ˆí•œ ì „ëµì„ ì„ íƒí•˜ì„¸ìš”

   - ê¹Šì€ ë””ë ‰í† ë¦¬ êµ¬ì¡°ì—ëŠ” `RecursiveFileDiscoveryStrategy` ì‚¬ìš©
   - í‘œì¤€ íŒŒì¼ ê²€ì¦ì—ëŠ” `BasicValidationStrategy` ì‚¬ìš©
   - í° íŒŒì¼ ì„¸íŠ¸ì—ëŠ” `AsyncUploadStrategy` ì‚¬ìš©

2. **ë‹¨ê³„ ìˆœì„œ**: ë…¼ë¦¬ì  ë‹¨ê³„ ì¢…ì†ì„±ì„ ìœ ì§€í•˜ì„¸ìš”

   - Initialize â†’ Process Metadata â†’ Analyze Collection â†’ Organize Files â†’ Validate â†’ Upload â†’ Generate Data Units â†’ Cleanup
   - ì‚¬ìš©ì ì •ì˜ ë‹¨ê³„ëŠ” ì›Œí¬í”Œë¡œìš°ì˜ ì ì ˆí•œ ì§€ì ì— ì‚½ì…í•´ì•¼ í•¨

3. **ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬**: ìƒíƒœ ê³µìœ ë¥¼ ìœ„í•´ UploadContextë¥¼ í™œìš©í•˜ì„¸ìš”
   - ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ ë‹¨ê³„ë¥¼ ìœ„í•´ ì»¨í…ìŠ¤íŠ¸ì— ì¤‘ê°„ ê²°ê³¼ ì €ì¥
   - ë‹¨ê³„ ê°„ í†µì‹ ì— ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©
   - ì •ë¦¬ ì‘ì—…ì„ ìœ„í•´ ë¡¤ë°± ë°ì´í„° ë³´ì¡´

### ì„±ëŠ¥ ìµœì í™”

1. **ë°°ì¹˜ ì²˜ë¦¬**: ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìµœì ì˜ ë°°ì¹˜ í¬ê¸°ë¥¼ êµ¬ì„±í•˜ì„¸ìš”

   ```python
   params = {
       "creating_data_unit_batch_size": 200,  # ë©”ëª¨ë¦¬ì— ë”°ë¼ ì¡°ì •
       "upload_batch_size": 10,               # ì—…ë¡œë“œ ì „ëµì„ ìœ„í•œ ì‚¬ìš©ì ì •ì˜ ë§¤ê°œë³€ìˆ˜
   }
   ```

2. **ë¹„ë™ê¸° ì‘ì—…**: I/O ë°”ì¸ë”© ì‘ì—…ì— ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í™œì„±í™”í•˜ì„¸ìš”

   ```python
   params = {
       "use_async_upload": True,  # ë„¤íŠ¸ì›Œí¬ ì‘ì—…ì˜ ë” ë‚˜ì€ ì²˜ë¦¬ëŸ‰
   }
   ```

3. **ë©”ëª¨ë¦¬ ê´€ë¦¬**: ì‚¬ìš©ì ì •ì˜ ì „ëµì—ì„œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ëª¨ë‹ˆí„°ë§í•˜ì„¸ìš”

   - ëª¨ë“  íŒŒì¼ì„ ë©”ëª¨ë¦¬ì— ë¡œë“œí•˜ì§€ ë§ê³  ì²­í¬ ë‹¨ìœ„ë¡œ ì²˜ë¦¬
   - í° íŒŒì¼ ì»¬ë ‰ì…˜ì— ì œë„ˆë ˆì´í„° ì‚¬ìš©
   - Excel ë³´ì•ˆ ì œí•œì„ ì ì ˆíˆ êµ¬ì„±

4. **ì§„í–‰ë¥  ëª¨ë‹ˆí„°ë§**: ìì„¸í•œ ì§„í–‰ë¥  ì¶”ì ì„ êµ¬í˜„í•˜ì„¸ìš”
   ```python
   # ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ê°€ í¬í•¨ëœ ì‚¬ìš©ì ì •ì˜ ë‹¨ê³„
   def execute(self, context):
       total_files = len(context.organized_files)
       for i, file_info in enumerate(context.organized_files):
           # íŒŒì¼ ì²˜ë¦¬
           progress = (i + 1) / total_files * 100
           context.update_metrics('custom_step', {'progress': progress})
   ```

### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **ì…ë ¥ ê²€ì¦**: ëª¨ë“  ì…ë ¥ ë§¤ê°œë³€ìˆ˜ ë° íŒŒì¼ ê²½ë¡œë¥¼ ê²€ì¦í•˜ì„¸ìš”

   ```python
   # ì „ëµì—ì„œ ì‚¬ìš©ì ì •ì˜ ê²€ì¦
   def validate_files(self, files, context):
       for file_path in files:
           if not self._is_safe_path(file_path):
               return False
       return True
   ```

2. **íŒŒì¼ ë‚´ìš© ë³´ì•ˆ**: ë‚´ìš© ê¸°ë°˜ ë³´ì•ˆ ê²€ì‚¬ë¥¼ êµ¬í˜„í•˜ì„¸ìš”

   - ì•…ì„± íŒŒì¼ ì„œëª… ìŠ¤ìº”
   - íŒŒì¼ í—¤ë”ê°€ í™•ì¥ìì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦
   - ì„ë² ë””ë“œ ì‹¤í–‰ íŒŒì¼ ê²€ì‚¬

3. **Excel ë³´ì•ˆ**: ì ì ˆí•œ ë³´ì•ˆ ì œí•œì„ êµ¬ì„±í•˜ì„¸ìš”

   ```python
   import os
   os.environ['EXCEL_MAX_FILE_SIZE_MB'] = '10'
   os.environ['EXCEL_MAX_MEMORY_MB'] = '30'
   ```

4. **ê²½ë¡œ ì •í™”**: ëª¨ë“  íŒŒì¼ ê²½ë¡œë¥¼ ê²€ì¦í•˜ê³  ì •í™”í•˜ì„¸ìš”
   - ê²½ë¡œ ìˆœíšŒ ê³µê²© ë°©ì§€
   - íŒŒì¼ í™•ì¥ì ê²€ì¦
   - íŒŒì¼ ê¶Œí•œ í™•ì¸

### ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë³µêµ¬

1. **ìš°ì•„í•œ ì €í•˜**: ë¶€ë¶„ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ìœ„í•´ ì„¤ê³„í•˜ì„¸ìš”

   ```python
   class RobustUploadStrategy(BaseUploadStrategy):
       def upload_files(self, files, context):
           successful_uploads = []
           failed_uploads = []

           for file_info in files:
               try:
                   result = self._upload_file(file_info)
                   successful_uploads.append(result)
               except Exception as e:
                   failed_uploads.append({'file': file_info, 'error': str(e)})
                   # ì™„ì „íˆ ì‹¤íŒ¨í•˜ì§€ ë§ê³  ë‹¤ë¥¸ íŒŒì¼ë¡œ ê³„ì† ì§„í–‰

           # ë¶€ë¶„ ê²°ê³¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
           context.add_uploaded_files(successful_uploads)
           if failed_uploads:
               context.add_error(f"Failed to upload {len(failed_uploads)} files")

           return successful_uploads
   ```

2. **ë¡¤ë°± ì„¤ê³„**: í¬ê´„ì ì¸ ë¡¤ë°± ì „ëµì„ êµ¬í˜„í•˜ì„¸ìš”

   ```python
   def rollback(self, context):
       # ì‘ì—…ì˜ ì—­ìˆœìœ¼ë¡œ ì •ë¦¬
       if hasattr(self, '_created_temp_files'):
           for temp_file in self._created_temp_files:
               try:
                   temp_file.unlink()
               except Exception:
                   pass  # ì •ë¦¬ ë¬¸ì œë¡œ ì¸í•œ ë¡¤ë°± ì‹¤íŒ¨ ë°©ì§€
   ```

3. **ìì„¸í•œ ë¡œê¹…**: ë””ë²„ê¹…ì„ ìœ„í•œ êµ¬ì¡°í™”ëœ ë¡œê¹…ì„ ì‚¬ìš©í•˜ì„¸ìš”

   ```python
   def execute(self, context):
       try:
           context.run.log_message_with_code(
               'CUSTOM_STEP_STARTED',
               {'step': self.name, 'file_count': len(context.organized_files)}
           )
           # ì—¬ê¸°ì— ë‹¨ê³„ ë¡œì§
       except Exception as e:
           context.run.log_message_with_code(
               'CUSTOM_STEP_FAILED',
               {'step': self.name, 'error': str(e)},
               level=Context.DANGER
           )
           raise
   ```

### ê°œë°œ ê°€ì´ë“œë¼ì¸

1. **ì‚¬ìš©ì ì •ì˜ ì „ëµ ê°œë°œ**: í™•ë¦½ëœ íŒ¨í„´ì„ ë”°ë¥´ì„¸ìš”

   ```python
   # í•­ìƒ ì ì ˆí•œ ê¸°ë³¸ í´ë˜ìŠ¤ë¥¼ í™•ì¥
   class MyCustomStrategy(BaseValidationStrategy):
       def __init__(self, config=None):
           self.config = config or {}

       def validate_files(self, files, context):
           # ê²€ì¦ ë¡œì§ êµ¬í˜„
           return True

       def validate_security(self, file_path):
           # ë³´ì•ˆ ê²€ì¦ êµ¬í˜„
           return True
   ```

2. **í…ŒìŠ¤íŠ¸ ì „ëµ**: í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€

   ```python
   # ì„±ê³µ ë° ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ ëª¨ë‘ í…ŒìŠ¤íŠ¸
   class TestCustomStrategy:
       def test_success_case(self):
           strategy = MyCustomStrategy()
           result = strategy.validate_files([Path('valid_file.txt')], mock_context)
           assert result is True

       def test_security_failure(self):
           strategy = MyCustomStrategy()
           result = strategy.validate_security(Path('malware.exe'))
           assert result is False

       def test_rollback_cleanup(self):
           step = MyCustomStep()
           step.rollback(mock_context)
           # ì •ë¦¬ê°€ ìˆ˜í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸
   ```

3. **í™•ì¥ ì§€ì **: í™•ì¥ì„±ì„ ìœ„í•´ íŒ©í† ë¦¬ íŒ¨í„´ ì‚¬ìš©

   ```python
   class CustomStrategyFactory(StrategyFactory):
       def create_validation_strategy(self, params, context=None):
           validation_type = params.get('validation_type', 'basic')

           strategy_map = {
               'basic': BasicValidationStrategy,
               'strict': StrictValidationStrategy,
               'custom': MyCustomValidationStrategy,
           }

           strategy_class = strategy_map.get(validation_type, BasicValidationStrategy)
           return strategy_class(params)
   ```

4. **êµ¬ì„± ê´€ë¦¬**: í™˜ê²½ ë³€ìˆ˜ ë° ë§¤ê°œë³€ìˆ˜ ì‚¬ìš©

   ```python
   class ConfigurableStep(BaseStep):
       def __init__(self):
           # ëŸ°íƒ€ì„ êµ¬ì„± í—ˆìš©
           self.batch_size = int(os.getenv('STEP_BATCH_SIZE', '50'))
           self.timeout = int(os.getenv('STEP_TIMEOUT_SECONDS', '300'))

       def execute(self, context):
           # êµ¬ì„±ëœ ê°’ ì‚¬ìš©
           batch_size = context.get_param('step_batch_size', self.batch_size)
           timeout = context.get_param('step_timeout', self.timeout)
   ```

### í”¼í•´ì•¼ í•  ì•ˆí‹°íŒ¨í„´

1. **ê°•í•œ ê²°í•©**: ì „ëµì„ íŠ¹ì • êµ¬í˜„ì— ê²°í•©í•˜ì§€ ë§ˆì„¸ìš”
2. **ìƒíƒœ ë³€í˜•**: update() ë©”ì„œë“œ ì™¸ë¶€ì—ì„œ ì»¨í…ìŠ¤íŠ¸ ìƒíƒœë¥¼ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ë§ˆì„¸ìš”
3. **ì˜ˆì™¸ ì‚¼í‚´**: ì ì ˆí•œ ì²˜ë¦¬ ì—†ì´ ì˜ˆì™¸ë¥¼ ì¡ì•„ì„œ ë¬´ì‹œí•˜ì§€ ë§ˆì„¸ìš”
4. **ë¸”ë¡œí‚¹ ì‘ì—…**: ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ì—†ì´ ì¥ì‹œê°„ ì‹¤í–‰ë˜ëŠ” ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ì§€ ë§ˆì„¸ìš”
5. **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜**: ë‹¨ê³„ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ í° ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ë³´ìœ í•˜ì§€ ë§ˆì„¸ìš”

### ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

1. **ë‹¨ê³„ ì‹¤íŒ¨**: ë‹¨ê³„ ì‹¤í–‰ ìˆœì„œ ë° ì¢…ì†ì„± í™•ì¸
2. **ì „ëµ ë¬¸ì œ**: ì „ëµ íŒ©í† ë¦¬ êµ¬ì„± ë° ë§¤ê°œë³€ìˆ˜ ì „ë‹¬ í™•ì¸
3. **ì»¨í…ìŠ¤íŠ¸ ë¬¸ì œ**: ì ì ˆí•œ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ë° ìƒíƒœ ê´€ë¦¬ í™•ì¸
4. **ë¡¤ë°± ì‹¤íŒ¨**: ë©±ë“±ì  ë¡¤ë°± ì‘ì—… ì„¤ê³„
5. **ì„±ëŠ¥ ë¬¸ì œ**: ë°°ì¹˜ í¬ê¸° ë° ë¹„ë™ê¸° ì‘ì—… ì‚¬ìš©ëŸ‰ í”„ë¡œíŒŒì¼ë§

### ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

ë ˆê±°ì‹œ êµ¬í˜„ì—ì„œ ì—…ê·¸ë ˆì´ë“œí•  ë•Œ:

- [ ] ë§¤ê°œë³€ìˆ˜ ì´ë¦„ì„ `collection`ì—ì„œ `data_collection`ìœ¼ë¡œ ì—…ë°ì´íŠ¸
- [ ] í˜¸í™˜ì„±ì„ ìœ„í•œ ê¸°ì¡´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸
- [ ] ìƒˆ ì•„í‚¤í…ì²˜ ê¸°íšŒì— ëŒ€í•œ ì‚¬ìš©ì ì •ì˜ í™•ì¥ ê²€í† 
- [ ] ìƒˆ ë¡¤ë°± ê¸°ëŠ¥ì„ í™œìš©í•˜ë„ë¡ ì˜¤ë¥˜ ì²˜ë¦¬ ì—…ë°ì´íŠ¸
- [ ] íŠ¹ìˆ˜ ìš”êµ¬ì‚¬í•­ì— ëŒ€í•œ ì‚¬ìš©ì ì •ì˜ ì „ëµ êµ¬í˜„ ê³ ë ¤
- [ ] ìƒˆ ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ë¥¼ ê²€ì¦í•˜ë„ë¡ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì—…ë°ì´íŠ¸
- [ ] í–¥ìƒëœ ì •ë³´ì— ëŒ€í•œ ë¡œê¹… ë° ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ê²€í† 

BaseUploader í…œí”Œë¦¿ì„ ì‚¬ìš©í•œ ì»¤ìŠ¤í…€ ì—…ë¡œë“œ í”ŒëŸ¬ê·¸ì¸ ê°œë°œì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” [ì—…ë¡œë“œ í…œí”Œë¦¿ ê°œë°œí•˜ê¸°](./developing-upload-template.md) ê°€ì´ë“œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
