; a generative tox configuration, see: https://testrun.org/tox/latest/config.html#generative-envlist

[tox]
envlist =
    clean,
    check,
    {py310,py311,py312},
    {py310,py311,py312}-nocover,
    report,

[testenv]
basepython =
    py310: {env:TOXPYTHON:python3.10}
    py311: {env:TOXPYTHON:python3.11}
    py312: {env:TOXPYTHON:python3.12}
    {clean,check,report}: python3.12
setenv =
    PYTHONPATH={toxinidir}/tests
    PYTHONUNBUFFERED=yes
    COVERAGE_FILE={toxinidir}/.coverage.{envname}
passenv =
    *
deps =
    pytest
    pytest-cov
    coverage[toml]
    seqrecord-expanded==0.2.16
allowlist_externals =
    pytest
commands =
    pytest --cov=dataset_creator --cov-report= {posargs:tests}

[testenv:check]
basepython = python3.12
deps =
    build
    twine
    check-manifest
skip_install = true
commands =
    python -m build
    twine check dist/*
    check-manifest {toxinidir}

[testenv:report]
basepython = python3.12
deps = coverage[toml]
skip_install = true
setenv =
    COVERAGE_FILE={toxinidir}/.coverage
changedir = {toxinidir}
commands =
    coverage combine
    coverage report
    coverage html

[testenv:clean]
commands = coverage erase
skip_install = true
deps = coverage[toml]
setenv =
    COVERAGE_FILE={toxinidir}/.coverage

[testenv:py310-nocover]
deps =
    pytest
commands =
    pytest -v {posargs:tests}

[testenv:py311-nocover]
deps =
    pytest
commands =
    pytest -v {posargs:tests}

[testenv:py312-nocover]
deps =
    pytest
commands =
    pytest -v {posargs:tests}
