"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[5375],{2983:(e,t,n)=>{n.r(t),n.d(t,{LinoEditor:()=>w,name:()=>k});var a=n(467),l=n(4467),r=n(3029),o=n(2901),i=n(6822),c=n(5501),s=n(3954),u=n(991),m=n(4756),p=n.n(m),d=n(6540),f=n(6606),b=n(7970),g=n(2756);n(1151);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(h=function(){return!!e})()}function v(e,t,n,a){var l=(0,u.A)((0,s.A)(1&a?e.prototype:e),t,n);return 2&a&&"function"==typeof l?function(e){return l.apply(n,e)}:l}var q,k="LinoEditor";q={AbortController:n.e(4166).then(n.t.bind(n,5568,23)),prButton:Promise.all([n.e(1927),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(7801)]).then(n.bind(n,9119)),prEditor:Promise.all([n.e(8026),n.e(8887),n.e(5573)]).then(n.bind(n,5937)),prDialog:Promise.all([n.e(6190),n.e(8887),n.e(5573),n.e(7335),n.e(6836),n.e(1960)]).then(n.bind(n,2955)),i18n:Promise.all([n.e(1304),n.e(8605),n.e(7211)]).then(n.bind(n,2292))};(0,f.RegisterImportPool)(q);var w=function(e){function t(e){var n,a,l,o;return(0,r.A)(this,t),a=this,l=t,o=[e],l=(0,s.A)(l),(n=(0,i.A)(a,h()?Reflect.construct(l,o||[],(0,s.A)(a).constructor):l.apply(a,o))).state=E(E({},n.state),{},{plain:"plain"===e.elem.field_options.format}),n.closeEditor=n.closeEditor.bind(n),n.onGlobalKeyDown=n.onGlobalKeyDown.bind(n),n}return(0,c.A)(t,e),(0,o.A)(t,[{key:"prepare",value:(n=(0,a.A)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,v(t,"prepare",this,3)([]);case 1:this.controller=new this.ex.AbortController.default,this.ex.i18n=this.ex.i18n.default;case 2:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"onReady",value:function(){window.addEventListener("keydown",this.onGlobalKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onGlobalKeyDown)}},{key:"onGlobalKeyDown",value:function(e){"Escape"==e.code&&this.closeEditor(e)}},{key:"closeEditor",value:function(e){var t=this.c,n=function(){t.history.pushPath({pathname:"/api/".concat(t.value.packId,"/").concat(t.value.actorId,"/").concat(t.value.pk),params:t.actionHandler.defaultStaticParams()})};t.isModified()?t.actionHandler.discardModDConfirm({agree:n}):n()}},{key:"headerExtend",value:function(){var e=this;return d.createElement(d.Fragment,null,b.PH.commonHeader(this),d.createElement("span",{className:"ql-formats"},d.createElement("button",{type:"button",onClick:function(t){return e.c.actionHandler.submit({})},"aria-label":"Submit changes"},d.createElement("i",{className:"pi pi-save"})),d.createElement("button",{type:"button",onClick:this.closeEditor,"aria-label":"Close window"},d.createElement("i",{className:"pi pi-times"}))))}},{key:"render",value:function(){var e=this;return this.state.ready?d.createElement(f.URLContextType.Consumer,null,function(t){var n=t.controller.APP,a=(0,b.tA)(n,t.controller.actionHandler.silentFetch,t.controller.signal,t.controller.mentionValues,e.ex.i18n,e);return d.createElement("div",{className:"l-editor",spellCheck:!n.state.site_data.disable_spell_check,onKeyDown:function(t){(t.ctrlKey||t.metaKey)&&"KeyS"===t.code?(t.stopPropagation(),t.preventDefault(),e.c.actionHandler.submit({})):t.ctrlKey&&t.shiftKey&&"KeyL"==t.code?(t.stopPropagation(),t.preventDefault(),(0,b.TY)(e)):"Escape"!==t.code&&t.stopPropagation()}},d.createElement(e.ex.prEditor.Editor,{headerTemplate:e.headerExtend(),modules:a,onLoad:function(t){e.quill=e.inputEl.getQuill(),(0,b.a7)(e,e.quill),(0,b.kA)(e.quill)},onTextChange:function(t){return(0,b.xB)(e,t)},ref:function(t){return e.inputEl=t},style:{background:"#ffffff"},value:e.context.data[t.fieldName]}),d.createElement("div",{id:"raw-editor-container",onKeyDown:function(e){return e.stopPropagation()}}))}):null}}]);var n}(g.LeafComponentInput);w.requiredModules=["AbortController","prButton","prEditor","prDialog","i18n"].concat(g.LeafComponentInput.requiredModules),w.iPool=Object.assign(q,g.LeafComponentInput.iPool.copy())},7970:(e,t,n)=>{n.d(t,{PH:()=>N,TY:()=>O,Zn:()=>A,a7:()=>E,kA:()=>q,tA:()=>v,xB:()=>h});var a=n(296),l=n(4467),r=(n(1480),n(8162),n(2047)),o=n(537),i=n(194),c=n(3117),s=n.n(c),u=n(2060),m=n.n(u),p=n(6540),d=n(6606);n(5065);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}r.default.register("modules/imageDropAndPaste",o.A),r.default.register("modules/blotFormatter2",i.Ay),r.default.register("modules/htmlEditButton",s()),r.default.register("modules/better-table",m());var g,y=o.A.ImageData;g={queryString:Promise.all([n.e(4166),n.e(2298)]).then(n.bind(n,8091))};(0,d.RegisterImportPool)(g);var E=function(e,t){},h=function(e,t){var n=t.textValue.slice(0,-1),a=(e.state.plain?n:t.htmlValue)||"";e.update((0,l.A)({},e.dataKey,a))},v=function(e,t,n,l,r,o){var i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],c={mention:w({silentFetch:t,signal:n,mentionValues:l}),blotFormatter2:{debug:!0,resize:{useRelativeSize:!0}},table:!1,"better-table":{operationMenu:{}}};return i&&(c.htmlEditButton={msg:r.t('Edit HTML here, when you click "OK" the quill editor\'s contents will be replaced'),prependSelector:"div#raw-editor-container",okText:r.t("Ok"),cancelText:r.t("Cancel"),buttonTitle:r.t("Show HTML source")}),e.state.site_data.installed_plugins.includes("uploads")&&(c.imageDropAndPaste={handler:k(o)}),c.keyboard={bindings:b(b({},m().keyboardBindings),{},{tab:{key:9,handler:function(e,t){return!0}},home:{key:"Home",handler:function(e,t){var n=g.quill,l=n.getLine(e.index),r=(0,a.A)(l,2),o=r[0];r[1];return!o||"LI"!==o.domNode.tagName||(n.setSelection(o.offset(n.scroll),0,"user"),!1)}}})},c},q=function(e){e.getModule("toolbar").addHandler("image",function(t){var n;t&&((n=document.createElement("input")).setAttribute("type","file"),n.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),n.classList.add("ql-image"),n.addEventListener("change",function(t){var a,l=t.target.files;if(l.length>0){var r=(a=l[0]).type,o=new FileReader;o.onload=function(t){var l=t.target.result;k({quill:e})(l,r,new y(l,r,a.name)),n.value=""},o.readAsDataURL(a)}}),n.click())})},k=function(e){return function(t,n,a){var l=e.quill,r=(l.getSelection()||{}).index;(void 0===r||r<0)&&(r=l.getLength()),l.insertEmbed(r,"image",t)}},w=function(e){var t=e.silentFetch,n=e.signal,a=e.mentionValues;return{allowedChars:/^[A-Za-z0-9\s]*$/,mentionDenotationChars:window.App.state.site_data.suggestors,source:function(e,l,r){if(0===e.length){var o=a[r];l(o,e)}else g.resolve(["queryString"]).then(function(a){var o=a.queryString;t({path:"suggestions?".concat(o.default.stringify({query:e,trigger:r})),signal:n}).then(function(t){return l(t.suggestions,e)})})},listItemClass:"ql-mention-list-item",mentionContainerClass:"ql-mention-list-container",mentionListClass:"ql-mention-list",dataAttributes:["value","link","title","denotationChar"]}},P=p.createElement(p.Fragment,null,p.createElement("span",{className:"ql-formats"},p.createElement("select",{className:"ql-header",defaultValue:"0"},p.createElement("option",{value:"1"},"Heading"),p.createElement("option",{value:"2"},"Subheading"),p.createElement("option",{value:"0"},"Normal")),p.createElement("select",{className:"ql-font"},p.createElement("option",{defaultValue:!0}),p.createElement("option",{value:"serif"}),p.createElement("option",{value:"monospace"}))),p.createElement("span",{className:"ql-formats"},p.createElement("select",{className:"ql-size"},p.createElement("option",{value:"small"}),p.createElement("option",{defaultValue:!0}),p.createElement("option",{value:"large"}),p.createElement("option",{value:"huge"}))),p.createElement("span",{className:"ql-formats"},p.createElement("button",{className:"ql-script",value:"sub"}),p.createElement("button",{className:"ql-script",value:"super"})),p.createElement("span",{className:"ql-formats"},p.createElement("button",{type:"button",className:"ql-bold","aria-label":"Bold"}),p.createElement("button",{type:"button",className:"ql-italic","aria-label":"Italic"}),p.createElement("button",{type:"button",className:"ql-underline","aria-label":"Underline"})),p.createElement("span",{className:"ql-formats"},p.createElement("select",{className:"ql-color"}),p.createElement("select",{className:"ql-background"})),p.createElement("span",{className:"ql-formats"},p.createElement("button",{type:"button",className:"ql-list",value:"ordered","aria-label":"Ordered List"}),p.createElement("button",{type:"button",className:"ql-list",value:"bullet","aria-label":"Unordered List"}),p.createElement("select",{className:"ql-align"},p.createElement("option",{defaultValue:!0}),p.createElement("option",{value:"center"}),p.createElement("option",{value:"right"}),p.createElement("option",{value:"justify"}))),p.createElement("span",{className:"ql-formats"},p.createElement("button",{type:"button",className:"ql-link","aria-label":"Insert Link"}),p.createElement("button",{type:"button",className:"ql-image","aria-label":"Insert Image"}),p.createElement("button",{type:"button",className:"ql-code-block","aria-label":"Insert Code Block"})),p.createElement("span",{className:"ql-formats"},p.createElement("button",{type:"button",className:"ql-clean","aria-label":"Remove Styles"}))),O=function(e){var t=e.props.urlParams.controller.APP.URLContext,n=(e.quill.getSelection()||{}).index;(void 0===n||n<0)&&(n=e.quill.getLength()),t.actionHandler.runAction({action_full_name:t.actionHandler.findUniqueAction("insert_reference").full_name,actorId:"about.About",response_callback:function(t){t.success&&e.quill.insertText(n,t.message)}})},A=function(e){return e.c.APP.state.site_data.installed_plugins.includes("memo")?p.createElement("span",{className:"ql-formats"},p.createElement("button",{type:"button",onClick:function(t){return O(e)},"aria-label":"Open link dialog"},p.createElement("i",{className:"pi pi-link"}))):null},N={header:P,commonHeader:function(e){return p.createElement(p.Fragment,null,P,A(e),p.createElement("span",{className:"ql-formats"},p.createElement("button",{type:"button",onClick:function(t){e.quill.getModule("better-table").insertTable(3,3)}},p.createElement("i",{className:"pi pi-table"}))))}}}}]);
//# sourceMappingURL=main.LinoEditor_LinoBody.333f17fe8ce8498ea4e0.js.map