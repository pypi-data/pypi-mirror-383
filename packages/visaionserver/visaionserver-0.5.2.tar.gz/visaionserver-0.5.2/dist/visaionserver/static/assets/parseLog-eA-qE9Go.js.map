{"version":3,"file":"parseLog-eA-qE9Go.js","sources":["../src/workers/parseLog.ts"],"sourcesContent":["\n\n\nonmessage = async function (e) {\n    let logDataArray = e.data[0]\n    let nowValStep = e.data[1]\n\n    let valStep=nowValStep\n    let metricsResult={data:[],step:valStep,xList:[],xOtherList:[],yList:[],yOtherList:[],eta:''}\n    for (const logDataRow of logDataArray) {\n        let data={}\n        if(logDataRow.includes(\"Iter(train)\")){\n            let arrayTempDataItem=logDataRow.split(\"]\")\n            let step=arrayTempDataItem[0].split(\"[\")[1].split('/')[0]\n            metricsResult.step=valStep=data['step']=step\n            \n            let arrayData=arrayTempDataItem[1].split(\"  \").filter(str => str !== \"\")\n            // console.log(arrayData)\n            for(let item of arrayData){\n                // let temp=item.split(\": \")\n                // console.log('0000',item)\n                if(item.indexOf('base_lr:')!=-1&&item.indexOf(' lr:')!=-1){//当有base_lr时候空格不对\n                item=item.replace(/base_lr.* /,'  lr: ')\n                console.log('lr:',item)\n            }\n                let temps=item.replace(':','').split(\" \")\n                \n                for (let index = 0; index < temps.length/2; index+=1) {\n                    let temp = [temps[index*2].trim(),temps[index*2+1].trim()];\n                    if(item.indexOf('base_lr')!=-1){\n                    console.log(temp)\n                    }\n                    ////\n                    // if(index==1){\n                    //     // console.log('999999',temp)\n                    // }\n                    \n                    if(temp[0]=='lr'||temp[0]=='base_lr'||temp[0]=='loss'){\n                        data[temp[0]]=temp[1]\n                        if(!metricsResult.yList[temp[0]]){\n                            metricsResult.yList[temp[0]]=[]\n                        }\n                        metricsResult.yList[temp[0]].push(temp[1])\n                    }else if(temp[0]=='eta'){\n                        let temp=item.split(\": \")\n                        metricsResult.eta=temp[1]\n                    }\n                }\n                \n            }\n            metricsResult.data.push(data)\n            metricsResult.xList.push(step)\n            // {\"lr\": 1e-06, \"step\": 395, \"loss\": 0.4156}\n        }else if(logDataRow.includes(\"Iter(val)\")&&!logDataRow.includes(\"eta:\")){\n            // {\"step\": 400, \"mIoU\": 13.18, \"IoU_ng\": 13.18, \"\\u533a\\u57df\\u68c0\\u51fa\\u7387_ng\": 36.23, \"\\u533a\\u57df\\u68c0\\u51fa\\u7387_\\u5168\\u5c40\": 36.23, \"\\u533a\\u57df\\u8fc7\\u68c0\\u7387_ng\": 15.25, \"\\u533a\\u57df\\u8fc7\\u68c0\\u7387_\\u5168\\u5c40\": 15.25}\n            let arrayTempDataItem=logDataRow.split(\"]\")\n            data['step']=valStep\n            let arrayData=arrayTempDataItem[1].split(\"  \").filter(str => str !== \"\")\n            for(const item of arrayData){\n                let temp=item.split(\": \")\n                if(temp[0]=='data_time'||temp[0]=='time'){\n                    continue;\n                }\n                data[temp[0]]=temp[1]\n                if(!metricsResult.yOtherList[temp[0]]){\n                    metricsResult.yOtherList[temp[0]]=[]\n                }\n                metricsResult.yOtherList[temp[0]].push(temp[1])\n            }\n            metricsResult.data.push(data)\n            metricsResult.xOtherList.push(valStep)\n        }\n    }\n    postMessage(metricsResult);\n}\n\nconst chargeArrayIn=(array:any,name:any,newArrays:any) =>{\n    let item = array.find((item:any) =>item.name==name)\n    if(item){\n        item.data = item.data.concat(newArrays)\n    }else {\n        array.push({name:name,data:newArrays})\n    }\n}"],"names":["e","logDataArray","valStep","metricsResult","logDataRow","data","arrayTempDataItem","step","arrayData","str","item","temps","index","temp"],"mappings":"yBAGA,UAAY,eAAgBA,EAAG,CACvB,IAAAC,EAAeD,EAAE,KAAK,CAAC,EAGvBE,EAFaF,EAAE,KAAK,CAAC,EAGrBG,EAAc,CAAC,KAAK,GAAG,KAAKD,EAAQ,MAAM,CAAA,EAAG,WAAW,CAAA,EAAG,MAAM,CAAC,EAAE,WAAW,CAAC,EAAE,IAAI,EAAE,EAC5F,UAAWE,KAAcH,EAAc,CACnC,IAAII,EAAK,CAAC,EACP,GAAAD,EAAW,SAAS,aAAa,EAAE,CAC9B,IAAAE,EAAkBF,EAAW,MAAM,GAAG,EACtCG,EAAKD,EAAkB,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,EACxDH,EAAc,KAAKD,EAAQG,EAAK,KAAQE,EAEpC,IAAAC,EAAUF,EAAkB,CAAC,EAAE,MAAM,IAAI,EAAE,OAAcG,GAAAA,IAAQ,EAAE,EAEvE,QAAQC,KAAQF,EAAU,CAGnBE,EAAK,QAAQ,UAAU,GAAG,IAAIA,EAAK,QAAQ,MAAM,GAAG,KAClDA,EAAAA,EAAK,QAAQ,aAAa,QAAQ,EAC/B,QAAA,IAAI,MAAMA,CAAI,GAEtB,IAAIC,EAAMD,EAAK,QAAQ,IAAI,EAAE,EAAE,MAAM,GAAG,EAExC,QAASE,EAAQ,EAAGA,EAAQD,EAAM,OAAO,EAAGC,GAAO,EAAG,CAClD,IAAIC,EAAO,CAACF,EAAMC,EAAM,CAAC,EAAE,OAAOD,EAAMC,EAAM,EAAE,CAAC,EAAE,MAAM,EAStD,GARAF,EAAK,QAAQ,SAAS,GAAG,IAC5B,QAAQ,IAAIG,CAAI,EAObA,EAAK,CAAC,GAAG,MAAMA,EAAK,CAAC,GAAG,WAAWA,EAAK,CAAC,GAAG,OAC3CR,EAAKQ,EAAK,CAAC,CAAC,EAAEA,EAAK,CAAC,EAChBV,EAAc,MAAMU,EAAK,CAAC,CAAC,IAC3BV,EAAc,MAAMU,EAAK,CAAC,CAAC,EAAE,CAAC,GAEpBV,EAAA,MAAMU,EAAK,CAAC,CAAC,EAAE,KAAKA,EAAK,CAAC,CAAC,UACpCA,EAAK,CAAC,GAAG,MAAM,CAChBA,IAAAA,EAAKH,EAAK,MAAM,IAAI,EACVP,EAAA,IAAIU,EAAK,CAAC,CAAA,CAC5B,CACJ,CAGUV,EAAA,KAAK,KAAKE,CAAI,EACdF,EAAA,MAAM,KAAKI,CAAI,CAAA,SAExBH,EAAW,SAAS,WAAW,GAAG,CAACA,EAAW,SAAS,MAAM,EAAE,CAEhE,IAAAE,EAAkBF,EAAW,MAAM,GAAG,EAC1CC,EAAK,KAAQH,EACT,IAAAM,EAAUF,EAAkB,CAAC,EAAE,MAAM,IAAI,EAAE,OAAcG,GAAAA,IAAQ,EAAE,EACvE,UAAUC,KAAQF,EAAU,CACpB,IAAAK,EAAKH,EAAK,MAAM,IAAI,EACrBG,EAAK,CAAC,GAAG,aAAaA,EAAK,CAAC,GAAG,SAGlCR,EAAKQ,EAAK,CAAC,CAAC,EAAEA,EAAK,CAAC,EAChBV,EAAc,WAAWU,EAAK,CAAC,CAAC,IAChCV,EAAc,WAAWU,EAAK,CAAC,CAAC,EAAE,CAAC,GAEzBV,EAAA,WAAWU,EAAK,CAAC,CAAC,EAAE,KAAKA,EAAK,CAAC,CAAC,EAAA,CAEpCV,EAAA,KAAK,KAAKE,CAAI,EACdF,EAAA,WAAW,KAAKD,CAAO,CAAA,CACzC,CAEJ,YAAYC,CAAa,CAC7B"}