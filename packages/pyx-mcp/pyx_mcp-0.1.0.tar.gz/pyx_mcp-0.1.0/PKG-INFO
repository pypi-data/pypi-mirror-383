Metadata-Version: 2.4
Name: pyx-mcp
Version: 0.1.0
Summary: X (Twitter) API client library with tweepy and pydantic
Requires-Python: >=3.13
Description-Content-Type: text/markdown
Requires-Dist: tweepy>=4.16.0
Requires-Dist: pydantic>=2.8.0
Requires-Dist: mcp>=1.17.0

# X (Twitter) API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ãƒªãƒ‡ã‚¶ã‚¤ãƒ³

X (Twitter) API ã¨é€£æºã™ã‚‹ãŸã‚ã® Python ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã™ã€‚tweepy ã‚’ãƒ™ãƒ¼ã‚¹ã« v2 API (æŠ•ç¨¿) ã¨ v1.1 API (ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰) ã‚’çµ±åˆã—ã€ã‚·ãƒ³ãƒ—ãƒ«ã«é‹ç”¨ã§ãã‚‹ã‚ˆã†å†è¨­è¨ˆã—ã¾ã—ãŸã€‚

## ä¸»ãªæ©Ÿèƒ½
- ãƒ‡ãƒ¥ã‚¢ãƒ«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ§‹æˆï¼šæŠ•ç¨¿ã¯ tweepy.Client (v2)ã€ãƒ¡ãƒ‡ã‚£ã‚¢ã¯ tweepy.API (v1.1)
- `.env` ã‚’ç”¨ã„ãŸå®‰å…¨ãªèªè¨¼æƒ…å ±ç®¡ç†ã¨ OAuth ãƒ•ãƒ­ãƒ¼çµ±åˆ
- `PostService` / `MediaService` ã«ã‚ˆã‚‹é«˜ãƒ¬ãƒ™ãƒ« API
- `examples/create_post.py` ã«ã‚ˆã‚‹ CLI ã‹ã‚‰ã®æŠ•ç¨¿ãƒ‡ãƒ¢
- é•·æ–‡ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã¨è‡ªå‹•ãƒªãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³æ§‹ç¯‰
- ãƒªãƒã‚¹ãƒˆï¼å–ã‚Šæ¶ˆã— API ã¨ MCP ãƒ„ãƒ¼ãƒ«
- æ¤œç´¢ API ã® expansionsï¼fields æŒ‡å®šå¯¾å¿œã¨è‘—è€…æƒ…å ±è§£æ±º
- ã‚µãƒ¼ãƒ“ã‚¹å±¤ã«çµ„ã¿è¾¼ã¾ã‚ŒãŸæ§‹é€ åŒ–ãƒ­ã‚°ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒƒã‚¯
- **MCP (Model Context Protocol) çµ±åˆ**: AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‹ã‚‰ X API ã‚’æ“ä½œå¯èƒ½

## å¿…è¦æ¡ä»¶
- Python 3.13 ä»¥ä¸Š
- X (Twitter) é–‹ç™ºè€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ API ã‚­ãƒ¼ä¸€å¼
- ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ„ãƒ¼ãƒ« [uv](https://docs.astral.sh/uv/)ï¼ˆæ¨å¥¨ï¼‰

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
uv sync
```

### èªè¨¼æƒ…å ±ã®è¨­å®š
`.env` ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°ã§èªè¨¼æƒ…å ±ã‚’è¨­å®šã—ã¾ã™ã€‚`.env` ã¯åˆå›ä¿å­˜æ™‚ã«è‡ªå‹•çš„ã« 0o600ï¼ˆæ‰€æœ‰è€…ã®ã¿èª­ã¿æ›¸ãå¯ï¼‰ã«ãªã‚Šã¾ã™ã€‚

1. **Python 3.13+** ã‚’æƒ³å®šã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ã«ã¯ `uv` ã‚’åˆ©ç”¨ã€‚
2. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: `uv sync`
ç’°å¢ƒå¤‰æ•°ã§è¨­å®šã™ã‚‹å ´åˆï¼ˆæ¨å¥¨ï¼‰:
```bash
export X_API_KEY="your_api_key"
export X_API_SECRET="your_api_secret"
export X_ACCESS_TOKEN="your_access_token"
export X_ACCESS_TOKEN_SECRET="your_access_token_secret"
export X_BEARER_TOKEN="your_bearer_token"  # v2 APIç”¨ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã«é…ç½®ï¼‰:
```bash
# .env
X_API_KEY=your_api_key
X_API_SECRET=your_api_secret
X_ACCESS_TOKEN=your_access_token
X_ACCESS_TOKEN_SECRET=your_access_token_secret
X_BEARER_TOKEN=your_bearer_token
```

`.env` ã¯ãƒªãƒã‚¸ãƒˆãƒªç›´ä¸‹ã«ç½®ãã¨ `ConfigManager` ãŒè‡ªå‹•çš„ã«èª­ã¿è¾¼ã¿ã¾ã™ã€‚åˆ¥ãƒ‘ã‚¹ã‚’ä½¿ã†å ´åˆã¯ `ConfigManager(dotenv_path=Path("/path/to/.env"))` ã®ã‚ˆã†ã«æ˜ç¤ºã—ã¦ãã ã•ã„ã€‚ `.env*` ã¯ `.gitignore` æ¸ˆã¿ã®ãŸã‚ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã«å«ã‚ãªã„ã§ãã ã•ã„ã€‚OAuth ãƒ•ãƒ­ãƒ¼çµŒç”±ã§å–å¾—ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã¯ `ConfigManager.save_credentials()` ã«ã‚ˆã‚Š `.env` ã«è¿½è¨˜ã•ã‚Œã¾ã™ã€‚

## ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦åˆ©ç”¨ã™ã‚‹
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ç›´æ¥å‘¼ã³å‡ºã™ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚

```python
from x_client.config import ConfigManager
from x_client.factory import XClientFactory
from x_client.services.post_service import PostService
from x_client.services.media_service import MediaService

# 1. èªè¨¼æƒ…å ±ã‚’èª­ã¿è¾¼ã¿
config = ConfigManager()
client = XClientFactory.create_from_config(config)

# 2. ã‚µãƒ¼ãƒ“ã‚¹å±¤ã‚’åˆæœŸåŒ–
post_service = PostService(client)
media_service = MediaService(client)

# 3. æŠ•ç¨¿ã‚’ä½œæˆ
post = post_service.create_post(text="Hello from x_client!")
print(f"Post created: {post.id}")

# 4. ç”»åƒä»˜ãæŠ•ç¨¿
from pathlib import Path
media_result = media_service.upload_image(Path("image.png"))
post = post_service.create_post(
    text="Check out this image!",
    media_ids=[media_result.media_id]
)

# 5. é•·æ–‡ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿
thread = post_service.create_thread(
    """Python 3.13 highlights... (long text)""",
    chunk_limit=200,
)
for idx, segment_post in enumerate(thread.posts, start=1):
    print(f"Segment {idx}: {segment_post.id}")
if not thread.succeeded:
    print("Thread failed", thread.error)

# 6. ãƒªãƒã‚¹ãƒˆæ“ä½œ
repost_state = post_service.repost_post(post.id)
print("Reposted:", repost_state.reposted)

undo_state = post_service.undo_repost(post.id)
print("Repost removed:", not undo_state.reposted)

# 7. è‘—è€…æƒ…å ±ä»˜ãæ¤œç´¢
search_results = post_service.search_recent(
    "from:twitterdev",
    expansions=["author_id"],
    user_fields=["username", "verified"],
    post_fields=["created_at"],
)
for item in search_results:
    author = item.author.username if item.author else "unknown"
    print(author, item.text)
```

## CLI ã§è©¦ã™
`examples/create_post.py` ã‚’ä½¿ã†ã¨ã€ç°¡å˜ã«æŠ•ç¨¿ã‚’è©¦ã›ã¾ã™ã€‚

```bash
# ãƒ†ã‚­ã‚¹ãƒˆã®ã¿
python examples/create_post.py "Hello from x_client!"

# ç”»åƒä»˜ã
python examples/create_post.py "Check out this image!" --image path/to/image.png

# å‹•ç”»ä»˜ãï¼ˆæœ€å¤§512MBã€ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰
python examples/create_post.py "Check out this video!" --video path/to/video.mp4

# åˆ¥ãƒ‘ã‚¹ã® .env ã‚’åˆ©ç”¨
python examples/create_post.py "Hello with custom env" --dotenv /secure/path/.env

# é•·æ–‡ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿ï¼ˆchunk_limit=180 ã§è‡ªå‹•åˆ†å‰²ï¼‰
python examples/create_post.py "Long form update..." --thread --chunk-limit 180

# ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’æŠ•ç¨¿ï¼ˆUTF-8 ãƒ†ã‚­ã‚¹ãƒˆã‚’æƒ³å®šï¼‰
python examples/create_post.py --thread-file docs/thread_draft.txt

# æ—¥æœ¬èªã®é•·æ–‡ã‚¹ãƒ¬ãƒƒãƒ‰ä¾‹ï¼ˆ280æ–‡å­—æœªæº€ã§é©åº¦ã«æ”¹è¡Œï¼‰
python examples/create_post.py --thread-file examples/long_thread_ja.txt --chunk-limit 180

# è‹±èªã®é•·æ–‡ã‚¹ãƒ¬ãƒƒãƒ‰ä¾‹ï¼ˆã‚»ãƒ³ãƒ†ãƒ³ã‚¹åŒºåˆ‡ã‚Šã‚’ç¶­æŒï¼‰
python examples/create_post.py --thread-file examples/long_thread_en.txt --chunk-limit 240

# ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆå›é¿ã®ãŸã‚å„æŠ•ç¨¿é–“ã§ 8 ç§’å¾…ã¤
python examples/create_post.py --thread-file examples/long_thread_en.txt --segment-pause 8

# å¤±æ•—ã—ãŸã‚¹ãƒ¬ãƒƒãƒ‰ã®å…ˆé ­ãƒ„ã‚¤ãƒ¼ãƒˆã‚’å‰Šé™¤ï¼ˆé‡è¤‡ã‚¨ãƒ©ãƒ¼ã®è§£æ¶ˆã«åˆ©ç”¨ï¼‰
python examples/create_post.py --delete 1234567890123456789

# ãƒªãƒã‚¹ãƒˆ / ãƒªãƒã‚¹ãƒˆã®å–ã‚Šæ¶ˆã—
python examples/create_post.py --repost 1234567890
python examples/create_post.py --undo-repost 1234567890
```

`examples/sample_image.png` ã‚’ã‚µãƒ³ãƒ—ãƒ«ç”»åƒã¨ã—ã¦åŒæ¢±ã—ã¦ã„ã‚‹ãŸã‚ã€å‹•ä½œç¢ºèªæ™‚ã«ã¯ `--image examples/sample_image.png` ã‚’æŒ‡å®šã§ãã¾ã™ã€‚

ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿ã¯ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼ˆAPI åˆ¶ç´„ä¸Šãƒ¡ãƒ‡ã‚£ã‚¢æ·»ä»˜ã¯ä¸å¯ï¼‰ã€‚`--chunk-limit` ã§ 1 ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚ãŸã‚Šã®æ–‡å­—æ•°ä¸Šé™ã‚’èª¿æ•´ã§ãã¾ã™ã€‚`--thread-file` ã‚’æŒ‡å®šã™ã‚‹ã¨ Markdown/ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãã®ã¾ã¾ã‚¹ãƒ¬ãƒƒãƒ‰ã¨ã—ã¦åˆ†å‰²æŠ•ç¨¿ã—ã¾ã™ã€‚

### ãƒ­ãƒ³ã‚°ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿ã«ãŠã‘ã‚‹è¨€èªåˆ¥ã®è€ƒæ…®äº‹é …
- **æ—¥æœ¬èª**: å…¨è§’æ–‡å­—ãŒå¤šã„å ´åˆã¯ 280 æ–‡å­—ã‚®ãƒªã‚®ãƒªã¾ã§è©°ã‚ã‚‹ã¨èª­ã¿ã¥ã‚‰ããªã‚‹ãŸã‚ã€`--chunk-limit` ã‚’ 150-200 æ–‡å­—ç¨‹åº¦ã«æŠ‘ãˆã¦æ–‡ç¯€ã”ã¨ã®ã¾ã¨ã¾ã‚Šã‚’ç¶­æŒã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€å¥èª­ç‚¹ç›´å¾Œã§åˆ†å‰²ã•ã‚Œã‚‹ã¨æ–‡è„ˆãŒé€”åˆ‡ã‚Œã‚„ã™ã„ã®ã§ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å´ã§æ®µè½ã”ã¨ã«ç©ºè¡Œã‚’å…¥ã‚Œã¦ãŠãã¨å®‰å…¨ã§ã™ã€‚UTF-8 ã®ã¾ã¾ä¿å­˜ã™ã‚Œã° X API ã§æ­£ã—ãæ‰±ã‚ã‚Œã¾ã™ã€‚
- **è‹±èª**: URL ã‚„çµµæ–‡å­—ã‚’å«ã‚€ã¨ãã¯ Twitter å´ã§ 23 æ–‡å­—æ›ç®—ã•ã‚Œã‚‹ãŸã‚ã€ä½™è£•ã‚’æŒã£ã¦ `--chunk-limit` ã‚’è¨­å®šã—ã¾ã™ã€‚ã‚»ãƒ³ãƒ†ãƒ³ã‚¹å˜ä½ã§æ”¹è¡Œã—ã¦ãŠãã¨ã€åˆ†å‰²å¾Œã‚‚èª­ã¿ã‚„ã™ã•ãŒä¿ãŸã‚Œã¾ã™ã€‚ã¾ãŸã€å¼•ç”¨ç¬¦ã‚„ Markdown è¨˜æ³•ã‚’ä½¿ã†å ´åˆã¯ã€å¤‰æ›å¾Œã« 280 æ–‡å­—ã‚’è¶…ãˆã¦ã„ãªã„ã‹å†’é ­ã®ãƒ‰ãƒ©ãƒ•ãƒˆæŠ•ç¨¿ã§å¿…ãšç¢ºèªã—ã¦ãã ã•ã„ã€‚

ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’å†æŠ•ç¨¿ã™ã‚‹å ´åˆã€X å´ã®ä»•æ§˜ã§ 24 æ™‚é–“ä»¥å†…ã«å…¨ãåŒã˜æœ¬æ–‡ã‚’æŠ•ç¨¿ã™ã‚‹ã¨ **Duplicate content** ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚å‰å›æŠ•ç¨¿ã—ãŸã‚¹ãƒ¬ãƒƒãƒ‰ã‚’å‰Šé™¤ã™ã‚‹ã‹ã€ãƒ†ã‚­ã‚¹ãƒˆã«ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãªã©ã®ä¸€æ„ãªèªå¥ã‚’è¿½åŠ ã—ã¦ã‹ã‚‰å†å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚`--delete` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å…ˆé ­ãƒ„ã‚¤ãƒ¼ãƒˆã‚’ç´ æ—©ãå‰Šé™¤ã§ãã¾ã™ã€‚

ã¾ãŸã€X API ã¯çŸ­æ™‚é–“ã«é€£ç¶šã§æŠ•ç¨¿ã™ã‚‹ã¨ HTTP 429 (Too Many Requests) ã‚’è¿”ã™ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚æœ¬ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ `RateLimitExceeded` ã‚’æ¤œçŸ¥ã™ã‚‹ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã® `x-rate-limit-reset` ã«å¾“ã£ã¦å¾…æ©Ÿã—ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¾ã™ãŒã€æ‰‹å‹•æŠ•ç¨¿ã§ã‚‚åŒã˜åˆ¶é™ãŒã‚ã‚‹ãŸã‚ã€429 ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ 2ï½3 åˆ†ã»ã©å¾…ã£ã¦ã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ã‚’å†å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
`--segment-pause` ã‚’ 5â€“10 ç§’ç¨‹åº¦ã«è¨­å®šã™ã‚‹ã¨ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã”ã¨ã®æŠ•ç¨¿é–“éš”ã«ä½™è£•ã‚’æŒãŸã›ã‚‰ã‚Œã€429 ã‚’äº‹å‰ã«å›é¿ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

ãƒªãƒã‚¹ãƒˆæ“ä½œã¯æœ¬æ–‡/ãƒ¡ãƒ‡ã‚£ã‚¢ä¸è¦ã§ã€`--repost` ã§æŒ‡å®š ID ã‚’ãƒªãƒã‚¹ãƒˆã€`--undo-repost` ã§å–ã‚Šæ¶ˆã—ã¾ã™ã€‚

## ãƒ­ã‚®ãƒ³ã‚°ã¨å¯è¦³æ¸¬æ€§

`PostService` ã«ã¯æ§‹é€ åŒ–ã•ã‚ŒãŸ INFO/DEBUG ãƒ­ã‚°ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒƒã‚¯ãŒæ¨™æº–ã§çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚`logging.basicConfig(level=logging.INFO)` ã‚’å‘¼ã³å‡ºã™ã ã‘ã§ã€ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿ã‚„ãƒªãƒã‚¹ãƒˆã®é€²è¡ŒçŠ¶æ³ãŒ `post.thread.*` / `post.repost.*` ã¨ã„ã£ãŸã‚¤ãƒ™ãƒ³ãƒˆåã§ç¢ºèªã§ãã¾ã™ã€‚

```python
import logging

from x_client.config import ConfigManager
from x_client.factory import XClientFactory
from x_client.services.post_service import PostService

logging.basicConfig(level=logging.INFO)

client = XClientFactory.create_from_config(ConfigManager())

def metrics_hook(event: str, payload: dict[str, object]) -> None:
    # Prometheus / OpenTelemetry ãªã©ã¸ã®é€£æºãƒã‚¤ãƒ³ãƒˆ
    print("metrics", event, payload)

post_service = PostService(client, event_hook=metrics_hook)
post_service.create_post("observability ready!")
```

ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒƒã‚¯ã¯æˆåŠŸãƒ»å¤±æ•—åŒæ–¹ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å˜ä¸€ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¸é›†ç´„ã™ã‚‹ãŸã‚ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹é€å‡ºã‚„åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã¨ã®é€£æºãŒå®¹æ˜“ã§ã™ã€‚å¤±æ•—æ™‚ã«ã¯ `post.create.error` ã‚„ `post.thread.error` ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ãŸã‚ã€å†è©¦è¡Œæˆ¦ç•¥ã‚„ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥ã¨çµ„ã¿åˆã‚ã›ã‚‰ã‚Œã¾ã™ã€‚

## MCP (Model Context Protocol) ã§åˆ©ç”¨ã™ã‚‹

ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆGitHub: `pyX-MCP`ï¼‰ã¯æ¨™æº–çš„ãª MCP ã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦ AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆï¼ˆClaude Desktop ãªã©ï¼‰ã‹ã‚‰åˆ©ç”¨ã§ãã¾ã™ã€‚

### ğŸš€ æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•ï¼šuvx ã§å®Ÿè¡Œï¼ˆPyPI å…¬é–‹å¾Œï¼‰

**PyPI ã«å…¬é–‹æ¸ˆã¿ã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ä½¿ç”¨ã§ãã¾ã™**:

```bash
uvx --from pyx-mcp x-mcp-server
```

**Claude Desktop è¨­å®šä¾‹**:
```json
{
  "mcpServers": {
    "x-client": {
      "command": "uvx",
      "args": ["--from", "pyx-mcp", "x-mcp-server", "--stdio"],
      "env": {
        "X_API_KEY": "your-api-key",
        "X_API_SECRET": "your-api-secret",
        "X_ACCESS_TOKEN": "your-access-token",
        "X_ACCESS_TOKEN_SECRET": "your-access-token-secret"
      }
    }
  }
}
```

**ãƒ¡ãƒªãƒƒãƒˆ**:
- âœ… Node.js ãªã—ã§åˆ©ç”¨å¯èƒ½ï¼ˆuv ãŒè‡ªå‹•ã§ä»®æƒ³ç’°å¢ƒã‚’æ§‹ç¯‰ï¼‰
- âœ… ä¾å­˜é–¢ä¿‚ã¯ `uv` ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆ©ç”¨ã—ã¦é«˜é€ŸåŒ–
- âœ… `--from` ã«ã‚ˆã‚Šå¸¸ã«æœ€æ–°ãƒªãƒªãƒ¼ã‚¹ã¸ç°¡å˜ã«æ›´æ–°

---

### é–‹ç™ºç’°å¢ƒã§ã®åˆ©ç”¨

**1. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— (åˆå›ã®ã¿):**

```bash
cd /path/to/twitter
uv pip install -e .
```

ã“ã‚Œã«ã‚ˆã‚Š `x-mcp-server` ã‚³ãƒãƒ³ãƒ‰ãŒ `.venv/bin/` ã«ä½œæˆã•ã‚Œã¾ã™ã€‚

**2. Claude Desktop ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†:**

macOS: `~/Library/Application Support/Claude/claude_desktop_config.json`

**æ¨å¥¨: uvx ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆä½¿ç”¨**
```json
{
  "mcpServers": {
    "x-client": {
      "command": "/absolute/path/to/twitter/.venv/bin/x-mcp-server",
      "env": {
        "X_API_KEY": "your-api-key",
        "X_API_SECRET": "your-api-secret",
        "X_ACCESS_TOKEN": "your-access-token",
        "X_ACCESS_TOKEN_SECRET": "your-access-token-secret"
      }
    }
  }
}
```

<details>
<summary>ä»£æ›¿æ–¹æ³• (ã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹)</summary>

**æ–¹æ³•2: uv ç›´æ¥ä½¿ç”¨**
```json
{
  "mcpServers": {
    "x-client": {
      "command": "uv",
      "args": ["run", "--directory", "/absolute/path/to/twitter", "python", "-m", "x_client.integrations.mcp_server"],
      "env": {
        "X_API_KEY": "your-api-key",
        "X_API_SECRET": "your-api-secret",
        "X_ACCESS_TOKEN": "your-access-token",
        "X_ACCESS_TOKEN_SECRET": "your-access-token-secret"
      }
    }
  }
}
```

**æ–¹æ³•3: ãƒ©ãƒ³ãƒãƒ£ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**
```json
{
  "mcpServers": {
    "x-client": {
      "command": "/absolute/path/to/twitter/scripts/run_mcp_server.sh",
      "env": { "X_API_KEY": "...", "X_API_SECRET": "...", "X_ACCESS_TOKEN": "...", "X_ACCESS_TOKEN_SECRET": "..." }
    }
  }
}
```
</details>

**é‡è¦**:
- `/absolute/path/to/twitter` ã‚’å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‘ã‚¹ã«ç½®ãæ›ãˆ
- èªè¨¼æƒ…å ±ã‚’å®Ÿéš›ã® X API è³‡æ ¼æƒ…å ±ã«ç½®ãæ›ãˆ

**2. Claude Desktop ã‚’å†èµ·å‹•**

**3. å‹•ä½œç¢ºèª:**

Claude ã«ã€Œåˆ©ç”¨å¯èƒ½ãª X API ãƒ„ãƒ¼ãƒ«ã‚’ä¸€è¦§è¡¨ç¤ºã—ã¦ã€ã¨ä¾é ¼ã™ã‚‹ã¨ã€10å€‹ã®ãƒ„ãƒ¼ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

### ä½¿ç”¨ä¾‹

```
ã‚ãªãŸ: ã€ŒHello from Claude via MCP!ã€ã¨æŠ•ç¨¿ã—ã¦

Claude: create_post ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™...
       æŠ•ç¨¿ãŒå®Œäº†ã—ã¾ã—ãŸï¼æŠ•ç¨¿ID: 1234567890
```

```
ã‚ãªãŸ: ã€ŒMCP ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€ã«ã¤ã„ã¦æœ€è¿‘ã®æŠ•ç¨¿ã‚’æ¤œç´¢ã—ã¦

Claude: search_recent_posts ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™...
       3ä»¶ã®æŠ•ç¨¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:
       1. @user1: MCP ã‚’ä½¿ã£ã¦ã¿ãŸ...
       2. @user2: Model Context Protocol ã¯...
```

### Python API ã¨ã—ã¦ã‚‚åˆ©ç”¨å¯èƒ½

MCP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä»¥å¤–ã‹ã‚‰ã‚‚ç›´æ¥å‘¼ã³å‡ºã›ã¾ã™:

```python
from x_client.integrations.mcp_adapter import XMCPAdapter

adapter = XMCPAdapter()  # èªè¨¼æƒ…å ±ã¯ ConfigManager ãŒè‡ªå‹•èª­ã¿è¾¼ã¿

post = adapter.create_post({"text": "Hello from MCP!"})
print(post)

media = adapter.upload_image({"path": "/path/to/image.png"})
adapter.create_post({"text": "Image post", "media_ids": [media["media_id"]]})
```

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
Claude Desktop â†” MCP Server (stdio) â†” XMCPAdapter â†” Service Layer â†” X API
```

### æä¾›ãƒ„ãƒ¼ãƒ«

- `create_post`, `delete_post`, `get_post`, `search_recent_posts`
- `create_thread`, `repost_post`, `undo_repost`
- `upload_image`ï¼ˆç”»åƒ: JPEG/PNG/WebP/GIF, æœ€å¤§ 5MBï¼‰
- `upload_video`ï¼ˆå‹•ç”»: MP4, æœ€å¤§ 512MB, ãƒãƒ£ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰
- `get_auth_status`ï¼ˆOAuth1 ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‹ã‚‰ `user_id` ã‚’æŠ½å‡ºã—ã€åˆ©ç”¨å¯èƒ½ã§ã‚ã‚Œã°ãƒ¬ãƒ¼ãƒˆåˆ¶é™æƒ…å ± `{limit, remaining, reset_at}` ã‚’è¿”å´ï¼‰

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- `ConfigurationError`: èªè¨¼æƒ…å ±ä¸è¶³ã€‚`.env` ã¨ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèªã€‚
- `AuthenticationError`: ãƒˆãƒ¼ã‚¯ãƒ³å¤±åŠ¹ã€‚OAuth ãƒ•ãƒ­ãƒ¼ã‚’å†å®Ÿè¡Œã€‚
- `RateLimitExceeded`: ãƒ¬ãƒ¼ãƒˆåˆ¶é™åˆ°é”ã€‚`reset_at` ã‚’å‚ç…§ã—ã€ãƒãƒƒã‚¯ã‚ªãƒ•ã‚’å®Ÿæ–½ã€‚
- `MediaProcessingTimeout` / `MediaProcessingFailed`: å‹•ç”»å‡¦ç†ãŒå®Œäº†ã—ãªã„å ´åˆã€‚`timeout` ã‚„å‹•ç”»å“è³ªã‚’èª¿æ•´ã€‚

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **Missing credentials**: `echo $X_API_KEY` ãªã©ã§ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèªã—ã€`.env` ãŒ 0o600 ã§ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã€‚
- **Invalid token**: `python examples/create_post.py "test"` ã‚’å®Ÿè¡Œã—ã¦ OAuth ãƒ•ãƒ­ãƒ¼ã‚’å¾©æ—§ã€‚
- **Video timeout**: `upload_video` ã® `timeout` ã‚’å»¶é•·ã™ã‚‹ã‹ã€`ffmpeg` ã§å†ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã€‚

### è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

MCP ã‚µãƒ¼ãƒãƒ¼ã®è©³ç´°ãªè¨­å®šã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯ [docs/mcp_setup.md](docs/mcp_setup.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### ãƒ†ã‚¹ãƒˆ

```bash
# MCP ã‚µãƒ¼ãƒãƒ¼ã®å‹•ä½œãƒ†ã‚¹ãƒˆ
uv run python scripts/test_mcp_server.py

# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
uv run pytest tests/unit/test_mcp_adapter.py -v
```

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

è©³ç´°ãªè¨­è¨ˆãƒ»è¨ˆç”»ã‚„æ—¢çŸ¥ã®æ‡¸å¿µç‚¹ã¯ `docs/x_api_design.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã“ã®1ãƒ•ã‚¡ã‚¤ãƒ«ã«çµ±åˆã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚

## ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
uv run pytest

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãå®Ÿè¡Œ
uv run pytest --cov=x_client --cov-report=html

# è©³ç´°ãƒ¢ãƒ¼ãƒ‰
uv run pytest -v

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
uv run pytest tests/unit/test_tweepy_client.py
```

## ã‚µãƒãƒ¼ãƒˆ
ãƒã‚°å ±å‘Šã‚„æ”¹å–„ææ¡ˆã¯ issue ã‚‚ã—ãã¯ pull request ã§ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ–¹é‡ã‚„è¨­è¨ˆã«é–¢ã™ã‚‹è©³ç´°ã¯ `docs/` ã‚’å‚ç…§ã®ã†ãˆã€å¿…è¦ã«å¿œã˜ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
