id: cve-2022-22965

info:
  name: Spring4Shell RCE Indicator (CVE-2022-22965)
  author: moriarty
  severity: critical
  description: Detects Spring Core applications responding with class loader exposure markers
  tags: cve,spring,rce

requests:
  - method: GET
    path:
      - "/?class.module.classLoader=1"
      - "/app?class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7B%7D"
    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - "contains(body, 'class.module.classLoader')"
          - "contains(body, 'org.springframework')"
        condition: or
      - type: regex
        regex:
          - "TomcatEmbeddedContext"
          - "org.apache.catalina.core.StandardContext"
        condition: or
      - type: status
        status:
          - 200
          - 500
    stop-at-first-match: true
