id: cve-2017-5638

info:
  name: Apache Struts 2 Remote Code Execution (CVE-2017-5638)
  author: moriarty
  severity: critical
  description: Detects Apache Struts installations exposing the S2-045 OGNL parser error pattern
  tags: cve,struts,rce

requests:
  - method: GET
    path:
      - "/struts2-showcase/index.action"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - "Struts Problem Report"
          - "Struts2"
        condition: or
      - type: dsl
        dsl:
          - "contains(body, 'ognl.OgnlException') or contains(body, 'No result defined for action')"
    stop-at-first-match: true
