id: cve-2018-7600

info:
  name: Drupalgeddon2 Remote Code Execution (CVE-2018-7600)
  author: moriarty
  severity: critical
  description: Detects Drupal instances vulnerable to Drupalgeddon2 via ajax request leakage
  tags: cve,drupal,rce

requests:
  - method: POST
    path:
      - "/user/register?element_parents=account/mail/%23value&ajax_form=1"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "form_id=user_register_form&_drupal_ajax=1"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "form_build_id"
          - "ajax_html"
        condition: and
      - type: dsl
        dsl:
          - "contains(body, 'drupal_settings')"
    stop-at-first-match: true
