id: cve-2019-11510

info:
  name: Pulse Secure Arbitrary File Read (CVE-2019-11510)
  author: moriarty
  severity: critical
  description: Detects Pulse Secure VPN appliances exposing the HTML5 gateway directory traversal flaw
  tags: cve,pulse,vpn

requests:
  - method: GET
    path:
      - "/dana-na/../dana/html5acc/guacamole/"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Guacamole"
          - "HTML5"
        condition: or
      - type: dsl
        dsl:
          - "contains(body, 'Pulse Secure') or contains(header('Set-Cookie') or '', 'DSID')"
    stop-at-first-match: true
