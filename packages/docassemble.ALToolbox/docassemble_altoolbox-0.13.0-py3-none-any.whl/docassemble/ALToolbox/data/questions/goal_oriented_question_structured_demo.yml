---
include:
  - goal_oriented_question_structured.yml
---
metadata:
  title: Legal Aid Intake - Structured Initial Question Demo
  short title: Structured Intake Demo
  description: |
    This interview demonstrates using GoalOrientedQuestionList with a
    structured initial question (using radio buttons, checkboxes, etc.)
    instead of an open-ended narrative response.
---
objects:
  - housing_intake: GoalOrientedQuestionList.using(rubric="The response provides complete information about the tenant's housing situation, including the type of issue, timeline, communication with landlord, and any immediate safety or habitability concerns.", initial_question="We need to understand your housing situation to determine how we can help. Please provide information about your housing issue.", llm_assumed_role="housing intake specialist", user_assumed_role="tenant seeking help")
---
mandatory: True
code: |
  intro_screen
  # Trigger the initial structured question
  housing_intake._initial_structured_complete
  housing_intake.gather()
  final_response
  intake_summary
---
code: |
  if len(housing_intake):
    final_response_default = housing_intake.synthesize_draft_response()
  else:
    final_response_default = housing_intake.initial_response_as_text()
---
continue button field: intro_screen
question: |
  Welcome to Housing Legal Aid Intake (Structured)
subquestion: |
  This demo shows how the **GoalOrientedQuestionList** can use structured
  fields (radio buttons, checkboxes, etc.) for the initial question instead
  of requiring an open-ended narrative.
  
  #### Scenario
  
  You are seeking help with a housing issue. An intake worker needs to understand
  your situation using a structured form.
  
  #### How it works:
  
  1. The AI will generate structured fields for the initial question based on the rubric
  2. You'll answer using radio buttons, checkboxes, dates, etc. (not just a text area)
  3. The AI will then ask follow-up questions if more information is needed
  4. Your responses will be synthesized into a complete intake summary
  
  This approach is useful when you want more structured data collection from the start.
---
question: |
  Review your intake information
subquestion: |
  % if len(housing_intake):
  Based on your responses, we've prepared this summary of your situation.
  Please review it and make any corrections or additions before we finalize
  your intake information.

  ${ collapse_template(housing_intake.show_current_progress) }
  % else:
  Here is the information you provided. You can make any edits before we finalize
  your intake.
  % endif
fields:
  - Intake summary: final_response
    datatype: area
    rows: 10
    default: |
      ${ final_response_default }
---
event: intake_summary
question: |
  Intake completed
subquestion: |
  Thank you for providing this information. Your intake summary is ready
  for the intake worker to review before your consultation.
  
  #### Intake Summary
  
  > ${ final_response }
  
  % if len(housing_intake):
  #### Your Conversation
  
  ${ collapse_template(housing_intake.show_current_progress) }
  
  % endif
  
  #### Next Steps
  
  An intake worker will review this information and contact you to determine
  if we can help with your housing issue.
  
  ---
  
  #### About this demo
  
  This demo used a **GoalOrientedQuestionList** with structured initial question:
  
  * **Initial question format**: Structured fields (generated by AI)
  * **Question limit**: ${ housing_intake.question_limit } follow-up questions maximum
  * **Follow-ups asked**: ${ len(housing_intake) }
  * **Sufficient information gathered**: ${ "Yes" if housing_intake.satisfied() else "Partially" }
  * **Model**: ${ housing_intake.model }
  * **LLM role**: ${ housing_intake.llm_assumed_role }
  * **User role**: ${ housing_intake.user_assumed_role }
  
  The AI generated structured fields for the initial question and then asked follow-ups until the response met this rubric:
  
  > ${ housing_intake.rubric }
buttons:
  - Exit: exit
  - Restart: restart
