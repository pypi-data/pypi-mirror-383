.. image:: https://odoo-community.org/readme-banner-image
   :target: https://odoo-community.org/get-involved?utm_source=readme
   :alt: Odoo Community Association

====================
Creación de Facturae
====================

.. 
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! source digest: sha256:e05a05372bc5b8c0937723c7acc4b2724436387b162f976bb66171dcb4aa7cc8
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
    :target: https://odoo-community.org/page/development-status
    :alt: Beta
.. |badge2| image:: https://img.shields.io/badge/license-AGPL--3-blue.png
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fl10n--spain-lightgray.png?logo=github
    :target: https://github.com/OCA/l10n-spain/tree/18.0/l10n_es_facturae
    :alt: OCA/l10n-spain
.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
    :target: https://translation.odoo-community.org/projects/l10n-spain-18-0/l10n-spain-18-0-l10n_es_facturae
    :alt: Translate me on Weblate
.. |badge5| image:: https://img.shields.io/badge/runboat-Try%20me-875A7B.png
    :target: https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&target_branch=18.0
    :alt: Try me on Runboat

|badge1| |badge2| |badge3| |badge4| |badge5|

En virtud de la Ley 25/2013, de 27 de diciembre, de impulso de la
factura electrónica y creación del registro contable de facturas en el
Sector Público, desde el día 15 de enero de 2015 todas las facturas
remitidas a las administraciones públicas tienen que ser electrónicas.
Téngase en cuenta, no obstante, que muchas Administraciones Públicas, y
entre ellas la Administración General del Estado, han hecho uso de la
potestad de exonerar de esta obligación a las facturas de hasta 5.000
euros. Estas facturas electrónicas se enviarán a través de los puntos
generales de entrada de facturas electrónicas de la administración
correspondiente. Estos puntos generales le permitirán consultar
electrónicamente el estado de tramitación de su factura, una vez
remitida. El de la Administración General del Estado se denomina FACe
(`www.face.gob.es <http://www.face.gob.es>`__). En estas facturas
electrónicas habrá que indicar la oficina contable, el órgano gestor y
la unidad tramitadora, para que llegue correctamente a su destino. La
administración le proporcionará estos datos.

Información sobre el formato:

- https://www.facturae.gob.es/formato/Versiones/Esquema_castellano_v3_2_x_06_06_2017_unificado.pdf

**Table of contents**

.. contents::
   :local:

Use Cases / Context
===================

La facturación electrónica consiste en la emisión, envío y recepción de
facturas en formato digital, garantizando su validez legal y fiscal.
Este método permite cumplir con las normativas vigentes, especialmente
en transacciones con administraciones públicas y grandes empresas.

Installation
============

Este módulo depende del módulo *account_payment_partner* y sus
dependencias, que se encuentran en https://github.com/OCA/bank-payment.

Para generar el archivo XML, hace falta el módulo *report_xml* que se
encuentra en https://github.com/OCA/reporting-engine.

En el caso de querer firmar el formato Facturae desde Odoo, debe
instalarse la última versión de xmlsig mediante el comando ´pip install
xmlsig´. La versión mínima de la misma debe ser 0.1.2.

Si se instalan los módulos *account_banking_mandate* o
*partner_firstname*, se utilizará para el XML generado la cuenta
bancaria de los mandatos o los apellidos respectivamente.

Configuration
=============

Pasos para comenzar a utilizar la facturación electrónica:

1. **Configurar los contactos a los que se emitirá facturación
   electrónica**

El primer paso es configurar los contactos de los clientes a los que se
enviará la facturación electrónica. Para ello, diríjase al menú de
**Contactos**, seleccione la **ficha del cliente** correspondiente y
acceda a la sección de **Facturación/Contabilidad**, específicamente al
apartado de **Facturae**.

|usage_01| |usage_02|

Aquí debe **activar la casilla** correspondiente, seleccionar la
**versión de Facturae** que utilizará y añadir los **códigos**
necesarios para completar esta configuración.

|usage_03|

2. **Completar la información de la compañía propia:**

Una vez configurados los contactos, es importante asegurarse de que la
información de su propia compañía esté completa. Para ello, acceda a la
ficha de su empresa en **ajustes** y añada todos los datos requeridos,
incluyendo la **versión de Facturae** que utilizará.

|usage_04| |usage_05|

Este paso es fundamental para que las facturas electrónicas se generen
correctamente y cumplan con los estándares exigidos.

3. **Añadir el certificado digital:**

El siguiente paso es cargar el certificado digital, que es indispensable
para firmar las facturas electrónicas. Vaya a la sección de
**Facturación/Contabilidad**, acceda al apartado de **Configuración** y
seleccione Certificados AEAT.

En esta pantalla, haga clic en **Nuevo** para crear un registro para su
certificado. |usage_06|

Asígnele un nombre y suba el archivo correspondiente. Una vez cargado el
certificado, haga clic en la opción de **Obtener claves** y guarde los
cambios.

|usage_07|

.. |usage_01| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_01.png
.. |usage_02| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_02.png
.. |usage_03| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_03.png
.. |usage_04| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_04.png
.. |usage_05| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_05.png
.. |usage_06| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_06.png
.. |usage_07| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_07.png

Usage
=====

**Descargue el archivo de facturae**

Con la configuración lista, ya puede proceder a emitir sus facturas
electrónicas. Para ello, acceda a **Facturación/Contabilidad**, entre en
el menú de **Clientes** y seleccione **Facturas**. |usage_08|

Haga clic en **Nuevo** para crear una nueva factura. Complete toda la
información necesaria, guarde los datos, y luego seleccione el icono de
**engranaje de Acción**.

|usage_09|

Aquí encontrará la opción para descargar el archivo de la factura
electrónica. Si es necesario, firme el archivo antes de descargarlo.

|usage_10|

Finalmente, una vez que tenga el archivo listo, puede subirlo al portal
**FACe** para completar el proceso.

.. |usage_08| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_08.png
.. |usage_09| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_09.png
.. |usage_10| image:: https://raw.githubusercontent.com/OCA/l10n-spain/18.0/l10n_es_facturae/static/description/usage_10.png

Known issues / Roadmap
======================

- No está soportada la exportación de facturas rectificativas. Fallan
  las series.
- El certificado y la contraseña de acceso al certificado no se guardan
  cifrados en la base de datos.
- Ver la posibilidad de exportar varias facturas juntas.
- Las facturas con recargo de equivalencia no generan un formato
  correcto.
- Debido a un cambio de certificados, mal hechos desde Camerfirma, se ha
  eliminado el cálculo automático del hash del método de firma.

Changelog
=========

13.0.2.0.0
----------

A la hora de integrar con los diferentes sistemas, se utilizará la
configuración definida en edi. Es decir, se gestionará con edi.document
y componentes.

Será potestad de los módulos que utilicen el antiguo
account.invoice.integration migrarlo a su configuración respectiva. En
la migración no se eliminarán las tablas antiguas para permitir la
migración necesaria.

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/OCA/l10n-spain/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us to smash it by providing a detailed and welcomed
`feedback <https://github.com/OCA/l10n-spain/issues/new?body=module:%20l10n_es_facturae%0Aversion:%2018.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
-------

* ASR-OSS
* FactorLibre
* Tecon
* Comunitea
* Tecnativa
* Dixmit

Contributors
------------

- ASR-OSS (http://www.asr-oss.com)
- FactorLibre (http://www.factorlibre.com)
- Tecon (http://www.tecon.es)
- Pexego (http://www.pexego.es)
- Malagatic (http://www.malagatic.es)
- Comunitea (http://www.comunitea.com)
- Pedro M. Baeza (http://www.tecnativa.com)
- Javi Melendez <javimelex@gmail.com>
- Enric Tobella <enric.tobella@dixmit.com>
- Adrián Gómez <adrian.gomez@pesol.es>
- Eduardo de Miguel (edu@moduon.team)
- Eric Antones (eantones@nuobit.com>
- Alberto Martínez (alberto.martinez@sygel.es)
- Carolina Fernandez (http://www.tecnativa.com)

Maintainers
-----------

This module is maintained by the OCA.

.. image:: https://odoo-community.org/logo.png
   :alt: Odoo Community Association
   :target: https://odoo-community.org

OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.

.. |maintainer-etobella| image:: https://github.com/etobella.png?size=40px
    :target: https://github.com/etobella
    :alt: etobella

Current `maintainer <https://odoo-community.org/page/maintainer-role>`__:

|maintainer-etobella| 

This module is part of the `OCA/l10n-spain <https://github.com/OCA/l10n-spain/tree/18.0/l10n_es_facturae>`_ project on GitHub.

You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
