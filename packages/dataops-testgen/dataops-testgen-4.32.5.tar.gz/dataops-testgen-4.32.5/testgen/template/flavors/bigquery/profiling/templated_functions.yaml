IS_NUM: CASE
            WHEN REGEXP_CONTAINS(CAST({$1} AS STRING),
             r'^\s*[+-]?\$?\s*[0-9]+(,[0-9]{3})*(\.[0-9]*)?[%]?\s*$') THEN 1
            ELSE 0
        END

IS_DATE: |
  CASE
    /* YYYY-MM-DD HH:MM:SS SSSSSS */
    WHEN SAFE.PARSE_DATETIME('%F %H:%M:%S %6f', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* YYYY-MM-DD HH:MM:SS */
    WHEN SAFE.PARSE_DATETIME('%F %H:%M:%S', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* YYYYMMDDHHMMSSSSSS */
    WHEN SAFE.PARSE_DATETIME('%Y%m%d%H%M%S%6f', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* YYYYMMDDHHMMSS */
    WHEN SAFE.PARSE_DATETIME('%Y%m%d%H%M%S', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* YYYYMMDD */
    WHEN LENGTH(CAST({$1} AS STRING)) = 8 AND SAFE.PARSE_DATE('%Y%m%d', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* Exclude anything else long */
    WHEN LENGTH(CAST({$1} AS STRING)) > 11 THEN 0

    /* YYYY-MON-DD */
    WHEN SAFE.PARSE_DATE('%Y-%b-%d', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* YYYY-MM-DD */
    WHEN SAFE.PARSE_DATE('%F', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* MM/DD/YYYY */
    WHEN SAFE.PARSE_DATE('%m/%d/%Y', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* MM/DD/YY */
    WHEN SAFE.PARSE_DATE('%m/%d/%y', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* MM-DD-YYYY */
    WHEN SAFE.PARSE_DATE('%m-%d-%Y', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* MM-DD-YY */
    WHEN SAFE.PARSE_DATE('%m-%d-%y', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    /* DD-MON-YYYY */
    WHEN SAFE.PARSE_DATE('%d-%b-%Y', CAST({$1} AS STRING)) IS NOT NULL THEN 1

    ELSE 0
  END
